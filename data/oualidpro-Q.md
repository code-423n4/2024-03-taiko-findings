## Summary

### Low Risk Issues

| |Issue|Instances|
|-|:-|:-:|
| [[L&#x2011;1](#l1-vulnerable-versions-of-packages-are-being-used)] | Vulnerable versions of packages are being used | 1 | 
| [[L&#x2011;2](#l2-direct-supportsinterface-calls-may-cause-caller-to-revert)] | Direct `supportsInterface()` calls may cause caller to revert | 1 | 
| [[L&#x2011;3](#l3-missing-checks-for-address-0-when-assigning-values-to-address-state-variables)] | Missing checks for `address(0)` when assigning values to address state variables | 8 | 
| [[L&#x2011;4](#l4-array-lengths-not-checked)] | Array lengths not checked | 2 | 
| [[L&#x2011;5](#l5-for-loops-in-public-or-external-functions-should-be-avoided-due-to-high-gas-costs-and-possible-dos)] | For loops in public or external functions should be avoided due to high gas costs and possible DOS | 11 | 
| [[L&#x2011;6](#l6-double-type-casts-create-complexity-within-the-code)] | Double type casts create complexity within the code | 2 | 
| [[L&#x2011;7](#l7-external-calls-in-an-un-bounded-loop-may-result-in-a-dos)] | `external` calls in an un-bounded loop may result in a DOS | 16 | 
| [[L&#x2011;8](#l8-constant-decimal-values)] | Constant decimal values | 1 | 
| [[L&#x2011;9](#l9-initialization-can-be-front-run)] | Initialization can be front-run | 19 | 
| [[L&#x2011;10](#l10-internal-function-calls-within-for-loops)] | `internal` Function calls within for loops | 13 | 
| [[L&#x2011;11](#l11-loss-of-precision)] | Loss of precision | 4 | 
| [[L&#x2011;12](#l12-onlyowner-functions-not-accessible-if-owner-renounces-ownership)] | `onlyOwner` functions not accessible if `owner` renounces ownership | 2 | 
| [[L&#x2011;13](#l13-governance-operations-should-be-behind-a-timelock)] | Governance operations should be behind a timelock | 36 | 
| [[L&#x2011;14](#l14-require-should-be-used-instead-of-assert)] | `require()` should be used instead of `assert()` | 4 | 
| [[L&#x2011;15](#l15-consider-using-openzeppelin-s-safecast-library-to-prevent-unexpected-overflows-when-casting-from-various-type-int-uint-values)] | Consider using OpenZeppelinâ€™s SafeCast library to prevent unexpected overflows when casting from various type int/uint values | 17 | 
| [[L&#x2011;16](#l16-setters-should-have-initial-value-check)] | Setters should have initial value check | 3 | 
| [[L&#x2011;17](#l17-int-casting-block-timestamp-can-reduce-the-lifespan-of-a-contract)] | Int casting `block.timestamp` can reduce the lifespan of a contract | 14 | 
| [[L&#x2011;18](#l18-large-transfers-may-not-work-with-some-erc20-tokens)] | Large transfers may not work with some `ERC20` tokens | 1 | 
| [[L&#x2011;19](#l19-arrays-can-grow-in-size-without-a-way-to-shrink-them)] | Arrays can grow in size without a way to shrink them | 1 | 
| [[L&#x2011;20](#l20-unsafe-downcast)] | Unsafe downcast | 31 | 
| [[L&#x2011;21](#l21-unused-empty-receive-fallback-function)] | Unused/empty `receive()`/`fallback()` function | 1 | 
| [[L&#x2011;22](#l22-consider-implementing-two-step-procedure-for-updating-protocol-addresses)] | Consider implementing two-step procedure for updating protocol addresses | 4 | 
| [[L&#x2011;23](#l23-upgradeable-contract-uses-non-upgradeable-version-of-the-openzeppelin-libraries-contracts)] | Upgradeable contract uses non-upgradeable version of the OpenZeppelin libraries/contracts | 26 | 
| [[L&#x2011;24](#l24-consider-using-descriptive-constant-s-when-passing-zero-as-a-function-argument)] | Consider using descriptive `constant`s when passing zero as a function argument | 3 | 
| [[L&#x2011;25](#l25-check-of-division-by-zero)] | Check of division by zero | 5 | 
| [[L&#x2011;26](#l26-functions-calling-contracts-addresses-with-transfer-hooks-are-missing-reentrancy-guards)] | Functions calling contracts/addresses with transfer hooks are missing reentrancy guards | 9 | 
| [[L&#x2011;27](#l27-pausing-withdrawals-is-unfair-to-the-users)] | Pausing withdrawals is unfair to the users | 1 | 
| [[L&#x2011;28](#l28-lack-of-support-for-erc1155-nft)] | Lack of support for ERC1155 NFT | 2 | 
| [[L&#x2011;29](#l29-some-function-should-not-be-marked-as-payable)] | Some function should not be marked as payable | 1 | 
| [[L&#x2011;30](#l30-code-does-not-follow-the-best-practice-of-check-effects-interaction)] | Code does not follow the best practice of check-effects-interaction | 9 | 
| [[L&#x2011;31](#l31-prevent-re-setting-a-state-variable-with-the-same-value)] | prevent re-setting a state variable with the same value | 4 | 
| [[L&#x2011;32](#l32-missing-contract-existence-checks-before-yul-call)] | Missing contract-existence checks before yul `call()` | 1 | 
| [[L&#x2011;33](#l33-use-of-tx-origin-is-unsafe-in-almost-every-context)] | Use of `tx.origin` is unsafe in almost every context | 1 | 
| [[L&#x2011;34](#l34-function-can-return-unassigned-variable)] | Function can return unassigned variable | 4 | 
| [[L&#x2011;35](#l35-missing-checks-in-initializer-function)] | Missing checks in initializer function | 4 | 
| [[L&#x2011;36](#l36-variables-shadowing-other-definitions)] | Variables shadowing other definitions | 70 | 
| [[L&#x2011;37](#l37-sending-tokens-in-a-for-loop)] | Sending tokens in a for loop | 4 | 
| [[L&#x2011;38](#l38-empty-receive-functions-can-cause-gas-issues)] | Empty receive functions can cause gas issues | 1 | 

Total: 337 instances over 38 issues

### Non-critical Issues

| |Issue|Instances|
|-|:-|:-:|
| [[NC&#x2011;1](#nc1-consider-using-modifiers-for-address-control)] | Consider using modifiers for address control | 20 | 
| [[NC&#x2011;2](#nc2-large-or-complicated-code-bases-should-implement-invariant-tests)] | Large or complicated code bases should implement invariant tests | 1 | 
| [[NC&#x2011;3](#nc3-array-is-push-ed-but-not-pop-ed)] | Array is `push()`ed but not `pop()`ed | 1 | 
| [[NC&#x2011;4](#nc4-assembly-blocks-should-have-extensive-comments)] | Assembly blocks should have extensive comments | 34 | 
| [[NC&#x2011;5](#nc5-natspec-natspec-author-is-missing-from-contract)] | [NatSpec] Natspec `@author` is missing from `contract` | 84 | 
| [[NC&#x2011;6](#nc6-avoid-the-use-of-sensitive-terms)] | Avoid the use of sensitive terms | 6 | 
| [[NC&#x2011;7](#nc7-variable-names-that-consist-of-all-capital-letters-should-be-reserved-for-constant-immutable-variables)] | Variable names that consist of all capital letters should be reserved for `constant`/`immutable` variables | 1 | 
| [[NC&#x2011;8](#nc8-common-functions-should-be-refactored-to-a-common-base-contract)] | Common functions should be refactored to a common base contract | 4 | 
| [[NC&#x2011;9](#nc9-overly-complicated-arithmetic)] | Overly complicated arithmetic | 8 | 
| [[NC&#x2011;10](#nc10-constants-in-comparisons-should-appear-on-the-left-side)] | Constants in comparisons should appear on the left side | 246 | 
| [[NC&#x2011;11](#nc11-natspec-natspec-description-is-missing-from-contract)] | [NatSpec] Natspec description is missing from `contract` | 392 | 
| [[NC&#x2011;12](#nc12-contract-does-not-follow-the-solidity-style-guide-s-suggested-layout-ordering)] | Contract does not follow the Solidity style guide's suggested layout ordering | 2 | 
| [[NC&#x2011;13](#nc13-contracts-containing-only-utility-functions-should-be-made-into-libraries)] | Contracts containing only utility functions should be made into libraries | 1 | 
| [[NC&#x2011;14](#nc14-control-structures-do-not-follow-the-solidity-style-guide)] | Control structures do not follow the Solidity Style Guide | 191 | 
| [[NC&#x2011;15](#nc15-custom-error-has-no-error-details)] | Custom error has no error details | 156 | 
| [[NC&#x2011;16](#nc16-consider-using-delete-rather-than-assigning-zero-to-clear-values)] | Consider using `delete` rather than assigning `zero` to clear values | 10 | 
| [[NC&#x2011;17](#nc17-else-block-not-required)] | `else`-block not required | 22 | 
| [[NC&#x2011;18](#nc18-empty-bytes-check-is-missing)] | Empty bytes check is missing | 102 | 
| [[NC&#x2011;19](#nc19-events-are-missing-sender-information)] | Events are missing sender information | 49 | 
| [[NC&#x2011;20](#nc20-events-may-be-emitted-out-of-order-due-to-reentrancy)] | Events may be emitted out of order due to reentrancy | 5 | 
| [[NC&#x2011;21](#nc21-explicitly-define-visibility-of-state-variables-to-prevent-misconceptions-on-what-can-access-the-variable)] | Explicitly define visibility of state variables to prevent misconceptions on what can access the variable | 3 | 
| [[NC&#x2011;22](#nc22-defining-all-external-public-functions-in-contract-interfaces)] | Defining All External/Public Functions in Contract Interfaces | 87 | 
| [[NC&#x2011;23](#nc23-function-ordering-does-not-follow-the-solidity-style-guide)] | Function ordering does not follow the Solidity style guide | 5 | 
| [[NC&#x2011;24](#nc24-address-s-shouldn-t-be-hard-coded)] | `address`s shouldn't be hard-coded | 1 | 
| [[NC&#x2011;25](#nc25-array-indicies-should-be-referenced-via-enum-s-rather-than-via-numeric-literals)] | Array indicies should be referenced via `enum`s rather than via numeric literals | 29 | 
| [[NC&#x2011;26](#nc26-hardcoded-string-that-is-repeatedly-used-can-be-replaced-with-a-constant)] | Hardcoded string that is repeatedly used can be replaced with a constant | 6 | 
| [[NC&#x2011;27](#nc27-duplicated-require-checks-should-be-refactored-to-a-modifier-or-function)] | Duplicated `require()` checks should be refactored to a modifier or function | 2 | 
| [[NC&#x2011;28](#nc28-some-if-statement-can-be-converted-to-a-ternary)] | Some if-statement can be converted to a ternary | 20 | 
| [[NC&#x2011;29](#nc29-imports-could-be-organized-more-systematically)] | Imports could be organized more systematically | 23 | 
| [[NC&#x2011;30](#nc30-import-declarations-should-import-specific-identifiers-rather-than-the-whole-file)] | Import declarations should import specific identifiers, rather than the whole file | 176 | 
| [[NC&#x2011;31](#nc31-inconsistent-spacing-in-comments)] | Inconsistent spacing in comments | 21 | 
| [[NC&#x2011;32](#nc32-inconsistent-usage-of-require-error)] | Inconsistent usage of `require`/`error` | 60 | 
| [[NC&#x2011;33](#nc33-interfaces-should-be-defined-in-separate-files-from-their-usage)] | Interfaces should be defined in separate files from their usage | 2 | 
| [[NC&#x2011;34](#nc34-internal-functions-not-called-by-the-contract-should-be-removed)] | `internal` functions not called by the contract should be removed | 13 | 
| [[NC&#x2011;35](#nc35-large-numeric-literals-should-use-underscores-for-readability)] | Large numeric literals should use underscores for readability | 23 | 
| [[NC&#x2011;36](#nc36-long-functions-should-be-refactored-into-multiple-smaller-functions)] | Long functions should be refactored into multiple, smaller, functions | 30 | 
| [[NC&#x2011;37](#nc37-long-lines-of-code)] | Long lines of code | 6 | 
| [[NC&#x2011;38](#nc38-missing-event-and-or-timelock-for-critical-parameter-change)] | Missing event and or timelock for critical parameter change | 3 | 
| [[NC&#x2011;39](#nc39-some-error-strings-are-not-descriptive)] | Some error strings are not descriptive | 16 | 
| [[NC&#x2011;40](#nc40-the-nonreentrant-modifier-should-occur-before-all-other-modifiers)] | The `nonReentrant` `modifier` should occur before all other modifiers | 4 | 
| [[NC&#x2011;41](#nc41-events-that-mark-critical-parameter-changes-should-contain-both-the-old-and-the-new-value)] | Events that mark critical parameter changes should contain both the old and the new value | 7 | 
| [[NC&#x2011;42](#nc42-use-of-override-is-unnecessary)] | Use of `override` is unnecessary | 38 | 
| [[NC&#x2011;43](#nc43-use-openzeppelin-s-merkleproof-rather-than-rolling-your-own)] | Use OpenZeppelin's `MerkleProof` rather than rolling your own | 1 | 
| [[NC&#x2011;44](#nc44-functions-which-are-either-private-or-internal-should-have-a-preceding-in-their-name)] | Functions which are either private or internal should have a preceding _ in their name | 95 | 
| [[NC&#x2011;45](#nc45-private-and-internal-state-variables-should-have-a-preceding-in-their-name-unless-they-are-constants)] | Private and internal state variables should have a preceding _ in their name unless they are constants | 1 | 
| [[NC&#x2011;46](#nc46-public-functions-not-called-by-the-contract-should-be-declared-external-instead)] | `public` functions not called by the contract should be declared `external` instead | 36 | 
| [[NC&#x2011;47](#nc47-adding-a-return-statement-when-the-function-defines-a-named-return-variable-is-redundant)] | Adding a `return` statement when the function defines a named return variable, is redundant | 3 | 
| [[NC&#x2011;48](#nc48-redundant-inheritance-specifier)] | Redundant inheritance specifier | 3 | 
| [[NC&#x2011;49](#nc49-require-revert-statements-should-have-descriptive-reason-strings)] | `require()` / `revert()` statements should have descriptive reason strings | 6 | 
| [[NC&#x2011;50](#nc50-setters-should-prevent-re-setting-of-the-same-value)] | Setters should prevent re-setting of the same value | 7 | 
| [[NC&#x2011;51](#nc51-natspec-return-argument-is-missing)] | NatSpec `@return` argument is missing | 20 | 
| [[NC&#x2011;52](#nc52-consider-using-safetransferlib-safetransfereth-or-address-sendvalue-for-clearer-semantic-meaning)] | Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning | 1 | 
| [[NC&#x2011;53](#nc53-polymorphic-functions-make-security-audits-more-time-consuming-and-error-prone)] | Polymorphic functions make security audits more time-consuming and error-prone | 3 | 
| [[NC&#x2011;54](#nc54-large-multiples-of-ten-should-use-scientific-notation-e-g-1e6-rather-than-decimal-literals-e-g-1000000-for-readability)] | Large multiples of ten should use scientific notation (e.g. `1e6`) rather than decimal literals (e.g. `1000000`), for readability | 7 | 
| [[NC&#x2011;55](#nc55-empty-receive-payable-fallback-function-does-not-authorize-requests)] | Empty `receive()`/`payable fallback()` function does not authorize requests | 1 | 
| [[NC&#x2011;56](#nc56-state-variables-should-have-natspec-comments)] | State variables should have `Natspec` comments | 73 | 
| [[NC&#x2011;57](#nc57-contracts-should-have-full-test-coverage)] | Contracts should have full test coverage | 1 | 
| [[NC&#x2011;58](#nc58-numeric-values-having-to-do-with-time-should-use-time-units-for-readability)] | Numeric values having to do with time should use time units for readability | 6 | 
| [[NC&#x2011;59](#nc59-natspec-natspec-title-is-missing-from-contract)] | [NatSpec] Natspec `@title` is missing from `contract` | 2 | 
| [[NC&#x2011;60](#nc60-open-todos)] | Open TODOs | 2 | 
| [[NC&#x2011;61](#nc61-top-level-pragma-declarations-should-be-separated-by-two-blank-lines)] | Top level pragma declarations should be separated by two blank lines | 56 | 
| [[NC&#x2011;62](#nc62-critical-functions-should-be-a-two-step-procedure)] | Critical functions should be a two step procedure | 14 | 
| [[NC&#x2011;63](#nc63-2-n-1-should-be-re-written-as-type-uint-n-max)] | `2**<n> - 1` should be re-written as `type(uint<n>).max` | 1 | 
| [[NC&#x2011;64](#nc64-uncommented-fields-in-a-struct)] | Uncommented fields in a struct | 43 | 
| [[NC&#x2011;65](#nc65-using-underscore-at-the-end-of-variable-name)] | Using underscore at the end of variable name | 99 | 
| [[NC&#x2011;66](#nc66-event-is-missing-indexed-fields)] | Event is missing `indexed` fields | 41 | 
| [[NC&#x2011;67](#nc67-unused-error-definition)] | Unused `error` definition | 1 | 
| [[NC&#x2011;68](#nc68-unused-import)] | Unused Import | 7 | 
| [[NC&#x2011;69](#nc69-unused-internal-private-contract-variable)] | Unused `internal`/`private` contract variable | 35 | 
| [[NC&#x2011;70](#nc70-missing-upgradability-functionality)] | Missing upgradability functionality | 1 | 
| [[NC&#x2011;71](#nc71-cast-to-bytes-or-bytes32-for-clearer-semantic-meaning)] | Cast to `bytes` or `bytes32` for clearer semantic meaning | 8 | 
| [[NC&#x2011;72](#nc72-use-bytes-concat-on-bytes-instead-of-abi-encodepacked-for-clearer-semantic-meaning)] | Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning | 8 | 
| [[NC&#x2011;73](#nc73-use-string-concat-on-strings-instead-of-abi-encodepacked-for-clearer-semantic-meaning)] | Use `string.concat()` on strings instead of `abi.encodePacked()` for clearer semantic meaning | 2 | 
| [[NC&#x2011;74](#nc74-constants-should-be-defined-rather-than-using-magic-numbers)] | Constants should be defined rather than using magic numbers | 395 | 
| [[NC&#x2011;75](#nc75-use-inheritdoc-rather-than-using-a-non-standard-annotation)] | Use `@inheritdoc` rather than using a non-standard annotation | 4 | 
| [[NC&#x2011;76](#nc76-use-openzeppelin-s-reentrancyguard-reentrancyguardupgradeable-rather-than-writing-your-own)] | Use OpenZeppelin's `ReentrancyGuard` / `ReentrancyGuardUpgradeable` rather than writing your own | 1 | 
| [[NC&#x2011;77](#nc77-use-a-single-file-for-system-wide-constants)] | Use a single file for system wide constants | 21 | 
| [[NC&#x2011;78](#nc78-consider-using-smtchecker)] | Consider using SMTChecker | 79 | 
| [[NC&#x2011;79](#nc79-whitespace-in-expressions)] | Whitespace in Expressions | 2 | 
| [[NC&#x2011;80](#nc80-complex-function-controle-flow)] | Complex function controle flow | 15 | 
| [[NC&#x2011;81](#nc81-consider-bounding-input-array-length)] | Consider bounding input array length | 12 | 
| [[NC&#x2011;82](#nc82-a-function-which-defines-named-returns-in-it-s-declaration-doesn-t-need-to-use-return)] | A function which defines named returns in it's declaration doesn't need to use return | 6 | 
| [[NC&#x2011;83](#nc83-natspec-natspec-dev-is-missing-from-contract)] | [NatSpec] Natspec `@dev` is missing from `contract` | 683 | 
| [[NC&#x2011;84](#nc84-add-inline-comments-for-unnamed-variables)] | Add inline comments for unnamed variables | 1 | 
| [[NC&#x2011;85](#nc85-contract-should-expose-an-interface)] | Contract should expose an `interface` | 87 | 
| [[NC&#x2011;86](#nc86-named-imports-of-parent-contracts-are-missing)] | Named imports of parent contracts are missing | 69 | 
| [[NC&#x2011;87](#nc87-natspec-natspec-notice-is-missing-from-contract)] | [NatSpec] Natspec `@notice` is missing from `contract` | 509 | 
| [[NC&#x2011;88](#nc88-do-not-use-underscore-in-struct-elements-names)] | Do not use UNDERSCORE in `struct` elements names | 2 | 
| [[NC&#x2011;89](#nc89-expressions-for-constant-values-should-use-immutable-rather-than-constant)] | Expressions for constant values should use `immutable` rather than `constant` | 7 | 
| [[NC&#x2011;90](#nc90-consider-splitting-long-calculations)] | Consider splitting long calculations | 9 | 
| [[NC&#x2011;91](#nc91-immutable-variable-names-don-t-follow-the-solidity-style-guide)] | `immutable` variable names don\'t follow the Solidity style guide | 2 | 
| [[NC&#x2011;92](#nc92-private-public-function-name-should-start-with-underscore)] | `private`/`public` function name should start with underscore | 95 | 
| [[NC&#x2011;93](#nc93-assembly-block-creates-dirty-bits)] | Assembly block creates dirty bits | 23 | 
| [[NC&#x2011;94](#nc94-add-inline-comments-for-unnamed-parameters)] | Add inline comments for unnamed parameters | 11 | 
| [[NC&#x2011;95](#nc95-consider-adding-formal-verification-proofs)] | Consider adding formal verification proofs | 1 | 
| [[NC&#x2011;96](#nc96-missing-zero-address-check-in-functions-with-address-parameters)] | Missing zero address check in functions with address parameters | 5 | 
| [[NC&#x2011;97](#nc97-use-a-struct-to-encapsulate-multiple-function-parameters)] | Use a struct to encapsulate multiple function parameters | 23 | 
| [[NC&#x2011;98](#nc98-use-custom-errors-rather-than-revert-require-strings-for-better-readability)] | Use custom errors rather than `revert()`/`require()` strings for better readability | 60 | 
| [[NC&#x2011;99](#nc99-use-inheritdoc-for-overridden-functions)] | Use `@inheritdoc` for overridden functions | 43 | 
| [[NC&#x2011;100](#nc100-multiple-mappings-with-same-keys-can-be-combined-into-a-single-struct-mapping-for-readability)] | Multiple mappings with same keys can be combined into a single struct mapping for readability | 7 | 
| [[NC&#x2011;101](#nc101-constructor-should-emit-an-event)] | constructor should emit an event | 3 | 
| [[NC&#x2011;102](#nc102-error-should-be-named-using-capwords-style)] | `error` should be named using CapWords style | 156 | 
| [[NC&#x2011;103](#nc103-complex-functions-should-include-comments)] | Complex functions should include comments | 26 | 
| [[NC&#x2011;104](#nc104-make-use-of-solidiy-s-using-keyword)] | Make use of Solidiy's `using` keyword | 107 | 
| [[NC&#x2011;105](#nc105-avoid-using-underscore-at-the-end-of-a-variable-name)] | Avoid using underscore at the end of a variable name | 99 | 
| [[NC&#x2011;106](#nc106-natspec-natspec-param-is-missing-from-error)] | [NatSpec] Natspec `@param` is missing from `error` | 216 | 
| [[NC&#x2011;107](#nc107-natspec-natspec-comment-is-missing-from-scope-block)] | [NatSpec] Natspec comment is missing from scope `block` | 12 | 
| [[NC&#x2011;108](#nc108-openzeppelin-libraries-should-be-upgraded-to-a-newer-version)] | OpenZeppelin libraries should be upgraded to a newer version | 71 | 
| [[NC&#x2011;109](#nc109-not-using-the-latest-version-of-prb-math-from-dependencies)] | Not using the latest version of `prb-math` from dependencies | 1 | 
| [[NC&#x2011;110](#nc110-enforcing-lowercase-and-underscores-only-in-the-name-field-of-package-json)] | Enforcing Lowercase and Underscores Only in the `name` Field of package.json | 1 | 
| [[NC&#x2011;111](#nc111-non-constant-immutable-state-variables-are-missing-a-setter-post-deployment)] | Non constant/immutable state variables are missing a setter post deployment | 39 | 
| [[NC&#x2011;112](#nc112-consider-making-private-state-variables-internal-to-increase-flexibility)] | Consider making private state variables internal to increase flexibility | 52 | 
| [[NC&#x2011;113](#nc113-off-by-one-timestamp-error)] | Off-by-one timestamp error | 8 | 
| [[NC&#x2011;114](#nc114-lack-of-space-near-the-operator)] | Lack of space near the operator | 79 | 
| [[NC&#x2011;115](#nc115-incorrect-withdraw-declaration)] | Incorrect withdraw declaration | 4 | 
| [[NC&#x2011;116](#nc116-avoid-mutating-function-parameters)] | Avoid mutating function parameters | 2 | 
| [[NC&#x2011;117](#nc117-a-event-should-be-emitted-if-a-non-immutable-state-variable-is-set-in-a-constructor)] | A event should be emitted if a non immutable state variable is set in a constructor | 4 | 
| [[NC&#x2011;118](#nc118-contracts-use-both-1-and-and-1)] | Contracts use both += 1 and ++ (-- and -= 1) | 3 | 
| [[NC&#x2011;119](#nc119-returning-a-struct-instead-of-returning-many-variables-is-better)] | Returning a struct instead of returning many variables is better | 3 | 
| [[NC&#x2011;120](#nc120-not-using-the-named-return-variables-anywhere-in-the-function-is-confusing)] | Not using the named return variables anywhere in the function is confusing | 7 | 
| [[NC&#x2011;121](#nc121-use-named-return-values)] | Use named return values | 141 | 
| [[NC&#x2011;122](#nc122-consider-moving-duplicated-strings-to-constants)] | Consider moving duplicated strings to constants | 44 | 
| [[NC&#x2011;123](#nc123-missing-checks-for-uint-state-variable-assignments)] | Missing checks for uint state variable assignments | 14 | 
| [[NC&#x2011;124](#nc124-consider-adding-validation-of-user-inputs)] | Consider adding validation of user inputs | 114 | 
| [[NC&#x2011;125](#nc125-consider-allowing-users-access-to-their-funds-at-all-times)] | Consider allowing users access to their funds at all times | 1 | 
| [[NC&#x2011;126](#nc126-interfaces-should-use-floating-version-pragmas)] | Interfaces should use floating version pragmas | 14 | 
| [[NC&#x2011;127](#nc127-consider-disallowing-transfers-to-address-this)] | Consider disallowing transfers to `address(this)` | 6 | 
| [[NC&#x2011;128](#nc128-unusual-loop-variable)] | Unusual loop variable | 1 | 
| [[NC&#x2011;129](#nc129-consider-using-named-function-calls)] | Consider using named function calls | 176 | 

Total: 6070 instances over 129 issues

## Low Risk Issues

### [L&#x2011;1] Vulnerable versions of packages are being used 
This project's specific package versions are vulnerable to the specific CVEs listed below. Consider switching to more recent versions of these packages that don't have these vulnerabilities


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: package.json


<details><summary>Vulnerabilities related to `@openzeppelin/contracts`:</summary>


- [CVE-2023-34459](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-wprv-93r4-jj2p) :When the verifyMultiProof, verifyMultiProofCalldata, processMultiProof, or processMultiProofCalldata functions are in use, it is possible to construct merkle trees that allow forging a valid multiproof for an arbitrary set of leaves.
A contract may be vulnerable if it uses multiproofs for verification and the merkle tree that is processed includes a node with value 0 at depth 1(just under the root).This could happen inadvertently for balanced trees with 3 leaves or less, if the leaves are not hashed.This could happen deliberately if a malicious tree builder includes such a node in the tree.
A contract is not vulnerable if it uses single- leaf proving(verify, verifyCalldata, processProof, or processProofCalldata), or if it uses multiproofs with a known tree that has hashed leaves.Standard merkle trees produced or validated with the @openzeppelin/merkle-tree library are safe.


- [CVE-2023-34234](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-5h3x-9wvq-w4m2) :By frontrunning the creation of a proposal, an attacker can become the proposer and gain the ability to cancel it. The attacker can do this repeatedly to try to prevent a proposal from being proposed at all.
This impacts the Governor contract in v4.9.0 only, and the GovernorCompatibilityBravo contract since v4.3.0.


- [CVE-2023-30541](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-mx2q-35m2-x2rh) :A function in the implementation contract may be inaccessible if its selector clashes with one of the proxy's own selectors. Specifically, if the clashing function has a different signature with incompatible ABI encoding, the proxy could revert while attempting to decode the arguments from calldata.
The probability of an accidental clash is negligible, but one could be caused deliberately.


- [CVE-2023-30542](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-93hq-5wgc-jc82) :The proposal creation entrypoint (propose) in GovernorCompatibilityBravo allows the creation of proposals with a signatures array shorter than the calldatas array. This causes the additional elements of the latter to be ignored, and if the proposal succeeds the corresponding actions would eventually execute without any calldata. The ProposalCreated event correctly represents what will eventually execute, but the proposal parameters as queried through getActions appear to respect the original intended calldata.
</details>

<details><summary>Vulnerabilities related to `@openzeppelin/contracts-upgradeable`:</summary>


- [CVE-2023-34459](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-wprv-93r4-jj2p) :When the verifyMultiProof, verifyMultiProofCalldata, processMultiProof, or processMultiProofCalldata functions are in use, it is possible to construct merkle trees that allow forging a valid multiproof for an arbitrary set of leaves.
A contract may be vulnerable if it uses multiproofs for verification and the merkle tree that is processed includes a node with value 0 at depth 1(just under the root).This could happen inadvertently for balanced trees with 3 leaves or less, if the leaves are not hashed.This could happen deliberately if a malicious tree builder includes such a node in the tree.
A contract is not vulnerable if it uses single- leaf proving(verify, verifyCalldata, processProof, or processProofCalldata), or if it uses multiproofs with a known tree that has hashed leaves.Standard merkle trees produced or validated with the @openzeppelin/merkle-tree library are safe.


- [CVE-2023-34234](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-5h3x-9wvq-w4m2) :By frontrunning the creation of a proposal, an attacker can become the proposer and gain the ability to cancel it. The attacker can do this repeatedly to try to prevent a proposal from being proposed at all.
This impacts the Governor contract in v4.9.0 only, and the GovernorCompatibilityBravo contract since v4.3.0.


- [CVE-2023-30541](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-mx2q-35m2-x2rh) :A function in the implementation contract may be inaccessible if its selector clashes with one of the proxy's own selectors. Specifically, if the clashing function has a different signature with incompatible ABI encoding, the proxy could revert while attempting to decode the arguments from calldata.
The probability of an accidental clash is negligible, but one could be caused deliberately.


- [CVE-2023-30542](https://github.com/OpenZeppelin/openzeppelin-contracts/security/advisories/GHSA-93hq-5wgc-jc82) :The proposal creation entrypoint (propose) in GovernorCompatibilityBravo allows the creation of proposals with a signatures array shorter than the calldatas array. This causes the additional elements of the latter to be ignored, and if the proposal succeeds the corresponding actions would eventually execute without any calldata. The ProposalCreated event correctly represents what will eventually execute, but the proposal parameters as queried through getActions appear to respect the original intended calldata.
</details>1: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol//package.json#L1-L1) 


</details>


### [L&#x2011;2] Direct `supportsInterface()` calls may cause caller to revert 
Calling `supportsInterface()` on a contract that doesn't implement the ERC-165 standard will result in the call reverting. Even if the caller does support the function, the contract may be malicious and consume all of the transaction's available gas. Call it via a low-level [staticcall()](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/f959d7e4e6ee0b022b41e5b644c79369869d8411/contracts/utils/introspection/ERC165Checker.sol#L119), with a fixed amount of gas, and check the return code, or use OpenZeppelin's [`ERC165Checker.supportsInterface()`](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/f959d7e4e6ee0b022b41e5b644c79369869d8411/contracts/utils/introspection/ERC165Checker.sol#L36-L39).


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/LibAddress.sol

56:         try IERC165(_addr).supportsInterface(_interfaceId) returns (bool _result) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L56-L56) 


</details>


### [L&#x2011;3] Missing checks for `address(0)` when assigning values to address state variables 



*There are 8 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/utils/SigVerifyLib.sol

21:         ES256VERIFIER = es256Verifier;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L21-L21) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

41:         token = _token;

42:         vault = _vault;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L41-L41) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L42-L42)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

69:         token = _token;

70:         vault = _vault;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L70-L70)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

39:         token = _token;

40:         vault = _vault;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L40-L40)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

81:         snapshooter = _snapshooter;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L81-L81) 


</details>


### [L&#x2011;4] Array lengths not checked 
If the length of the arrays are not required to be of the same length, user operations may not be fully executed due to a mismatch in the number of items iterated over, versus the number of items provided in the second array


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

//@audit , _targets, _values, _calldatas length are not checked
48:     function propose(
49:         address[] memory _targets,
50:         uint256[] memory _values,
51:         bytes[] memory _calldatas,
52:         string memory _description
53:     )
54:         public
55:         override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
56:         returns (uint256)
57:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L48-L57) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit , _tokenIds, _amounts length are not checked
83:     function mintBatch(
84:         address _to,
85:         uint256[] memory _tokenIds,
86:         uint256[] memory _amounts
87:     )
88:         public
89:         nonReentrant
90:         whenNotPaused
91:         onlyFromNamed("erc1155_vault")
92:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L83-L92) 


</details>


### [L&#x2011;5] For loops in public or external functions should be avoided due to high gas costs and possible DOS 
In Solidity, for loops can potentially cause Denial of Service (DoS) attacks if not handled carefully. DoS attacks can occur when an attacker intentionally exploits the gas cost of a function, causing it to run out of gas or making it too expensive for other users to call. Below are some scenarios where for loops can lead to DoS attacks: Nested for loops can become exceptionally gas expensive and should be used sparingly


*There are 11 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(
54:         address[] memory _newGuardians,
55:         uint8 _minGuardians
56:     )
57:         external
58:         onlyOwner
59:         nonReentrant
60:     {
61:         // We need at least MIN_NUM_GUARDIANS and at most 255 guardians (so the approval bits fit in
62:         // a uint256)
63:         if (_newGuardians.length < MIN_NUM_GUARDIANS || _newGuardians.length > type(uint8).max) {
64:             revert INVALID_GUARDIAN_SET();
65:         }
66:         // Minimum number of guardians to approve is at least equal or greater than half the
67:         // guardians (rounded up) and less or equal than the total number of guardians
68:         if (_minGuardians < (_newGuardians.length + 1) >> 1 || _minGuardians > _newGuardians.length)
69:         {
70:             revert INVALID_MIN_GUARDIANS();
71:         }
72: 
73:         // Delete the current guardians
74:         for (uint256 i; i < guardians.length; ++i) {

53:     function setGuardians(
54:         address[] memory _newGuardians,
55:         uint8 _minGuardians
56:     )
57:         external
58:         onlyOwner
59:         nonReentrant
60:     {
61:         // We need at least MIN_NUM_GUARDIANS and at most 255 guardians (so the approval bits fit in
62:         // a uint256)
63:         if (_newGuardians.length < MIN_NUM_GUARDIANS || _newGuardians.length > type(uint8).max) {
64:             revert INVALID_GUARDIAN_SET();
65:         }
66:         // Minimum number of guardians to approve is at least equal or greater than half the
67:         // guardians (rounded up) and less or equal than the total number of guardians
68:         if (_minGuardians < (_newGuardians.length + 1) >> 1 || _minGuardians > _newGuardians.length)
69:         {
70:             revert INVALID_MIN_GUARDIANS();
71:         }
72: 
73:         // Delete the current guardians
74:         for (uint256 i; i < guardians.length; ++i) {
75:             delete guardianIds[guardians[i]];
76:         }
77:         delete guardians;
78: 
79:         // Set the new guardians
80:         for (uint256 i = 0; i < _newGuardians.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L74) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L80)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

73:     function addRevokedCertSerialNum(
74:         uint256 index,
75:         bytes[] calldata serialNumBatch
76:     )
77:         external
78:         onlyOwner
79:     {
80:         for (uint256 i; i < serialNumBatch.length; ++i) {

88:     function removeRevokedCertSerialNum(
89:         uint256 index,
90:         bytes[] calldata serialNumBatch
91:     )
92:         external
93:         onlyOwner
94:     {
95:         for (uint256 i; i < serialNumBatch.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L80) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L95)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

40:     function splitCertificateChain(
41:         bytes memory pemChain,
42:         uint256 size
43:     )
44:         external
45:         pure
46:         returns (bool success, bytes[] memory certs)
47:     {
48:         certs = new bytes[](size);
49:         string memory pemChainStr = string(pemChain);
50: 
51:         uint256 index = 0;
52:         uint256 len = pemChain.length;
53: 
54:         for (uint256 i; i < size; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L54) 


```solidity

File: /contracts/bridge/Bridge.sol

82:     function suspendMessages(
83:         bytes32[] calldata _msgHashes,
84:         bool _suspend
85:     )
86:         external
87:         onlyFromOwnerOrNamed("bridge_watchdog")
88:     {
89:         uint64 _timestamp = _suspend ? type(uint64).max : uint64(block.timestamp);
90:         for (uint256 i; i < _msgHashes.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L82-L90) 


```solidity

File: /contracts/signal/SignalService.sol

083:     function proveSignalReceived(
084:         uint64 _chainId,
085:         address _app,
086:         bytes32 _signal,
087:         bytes calldata _proof
088:     )
089:         public
090:         virtual
091:         validSender(_app)
092:         nonZeroValue(_signal)
093:     {
094:         HopProof[] memory hopProofs = abi.decode(_proof, (HopProof[]));
095:         if (hopProofs.length == 0) revert SS_EMPTY_PROOF();
096: 
097:         uint64 chainId = _chainId;
098:         address app = _app;
099:         bytes32 signal = _signal;
100:         bytes32 value = _signal;
101:         address signalService = resolve(chainId, "signal_service", false);
102: 
103:         HopProof memory hop;
104:         for (uint256 i; i < hopProofs.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L104) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

47:     function claim(
48:         address user,
49:         uint256[] calldata tokenIds,
50:         bytes32[] calldata proof
51:     )
52:         external
53:         nonReentrant
54:     {
55:         // Check if this can be claimed
56:         _verifyClaim(abi.encode(user, tokenIds), proof);
57: 
58:         // Transfer the tokens
59:         for (uint256 i; i < tokenIds.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L47-L59) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

39:     function sendToken(BridgeTransferOp memory _op)
40:         external
41:         payable
42:         nonReentrant
43:         whenNotPaused
44:         withValidOperation(_op)
45:         returns (IBridge.Message memory message_)
46:     {
47:         for (uint256 i; i < _op.amounts.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L39-L47) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

26:     function sendToken(BridgeTransferOp memory _op)
27:         external
28:         payable
29:         nonReentrant
30:         whenNotPaused
31:         withValidOperation(_op)
32:         returns (IBridge.Message memory message_)
33:     {
34:         for (uint256 i; i < _op.tokenIds.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L26-L34) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

100:     function deleteInstances(uint256[] calldata _ids)
101:         external
102:         onlyFromOwnerOrNamed("rollup_watchdog")
103:     {
104:         for (uint256 i; i < _ids.length; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L100-L104) 


</details>


### [L&#x2011;6] Double type casts create complexity within the code 
Double type casting should be avoided in Solidity contracts to prevent unintended consequences and ensure accurate data representation. Performing multiple type casts in succession can lead to unexpected truncation, rounding errors, or loss of precision, potentially compromising the contract's functionality and reliability. Furthermore, double type casting can make the code less readable and harder to maintain, increasing the likelihood of errors and misunderstandings during development and debugging. To ensure precise and consistent data handling, developers should use appropriate data types and avoid unnecessary or excessive type casting, promoting a more robust and dependable contract execution. 


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

154:             uint256 digits = uint256(uint8(bytes1(encoded[i])));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L154-L154) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

336:             decoded = uint8(BASE32_HEX_TABLE[uint256(uint8(char)) - 0x30]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L336-L336) 


</details>


### [L&#x2011;7] `external` calls in an un-bounded loop may result in a DOS 
Consider limiting the number of iterations in loops that make external calls


*There are 16 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibDepositing.sol

88:                 deposits_[i] = TaikoData.EthDeposit({


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L88-L88) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

149:                         tierProvider = _resolver.resolve("tier_provider", false);

152:                         uint256(ITierProvider(tierProvider).getTier(ts.tier).cooldownWindow) * 60

188:                 IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));

189:                 tko.transfer(ts.prover, bondToReturn);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L149-L149) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L189-L189)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

285:             verified = sigVerifyLib.verifyES256Signature(

424:                 (certDecodedSuccessfully, parsedQuoteCerts[i]) = pemCertLib.decodeCert(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L285-L285) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L424-L424)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

78:                     ptr: MemoryPointer.wrap(MemoryPointer.unwrap(_in.ptr) + offset)

78:                     ptr: MemoryPointer.wrap(MemoryPointer.unwrap(_in.ptr) + offset)

86:                 ptr: MemoryPointer.wrap(MemoryPointer.unwrap(_in.ptr) + offset)

86:                 ptr: MemoryPointer.wrap(MemoryPointer.unwrap(_in.ptr) + offset)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L78-L78) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L86-L86)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

94:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),

100:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L94-L94) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L100-L100)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

252:                     BridgedERC1155(_op.token).burn(_user, _op.tokenIds[i], _op.amounts[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L252-L252) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

176:                 BridgedERC721(token_).mint(_to, _tokenIds[i]);

198:                     BridgedERC721(_op.token).burn(_user, _op.tokenIds[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L176-L176) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L198-L198)


</details>


### [L&#x2011;8] Constant decimal values 
The use of fixed decimal values such as 1e18 or 1e8 in Solidity contracts can lead to inaccuracies, bugs, and vulnerabilities, particularly when interacting with tokens having different decimal configurations.Not all ERC20 tokens follow the standard 18 decimal places, and assumptions about decimal places can lead to miscalculations.
Always retrieve and use the `decimals()` function from the token contract itself when performing calculations involving token amounts.This ensures that your contract correctly handles tokens with any number of decimal places, mitigating the risk of numerical errors or under / overflows that could jeopardize contract integrity and user funds. 


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/team/TimelockTokenPool.sol

197:         uint128 _amountUnlocked = amountUnlocked / 1e18; // divide first


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L197-L197) 


</details>


### [L&#x2011;9] Initialization can be front-run 
The `initialize()` functions are not protected by a modifier, which allow attackers to call this function once the contract is deployed through the proxy. Consider adding modifiers to protect this function or create a contract that both deploy the project and initialize it on the same transaction.


*There are 19 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoL1.sol

42:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L42-L42) 


```solidity

File: /contracts/L1/TaikoToken.sol

25:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L25-L25) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

31:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L31-L31) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

15:     function init(address _owner, uint256 _minDelay) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L15-L15) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

57:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L57-L57) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

25:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L25-L25) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L2/TaikoL2.sol

71:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L71-L71) 


```solidity

File: /contracts/common/AddressManager.sol

30:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L30-L30) 


```solidity

File: /contracts/signal/SignalService.sol

48:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L48-L48) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

111:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L111-L111) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

27:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L27-L27) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

54:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L54) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

25:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L25-L25) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

38:     function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L38-L38) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

18:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L18-L18) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

83:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L83-L83) 


</details>


### [L&#x2011;10] `internal` Function calls within for loops 
Making function calls or external calls within loops in Solidity can lead to inefficient gas usage, potential bottlenecks, and increased vulnerability to attacks. Each function call or external call consumes gas, and when executed within a loop, the gas cost multiplies, potentially causing the transaction to run out of gas or exceed block gas limits. This can result in transaction failure or unpredictable behavior.


*There are 13 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

217:             bool cpuSvnsAreHigherOrGreater = _isCpuSvnHigherOrGreater(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L217-L217) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

62:             (success, certs[i], increment) = _removeHeadersAndFooters(input);

308:                         (flags.tcbFound, pcesvn, cpusvns) = _findTcb(der, extnValueOidPtr);

308:                         (flags.tcbFound, pcesvn, cpusvns) = _findTcb(der, extnValueOidPtr);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L62-L62) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L308-L308), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L308-L308)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

49:             if (isLeapYear(i)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L49-L49) 


```solidity

File: /contracts/signal/SignalService.sol

107:             bytes32 signalRoot = _verifyHopProof(chainId, app, signal, value, hop, signalService);

122:             _cacheChainData(hop, chainId, hop.blockId, signalRoot, isFullProof, isLastHop);

125:             signal = signalForChainData(chainId, kind, hop.blockId);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L107-L107) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L125-L125)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

75:             (uint256 itemOffset, uint256 itemLength,) = _decodeLength(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L75-L75) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

136:                     currentNodeID = _getNodeID(nextNode);

140:                 bytes memory path = _getNodePath(currentNode);

145:                 uint256 sharedNibbleLength = _getSharedNibbleLength(pathRemainder, keyRemainder);

188:                     currentNodeID = _getNodeID(currentNode.decoded[1]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L136-L136) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L188-L188)


</details>


### [L&#x2011;11] Loss of precision 
Division by large numbers may result in the result being zero, due to solidity not supporting fractions. Consider requiring a minimum amount for the numerator to ensure that it is always larger than the denominator


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibVerifying.sol

262:                 || _config.ethDepositMaxFee > type(uint96).max / _config.ethDepositMaxCountPerBlock


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L262-L262) 


```solidity

File: /contracts/L2/Lib1559Math.sol

28:         return _ethQty(_gasExcess, _adjustmentFactor) / LibFixedPointMath.SCALING_FACTOR

41:         uint256 input = _gasExcess * LibFixedPointMath.SCALING_FACTOR / _adjustmentFactor;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L41-L41)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

117:         uint256 timeBasedAllowance = balance


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L117-L117) 


</details>


### [L&#x2011;12] `onlyOwner` functions not accessible if `owner` renounces ownership 
The `owner` is able to perform certain privileged activities, but it's possible to set the owner to `address(0)`. This can represent a certain risk if the ownership is renounced for any other reason than by design.
Renouncing ownership will leave the contract without an `owner`, therefore limiting any functionality that needs authority.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }

116:     function _authorizePause(address) internal virtual onlyOwner { }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L116-L116)


</details>


### [L&#x2011;13] Governance operations should be behind a timelock 
All critical and governance operations should be protected by a timelock. For example from the point of view of a user, the changing of the owner of a contract is a high risk operation that may have outcomes ranging from an attacker gaining control over the protocol, to the function no longer functioning due to a typo in the destination address. To give users plenty of warning so that they can validate any ownership changes, changes of ownership should be behind a timelock.


*There are 36 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoToken.sol

47:     function burn(address _from, uint256 _amount) public onlyOwner {
48:         _burn(_from, _amount);
49:     }

52:     function snapshot() public onlyFromOwnerOrNamed("snapshooter") {
53:         _snapshot();
54:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L47-L49) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L52-L54)


```solidity

File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(
54:         address[] memory _newGuardians,
55:         uint8 _minGuardians
56:     )
57:         external
58:         onlyOwner
59:         nonReentrant
60:     {
61:         // We need at least MIN_NUM_GUARDIANS and at most 255 guardians (so the approval bits fit in
62:         // a uint256)
63:         if (_newGuardians.length < MIN_NUM_GUARDIANS || _newGuardians.length > type(uint8).max) {
64:             revert INVALID_GUARDIAN_SET();
65:         }
66:         // Minimum number of guardians to approve is at least equal or greater than half the
67:         // guardians (rounded up) and less or equal than the total number of guardians
68:         if (_minGuardians < (_newGuardians.length + 1) >> 1 || _minGuardians > _newGuardians.length)
69:         {
70:             revert INVALID_MIN_GUARDIANS();
71:         }
72: 
73:         // Delete the current guardians
74:         for (uint256 i; i < guardians.length; ++i) {
75:             delete guardianIds[guardians[i]];
76:         }
77:         delete guardians;
78: 
79:         // Set the new guardians
80:         for (uint256 i = 0; i < _newGuardians.length; ++i) {
81:             address guardian = _newGuardians[i];
82:             if (guardian == address(0)) revert INVALID_GUARDIAN();
83:             // This makes sure there are not duplicate addresses
84:             if (guardianIds[guardian] != 0) revert INVALID_GUARDIAN_SET();
85: 
86:             // Save and index the guardian
87:             guardians.push(guardian);
88:             guardianIds[guardian] = guardians.length;
89:         }
90: 
91:         // Bump the version so previous approvals get invalidated
92:         ++version;
93: 
94:         minGuardians = _minGuardians;
95:         emit GuardiansUpdated(version, _newGuardians);
96:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L96) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

36:     function onMessageInvocation(bytes calldata _data)
37:         external
38:         payable
39:         whenNotPaused
40:         onlyFromNamed("bridge")
41:     {
42:         (uint64 txId, bytes memory txdata) = abi.decode(_data, (uint64, bytes));
43:         if (txId != nextTxId) revert XCO_INVALID_TX_ID();
44: 
45:         IBridge.Context memory ctx = IBridge(msg.sender).context();
46:         if (ctx.srcChainId != ownerChainId || ctx.from != owner()) {
47:             revert XCO_PERMISSION_DENIED();
48:         }
49: 
50:         (bool success,) = address(this).call(txdata);
51:         if (!success) revert XCO_TX_REVERTED();
52: 
53:         emit TransactionExecuted(nextTxId++, bytes4(txdata));
54:     }

60:     function __CrossChainOwned_init(
61:         address _owner,
62:         address _addressManager,
63:         uint64 _ownerChainId
64:     )
65:         internal
66:         virtual
67:         onlyInitializing
68:     {
69:         __Essential_init(_owner, _addressManager);
70:         if (_ownerChainId == 0 || _ownerChainId == block.chainid) {
71:             revert XCO_INVALID_OWNER_CHAINID();
72:         }
73:         ownerChainId = _ownerChainId;
74:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L36-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L60-L74)


```solidity

File: /contracts/L2/TaikoL2.sol

163:     function withdraw(
164:         address _token,
165:         address _to
166:     )
167:         external
168:         onlyFromOwnerOrNamed("withdrawer")
169:         nonReentrant
170:         whenNotPaused
171:     {
172:         if (_to == address(0)) revert L2_INVALID_PARAM();
173:         if (_token == address(0)) {
174:             _to.sendEther(address(this).balance);
175:         } else {
176:             IERC20(_token).safeTransfer(_to, IERC20(_token).balanceOf(address(this)));
177:         }
178:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L178) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

25:     function setConfigAndExcess(
26:         Config memory _newConfig,
27:         uint64 _newGasExcess
28:     )
29:         external
30:         virtual
31:         onlyOwner
32:     {
33:         if (_newConfig.gasTargetPerL1Block == 0) revert L2_INVALID_CONFIG();
34:         if (_newConfig.basefeeAdjustmentQuotient == 0) revert L2_INVALID_CONFIG();
35: 
36:         customConfig = _newConfig;
37:         gasExcess = _newGasExcess;
38: 
39:         emit ConfigAndExcessChanged(_newConfig, _newGasExcess);
40:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L25-L40) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
66:         _trustedUserMrSigner[_mrSigner] = _trusted;
67:     }

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
70:         _trustedUserMrEnclave[_mrEnclave] = _trusted;
71:     }

73:     function addRevokedCertSerialNum(
74:         uint256 index,
75:         bytes[] calldata serialNumBatch
76:     )
77:         external
78:         onlyOwner
79:     {
80:         for (uint256 i; i < serialNumBatch.length; ++i) {
81:             if (_serialNumIsRevoked[index][serialNumBatch[i]]) {
82:                 continue;
83:             }
84:             _serialNumIsRevoked[index][serialNumBatch[i]] = true;
85:         }
86:     }

088:     function removeRevokedCertSerialNum(
089:         uint256 index,
090:         bytes[] calldata serialNumBatch
091:     )
092:         external
093:         onlyOwner
094:     {
095:         for (uint256 i; i < serialNumBatch.length; ++i) {
096:             if (!_serialNumIsRevoked[index][serialNumBatch[i]]) {
097:                 continue;
098:             }
099:             delete _serialNumIsRevoked[index][serialNumBatch[i]];
100:         }
101:     }

103:     function configureTcbInfoJson(
104:         string calldata fmspc,
105:         TCBInfoStruct.TCBInfo calldata tcbInfoInput
106:     )
107:         public
108:         onlyOwner
109:     {
110:         // 2.2M gas
111:         tcbInfo[fmspc] = tcbInfoInput;
112:     }

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)
115:         external
116:         onlyOwner
117:     {
118:         // 250k gas
119:         qeIdentity = qeIdentityInput;
120:     }

122:     function toggleLocalReportCheck() external onlyOwner {
123:         _checkLocalEnclaveReport = !_checkLocalEnclaveReport;
124:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L67) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L71), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122-L124)


```solidity

File: /contracts/bridge/Bridge.sol

101:     function banAddress(
102:         address _addr,
103:         bool _ban
104:     )
105:         external
106:         onlyFromOwnerOrNamed("bridge_watchdog")
107:         nonReentrant
108:     {
109:         if (addressBanned[_addr] == _ban) revert B_INVALID_STATUS();
110:         addressBanned[_addr] = _ban;
111:         emit AddressBanned(_addr, _ban);
112:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L101-L112) 


```solidity

File: /contracts/common/AddressManager.sol

38:     function setAddress(
39:         uint64 _chainId,
40:         bytes32 _name,
41:         address _newAddress
42:     )
43:         external
44:         virtual
45:         onlyOwner
46:     {
47:         address oldAddress = __addresses[_chainId][_name];
48:         if (_newAddress == oldAddress) revert AM_INVALID_PARAMS();
49:         __addresses[_chainId][_name] = _newAddress;
50:         emit AddressSet(_chainId, _name, _newAddress, oldAddress);
51:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L38-L51) 


```solidity

File: /contracts/common/EssentialContract.sol

095:     function __Essential_init(
096:         address _owner,
097:         address _addressManager
098:     )
099:         internal
100:         virtual
101:         onlyInitializing
102:     {
103:         __Essential_init(_owner);
104: 
105:         if (_addressManager == address(0)) revert ZERO_ADDR_MANAGER();
106:         __AddressResolver_init(_addressManager);
107:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L95-L107) 


```solidity

File: /contracts/signal/SignalService.sol

56:     function authorize(address _addr, bool _authorize) external onlyOwner {
57:         if (isAuthorized[_addr] == _authorize) revert SS_INVALID_STATE();
58:         isAuthorized[_addr] = _authorize;
59:         emit Authorized(_addr, _authorize);
60:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L56-L60) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

135:     function grant(address _recipient, Grant memory _grant) external onlyOwner {
136:         if (_recipient == address(0)) revert INVALID_PARAM();
137:         if (recipients[_recipient].grant.amount != 0) revert ALREADY_GRANTED();
138: 
139:         _validateGrant(_grant);
140: 
141:         totalAmountGranted += _grant.amount;
142:         recipients[_recipient].grant = _grant;
143:         emit Granted(_recipient, _grant);
144:     }

150:     function void(address _recipient) external onlyOwner {
151:         Recipient storage r = recipients[_recipient];
152:         uint128 amountVoided = _voidGrant(r.grant);
153: 
154:         if (amountVoided == 0) revert NOTHING_TO_VOID();
155: 
156:         totalAmountVoided += amountVoided;
157:         emit Voided(_recipient, amountVoided);
158:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L135-L144) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L150-L158)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

45:     function setConfig(
46:         uint64 _claimStart,
47:         uint64 _claimEnd,
48:         bytes32 _merkleRoot
49:     )
50:         external
51:         onlyOwner
52:     {
53:         _setConfig(_claimStart, _claimEnd, _merkleRoot);
54:     }

56:     function __MerkleClaimable_init(
57:         uint64 _claimStart,
58:         uint64 _claimEnd,
59:         bytes32 _merkleRoot
60:     )
61:         internal
62:         onlyInitializing
63:     {
64:         _setConfig(_claimStart, _claimEnd, _merkleRoot);
65:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L45-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L56-L65)


```solidity

File: /contracts/tokenvault/BaseVault.sol

47:     function checkProcessMessageContext()
48:         internal
49:         view
50:         onlyFromBridge
51:         returns (IBridge.Context memory ctx_)
52:     {
53:         ctx_ = IBridge(msg.sender).context();
54:         address selfOnSourceChain = resolve(ctx_.srcChainId, name(), false);
55:         if (ctx_.from != selfOnSourceChain) revert VAULT_PERMISSION_DENIED();
56:     }

58:     function checkRecallMessageContext()
59:         internal
60:         view
61:         onlyFromBridge
62:         returns (IBridge.Context memory ctx_)
63:     {
64:         ctx_ = IBridge(msg.sender).context();
65:         if (ctx_.from != msg.sender) revert VAULT_PERMISSION_DENIED();
66:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L47-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L58-L66)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

66:     function mint(
67:         address _to,
68:         uint256 _tokenId,
69:         uint256 _amount
70:     )
71:         public
72:         nonReentrant
73:         whenNotPaused
74:         onlyFromNamed("erc1155_vault")
75:     {
76:         _mint(_to, _tokenId, _amount, "");
77:     }

83:     function mintBatch(
84:         address _to,
85:         uint256[] memory _tokenIds,
86:         uint256[] memory _amounts
87:     )
88:         public
89:         nonReentrant
90:         whenNotPaused
91:         onlyFromNamed("erc1155_vault")
92:     {
93:         _mintBatch(_to, _tokenIds, _amounts, "");
94:     }

100:     function burn(
101:         address _account,
102:         uint256 _tokenId,
103:         uint256 _amount
104:     )
105:         public
106:         nonReentrant
107:         whenNotPaused
108:         onlyFromNamed("erc1155_vault")
109:     {
110:         _burn(_account, _tokenId, _amount);
111:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L66-L77) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L83-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L100-L111)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

80:     function setSnapshoter(address _snapshooter) external onlyOwner {
81:         snapshooter = _snapshooter;
82:     }

85:     function snapshot() external onlyOwnerOrSnapshooter {
86:         _snapshot();
87:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L82) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L85-L87)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

36:     function changeMigrationStatus(
37:         address _migratingAddress,
38:         bool _migratingInbound
39:     )
40:         external
41:         nonReentrant
42:         whenNotPaused
43:         onlyFromOwnerOrNamed("erc20_vault")
44:     {
45:         if (_migratingAddress == migratingAddress && _migratingInbound == migratingInbound) {
46:             revert BB_INVALID_PARAMS();
47:         }
48: 
49:         migratingAddress = _migratingAddress;
50:         migratingInbound = _migratingInbound;
51:         emit MigrationStatusChanged(_migratingAddress, _migratingInbound);
52:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L36-L52) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

54:     function mint(
55:         address _account,
56:         uint256 _tokenId
57:     )
58:         public
59:         nonReentrant
60:         whenNotPaused
61:         onlyFromNamed("erc721_vault")
62:     {
63:         _safeMint(_account, _tokenId);
64:     }

69:     function burn(
70:         address _account,
71:         uint256 _tokenId
72:     )
73:         public
74:         nonReentrant
75:         whenNotPaused
76:         onlyFromNamed("erc721_vault")
77:     {
78:         // Check if the caller is the owner of the token.
79:         if (ownerOf(_tokenId) != _account) {
80:             revert BTOKEN_INVALID_BURN();
81:         }
82:         _burn(_tokenId);
83:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L54-L64) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L69-L83)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

148:     function changeBridgedToken(
149:         CanonicalERC20 calldata _ctoken,
150:         address _btokenNew
151:     )
152:         external
153:         nonReentrant
154:         whenNotPaused
155:         onlyOwner
156:         returns (address btokenOld_)
157:     {
158:         if (_btokenNew == address(0) || bridgedToCanonical[_btokenNew].addr != address(0)) {
159:             revert VAULT_INVALID_NEW_BTOKEN();
160:         }
161: 
162:         if (btokenBlacklist[_btokenNew]) revert VAULT_BTOKEN_BLACKLISTED();
163: 
164:         if (IBridgedERC20(_btokenNew).owner() != owner()) {
165:             revert VAULT_NOT_SAME_OWNER();
166:         }
167: 
168:         btokenOld_ = canonicalToBridged[_ctoken.chainId][_ctoken.addr];
169: 
170:         if (btokenOld_ != address(0)) {
171:             CanonicalERC20 memory ctoken = bridgedToCanonical[btokenOld_];
172: 
173:             // The ctoken must match the saved one.
174:             if (
175:                 ctoken.decimals != _ctoken.decimals
176:                     || keccak256(bytes(ctoken.symbol)) != keccak256(bytes(_ctoken.symbol))
177:                     || keccak256(bytes(ctoken.name)) != keccak256(bytes(_ctoken.name))
178:             ) revert VAULT_CTOKEN_MISMATCH();
179: 
180:             delete bridgedToCanonical[_btokenNew];
181:             btokenBlacklist[btokenOld_] = true;
182: 
183:             // Start the migration
184:             IBridgedERC20(btokenOld_).changeMigrationStatus(_btokenNew, false);
185:             IBridgedERC20(_btokenNew).changeMigrationStatus(btokenOld_, true);
186:         }
187: 
188:         bridgedToCanonical[_btokenNew] = _ctoken;
189:         canonicalToBridged[_ctoken.chainId][_ctoken.addr] = _btokenNew;
190: 
191:         emit BridgedTokenChanged({
192:             srcChainId: _ctoken.chainId,
193:             ctoken: _ctoken.addr,
194:             btokenOld: btokenOld_,
195:             btokenNew: _btokenNew,
196:             ctokenSymbol: _ctoken.symbol,
197:             ctokenName: _ctoken.name,
198:             ctokenDecimal: _ctoken.decimals
199:         });
200:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L148-L200) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

90:     function addInstances(address[] calldata _instances)
91:         external
92:         onlyOwner
93:         returns (uint256[] memory)
94:     {
95:         return _addInstances(_instances, true);
96:     }

100:     function deleteInstances(uint256[] calldata _ids)
101:         external
102:         onlyFromOwnerOrNamed("rollup_watchdog")
103:     {
104:         for (uint256 i; i < _ids.length; ++i) {
105:             uint256 idx = _ids[i];
106: 
107:             if (instances[idx].addr == address(0)) revert SGX_INVALID_INSTANCE();
108: 
109:             emit InstanceDeleted(idx, instances[idx].addr);
110: 
111:             delete instances[idx];
112:         }
113:     }

139:     function verifyProof(
140:         Context calldata _ctx,
141:         TaikoData.Transition calldata _tran,
142:         TaikoData.TierProof calldata _proof
143:     )
144:         external
145:         onlyFromNamed("taiko")
146:     {
147:         // Do not run proof verification to contest an existing proof
148:         if (_ctx.isContesting) return;
149: 
150:         // Size is: 89 bytes
151:         // 4 bytes + 20 bytes + 65 bytes (signature) = 89
152:         if (_proof.data.length != 89) revert SGX_INVALID_PROOF();
153: 
154:         uint32 id = uint32(bytes4(Bytes.slice(_proof.data, 0, 4)));
155:         address newInstance = address(bytes20(Bytes.slice(_proof.data, 4, 20)));
156:         bytes memory signature = Bytes.slice(_proof.data, 24);
157: 
158:         address oldInstance =
159:             ECDSA.recover(getSignedHash(_tran, newInstance, _ctx.prover, _ctx.metaHash), signature);
160: 
161:         if (!_isInstanceValid(id, oldInstance)) revert SGX_INVALID_INSTANCE();
162:         _replaceInstance(id, oldInstance, newInstance);
163:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L90-L96) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L100-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L139-L163)


</details>


### [L&#x2011;14] `require()` should be used instead of `assert()` 
Prior to solidity version 0.8.0, hitting an assert consumes the ** remainder of the transaction's available gas** rather than returning it, as `require()` / `revert()` do. `assert()` should be avoided even past solidity version 0.8.0 as its[documentation](https://docs.soliditylang.org/en/v0.8.14/control-structures.html#panic-via-assert-and-error-via-require) states that "The assert function creates an error of type Panic(uint256). ... Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix".


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProving.sol

223:                 assert(tier.validityBond == 0);

224:                 assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L223-L223) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L224-L224)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

138:         assert(success); // never reverts, always returns 0 or 1


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L138-L138) 


```solidity

File: /contracts/bridge/Bridge.sol

486:         assert(_message.from != address(this));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L486-L486) 


</details>


### [L&#x2011;15] Consider using OpenZeppelinâ€™s SafeCast library to prevent unexpected overflows when casting from various type int/uint values 



*There are 17 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibDepositing.sol

//@audit `data` is getting converted from `uint256` to `uint96`
90:                     amount: uint96(data),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L90-L90) 


```solidity

File: /contracts/L2/Lib1559Math.sol

//@audit `input` is getting converted from `uint256` to `int256`
45:         return uint256(LibFixedPointMath.exp(int256(input)));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L45-L45) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit `gasExcess` is getting converted from `uint64` to `uint256`
265:             uint256 excess = uint256(gasExcess) + _parentGasUsed;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L265-L265) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit `svnValue` is getting converted from `uint16` to `uint256`
363:                 pcesvn = uint256(svnValue);

//@audit `svnValue` is getting converted from `uint16` to `uint256`
366:                 uint256 cpusvn = uint256(svnValue);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L363-L363) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L366-L366)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit `self` is getting converted from `uint256` to `uint80`
15:         return uint80(self);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L15-L15) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit `diff` is getting converted from `uint256` to `int256`
97:                     return int256(diff);

//@audit `len` is getting converted from `uint256` to `int256`
104:         return int256(len) - int256(otherlen);

//@audit `otherlen` is getting converted from `uint256` to `int256`
104:         return int256(len) - int256(otherlen);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L97-L97) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L104-L104)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

//@audit `hour` is getting converted from `uint8` to `uint256`
64:         timestamp += uint256(hour) * 3600; // Hours in seconds

//@audit `minute` is getting converted from `uint8` to `uint256`
65:         timestamp += uint256(minute) * 60; // Minutes in seconds


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L64-L64) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L65-L65)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit `PLACEHOLDER` is getting converted from `uint256` to `uint64`
533:             _storeContext(bytes32(PLACEHOLDER), address(uint160(PLACEHOLDER)), uint64(PLACEHOLDER));

//@audit `PLACEHOLDER` is getting converted from `uint256` to `uint160`
533:             _storeContext(bytes32(PLACEHOLDER), address(uint160(PLACEHOLDER)), uint64(PLACEHOLDER));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L533-L533) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L533-L533)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit `_len` is getting converted from `uint256` to `uint8`
35:             out_[0] = bytes1(uint8(_len) + uint8(_offset));

//@audit `_offset` is getting converted from `uint256` to `uint8`
35:             out_[0] = bytes1(uint8(_len) + uint8(_offset));

//@audit `lenLen` is getting converted from `uint256` to `uint8`
45:             out_[0] = bytes1(uint8(lenLen) + uint8(_offset) + 55);

//@audit `_offset` is getting converted from `uint256` to `uint8`
45:             out_[0] = bytes1(uint8(lenLen) + uint8(_offset) + 55);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45-L45)


</details>


### [L&#x2011;16] Setters should have initial value check 
Setters should have initial value check to prevent assigning wrong value to the variable. Assginment of wrong value can lead to unexpected behavior of the contract.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

80:     function setSnapshoter(address _snapshooter) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L80) 


</details>


### [L&#x2011;17] Int casting `block.timestamp` can reduce the lifespan of a contract 
Consider removing casting to ensure future functionality.


*There are 14 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoL1.sol

126:         state.slotB.lastUnpausedAt = uint64(block.timestamp);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L126-L126) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

130:                 timestamp: uint64(block.timestamp),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L130-L130) 


```solidity

File: /contracts/L1/libs/LibProving.sol

78:             _state.slotB.lastUnpausedAt = uint64(block.timestamp);

264:         ts.timestamp = uint64(block.timestamp);

414:         bool inProvingWindow = uint256(_ts.timestamp).max(_state.slotB.lastUnpausedAt)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L78-L78) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L414-L414)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

58:         _state.slotA.genesisTimestamp = uint64(block.timestamp);

64:         blk.proposedAt = uint64(block.timestamp);

71:         ts.timestamp = uint64(block.timestamp);

153:                             + uint256(ts.timestamp).max(_state.slotB.lastUnpausedAt) > block.timestamp


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L153-L153)


```solidity

File: /contracts/bridge/Bridge.sol

89:         uint64 _timestamp = _suspend ? type(uint64).max : uint64(block.timestamp);

183:             receivedAt = uint64(block.timestamp);

240:             receivedAt = uint64(block.timestamp);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L89-L89) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L183-L183), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L240-L240)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

204:         uint64 validSince = uint64(block.timestamp);

229:         instances[id] = Instance(newInstance, uint64(block.timestamp));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L204-L204) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L229-L229)


</details>


### [L&#x2011;18] Large transfers may not work with some `ERC20` tokens 
Some `IERC20` implementations (e.g `UNI`, `COMP`) may fail if the valued transferred is larger than `uint96`. [Source](https://github.com/d-xo/weird-erc20#revert-on-large-approvals--transfers)


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/ERC20Vault.sol

330:             IERC20(token_).safeTransfer(_to, _amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L330-L330) 


</details>


### [L&#x2011;19] Arrays can grow in size without a way to shrink them 
It's a good practice to maintain control over the size of array state variables in Solidity, especially if they are dynamically updated.If a contract includes a mechanism to push items into an array, it should ideally also provide a mechanism to remove items.This is because Solidity arrays don't automatically shrink when items are deleted - their length needs to be manually adjusted.
Ignoring this can lead to bloated and inefficient contracts.For instance, iterating over a large array can cause your contract to hit the block gas limit.Additionally, if entries are only marked for deletion but never actually removed, you may end up dealing with stale or irrelevant data, which can cause logical errors.
Therefore, implementing a method to 'pop' items from arrays helps manage contract's state, improve efficiency and prevent potential issues related to gas limits or stale data. Always ensure to handle potential underflow conditions when popping elements from the array.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/Guardians.sol

//@audit the array `guardians` has a `push()` call as shown in the code snippet but without a `pop()` call
87:             guardians.push(guardian);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L87-L87) 


</details>


### [L&#x2011;20] Unsafe downcast 
When a type is downcast to a smaller type, the higher order bits are truncated, effectively applying a modulo to the original value. Without any other checks, this wrapping will lead to unexpected behavior and bugs


*There are 31 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibDepositing.sol

//@audit converting from `uint256` to `uint96`
53:                 amount: uint96(msg.value),

//@audit converting from `uint256` to `uint96`
83:             uint96 fee = uint96(_config.ethDepositMaxFee.min(block.basefee * _config.ethDepositGas));

//@audit `data` is getting converted from `uint256` to `uint96`
90:                     amount: uint96(data),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L53-L53) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L90-L90)


```solidity

File: /contracts/L1/libs/LibProposing.sol

//@audit converting from `uint256` to `uint64`
131:                 l1Height: uint64(block.number - 1),

//@audit converting from `uint256` to `uint24`
191:             meta_.txListByteSize = uint24(_txList.length);

//@audit converting from `uint256` to `uint64`
220:             proposedIn: uint64(block.number),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L131-L131) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L220-L220)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit converting from `uint256` to `uint64`
57:         _state.slotA.genesisHeight = uint64(block.number);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L57-L57) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit converting from `uint256` to `uint64`
284:             gasExcess_ = uint64(excess.min(type(uint64).max));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L284-L284) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit converting from `uint256` to `uint16`
146:         enclaveReport.isvProdId = uint16(littleEndianDecode(rawEnclaveReport.substring(256, 2)));

//@audit converting from `uint256` to `uint16`
147:         enclaveReport.isvSvn = uint16(littleEndianDecode(rawEnclaveReport.substring(258, 2)));

//@audit converting from `uint256` to `uint16`
212:         qeAuthData.parsedDataSize = uint16(littleEndianDecode(rawAuthData.substring(576, 2)));

//@audit converting from `uint256` to `uint16`
217:         cert.certType = uint16(littleEndianDecode(rawAuthData.substring(offset, 2)));

//@audit converting from `uint256` to `uint32`
222:         cert.certDataSize = uint32(littleEndianDecode(rawAuthData.substring(offset, 4)));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L146-L146) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L222-L222)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit `self` is getting converted from `uint256` to `uint80`
15:         return uint80(self);

//@audit converting from `uint256` to `uint80`
20:         return uint80(self >> 80);

//@audit converting from `uint256` to `uint80`
25:         return uint80(self >> 160);

//@audit converting from `uint256` to `uint80`
193:             ixFirstContentByte = uint80(ix + 2);

//@audit converting from `uint256` to `uint80`
194:             ixLastContentByte = uint80(ixFirstContentByte + length - 1);

//@audit converting from `uint256` to `uint80`
206:             ixFirstContentByte = uint80(ix + 2 + lengthbytesLength);

//@audit converting from `uint256` to `uint80`
207:             ixLastContentByte = uint80(ixFirstContentByte + length - 1);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L193-L193), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L207-L207)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit converting from `uint256` to `uint64`
146:         message_.srcChainId = uint64(block.chainid);

//@audit `PLACEHOLDER` is getting converted from `uint256` to `uint64`
533:             _storeContext(bytes32(PLACEHOLDER), address(uint160(PLACEHOLDER)), uint64(PLACEHOLDER));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L146-L146) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L533-L533)


```solidity

File: /contracts/signal/SignalService.sol

//@audit converting from `uint256` to `uint64`
264:         slot_ = getSignalSlot(uint64(block.chainid), _app, _signal);

//@audit converting from `uint256` to `uint64`
308:         bytes32 slot = getSignalSlot(uint64(block.chainid), _app, _signal);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L264-L264) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L308-L308)


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit converting from `uint256` to `uint64`
264:         return _amount * uint64(block.timestamp - _start) / _period;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L264-L264) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit `_offset` is getting converted from `uint256` to `uint8`
35:             out_[0] = bytes1(uint8(_len) + uint8(_offset));

//@audit `_offset` is getting converted from `uint256` to `uint8`
45:             out_[0] = bytes1(uint8(lenLen) + uint8(_offset) + 55);

//@audit converting from `uint256` to `uint8`
47:                 out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit converting from `uint256` to `uint64`
257:                     chainId: uint64(block.chainid),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L257-L257) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit converting from `uint256` to `uint64`
366:                 chainId: uint64(block.chainid),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L366-L366) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit converting from `uint256` to `uint64`
204:                     chainId: uint64(block.chainid),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L204-L204) 


</details>


### [L&#x2011;21] Unused/empty `receive()`/`fallback()` function 
If the intention is for the Ether to be used, the function should call another function or emit an event, otherwise it should revert.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/bridge/Bridge.sol

70:     receive() external payable { }
71: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L70-L71) 


</details>


### [L&#x2011;22] Consider implementing two-step procedure for updating protocol addresses 
A copy-paste error or a typo may end up bricking protocol functionality, or sending tokens to an address with no known private key. Consider implementing a two-step procedure for updating protocol addresses, where the recipient is set as pending, and must 'accept' the assignment by making an affirmative call. A straight forward way of doing this would be to have the target contracts implement [EIP-165](https://eips.ethereum.org/EIPS/eip-165), and to have the 'set' functions ensure that the recipient is of the right interface type.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

38:     function setAddress(
39:         uint64 _chainId,
40:         bytes32 _name,
41:         address _newAddress
42:     )
43:         external
44:         virtual
45:         onlyOwner
46:     {
47:         address oldAddress = __addresses[_chainId][_name];
48:         if (_newAddress == oldAddress) revert AM_INVALID_PARAMS();
49:         __addresses[_chainId][_name] = _newAddress;
50:         emit AddressSet(_chainId, _name, _newAddress, oldAddress);
51:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L38-L51) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

80:     function setSnapshoter(address _snapshooter) external onlyOwner {
81:         snapshooter = _snapshooter;
82:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L82) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

36:     function changeMigrationStatus(
37:         address _migratingAddress,
38:         bool _migratingInbound
39:     )
40:         external
41:         nonReentrant
42:         whenNotPaused
43:         onlyFromOwnerOrNamed("erc20_vault")
44:     {
45:         if (_migratingAddress == migratingAddress && _migratingInbound == migratingInbound) {
46:             revert BB_INVALID_PARAMS();
47:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L36-L47) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

148:     function changeBridgedToken(
149:         CanonicalERC20 calldata _ctoken,
150:         address _btokenNew
151:     )
152:         external
153:         nonReentrant
154:         whenNotPaused
155:         onlyOwner
156:         returns (address btokenOld_)
157:     {
158:         if (_btokenNew == address(0) || bridgedToCanonical[_btokenNew].addr != address(0)) {
159:             revert VAULT_INVALID_NEW_BTOKEN();
160:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L148-L160) 


</details>


### [L&#x2011;23] Upgradeable contract uses non-upgradeable version of the OpenZeppelin libraries/contracts 
OpenZeppelin has an [Upgradeable](https://github.com/OpenZeppelin/openzeppelin-contracts-upgradeable/tree/master/contracts/utils) variants of each of its libraries and contracts, and upgradeable contracts should use those variants.


*There are 26 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/hooks/AssignmentHook.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L5-L5)


```solidity

File: /contracts/L2/CrossChainOwned.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L4-L4) 


```solidity

File: /contracts/L2/TaikoL2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L5-L5)


```solidity

File: /contracts/bridge/Bridge.sol

4: import "@openzeppelin/contracts/utils/Address.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L4-L4) 


```solidity

File: /contracts/signal/SignalService.sol

4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L4-L4) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";

5: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L6-L6)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/governance/utils/IVotes.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L5-L5)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L4-L4) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L4-L4) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

4: import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

5: import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L5-L5) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

5: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L5-L5) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

5: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L5-L5) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

4: import "@openzeppelin/contracts/token/ERC1155/IERC1155.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";

6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L6-L6)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

5: import "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L5-L5)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L4-L4) 


</details>


### [L&#x2011;24] Consider using descriptive `constant`s when passing zero as a function argument 
Passing zero as a function argument can sometimes result in a security issue (e.g. passing zero as the slippage parameter). Consider using a `constant` variable with a descriptive name, so it's clear that the argument is intentionally being used, and for the right reasons.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibVerifying.sol

//@audit parameter number 3 starting from left
234:         (uint64 lastSyncedBlock,) = signalService.getSyncedChainData(
235:             _config.chainId, LibSignals.STATE_ROOT, 0 /* latest block Id*/
236:         );


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L234-L236) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit parameter number 2 starting from left
40:         return compare(self, 0, self.length, other, 0, other.length);

//@audit parameter number 5 starting from left
40:         return compare(self, 0, self.length, other, 0, other.length);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L40-L40)


</details>


### [L&#x2011;25] Check of division by zero 



*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/Lib1559Math.sol

28:         return _ethQty(_gasExcess, _adjustmentFactor) / LibFixedPointMath.SCALING_FACTOR

41:         uint256 input = _gasExcess * LibFixedPointMath.SCALING_FACTOR / _adjustmentFactor;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L41-L41)


```solidity

File: /contracts/team/TimelockTokenPool.sol

264:         return _amount * uint64(block.timestamp - _start) / _period;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L264-L264) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

117:         uint256 timeBasedAllowance = balance


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L117-L117) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

39:             while (_len / i != 0) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L39-L39) 


</details>


### [L&#x2011;26] Functions calling contracts/addresses with transfer hooks are missing reentrancy guards 
Even if the function follows the best practice of check-effects-interaction, not using a reentrancy guard when there may be transfer hooks will open the users of this protocol up to [read-only reentrancies](https://chainsecurity.com/curve-lp-oracle-manipulation-post-mortem/) with no way to protect against it, except by block-listing the whole protocol.


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProving.sol

//@audit function `proveBlock()` is not protected against reentrancy
196:                 tko.transfer(blk.assignedProver, blk.livenessBond);

//@audit function `_overrideWithHigherProof()` is not protected against reentrancy
384:                 _tko.transferFrom(msg.sender, address(this), _tier.validityBond - reward);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L196-L196) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L384-L384)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit function `verifyBlocks()` is not protected against reentrancy
189:                 tko.transfer(ts.prover, bondToReturn);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L189-L189) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit function `_withdraw()` is not protected against reentrancy
219:         IERC20(taikoToken).transferFrom(sharedVault, _to, amountToWithdraw);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L219-L219) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit function `withdraw()` is not protected against reentrancy
91:         IERC20(token).transferFrom(vault, user, amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L91-L91) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit function `_transferTokens()` is not protected against reentrancy
330:             IERC20(token_).safeTransfer(_to, _amount);

//@audit function `_handleMessage()` is not protected against reentrancy
379:             t.safeTransferFrom({ from: msg.sender, to: address(this), value: _amount });


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L330-L330) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L379-L379)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit function `_transferTokens()` is not protected against reentrancy
171:                 IERC721(token_).safeTransferFrom(address(this), _to, _tokenIds[i]);

//@audit function `_handleMessage()` is not protected against reentrancy
211:                     t.safeTransferFrom(_user, address(this), _op.tokenIds[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L171-L171) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L211-L211)


</details>


### [L&#x2011;27] Pausing withdrawals is unfair to the users 
Users should always have the possibility of accessing their own funds, but when these functions are paused, their funds will be locked until the contracts are unpaused.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/TaikoL2.sol

163:     function withdraw(
164:         address _token,
165:         address _to
166:     )
167:         external
168:         onlyFromOwnerOrNamed("withdrawer")
169:         nonReentrant
170:         whenNotPaused


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L170) 


</details>


### [L&#x2011;28] Lack of support for ERC1155 NFT 
Lack of support for ERC1155 NFT so a vast amount of popular ERC1155 NFT cannot be usedLack of support for `ERC1155` NFT so a vast amount of popular `ERC1155` NFT cannot be used. The codebase use `ERC721` `safeTransferFrom` extensively and assume that the underlyling NFT contract conforms to ERC721 standard. \nHowever, there are popular NFT, that conform to ERC1155 standard, [NFT1155 tokens](https://etherscan.io/tokens-nft1155) which use `safeTransferFrom` in `ERC1155` implementation and does not match `ERC721` `safeTransferFrom` method call


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/team/airdrop/ERC721Airdrop.sol

60:             IERC721(token).safeTransferFrom(vault, user, tokenIds[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L60-L60) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

171:                 IERC721(token_).safeTransferFrom(address(this), _to, _tokenIds[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L171-L171) 


</details>


### [L&#x2011;29] Some function should not be marked as payable 
Some function should not be marked as payable, otherwise the ETH that mistakenly sent along with the function call is locked in the contract


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoL1.sol

55:     function proposeBlock(
56:         bytes calldata _params,
57:         bytes calldata _txList
58:     )
59:         external
60:         payable
61:         nonReentrant
62:         whenNotPaused
63:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
64:     {
65:         TaikoData.Config memory config = getConfig();
66: 
67:         (meta_, deposits_) = LibProposing.proposeBlock(state, config, this, _params, _txList);
68: 
69:         if (!state.slotB.provingPaused) {
70:             LibVerifying.verifyBlocks(state, config, this, config.maxBlocksToVerifyPerProposal);
71:         }
72:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L55-L72) 


</details>


### [L&#x2011;30] Code does not follow the best practice of check-effects-interaction 
Code should follow the best-practice of [check-effects-interaction](https://blockchain-academy.hs-mittweida.de/courses/solidity-coding-beginners-to-intermediate/lessons/solidity-11-coding-patterns/topic/checks-effects-interactions/), where state variables are updated before any external calls are made. Doing so prevents a large class of reentrancy bugs.


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/BridgedERC1155.sol

//@audit the function `validateInputs()` is called before the following assignment
56:         srcToken = _srcToken;

//@audit the function `validateInputs()` is called before the following assignment
57:         srcChainId = _srcChainId;

//@audit the function `validateInputs()` is called before the following assignment
58:         __symbol = _symbol;

//@audit the function `validateInputs()` is called before the following assignment
59:         __name = _name;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L59-L59)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit the function `validateInputs()` is called before the following assignment
73:         srcToken = _srcToken;

//@audit the function `validateInputs()` is called before the following assignment
74:         srcChainId = _srcChainId;

//@audit the function `validateInputs()` is called before the following assignment
75:         __srcDecimals = _decimals;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L75-L75)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

//@audit the function `validateInputs()` is called before the following assignment
47:         srcToken = _srcToken;

//@audit the function `validateInputs()` is called before the following assignment
48:         srcChainId = _srcChainId;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L48-L48)


</details>


### [L&#x2011;31] prevent re-setting a state variable with the same value 
Not only is wasteful in terms of gas, but this is especially problematic when an event is emitted and the old and new values set are the same, as listeners might not expect this kind of scenario.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

45:     function setConfig(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L45-L45) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

80:     function setSnapshoter(address _snapshooter) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L80) 


</details>


### [L&#x2011;32] Missing contract-existence checks before yul `call()` 
Low-level calls return success if there is no code present at the specified address. In addition to the zero-address checks, add a check to verify that `extcodesize()` is non-zero.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

43:         assembly {
44:             _success :=
45:                 call(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L43-L45) 


</details>


### [L&#x2011;33] Use of `tx.origin` is unsafe in almost every context 
According to [Vitalik Buterin](https://ethereum.stackexchange.com/questions/196/how-do-i-make-my-dapp-serenity-proof), contracts should _not_ `assume that tx.origin will continue to be usable or meaningful`. An example of this is [EIP-3074](https://eips.ethereum.org/EIPS/eip-3074#allowing-txorigin-as-signer-1) which explicitly mentions the intention to change its semantics when it's used with new op codes.There have also been calls to [remove](https://github.com/ethereum/solidity/issues/683) `tx.origin`, and there are [security issues](solidity.readthedocs.io/en/v0.4.24/security-considerations.html#tx-origin) associated with using it for authorization. For these reasons, it's best to completely avoid the feature.Using the variable could make a contract vulnerable if an authorized account calls a malicious contract.You can impersonate a user using a third party contract.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/LibAddress.sol

78:         return msg.sender == tx.origin;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L78-L78) 


</details>


### [L&#x2011;34] Function can return unassigned variable 
Make sure that functions with a return value always return a valid and assigned value. Even if the default value is as expected, it should be assigned with the default value for code clarity and to reduce confusion.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

140:         return success;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L140-L140) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

305:         return ret;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L305-L305) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

83:         return tempBytes;

142:         return _nibbles;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L83-L83) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L142-L142)


</details>


### [L&#x2011;35] Missing checks in initializer function 
There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/TaikoL2.sol

//@audit _gasExcess,  are not checked
71:     function init(
72:         address _owner,
73:         address _addressManager,
74:         uint64 _l1ChainId,
75:         uint64 _gasExcess
76:     )
77:         external
78:         initializer
79:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L71-L79) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit _withdrawalWindow,  are not checked
54:     function init(
55:         address _owner,
56:         uint64 _claimStart,
57:         uint64 _claimEnd,
58:         bytes32 _merkleRoot,
59:         address _token,
60:         address _vault,
61:         uint64 _withdrawalWindow
62:     )
63:         external
64:         initializer
65:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L65) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit _symbol, _name,  are not checked
38:     function init(
39:         address _owner,
40:         address _addressManager,
41:         address _srcToken,
42:         uint256 _srcChainId,
43:         string memory _symbol,
44:         string memory _name
45:     )
46:         external
47:         initializer
48:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L38-L48) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit _decimals,  are not checked
52:     function init(
53:         address _owner,
54:         address _addressManager,
55:         address _srcToken,
56:         uint256 _srcChainId,
57:         uint8 _decimals,
58:         string memory _symbol,
59:         string memory _name
60:     )
61:         external
62:         initializer
63:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L52-L63) 


</details>


### [L&#x2011;36] Variables shadowing other definitions 
A variable declaration shadowing any other existing definition is error-prone. It can cause confusion for developers, potentially introduce bugs, and reduce the readability and maintainability.


*There are 70 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoL1.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
26:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
43:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L43-L43)


```solidity

File: /contracts/L1/TaikoToken.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
16:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
26:         address _owner,

//@audit this variable is shadowing the `ERC20Upgradeable`'s stat variable `_name`
27:         string calldata _name,

//@audit this variable is shadowing the `ERC20Upgradeable`'s stat variable `_symbol`
28:         string calldata _symbol,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L28-L28)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
23:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
32:         address _owner,

//@audit this variable is shadowing the `GovernorTimelockControlUpgradeable`'s stat variable `_timelock`
34:         TimelockControllerUpgradeable _timelock


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L34-L34)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
10:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
15:     function init(address _owner, uint256 _minDelay) external initializer {

//@audit this variable is shadowing the `TimelockControllerUpgradeable`'s stat variable `_minDelay`
15:     function init(address _owner, uint256 _minDelay) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L15-L15)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
40:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
57:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L57-L57)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

//@audit this variable is shadowing the `Guardians`'s stat variable `__gap`
11:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
25:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L25-L25)


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
32:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L32-L32) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
11:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L15-L15)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
11:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L15-L15)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
11:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L15-L15)


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
21:     uint256[49] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
61:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L61-L61)


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit this variable is shadowing the `CrossChainOwned`'s stat variable `__gap`
52:     uint256[47] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
72:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L72-L72)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

//@audit this variable is shadowing the `TaikoL2`'s stat variable `__gap`
13:     uint256[49] private __gap;

//@audit this variable is shadowing the `TaikoL2`'s stat variable `gasExcess`
18:     event ConfigAndExcessChanged(Config config, uint64 gasExcess);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L18-L18)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
48:     uint256[43] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
75:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L75-L75)


```solidity

File: /contracts/common/AddressManager.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
14:     uint256[49] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
30:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L30-L30)


```solidity

File: /contracts/common/EssentialContract.sol

//@audit this variable is shadowing the `Ownable2StepUpgradeable`'s stat variable `__gap`
25:     uint256[49] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
96:         address _owner,

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
109:     function __Essential_init(address _owner) internal virtual {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L109-L109)


```solidity

File: /contracts/signal/SignalService.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
23:     uint256[48] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
48:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L48-L48)


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
82:     uint128[44] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
112:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L82-L82) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L112-L112)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

//@audit this variable is shadowing the `MerkleClaimable`'s stat variable `__gap`
18:     uint256[48] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
28:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L28-L28)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit this variable is shadowing the `MerkleClaimable`'s stat variable `__gap`
30:     uint256[45] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
55:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L55-L55)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

//@audit this variable is shadowing the `MerkleClaimable`'s stat variable `__gap`
16:     uint256[48] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
26:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L26-L26)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
23:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L23-L23) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

//@audit this variable is shadowing the `BaseVault`'s stat variable `__gap`
61:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L61-L61) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
18:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
32:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L32-L32)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
27:     uint256[46] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
39:         address _owner,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L39-L39)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit this variable is shadowing the `BridgedERC20Base`'s stat variable `__gap`
32:     uint256[47] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
53:         address _owner,

//@audit this variable is shadowing the `ERC20Upgradeable`'s stat variable `_symbol`
58:         string memory _symbol,

//@audit this variable is shadowing the `ERC20Upgradeable`'s stat variable `_name`
59:         string memory _name


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L59-L59)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
16:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L16-L16) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
19:     uint256[48] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
32:         address _owner,

//@audit this variable is shadowing the `ERC721Upgradeable`'s stat variable `_symbol`
36:         string memory _symbol,

//@audit this variable is shadowing the `ERC721Upgradeable`'s stat variable `_name`
37:         string memory _name


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L37-L37)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit this variable is shadowing the `BaseNFTVault`'s stat variable `__gap`
32:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit this variable is shadowing the `BaseVault`'s stat variable `__gap`
54:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L54-L54) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit this variable is shadowing the `BaseNFTVault`'s stat variable `__gap`
19:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L19-L19) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

//@audit this variable is shadowing the `BridgedERC20Base`'s stat variable `__gap`
32:     uint256[49] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
38:     function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L38-L38)


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
11:     uint256[50] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
18:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L18-L18)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit this variable is shadowing the `EssentialContract`'s stat variable `__gap`
57:     uint256[47] private __gap;

//@audit this variable is shadowing the `OwnableUpgradeable`'s stat variable `_owner`
83:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L83-L83)


</details>


### [L&#x2011;37] Sending tokens in a for loop 
Performing token transfers in a loop in a Solidity contract is generally not recommended due to various reasons. One of these reasons is the 'Fail- Silently' issue.\n\nIn a Solidity loop, if one transfer operation fails, it causes the entire transaction to fail.This issue can be particularly troublesome when you're dealing with multiple transfers in one transaction. For instance, if you're looping through an array of recipients to distribute dividends or rewards, a single failed transfer will prevent all the subsequent recipients from receiving their transfers.This could be due to the recipient contract throwing an exception or due to other issues like a gas limit being exceeded.\n\nMoreover, such a design could also inadvertently lead to a situation where a malicious contract intentionally causes a failure when receiving Ether to prevent other participants from getting their rightful transfers.This could open up avenues for griefing attacks in the system.\n\nResolution: To mitigate this problem, it's typically recommended to follow the 'withdraw pattern' in your contracts instead of pushing payments. In this model, each recipient would be responsible for triggering their own payment. This separates each transfer operation, so a failure in one doesn't impact the others.Additionally, it greatly reduces the chance of malicious interference as the control over fund withdrawal lies with the intended recipient and not with an external loop operation.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibVerifying.sol

189:                 tko.transfer(ts.prover, bondToReturn);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L189-L189) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

60:             IERC721(token).safeTransferFrom(vault, user, tokenIds[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L60-L60) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

171:                 IERC721(token_).safeTransferFrom(address(this), _to, _tokenIds[i]);

211:                     t.safeTransferFrom(_user, address(this), _op.tokenIds[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L171-L171) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L211-L211)


</details>


### [L&#x2011;38] Empty receive functions can cause gas issues 
In Solidity, functions that receive Ether without corresponding functionality to utilize or withdraw these funds can inadvertently lead to a permanent loss of value. This is because if someone sends Ether to the contract, they may be unable to retrieve it. To avoid this, functions receiving Ether should be accompanied by additional methods that process or allow the withdrawal of these funds. If the intent is to use the received Ether, it should trigger a separate function; if not, it should revert the transaction (for instance, via `require(msg.sender == address(weth))`). Access control checks can also prevent unintended Ether transfers, despite the slight gas cost they entail. If concerns over gas costs persist, at minimum, include a rescue function to recover unused Ether. Missteps in handling Ether in smart contracts can lead to irreversible financial losses, hence these precautions are crucial.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/bridge/Bridge.sol

70:     receive() external payable { }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L70-L70) 


</details>


## Non-critical Issues

### [NC&#x2011;1] Consider using modifiers for address control 
Modifiers in Solidity can improve code readability and modularity by encapsulating repetitive checks, such as address validity checks, into a reusable construct. For example, an `onlyOwner` modifier can be used to replace repetitive `require(msg.sender == owner)` checks across several functions, reducing code redundancy and enhancing maintainability. To implement, define a modifier with the check, then apply the modifier to relevant functions.


*There are 20 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProposing.sol

310:             if (proposerOne != address(0) && msg.sender != proposerOne) {

310:             if (proposerOne != address(0) && msg.sender != proposerOne) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L310-L310) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L310-L310)


```solidity

File: /contracts/L2/TaikoL2.sol

123:         if (msg.sender != GOLDEN_TOUCH_ADDRESS) revert L2_INVALID_SENDER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L123-L123) 


```solidity

File: /contracts/bridge/Bridge.sol

250:         if (invocationDelay != 0 && msg.sender != proofReceipt[msgHash].preferredExecutor) {

294:             if (msg.sender == refundTo) {

260:             if (_message.gasLimit == 0 && msg.sender != _message.destOwner) {

280:                 uint256 gasLimit = msg.sender == _message.destOwner ? gasleft() : _message.gasLimit;

260:             if (_message.gasLimit == 0 && msg.sender != _message.destOwner) {

280:                 uint256 gasLimit = msg.sender == _message.destOwner ? gasleft() : _message.gasLimit;

294:             if (msg.sender == refundTo) {

322:             if (msg.sender != _message.destOwner) revert B_PERMISSION_DENIED();

322:             if (msg.sender != _message.destOwner) revert B_PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L250-L250) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L294-L294), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L280-L280), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L280-L280), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L294-L294), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L322-L322), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L322-L322)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

61:         if (msg.sender == migratingAddress) {

64:         } else if (msg.sender != resolve("erc20_vault", true)) {

64:         } else if (msg.sender != resolve("erc20_vault", true)) {

83:         } else if (msg.sender != resolve("erc20_vault", true)) {

78:             if (msg.sender != _account) revert BB_PERMISSION_DENIED();

83:         } else if (msg.sender != resolve("erc20_vault", true)) {

78:             if (msg.sender != _account) revert BB_PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L61-L61) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L78-L78)


```solidity

File: /contracts/tokenvault/BaseVault.sol

65:         if (ctx_.from != msg.sender) revert VAULT_PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L65-L65) 


</details>


### [NC&#x2011;2] Large or complicated code bases should implement invariant tests 
Large code bases, or code with lots of inline-assembly, complicated math, or complicated interactions between multiple contracts, should implement [invariant fuzzing tests](https://medium.com/coinmonks/smart-contract-fuzzing-d9b88e0b0a05). Invariant fuzzers such as Echidna require the test writer to come up with invariants which should not be violated under any circumstances, and the fuzzer tests various inputs and function calls to ensure that the invariants always hold. Even code with 100% code coverage can still have bugs due to the order of the operations a user performs, and invariant fuzzers, with properly and extensively-written invariants, can close this testing gap significantly.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

@audit Should implement invariant tests
1: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L1-L1) 


</details>


### [NC&#x2011;3] Array is `push()`ed but not `pop()`ed 
Array entries are added but are never removed. Consider whether this should be the case, or whether there should be a maximum, or whether old entries should be removed. Cases where there are specific potential problems will be flagged separately under a different issue.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/Guardians.sol

23:     address[] public guardians;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L23-L23) 


</details>


### [NC&#x2011;4] Assembly blocks should have extensive comments 
Assembly blocks are taking a lot more time to audit than normal Solidity code, and often have gotchas and side-effects that the Solidity versions of the same code do not. Consider adding more comments explaining what is being done in every step of the assembly code


*There are 34 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

121:             assembly {

132:             assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L121-L121) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L132-L132)


```solidity

File: /contracts/libs/Lib4844.sol

53:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L53-L53) 


```solidity

File: /contracts/L2/TaikoL2.sol

242:         assembly {

247:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L242-L242) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L247-L247)


```solidity

File: /contracts/signal/SignalService.sol

265:         assembly {

309:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L265-L265) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L309-L309)


```solidity

File: /contracts/bridge/Bridge.sol

543:             assembly {

560:             assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L543-L543) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L560-L560)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

43:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L43-L43) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

32:         assembly {

104:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L104-L104)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

43:         assembly {

94:         assembly {

159:         assembly {

295:         assembly {

178:             assembly {

198:             assembly {

208:             assembly {

244:             assembly {

254:             assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L295-L295), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L244-L244), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L254-L254)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

26:         assembly {

76:         assembly {

200:         assembly {

213:         assembly {

226:         assembly {

239:         assembly {

266:         assembly {

273:         assembly {

299:         assembly {

83:             assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L200-L200), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L266-L266), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L273-L273), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L299-L299), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L83-L83)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

99:         assembly {

247:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L99-L99) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L247-L247)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

12:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L12-L12) 


</details>


### [NC&#x2011;5] [NatSpec] Natspec `@author` is missing from `contract` 



*There are 84 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

4: /// @title IAddressManager
5: /// @notice Manages a mapping of (chainId, name) pairs to Ethereum addresses.
6: /// @custom:security-contact security@taiko.xyz
7: interface IAddressManager {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L4-L7) 


```solidity

File: /contracts/common/AddressManager.sol

07: /// @title AddressManager
08: /// @notice See the documentation in {IAddressManager}.
09: /// @custom:security-contact security@taiko.xyz
10: contract AddressManager is EssentialContract, IAddressManager {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L7-L10) 


```solidity

File: /contracts/common/EssentialContract.sol

08: /// @title EssentialContract
09: /// @custom:security-contact security@taiko.xyz
10: abstract contract EssentialContract is UUPSUpgradeable, Ownable2StepUpgradeable, AddressResolver {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L8-L10) 


```solidity

File: /contracts/libs/Lib4844.sol

4: /// @title Lib4844
5: /// @notice A library for handling EIP-4844 blobs
6: /// @dev `solc contracts/libs/Lib4844.sol --ir > contracts/libs/Lib4844.yul`
7: /// @custom:security-contact security@taiko.xyz
8: library Lib4844 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L4-L8) 


```solidity

File: /contracts/libs/LibAddress.sol

10: /// @title LibAddress
11: /// @dev Provides utilities for address-related operations.
12: /// @custom:security-contact security@taiko.xyz
13: library LibAddress {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L10-L13) 


```solidity

File: /contracts/libs/LibMath.sol

4: /// @title LibMath
5: /// @dev This library offers additional math functions for uint256.
6: /// @custom:security-contact security@taiko.xyz
7: library LibMath {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L4-L7) 


```solidity

File: /contracts/libs/LibTrieProof.sol

13: /// @title LibTrieProof
14: /// @custom:security-contact security@taiko.xyz
15: library LibTrieProof {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L13-L15) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

14: /// @title TaikoGovernor
15: /// @custom:security-contact security@taiko.xyz
16: contract TaikoGovernor is


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L14-L16) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

7: /// @title TaikoTimelockController
8: /// @custom:security-contact security@taiko.xyz
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L7-L9) 


```solidity

File: /contracts/L1/hooks/IHook.sol

6: /// @title IHook
7: /// @custom:security-contact security@taiko.xyz
8: interface IHook {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L6-L8) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

11: /// @title AssignmentHook
12: /// @notice A hook that handles prover assignment verification and fee processing.
13: /// @custom:security-contact security@taiko.xyz
14: contract AssignmentHook is EssentialContract, IHook {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L11-L14) 


```solidity

File: /contracts/L1/ITaikoL1.sol

6: /// @title ITaikoL1
7: /// @custom:security-contact security@taiko.xyz
8: interface ITaikoL1 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L6-L8) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

09: /// @title LibDepositing
10: /// @notice A library for handling Ether deposits in the Taiko protocol.
11: /// @custom:security-contact security@taiko.xyz
12: library LibDepositing {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L9-L12) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

12: /// @title LibProposing
13: /// @notice A library for handling block proposals in the Taiko protocol.
14: /// @custom:security-contact security@taiko.xyz
15: library LibProposing {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L12-L15) 


```solidity

File: /contracts/L1/libs/LibProving.sol

12: /// @title LibProving
13: /// @notice A library for handling block contestation and proving in the Taiko
14: /// protocol.
15: /// @custom:security-contact security@taiko.xyz
16: library LibProving {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L12-L16) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

6: /// @title LibUtils
7: /// @notice A library that offers helper functions.
8: /// @custom:security-contact security@taiko.xyz
9: library LibUtils {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L6-L9) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

13: /// @title LibVerifying
14: /// @notice A library for handling block verification in the Taiko protocol.
15: /// @custom:security-contact security@taiko.xyz
16: library LibVerifying {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L13-L16) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

08: /// @title GuardianProver
09: /// @custom:security-contact security@taiko.xyz
10: contract GuardianProver is Guardians {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L8-L10) 


```solidity

File: /contracts/L1/provers/Guardians.sol

6: /// @title Guardians
7: /// @notice A contract that manages a set of guardians and their approvals.
8: /// @custom:security-contact security@taiko.xyz
9: abstract contract Guardians is EssentialContract {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L6-L9) 


```solidity

File: /contracts/L1/TaikoData.sol

4: /// @title TaikoData
5: /// @notice This library defines various data structures used in the Taiko
6: /// protocol.
7: /// @custom:security-contact security@taiko.xyz
8: library TaikoData {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L4-L8) 


```solidity

File: /contracts/L1/TaikoErrors.sol

04: /// @title TaikoErrors
05: /// @notice This abstract contract provides custom error declarations used in
06: /// the Taiko protocol. Each error corresponds to specific situations where
07: /// exceptions might be thrown.
08: /// @dev The errors defined here must match the definitions in the corresponding
09: /// L1 libraries.
10: /// @custom:security-contact security@taiko.xyz
11: abstract contract TaikoErrors {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L4-L11) 


```solidity

File: /contracts/L1/TaikoEvents.sol

06: /// @title TaikoEvents
07: /// @notice This abstract contract provides event declarations for the Taiko
08: /// protocol, which are emitted during block proposal, proof, verification, and
09: /// Ethereum deposit processes.
10: /// @dev The events defined here must match the definitions in the corresponding
11: /// L1 libraries.
12: /// @custom:security-contact security@taiko.xyz
13: abstract contract TaikoEvents {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L6-L13) 


```solidity

File: /contracts/L1/TaikoL1.sol

13: /// @title TaikoL1
14: /// @notice This contract serves as the "base layer contract" of the Taiko protocol, providing
15: /// functionalities for proposing, proving, and verifying blocks. The term "base layer contract"
16: /// means that although this is usually deployed on L1, it can also be deployed on L2s to create
17: /// L3 "inception layers". The contract also handles the deposit and withdrawal of Taiko tokens
18: /// and Ether. Additionally, this contract doesn't hold any Ether. Ether deposited to L2 are held
19: /// by the Bridge contract.
20: /// @dev Labeled in AddressResolver as "taiko"
21: /// @custom:security-contact security@taiko.xyz
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L13-L22) 


```solidity

File: /contracts/L1/TaikoToken.sol

09: /// @title TaikoToken
10: /// @notice The TaikoToken (TKO), in the protocol is used for prover collateral
11: /// in the form of bonds. It is an ERC20 token with 18 decimal places of
12: /// precision.
13: /// @dev Labeled in AddressResolver as "taiko_token"
14: /// @custom:security-contact security@taiko.xyz
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L9-L15) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

4: /// @title ITierProvider
5: /// @notice Defines interface to return tier configuration.
6: /// @custom:security-contact security@taiko.xyz
7: interface ITierProvider {

36: /// @dev Tier ID cannot be zero!
37: library LibTiers {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L4-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L36-L37)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

07: /// @title DevnetTierProvider
08: /// @dev Labeled in AddressResolver as "tier_provider"
09: /// @custom:security-contact security@taiko.xyz
10: contract DevnetTierProvider is EssentialContract, ITierProvider {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L7-L10) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

07: /// @title MainnetTierProvider
08: /// @dev Labeled in AddressResolver as "tier_provider"
09: /// @custom:security-contact security@taiko.xyz
10: contract MainnetTierProvider is EssentialContract, ITierProvider {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L7-L10) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

07: /// @title TestnetTierProvider
08: /// @dev Labeled in AddressResolver as "tier_provider"
09: /// @custom:security-contact security@taiko.xyz
10: contract TestnetTierProvider is EssentialContract, ITierProvider {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L7-L10) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

08: /// @title CrossChainOwned
09: /// @notice This contract's owner can be a local address or one that lives on another chain and uses
10: /// signals for transaction approval.
11: /// @dev Notice that when sending the message on the owner chain, the gas limit of the message must
12: /// not be zero, so on this chain, some EOA can help execute this transaction.
13: /// @custom:security-contact security@taiko.xyz
14: abstract contract CrossChainOwned is EssentialContract, IMessageInvocable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L8-L14) 


```solidity

File: /contracts/L2/Lib1559Math.sol

06: /// @title Lib1559Math
07: /// @notice Implements e^(x) based bonding curve for EIP-1559
08: /// @dev See https://ethresear.ch/t/make-eip-1559-more-like-an-amm-curve/9082
09: /// @custom:security-contact security@taiko.xyz
10: library Lib1559Math {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L6-L10) 


```solidity

File: /contracts/L2/TaikoL2.sol

14: /// @title TaikoL2
15: /// @notice Taiko L2 is a smart contract that handles cross-layer message
16: /// verification and manages EIP-1559 gas pricing for Layer 2 (L2) operations.
17: /// It is used to anchor the latest L1 block details to L2 for cross-layer
18: /// communication, manage EIP-1559 parameters for gas pricing, and store
19: /// verified L1 block information.
20: /// @custom:security-contact security@taiko.xyz
21: contract TaikoL2 is CrossChainOwned {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L14-L21) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

6: /// @title TaikoL2EIP1559Configurable
7: /// @notice TaikoL2 with a setter to change EIP-1559 configurations and states.
8: /// @custom:security-contact security@taiko.xyz
9: contract TaikoL2EIP1559Configurable is TaikoL2 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L6-L9) 


```solidity

File: /contracts/signal/ISignalService.sol

04: /// @title ISignalService
05: /// @notice The SignalService contract serves as a secure cross-chain message
06: /// passing system. It defines methods for sending and verifying signals with
07: /// merkle proofs. The trust assumption is that the target chain has secure
08: /// access to the merkle root (such as Taiko injects it in the anchor
09: /// transaction). With this, verifying a signal is reduced to simply verifying
10: /// a merkle proof.
11: /// @custom:security-contact security@taiko.xyz
12: interface ISignalService {

04: /// @title ISignalService
05: /// @notice The SignalService contract serves as a secure cross-chain message
06: /// passing system. It defines methods for sending and verifying signals with
07: /// merkle proofs. The trust assumption is that the target chain has secure
08: /// access to the merkle root (such as Taiko injects it in the anchor
09: /// transaction). With this, verifying a signal is reduced to simply verifying
10: /// a merkle proof.
11: /// @custom:security-contact security@taiko.xyz
12: interface ISignalService {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L4-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L4-L12)


```solidity

File: /contracts/signal/LibSignals.sol

4: /// @title LibSignals
5: /// @custom:security-contact security@taiko.xyz
6: library LibSignals {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/LibSignals.sol#L4-L6) 


```solidity

File: /contracts/signal/SignalService.sol

10: /// @title SignalService
11: /// @notice See the documentation in {ISignalService} for more details.
12: /// @dev Labeled in AddressResolver as "signal_service".
13: /// @custom:security-contact security@taiko.xyz
14: contract SignalService is EssentialContract, ISignalService {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L10-L14) 


```solidity

File: /contracts/bridge/IBridge.sol

4: /// @title IBridge
5: /// @notice The bridge used in conjunction with the {ISignalService}.
6: /// @dev Ether is held by Bridges on L1 and L2s.
7: /// @custom:security-contact security@taiko.xyz
8: interface IBridge {

158: /// @title IRecallableSender
159: /// @notice An interface that all recallable message senders shall implement.
160: interface IRecallableSender {

172: /// @title IMessageInvocable
173: /// @notice An interface that all bridge message receiver shall implement
174: interface IMessageInvocable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L4-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L158-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L172-L174)


```solidity

File: /contracts/bridge/Bridge.sol

11: /// @title Bridge
12: /// @notice See the documentation for {IBridge}.
13: /// @dev Labeled in AddressResolver as "bridge". Additionally, the code hash for the same address on
14: /// L1 and L2 may be different.
15: /// @custom:security-contact security@taiko.xyz
16: contract Bridge is EssentialContract, IBridge {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L11-L16) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

6: /// @title IUSDC
7: /// @custom:security-contact security@taiko.xyz
8: interface IUSDC {

26: /// @title USDCAdapter
27: /// @custom:security-contact security@taiko.xyz
28: contract USDCAdapter is BridgedERC20Base {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L26-L28)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

11: /// @title BridgedERC20
12: /// @notice An upgradeable ERC20 contract that represents tokens bridged from
13: /// another chain.
14: /// @custom:security-contact security@taiko.xyz
15: contract BridgedERC20 is


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L11-L15) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

7: /// @title BridgedERC20Base
8: /// @custom:security-contact security@taiko.xyz
9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L7-L9) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

09: /// @title BridgedERC721
10: /// @notice Contract for bridging ERC721 tokens across different chains.
11: /// @custom:security-contact security@taiko.xyz
12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L9-L12) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

11: /// @title BridgedERC1155
12: /// @notice Contract for bridging ERC1155 tokens across different chains.
13: /// @custom:security-contact security@taiko.xyz
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L11-L14) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

6: /// @title BaseNFTVault
7: /// @notice Abstract contract for bridging NFTs across different chains.
8: /// @custom:security-contact security@taiko.xyz
9: abstract contract BaseNFTVault is BaseVault {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L6-L9) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

09: /// @title BaseVault
10: /// @notice This abstract contract provides a base implementation for vaults.
11: /// @custom:security-contact security@taiko.xyz
12: abstract contract BaseVault is


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L9-L12) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

11: /// @title IERC1155NameAndSymbol
12: /// @notice Interface for ERC1155 contracts that provide name() and symbol()
13: /// functions. These functions may not be part of the official interface but are
14: /// used by some contracts.
15: /// @custom:security-contact security@taiko.xyz
16: interface IERC1155NameAndSymbol {

24: /// @title ERC1155Vault
25: /// @dev Labeled in AddressResolver as "erc1155_vault"
26: /// @notice This vault holds all ERC1155 tokens that users have deposited.
27: /// It also manages the mapping between canonical tokens and their bridged
28: /// tokens.
29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L11-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L24-L29)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

12: /// @title ERC20Vault
13: /// @notice This vault holds all ERC20 tokens (excluding Ether) that users have
14: /// deposited. It also manages the mapping between canonical ERC20 tokens and
15: /// their bridged tokens.
16: /// @dev Labeled in AddressResolver as "erc20_vault".
17: /// @custom:security-contact security@taiko.xyz
18: contract ERC20Vault is BaseVault {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L12-L18) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

11: /// @title ERC721Vault
12: /// @notice This vault holds all ERC721 tokens that users have deposited. It also manages
13: /// the mapping between canonical tokens and their bridged tokens.
14: /// @dev Labeled in AddressResolver as "erc721_vault".
15: /// @custom:security-contact security@taiko.xyz
16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L11-L16) 


```solidity

File: /contracts/tokenvault/IBridgedERC20.sol

04: /// @title IBridgedERC20
05: /// @notice Interface for all bridged tokens.
06: /// @dev To facilitate compatibility with third-party bridged tokens, such as USDC's native
07: /// standard, it's necessary to implement an intermediary adapter contract which should conform to
08: /// this interface, enabling effective interaction with third-party contracts.
09: /// @custom:security-contact security@taiko.xyz
10: interface IBridgedERC20 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L4-L10) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

6: /// @title LibBridgedToken
7: /// @custom:security-contact security@taiko.xyz
8: library LibBridgedToken {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L6-L8) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5-L5) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

4: /// @title Bytes
5: /// @notice Bytes is a library for manipulating byte arrays.
6: library Bytes {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L4-L6) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

4: /// @custom:attribution https://github.com/hamdiallam/Solidity-RLP
5: /// @title RLPReader
6: /// @notice RLPReader is a library for parsing RLP-encoded byte arrays into Solidity types. Adapted
7: ///         from Solidity-RLP (https://github.com/hamdiallam/Solidity-RLP) by Hamdi Allam with
8: ///         various tweaks to improve readability.
9: library RLPReader {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L4-L9) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

07: /// @title MerkleTrie
08: /// @notice MerkleTrie is a small library for verifying standard Ethereum Merkle-Patricia trie
09: ///         inclusion proofs. By default, this library assumes a hexary trie. One can change the
10: ///         trie radix constant to support other trie radixes.
11: library MerkleTrie {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L7-L11) 


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

6: /// @title SecureMerkleTrie
7: /// @notice SecureMerkleTrie is a thin wrapper around the MerkleTrie library that hashes the input
8: ///         keys. Ethereum's state trie hashes input keys before storing them.
9: library SecureMerkleTrie {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L6-L9) 


```solidity

File: /contracts/verifiers/IVerifier.sol

6: /// @title IVerifier
7: /// @notice Defines the function that handles proof verification.
8: /// @custom:security-contact security@taiko.xyz
9: interface IVerifier {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L6-L9) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

08: /// @title GuardianVerifier
09: /// @custom:security-contact security@taiko.xyz
10: contract GuardianVerifier is EssentialContract, IVerifier {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L8-L10) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

12: /// @title SgxVerifier
13: /// @notice This contract is the implementation of verifying SGX signature proofs
14: /// onchain.
15: /// @dev Please see references below:
16: /// - Reference #1: https://ethresear.ch/t/2fa-zk-rollups-using-sgx/14462
17: /// - Reference #2: https://github.com/gramineproject/gramine/discussions/1579
18: /// @custom:security-contact security@taiko.xyz
19: contract SgxVerifier is EssentialContract, IVerifier {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L12-L19) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

08: /// @title ERC20Airdrop
09: /// @notice Contract for managing Taiko token airdrop for eligible users.
10: /// @custom:security-contact security@taiko.xyz
11: contract ERC20Airdrop is MerkleClaimable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L8-L11) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

08: /// @title ERC20Airdrop2
09: /// @notice Contract for managing Taiko token airdrop for eligible users, but the
10: /// withdrawal is not immediate and is subject to a withdrawal window.
11: /// @custom:security-contact security@taiko.xyz
12: contract ERC20Airdrop2 is MerkleClaimable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L8-L12) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

7: /// @title ERC721Airdrop
8: /// @custom:security-contact security@taiko.xyz
9: contract ERC721Airdrop is MerkleClaimable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L7-L9) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

07: /// @title MerkleClaimable
08: /// @notice Contract for managing Taiko token airdrop for eligible users
09: /// @custom:security-contact security@taiko.xyz
10: abstract contract MerkleClaimable is EssentialContract {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L7-L10) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

09: /// @title TimelockTokenPool
10: /// @notice Contract for managing Taiko tokens allocated to different roles and
11: /// individuals.
12: ///
13: /// Manages Taiko tokens through a three-state lifecycle: "allocated" to
14: /// "granted, owned, and locked," and finally to "granted, owned, and unlocked."
15: /// Allocation doesn't transfer ownership unless specified by grant settings.
16: /// Conditional allocated tokens can be canceled by invoking `void()`, making
17: /// them available for other uses. Once granted and owned, tokens are
18: /// irreversible and their unlock schedules are immutable.
19: ///
20: /// We should deploy multiple instances of this contract for different roles:
21: /// - investors
22: /// - team members, advisors, etc.
23: /// - grant program grantees
24: /// @custom:security-contact security@taiko.xyz
25: contract TimelockTokenPool is EssentialContract {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L9-L25) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

20: /// @title AutomataDcapV3Attestation
21: /// @custom:security-contact security@taiko.xyz
22: contract AutomataDcapV3Attestation is IAttestation {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L20-L22) 


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

6: /// @title IAttestation
7: /// @custom:security-contact security@taiko.xyz
8: interface IAttestation {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L6-L8) 


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

4: /// @title ISigVerifyLib
5: /// @custom:security-contact security@taiko.xyz
6: interface ISigVerifyLib {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L4-L6) 


```solidity

File: /contracts/automata-attestation/lib/EnclaveIdStruct.sol

4: /// @title EnclaveIdStruct
5: /// @custom:security-contact security@taiko.xyz
6: library EnclaveIdStruct {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L4-L6) 


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

4: /// @title IPEMCertChainLib
5: /// @custom:security-contact security@taiko.xyz
6: interface IPEMCertChainLib {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L4-L6) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

10: /// @title PEMCertChainLib
11: /// @custom:security-contact security@taiko.xyz
12: contract PEMCertChainLib is IPEMCertChainLib {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L10-L12) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

09: /// @title V3Parser
10: /// @custom:security-contact security@taiko.xyz
11: library V3Parser {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L9-L11) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

4: /// @title V3Struct
5: /// @custom:security-contact security@taiko.xyz
6: library V3Struct {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L4-L6) 


```solidity

File: /contracts/automata-attestation/lib/TCBInfoStruct.sol

4: /// @title TCBInfoStruct
5: /// @custom:security-contact security@taiko.xyz
6: library TCBInfoStruct {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L4-L6) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

10: /// @title NodePtr
11: /// @custom:security-contact security@taiko.xyz
12: library NodePtr {

36: /// @title Asn1Decode
37: /// @custom:security-contact security@taiko.xyz
38: library Asn1Decode {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L10-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L36-L38)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

6: /// @title BytesUtils
7: /// @custom:security-contact security@taiko.xyz
8: library BytesUtils {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L6-L8) 


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

32: /// @title RsaVerify
33: /// @custom:security-contact security@taiko.xyz
34: library RsaVerify {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L32-L34) 


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

08: /// @title SHA1
09: /// @custom:security-contact security@taiko.xyz
10: library SHA1 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L8-L10) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

08: /// @title SigVerifyLib
09: /// @custom:security-contact security@taiko.xyz
10: // Library for verifying signatures


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L8-L10) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

5: /// @title X509DateUtils
6: /// @custom:security-contact security@taiko.xyz
7: library X509DateUtils {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L5-L7) 


</details>


### [NC&#x2011;6] Avoid the use of sensitive terms 
Use [alternative variants](https://www.zdnet.com/article/mysql-drops-master-slave-and-blacklist-whitelist-terminology/), e.g. allowlist/denylist instead of whitelist/blacklist


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/ERC20Vault.sol

51:     /// @notice Mappings from bridged tokens to their blacklist status.

52:     mapping(address btoken => bool blacklisted) public btokenBlacklist;

136:     error VAULT_BTOKEN_BLACKLISTED();

162:         if (btokenBlacklist[_btokenNew]) revert VAULT_BTOKEN_BLACKLISTED();

181:             btokenBlacklist[btokenOld_] = true;

216:         if (btokenBlacklist[_op.token]) revert VAULT_BTOKEN_BLACKLISTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L216-L216)


</details>


### [NC&#x2011;7] Variable names that consist of all capital letters should be reserved for `constant`/`immutable` variables 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/utils/SigVerifyLib.sol

18:     address private ES256VERIFIER;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L18-L18) 


</details>


### [NC&#x2011;8] Common functions should be refactored to a common base contract 
The functions below have the same implementation as is seen in other files. The functions should be refactored into functions of a common base contract


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

//@audit this function is already seen in `/contracts/L1/tiers/DevnetTierProvider.sol`
31:     function init(
32:         address _owner,
33:         IVotesUpgradeable _token,
34:         TimelockControllerUpgradeable _timelock
35:     )
36:         external
37:         initializer
38:     {
39:         __Essential_init(_owner);
40:         __Governor_init("TaikoGovernor");
41:         __GovernorCompatibilityBravo_init();
42:         __GovernorVotes_init(_token);
43:         __GovernorVotesQuorumFraction_init(4);
44:         __GovernorTimelockControl_init(_timelock);
45:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L31-L45) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit this function is already seen in `/contracts/tokenvault/BridgedERC20.sol`
152:     function _afterTokenTransfer(
153:         address _from,
154:         address _to,
155:         uint256 _amount
156:     )
157:         internal
158:         override(ERC20Upgradeable, ERC20VotesUpgradeable)
159:     {
160:         super._afterTokenTransfer(_from, _to, _amount);
161:     }

//@audit this function is already seen in `/contracts/tokenvault/BridgedERC20.sol`
163:     function _mint(
164:         address _to,
165:         uint256 _amount
166:     )
167:         internal
168:         override(ERC20Upgradeable, ERC20VotesUpgradeable)
169:     {
170:         super._mint(_to, _amount);
171:     }

//@audit this function is already seen in `/contracts/tokenvault/BridgedERC20.sol`
173:     function _burn(
174:         address _from,
175:         uint256 _amount
176:     )
177:         internal
178:         override(ERC20Upgradeable, ERC20VotesUpgradeable)
179:     {
180:         super._burn(_from, _amount);
181:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L161) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L181)


</details>


### [NC&#x2011;9] Overly complicated arithmetic 
To maintain readability in code, particularly in Solidity which can involve complex mathematical operations, it is often recommended to limit the number of arithmetic operations to a maximum of 2-3 per line. Too many operations in a single line can make the code difficult to read and understand, increase the likelihood of mistakes, and complicate the process of debugging and reviewing the code. Consider splitting such operations over more than one line, take special care when dealing with division however. Try to limit the number of arithmetic operations to a maximum of 3 per line.


*There are 8 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/team/airdrop/ERC20Airdrop2.sol

117:         uint256 timeBasedAllowance = balance
118:             * (block.timestamp.min(claimEnd + withdrawalWindow) - claimEnd) / withdrawalWindow;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L117-L118) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

24:         yrs += (uint8(x509Time[offset + 0]) - 48) * 10 + uint8(x509Time[offset + 1]) - 48;
25:         mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;

25:         mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;
26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;

26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;
27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;

27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;
28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;

28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;
29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;

29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;
30: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L24-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L25-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L26-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L27-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L28-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L29-L30)


</details>


### [NC&#x2011;10] Constants in comparisons should appear on the left side 



*There are 246 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

//@audit `_TRUE`
89:         return __paused == _TRUE;

//@audit `1`
120:         if (block.chainid == 1) {

//@audit `1`
131:         if (block.chainid == 1) {

//@audit `_TRUE`
141:         return _loadReentryLock() == _TRUE;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L89-L89) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L141-L141)


```solidity

File: /contracts/libs/Lib4844.sol

//@audit `BLS_MODULUS`
40:         if (_x >= BLS_MODULUS) revert POINT_X_TOO_LARGE();

//@audit `BLS_MODULUS`
41:         if (_y >= BLS_MODULUS) revert POINT_Y_TOO_LARGE();

//@audit `64`
49:         if (ret.length != 64) revert EVAL_FAILED_2();

//@audit `FIELD_ELEMENTS_PER_BLOB`
57:         if (uint256(first) != FIELD_ELEMENTS_PER_BLOB || uint256(second) != BLS_MODULUS) {

//@audit `BLS_MODULUS`
57:         if (uint256(first) != FIELD_ELEMENTS_PER_BLOB || uint256(second) != BLS_MODULUS) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L57-L57)


```solidity

File: /contracts/libs/LibAddress.sol

//@audit `_EIP1271_MAGICVALUE`
71:             return IERC1271(_addr).isValidSignature(_hash, _sig) == _EIP1271_MAGICVALUE;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L71-L71) 


```solidity

File: /contracts/libs/LibTrieProof.sol

//@audit `0`
46:         if (_accountProof.length != 0) {

//@audit `0`
50:             if (rlpAccount.length == 0) revert LTP_INVALID_ACCOUNT_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L50-L50)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

//@audit `0`
125:         if (address(this).balance > 0) {

//@audit `0`
120:         if (input.tip != 0 && block.coinbase != address(0)) {

//@audit `0`
86:                 || assignment.maxProposedIn != 0 && block.number > assignment.maxProposedIn

//@audit `0`
85:                 || assignment.maxBlockId != 0 && _meta.id > assignment.maxBlockId

//@audit `0`
84:                 || assignment.parentMetaHash != 0 && _meta.parentMetaHash != assignment.parentMetaHash

//@audit `0`
83:                 || assignment.metaHash != 0 && _blk.metaHash != assignment.metaHash


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L125-L125) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L83-L83)


```solidity

File: /contracts/L1/libs/LibProposing.sol

//@audit `0`
108:         if (params.parentMetaHash != 0 && parentMetaHash != params.parentMetaHash) {

//@audit `0`
195:         if (meta_.txListByteSize == 0 || meta_.txListByteSize > _config.blockMaxTxListBytes) {

//@audit `0`
260:             if (address(this).balance != 0) {

//@audit `0`
185:             if (params.txListByteOffset != 0) {

//@audit `0`
144:             if (params.blobHash != 0) {

//@audit `MAX_BYTES_PER_BLOB`
171:             if (uint256(params.txListByteOffset) + params.txListByteSize > MAX_BYTES_PER_BLOB) {

//@audit `0`
135:                 blobUsed: _txList.length == 0,

//@audit `0`
159:                 if (meta_.blobHash == 0) revert L1_BLOB_NOT_FOUND();

//@audit `1`
307:         if (_slotB.numBlocks == 1) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L108-L108) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L307-L307)


```solidity

File: /contracts/L1/libs/LibProving.sol

//@audit `0`
186:         bool isTopTier = tier.contestBond == 0;

//@audit `0`
105:         if (_tran.parentHash == 0 || _tran.blockHash == 0 || _tran.stateRoot == 0) {

//@audit `0`
105:         if (_tran.parentHash == 0 || _tran.blockHash == 0 || _tran.stateRoot == 0) {

//@audit `0`
105:         if (_tran.parentHash == 0 || _tran.blockHash == 0 || _tran.stateRoot == 0) {

//@audit `0`
134:         if (_proof.tier == 0 || _proof.tier < _meta.minTier || _proof.tier < ts.tier) {

//@audit `TIER_OP`
178:             } else if (tier.verifierName != TIER_OP) {

//@audit `RETURN_LIVENESS_BOND`
193:                 && bytes32(_proof.data) == RETURN_LIVENESS_BOND;

//@audit `0`
164:                 bool isContesting = _proof.tier == ts.tier && tier.contestBond != 0;

//@audit `0`
192:             bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32

//@audit `32`
192:             bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32

//@audit `0`
223:                 assert(tier.validityBond == 0);

//@audit `0`
224:                 assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0));

//@audit `0`
224:                 assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0));

//@audit `0`
280:         if (tid_ == 0) {

//@audit `1`
309:             if (tid_ == 1) {

//@audit `0`
412:         if (_tier.contestBond == 0) return;

//@audit `1`
419:         if (_tid == 1 && _ts.tier == 0 && inProvingWindow) {

//@audit `0`
419:         if (_tid == 1 && _ts.tier == 0 && inProvingWindow) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L186-L186) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L193-L193), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L280-L280), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L309-L309), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L412-L412), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L419-L419), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L419-L419)


```solidity

File: /contracts/L1/libs/LibUtils.sol

//@audit `0`
43:         if (tid == 0) revert L1_TRANSITION_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L43-L43) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit `0`
93:         if (_maxBlocksToVerify == 0) {

//@audit `0`
111:         if (tid == 0) revert L1_TRANSITION_ID_ZERO();

//@audit `0`
212:             if (numBlocksVerified > 0) {

//@audit `0`
137:                 if (tid == 0) break;

//@audit `0`
261:                 || _config.ethDepositMaxFee == 0

//@audit `0`
260:                 || _config.ethDepositMaxAmount > type(uint96).max || _config.ethDepositGas == 0

//@audit `0`
258:                 || _config.ethDepositMinAmount == 0

//@audit `32`
256:             || _config.ethDepositMaxCountPerBlock > 32

//@audit `0`
253:                 || _config.ethDepositMinCountPerBlock == 0

//@audit `1`
252:                 || _config.livenessBond == 0 || _config.ethDepositRingBufferSize <= 1

//@audit `0`
252:                 || _config.livenessBond == 0 || _config.ethDepositRingBufferSize <= 1

//@audit `0`
250:                 || _config.blockMaxGasLimit == 0 || _config.blockMaxTxListBytes == 0

//@audit `0`
250:                 || _config.blockMaxGasLimit == 0 || _config.blockMaxTxListBytes == 0

//@audit `1`
248:                 || _config.blockMaxProposals == 1

//@audit `1`
247:             _config.chainId <= 1 || _config.chainId == block.chainid //


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L93-L93) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L261-L261), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L256-L256), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L247-L247)


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit `MIN_NUM_GUARDIANS`
63:         if (_newGuardians.length < MIN_NUM_GUARDIANS || _newGuardians.length > type(uint8).max) {

//@audit `0`
84:             if (guardianIds[guardian] != 0) revert INVALID_GUARDIAN_SET();

//@audit `0`
113:         if (id == 0) revert INVALID_GUARDIAN();

//@audit `1`
134:                 if (bits & 1 == 1) ++count;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L63-L63) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L113-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L134-L134)


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit `0`
153:         if (blk_.verifiedTransitionId != 0) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L153-L153) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit `0`
68:         if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L68-L68) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit `0`
68:         if (_rand % 10 == 0) return LibTiers.TIER_SGX;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L68-L68) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit `0`
70:         if (_ownerChainId == 0 || _ownerChainId == block.chainid) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L70-L70) 


```solidity

File: /contracts/L2/Lib1559Math.sol

//@audit `0`
24:         if (_adjustmentFactor == 0) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L24-L24) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit `0`
86:         if (block.number == 0) {

//@audit `1`
82:         if (block.chainid <= 1 || block.chainid > type(uint64).max) {

//@audit `1`
88:         } else if (block.number == 1) {

//@audit `GOLDEN_TOUCH_ADDRESS`
123:         if (msg.sender != GOLDEN_TOUCH_ADDRESS) revert L2_INVALID_SENDER();

//@audit `0`
117:             _l1BlockHash == 0 || _l1StateRoot == 0 || _l1BlockId == 0

//@audit `0`
117:             _l1BlockHash == 0 || _l1StateRoot == 0 || _l1BlockId == 0

//@audit `0`
117:             _l1BlockHash == 0 || _l1StateRoot == 0 || _l1BlockId == 0

//@audit `1`
118:                 || (block.number != 1 && _parentGasUsed == 0)

//@audit `0`
118:                 || (block.number != 1 && _parentGasUsed == 0)

//@audit `255`
234:             for (uint256 i; i < 255 && _blockId >= i + 1; ++i) {

//@audit `0`
262:         if (gasExcess > 0) {

//@audit `0`
296:         if (basefee_ == 0) basefee_ = 1;

//@audit `0`
279:             if (numL1Blocks > 0) {

//@audit `0`
275:             if (lastSyncedBlock > 0 && _l1BlockId > lastSyncedBlock) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L86-L86) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L234-L234), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L262-L262), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L296-L296), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L279-L279), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L275-L275)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

//@audit `0`
33:         if (_newConfig.gasTargetPerL1Block == 0) revert L2_INVALID_CONFIG();

//@audit `0`
34:         if (_newConfig.basefeeAdjustmentQuotient == 0) revert L2_INVALID_CONFIG();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L33-L33) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L34-L34)


```solidity

File: /contracts/signal/SignalService.sol

//@audit `0`
95:         if (hopProofs.length == 0) revert SS_EMPTY_PROOF();

//@audit `0`
131:         if (value == 0 || value != _loadSignalValue(address(this), signal)) {

//@audit `0`
120:             bool isFullProof = hop.accountProof.length > 0;

//@audit `0`
114:                 if (hop.chainId == 0 || hop.chainId == block.chainid) {

//@audit `0`
154:         return _loadSignalValue(_app, _signal) != 0;

//@audit `0`
169:         if (blockId_ != 0) {

//@audit `0`
167:         blockId_ = _blockId != 0 ? _blockId : topBlockId[_chainId][_kind];

//@audit `0`
172:             if (chainData_ == 0) revert SS_SIGNAL_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L95-L95) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L167-L167), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L172-L172)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit `0`
169:         bool isMessageProven = receivedAt != 0;

//@audit `0`
231:         bool isMessageProven = receivedAt != 0;

//@audit `0`
250:         if (invocationDelay != 0 && msg.sender != proofReceipt[msgHash].preferredExecutor) {

//@audit `0`
242:             if (invocationDelay != 0) {

//@audit `0`
260:             if (_message.gasLimit == 0 && msg.sender != _message.destOwner) {

//@audit `0`
245:                     preferredExecutor: _message.gasLimit == 0 ? _message.destOwner : msg.sender

//@audit `0`
321:         if (_message.gasLimit == 0 || _isLastAttempt) {

//@audit `0`
405:         if (ctx_.msgHash == 0 || ctx_.msgHash == bytes32(PLACEHOLDER)) {

//@audit `1`
424:             block.chainid == 1 // Ethereum mainnet

//@audit `11_155_111`
435:                 || block.chainid == 11_155_111 // Sepolia

//@audit `17_000`
434:                 || block.chainid == 17_000 // Holesky

//@audit `32_300`
439:         } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {

//@audit `32_400`
439:         } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {

//@audit `42`
433:                 || block.chainid == 42 // Kovan

//@audit `5`
432:                 || block.chainid == 5 // Goerli

//@audit `2`
430:             block.chainid == 2 // Ropsten

//@audit `4`
431:                 || block.chainid == 4 // Rinkeby

//@audit `0`
485:         if (_gasLimit == 0) revert B_INVALID_GAS_LIMIT();

//@audit `4`
491:             _message.data.length >= 4 // msg can be empty

//@audit `1`
530:         if (block.chainid == 1) {

//@audit `1`
542:         if (block.chainid == 1) {

//@audit `1`
556:         if (block.chainid == 1) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L169-L169) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L242-L242), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L321-L321), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L405-L405), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L424-L424), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L435-L435), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L434-L434), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L439-L439), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L439-L439), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L433-L433), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L432-L432), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L430-L430), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L431-L431), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L485-L485), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L491-L491), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L530-L530), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L542-L542), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L556-L556)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit `0`
48:             if (_op.amounts[i] == 0) revert VAULT_INVALID_AMOUNT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L48-L48) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit `0`
214:         if (_op.amount == 0) revert VAULT_INVALID_AMOUNT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L214-L214) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit `0`
35:             if (_op.amounts[i] != 0) revert VAULT_INVALID_AMOUNT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L35-L35) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

//@audit `0`
22:                 || bytes(_symbol).length == 0 || bytes(_name).length == 0

//@audit `0`
22:                 || bytes(_symbol).length == 0 || bytes(_name).length == 0

//@audit `0`
21:             _srcToken == address(0) || _srcChainId == 0 || _srcChainId == block.chainid


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L21-L21)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

//@audit `0`
38:             _in.length > 0,

//@audit `0x7f`
163:         if (prefix <= 0x7f) {

//@audit `0`
153:             _in.length > 0,

//@audit `0xb7`
166:         } else if (prefix <= 0xb7) {

//@audit `0xbf`
188:         } else if (prefix <= 0xbf) {

//@audit `0xf7`
223:         } else if (prefix <= 0xf7) {

//@audit `0x00`
203:                 firstByteOfContent != 0x00,

//@audit `55`
213:                 strLen > 55,

//@audit `1`
183:                 strLen != 1 || firstByteOfContent >= 0x80,

//@audit `0x80`
183:                 strLen != 1 || firstByteOfContent >= 0x80,

//@audit `0x00`
249:                 firstByteOfContent != 0x00,

//@audit `55`
259:                 listLen > 55,

//@audit `0`
287:         if (_length == 0) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L153-L153), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L183-L183), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L183-L183), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L259-L259), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L287-L287)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit `1`
14:         if (_in.length == 1 && uint8(_in[0]) < 128) {

//@audit `128`
14:         if (_in.length == 1 && uint8(_in[0]) < 128) {

//@audit `56`
33:         if (_len < 56) {

//@audit `0`
39:             while (_len / i != 0) {

//@audit `32`
59:         for (; i < 32; i++) {

//@audit `0`
60:             if (b[i] != 0) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L60-L60)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

//@audit `0`
77:         require(_key.length > 0, "MerkleTrie: empty key");

//@audit `0`
91:             if (currentKeyIndex == 0) {

//@audit `BRANCH_NODE_LENGTH`
111:             if (currentNode.decoded.length == BRANCH_NODE_LENGTH) {

//@audit `32`
97:             } else if (currentNode.encoded.length >= 32) {

//@audit `LEAF_OR_EXTENSION_NODE_LENGTH`
139:             } else if (currentNode.decoded.length == LEAF_OR_EXTENSION_NODE_LENGTH) {

//@audit `PREFIX_LEAF_EVEN`
155:                 if (prefix == PREFIX_LEAF_EVEN || prefix == PREFIX_LEAF_ODD) {

//@audit `PREFIX_LEAF_ODD`
155:                 if (prefix == PREFIX_LEAF_EVEN || prefix == PREFIX_LEAF_ODD) {

//@audit `PREFIX_EXTENSION_EVEN`
184:                 } else if (prefix == PREFIX_EXTENSION_EVEN || prefix == PREFIX_EXTENSION_ODD) {

//@audit `PREFIX_EXTENSION_ODD`
184:                 } else if (prefix == PREFIX_EXTENSION_EVEN || prefix == PREFIX_EXTENSION_ODD) {

//@audit `0`
120:                         value_.length > 0,

//@audit `0`
173:                         value_.length > 0,

//@audit `32`
221:         id_ = _node.length < 32 ? RLPReader.readRawBytes(_node) : RLPReader.readBytes(_node);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L77-L77) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L184-L184), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L184-L184), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L173-L173), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L221-L221)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit `89`
152:         if (_proof.data.length != 89) revert SGX_INVALID_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L152-L152) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit `0`
111:         if (balance == 0) return (0, 0);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L111-L111) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit `0`
137:         if (recipients[_recipient].grant.amount != 0) revert ALREADY_GRANTED();

//@audit `0`
154:         if (amountVoided == 0) revert NOTHING_TO_VOID();

//@audit `0`
255:         if (_amount == 0) return 0;

//@audit `0`
256:         if (_start == 0) return _amount;

//@audit `0`
259:         if (_period == 0) return _amount;

//@audit `0`
268:         if (_grant.amount == 0) revert INVALID_GRANT();

//@audit `0`
274:         if (_start == 0 || _period == 0) {

//@audit `0`
274:         if (_start == 0 || _period == 0) {

//@audit `0`
275:             if (_cliff > 0) revert INVALID_GRANT();

//@audit `0`
277:             if (_cliff > 0 && _cliff <= _start) revert INVALID_GRANT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L137-L137) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L256-L256), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L259-L259), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L268-L268), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L274-L274), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L274-L274), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L275-L275), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L277-L277)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit `CPUSVN_LENGTH`
240:         for (uint256 i; i < CPUSVN_LENGTH; ++i) {

//@audit `CPUSVN_LENGTH`
237:         if (pckCpuSvns.length != CPUSVN_LENGTH || tcbCpuSvns.length != CPUSVN_LENGTH) {

//@audit `CPUSVN_LENGTH`
237:         if (pckCpuSvns.length != CPUSVN_LENGTH || tcbCpuSvns.length != CPUSVN_LENGTH) {

//@audit `ROOTCA_PUBKEY_HASH`
294:             if (issuerPubKeyHash == ROOTCA_PUBKEY_HASH) {

//@audit `3`
420:             for (uint256 i; i < 3; ++i) {

//@audit `0`
421:                 bool isPckCert = i == 0; // additional parsing for PCKCert


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L240-L240) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L294-L294), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L420-L420), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L421-L421)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit `0`
56:             if (i > 0) {

//@audit `0xA3`
189:             if (der[tbsPtr.ixs()] != 0xA3) {

//@audit `0x17`
135:                 (notBeforeTag != 0x17 && notBeforeTag == 0x18)

//@audit `0x18`
135:                 (notBeforeTag != 0x17 && notBeforeTag == 0x18)

//@audit `0x17`
136:                     || (notAfterTag != 0x17 && notAfterTag != 0x18)

//@audit `0x18`
136:                     || (notAfterTag != 0x17 && notAfterTag != 0x18)

//@audit `0`
286:         while (tbsPtr != 0) {

//@audit `0x06`
288:             if (der[internalPtr.ixs()] != 0x06) {

//@audit `0x06`
303:                     if (der[extnValueOidPtr.ixs()] != 0x06) {

//@audit `2`
358:             uint16 svnValue = svnValueBytes.length < 2


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L189-L189), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L286-L286), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L288-L288), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L358-L358)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit `MINIMUM_QUOTE_LENGTH`
29:         if (quote.length <= MINIMUM_QUOTE_LENGTH) {

//@audit `5`
88:             v3Quote.v3AuthData.certification.certType == 5,

//@audit `3`
92:             v3Quote.v3AuthData.certification.decodedCertDataArray.length == 3, "3 certs in chain"

//@audit `MINIMUM_QUOTE_LENGTH`
116:         require(totalQuoteSize >= MINIMUM_QUOTE_LENGTH, "Invalid quote size");

//@audit `64`
79:                 && localEnclaveReport.reportData.length == 64,

//@audit `64`
84:                 && pckSignedQeReport.reportData.length == 64,

//@audit `64`
97:                 && v3Quote.v3AuthData.qeReportSignature.length == 64,

//@audit `96`
78:             localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60

//@audit `60`
78:             localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60

//@audit `96`
83:             pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60

//@audit `60`
83:             pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60

//@audit `64`
95:             v3Quote.v3AuthData.ecdsa256BitSignature.length == 64

//@audit `64`
96:                 && v3Quote.v3AuthData.ecdsaAttestationKey.length == 64

//@audit `SUPPORTED_QUOTE_VERSION`
171:         if (version != SUPPORTED_QUOTE_VERSION) {

//@audit `SUPPORTED_ATTESTATION_KEY_TYPE`
176:         if (attestationKeyType != SUPPORTED_ATTESTATION_KEY_TYPE) {

//@audit `SUPPORTED_TEE_TYPE`
181:         if (teeType != SUPPORTED_TEE_TYPE) {

//@audit `VALID_QE_VENDOR_ID`
186:         if (qeVendorId != VALID_QE_VENDOR_ID) {

//@audit `1`
218:         if (cert.certType < 1 || cert.certType > 5) {

//@audit `5`
218:         if (cert.certType < 1 || cert.certType > 5) {

//@audit `3`
281:         for (uint256 i; i < 3; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L186-L186), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L218-L218), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L218-L218), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L281-L281)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit `0x03`
57:         require(der[ptr.ixs()] == 0x03, "Not type BIT STRING");

//@audit `0x04`
67:         require(der[ptr.ixs()] == 0x04, "Not type OCTET STRING");

//@audit `0x20`
88:         require(der[ptr.ixs()] & 0x20 == 0x20, "Not a constructed type");

//@audit `0x02`
142:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

//@audit `0`
143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

//@audit `0`
158:         if (der[ptr.ixf()] == 0) {

//@audit `0x02`
155:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

//@audit `0`
156:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

//@audit `0x03`
180:         require(der[ptr.ixs()] == 0x03, "ixs Not type BIT STRING 0x03");

//@audit `0x00`
182:         require(der[ptr.ixf()] == 0x00, "ixf Not 0");

//@audit `0`
191:         if ((der[ix + 1] & 0x80) == 0) {

//@audit `1`
197:             if (lengthbytesLength == 1) {

//@audit `2`
199:             } else if (lengthbytesLength == 2) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L182-L182), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L197-L197), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L199-L199)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit `32`
90:                 if (shortest > 32) {

//@audit `0`
96:                 if (diff != 0) {

//@audit `32`
264:         require(len <= 32, "unexpected len");

//@audit `0`
345:         if (len % 8 == 0) {

//@audit `52`
329:         require(len <= 52, "unexpected len");

//@audit `2`
348:         } else if (len % 8 == 2) {

//@audit `4`
352:         } else if (len % 8 == 4) {

//@audit `0x20`
337:             require(decoded <= 0x20, "invalid decoded");

//@audit `5`
356:         } else if (len % 8 == 5) {

//@audit `0x30`
335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

//@audit `0x7A`
335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

//@audit `7`
360:         } else if (len % 8 == 7) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L90-L90) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L345-L345), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L329-L329), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L348-L348), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L337-L337), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L356-L356), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L335-L335), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L335-L335), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L360-L360)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

//@audit `0x31`
125:         if (uint8(decipher[decipherlen - 50]) == 0x31) {

//@audit `0`
145:         if (decipher[2 + paddingLen] != 0) {

//@audit `0x2f`
128:         } else if (uint8(decipher[decipherlen - 48]) == 0x2f) {

//@audit `0`
137:         if (decipher[0] != 0 || decipher[1] != 0x01) {

//@audit `0x01`
137:         if (decipher[0] != 0 || decipher[1] != 0x01) {

//@audit `0x04`
168:             decipher[3 + paddingLen + digestAlgoWithParamLen] != 0x04

//@audit `0x20`
169:                 || decipher[4 + paddingLen + digestAlgoWithParamLen] != 0x20

//@audit `0xff`
141:             if (decipher[i] != 0xff) {

//@audit `0`
278:         if (decipher[2 + paddingLen] != 0) {

//@audit `0`
270:         if (decipher[0] != 0 || decipher[1] != 0x01) {

//@audit `0x01`
270:         if (decipher[0] != 0 || decipher[1] != 0x01) {

//@audit `0xff`
274:             if (decipher[i] != 0xff) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L125-L125) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L278-L278), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L270-L270), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L270-L270), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L274-L274)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

//@audit `64`
123:         if (signature.length != 64) {

//@audit `64`
129:         if (publicKey.length != 64) {

//@audit `1`
140:         return abi.decode(ret, (uint256)) == 1;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L123-L123) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L140-L140)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

//@audit `13`
17:         if (x509Time.length == 13) {

//@audit `5`
18:             if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;

//@audit `0`
72:         if (year % 4 != 0) return false;

//@audit `0`
73:         if (year % 100 != 0) return true;

//@audit `0`
74:         if (year % 400 != 0) return false;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L74-L74)


</details>


### [NC&#x2011;11] [NatSpec] Natspec description is missing from `contract` 
It is recommended that Solidity contracts are fully annotated using NatSpec for all public interfaces (everything in the ABI). It is clearly stated in the Solidity official documentation. In complex projects such as Defi, the interpretation of all functions and their arguments and returns is important for code readability and auditability.[source](https://docs.soliditylang.org/en/v0.8.15/natspec-format.html)


*There are 392 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

14:     uint256[49] private __gap;

25:     error AM_INVALID_PARAMS();

26:     error AM_UNSUPPORTED();

58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58)


```solidity

File: /contracts/common/EssentialContract.sol

11:     uint8 private constant _FALSE = 1;

13:     uint8 private constant _TRUE = 2;

23:     uint8 private __paused;

25:     uint256[49] private __gap;

35:     error REENTRANT_CALL();

36:     error INVALID_PAUSE_STATUS();

37:     error ZERO_ADDR_MANAGER();

46:     modifier nonReentrant() {

53:     modifier whenPaused() {

58:     modifier whenNotPaused() {

109:     function __Essential_init(address _owner) internal virtual {

114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }

116:     function _authorizePause(address) internal virtual onlyOwner { }

119:     function _storeReentryLock(uint8 _reentry) internal virtual {

130:     function _loadReentryLock() internal view virtual returns (uint8 reentry_) {

140:     function _inNonReentrant() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L119-L119), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L140-L140)


```solidity

File: /contracts/libs/Lib4844.sol

19:     error EVAL_FAILED_1();

20:     error EVAL_FAILED_2();

21:     error POINT_X_TOO_LARGE();

22:     error POINT_Y_TOO_LARGE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L22-L22)


```solidity

File: /contracts/libs/LibAddress.sol

14:     bytes4 private constant _EIP1271_MAGICVALUE = 0x1626ba7e;

16:     error ETH_TRANSFER_FAILED();

46:     function supportsInterface(

61:     function isValidSignature(

77:     function isSenderEOA() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L77-L77)


```solidity

File: /contracts/libs/LibTrieProof.sol

18:     uint256 private constant _ACCOUNT_FIELD_INDEX_STORAGE_HASH = 2;

20:     error LTP_INVALID_ACCOUNT_PROOF();

21:     error LTP_INVALID_INCLUSION_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L21-L21)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

23:     uint256[50] private __gap;

25:     error TG_INVALID_SIGNATURES_LENGTH();

127:     function _execute(

140:     function _cancel(

153:     function _executor()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L153-L153)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

10:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L10-L10) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

40:     uint256[50] private __gap;

50:     error HOOK_ASSIGNMENT_EXPIRED();

51:     error HOOK_ASSIGNMENT_INVALID_SIG();

52:     error HOOK_TIER_NOT_FOUND();

164:     function _getProverFee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L164-L164)


```solidity

File: /contracts/L1/libs/LibProposing.sol

44:     error L1_BLOB_FOR_DA_DISABLED();

45:     error L1_BLOB_NOT_FOUND();

46:     error L1_BLOB_NOT_REUSABLE();

47:     error L1_BLOB_REUSE_DISABLED();

48:     error L1_INVALID_HOOK();

49:     error L1_INVALID_PARAM();

50:     error L1_INVALID_PROVER();

51:     error L1_LIVENESS_BOND_NOT_RECEIVED();

52:     error L1_PROPOSER_NOT_EOA();

53:     error L1_TOO_MANY_BLOCKS();

54:     error L1_TXLIST_OFFSET();

55:     error L1_TXLIST_SIZE();

56:     error L1_UNAUTHORIZED();

57:     error L1_UNEXPECTED_PARENT();

299:     function _isProposerPermitted(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L299-L299)


```solidity

File: /contracts/L1/libs/LibProving.sol

59:     error L1_ALREADY_CONTESTED();

60:     error L1_ALREADY_PROVED();

61:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

62:     error L1_BLOCK_MISMATCH();

63:     error L1_INVALID_BLOCK_ID();

64:     error L1_INVALID_PAUSE_STATUS();

65:     error L1_INVALID_TIER();

66:     error L1_INVALID_TRANSITION();

67:     error L1_MISSING_VERIFIER();

68:     error L1_NOT_ASSIGNED_PROVER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L68-L68)


```solidity

File: /contracts/L1/libs/LibUtils.sol

11:     error L1_BLOCK_MISMATCH();

12:     error L1_INVALID_BLOCK_ID();

13:     error L1_TRANSITION_NOT_FOUND();

14:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L14-L14)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

39:     error L1_BLOCK_MISMATCH();

40:     error L1_INVALID_CONFIG();

41:     error L1_TRANSITION_ID_ZERO();

224:     function _syncChainData(

245:     function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L245-L245)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L11-L11) 


```solidity

File: /contracts/L1/provers/Guardians.sol

32:     uint256[46] private __gap;

45:     error INVALID_GUARDIAN();

46:     error INVALID_GUARDIAN_SET();

47:     error INVALID_MIN_GUARDIANS();

48:     error INVALID_PROOF();

111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {

124:     function deleteApproval(bytes32 _hash) internal {

128:     function isApproved(uint256 _approvalBits) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L128-L128)


```solidity

File: /contracts/L1/TaikoErrors.sol

12:     error L1_ALREADY_CONTESTED();

13:     error L1_ALREADY_PROVED();

14:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

15:     error L1_BLOB_FOR_DA_DISABLED();

16:     error L1_BLOB_NOT_FOUND();

17:     error L1_BLOB_NOT_REUSABLE();

18:     error L1_BLOB_REUSE_DISABLED();

19:     error L1_BLOCK_MISMATCH();

20:     error L1_INVALID_BLOCK_ID();

21:     error L1_INVALID_CONFIG();

22:     error L1_INVALID_ETH_DEPOSIT();

23:     error L1_INVALID_HOOK();

24:     error L1_INVALID_PARAM();

25:     error L1_INVALID_PAUSE_STATUS();

26:     error L1_INVALID_PROVER();

27:     error L1_INVALID_TIER();

28:     error L1_INVALID_TRANSITION();

29:     error L1_LIVENESS_BOND_NOT_RECEIVED();

30:     error L1_NOT_ASSIGNED_PROVER();

31:     error L1_PROPOSER_NOT_EOA();

32:     error L1_PROVING_PAUSED();

33:     error L1_RECEIVE_DISABLED();

34:     error L1_MISSING_VERIFIER();

35:     error L1_TOO_MANY_BLOCKS();

36:     error L1_TOO_MANY_TIERS();

37:     error L1_TRANSITION_ID_ZERO();

38:     error L1_TRANSITION_NOT_FOUND();

39:     error L1_TXLIST_SIZE();

40:     error L1_UNAUTHORIZED();

41:     error L1_UNEXPECTED_PARENT();

42:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L42-L42)


```solidity

File: /contracts/L1/TaikoL1.sol

26:     uint256[50] private __gap;

28:     modifier whenProvingNotPaused() {

220:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L220)


```solidity

File: /contracts/L1/TaikoToken.sol

16:     uint256[50] private __gap;

18:     error TKO_INVALID_ADDR();

83:     function _beforeTokenTransfer(

94:     function _afterTokenTransfer(

105:     function _mint(

115:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L115-L115)


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

17:     error TIER_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L17-L17) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

21:     uint256[49] private __gap;

28:     error XCO_INVALID_OWNER_CHAINID();

29:     error XCO_INVALID_TX_ID();

30:     error XCO_PERMISSION_DENIED();

31:     error XCO_TX_REVERTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L31-L31)


```solidity

File: /contracts/L2/Lib1559Math.sol

11:     error EIP1559_INVALID_PARAMS();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L11-L11) 


```solidity

File: /contracts/L2/TaikoL2.sol

52:     uint256[47] private __gap;

59:     error L2_BASEFEE_MISMATCH();

60:     error L2_INVALID_CHAIN_ID();

61:     error L2_INVALID_PARAM();

62:     error L2_INVALID_SENDER();

63:     error L2_PUBLIC_INPUT_HASH_MISMATCH();

64:     error L2_TOO_LATE();

223:     function _calcPublicInputHash(uint256 _blockId)

252:     function _calc1559BaseFee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L252-L252)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

13:     uint256[49] private __gap;

20:     error L2_INVALID_CONFIG();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L20-L20)


```solidity

File: /contracts/signal/SignalService.sol

23:     uint256[48] private __gap;

25:     error SS_EMPTY_PROOF();

26:     error SS_INVALID_SENDER();

27:     error SS_INVALID_LAST_HOP_CHAINID();

28:     error SS_INVALID_MID_HOP_CHAINID();

29:     error SS_INVALID_STATE();

30:     error SS_INVALID_VALUE();

31:     error SS_SIGNAL_NOT_FOUND();

32:     error SS_UNAUTHORIZED();

33:     error SS_UNSUPPORTED();

35:     modifier validSender(address _app) {

40:     modifier nonZeroValue(bytes32 _input) {

206:     function _verifyHopProof(

231:     function _authorizePause(address) internal pure override {

235:     function _syncChainData(

253:     function _sendSignal(

271:     function _cacheChainData(

298:     function _loadSignalValue(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L298-L298)


```solidity

File: /contracts/bridge/Bridge.sol

48:     uint256[43] private __gap;

50:     error B_INVALID_CHAINID();

51:     error B_INVALID_CONTEXT();

52:     error B_INVALID_GAS_LIMIT();

53:     error B_INVALID_STATUS();

54:     error B_INVALID_USER();

55:     error B_INVALID_VALUE();

56:     error B_MESSAGE_NOT_SENT();

57:     error B_NON_RETRIABLE();

58:     error B_NOT_FAILED();

59:     error B_NOT_RECEIVED();

60:     error B_PERMISSION_DENIED();

61:     error B_STATUS_MISMATCH();

62:     error B_INVOCATION_TOO_EARLY();

64:     modifier sameChain(uint64 _chainId) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L64-L64)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

32:     uint256[49] private __gap;

43:     function _mintToken(address _account, uint256 _amount) internal override {

47:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

24:     uint8 private __srcDecimals;

32:     uint256[47] private __gap;

34:     error BTOKEN_CANNOT_RECEIVE();

35:     error BTOKEN_UNAUTHORIZED();

37:     modifier onlyOwnerOrSnapshooter() {

129:     function _mintToken(address _account, uint256 _amount) internal override {

133:     function _burnToken(address _from, uint256 _amount) internal override {

152:     function _afterTokenTransfer(

163:     function _mint(

173:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L173)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

16:     uint256[49] private __gap;

29:     error BB_PERMISSION_DENIED();

30:     error BB_INVALID_PARAMS();

31:     error BB_MINT_DISALLOWED();

97:     function _mintToken(address _account, uint256 _amount) internal virtual;

99:     function _burnToken(address _from, uint256 _amount) internal virtual;

101:     function _isMigratingOut() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L101-L101)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

19:     uint256[48] private __gap;

21:     error BTOKEN_CANNOT_RECEIVE();

22:     error BTOKEN_INVALID_BURN();

115:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L115)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

27:     uint256[46] private __gap;

29:     error BTOKEN_CANNOT_RECEIVE();

125:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L125)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

61:     uint256[48] private __gap;

133:     error VAULT_INVALID_TOKEN();

134:     error VAULT_INVALID_AMOUNT();

135:     error VAULT_INVALID_TO();

136:     error VAULT_INTERFACE_NOT_SUPPORTED();

137:     error VAULT_TOKEN_ARRAY_MISMATCH();

138:     error VAULT_MAX_TOKEN_PER_TXN_EXCEEDED();

140:     modifier withValidOperation(BridgeTransferOp memory _op) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L61-L61) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L140-L140)


```solidity

File: /contracts/tokenvault/BaseVault.sol

18:     uint256[50] private __gap;

20:     error VAULT_PERMISSION_DENIED();

22:     modifier onlyFromBridge() {

47:     function checkProcessMessageContext()

58:     function checkRecallMessageContext()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L58-L58)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

32:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

54:     uint256[47] private __gap;

136:     error VAULT_BTOKEN_BLACKLISTED();

137:     error VAULT_CTOKEN_MISMATCH();

138:     error VAULT_INVALID_TOKEN();

139:     error VAULT_INVALID_AMOUNT();

140:     error VAULT_INVALID_NEW_BTOKEN();

141:     error VAULT_INVALID_TO();

142:     error VAULT_NOT_SAME_OWNER();

320:     function _transferTokens(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L320-L320)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

19:     uint256[50] private __gap;

160:     function _transferTokens(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L160-L160)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

9:     error BTOKEN_INVALID_PARAMS();

11:     function validateInputs(

28:     function buildName(

39:     function buildSymbol(string memory _symbol) internal pure returns (string memory) {

43:     function buildURI(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L43)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {

6:     uint256 constant LOW_28_MASK =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6-L6)


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

11:     uint256[50] private __gap;

13:     error PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L13-L13)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

57:     uint256[47] private __gap;

74:     error SGX_ALREADY_ATTESTED();

75:     error SGX_INVALID_ATTESTATION();

76:     error SGX_INVALID_INSTANCE();

77:     error SGX_INVALID_PROOF();

78:     error SGX_RA_NOT_SUPPORTED();

195:     function _addInstances(

226:     function _replaceInstance(uint256 id, address oldInstance, address newInstance) private {

233:     function _isInstanceValid(uint256 id, address instance) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L233-L233)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

18:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L18-L18) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

30:     uint256[45] private __gap;

37:     error WITHDRAWALS_NOT_ONGOING();

39:     modifier ongoingWithdrawals() {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L39-L39)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

16:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L16-L16) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

23:     uint256[47] private __gap;

29:     error CLAIM_NOT_ONGOING();

30:     error CLAIMED_ALREADY();

31:     error INVALID_PROOF();

33:     modifier ongoingClaim() {

56:     function __MerkleClaimable_init(

67:     function _verifyClaim(bytes memory data, bytes32[] calldata proof) internal ongoingClaim {

77:     function _verifyMerkleProof(

90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L90)


```solidity

File: /contracts/team/TimelockTokenPool.sol

82:     uint128[44] private __gap;

101:     error ALREADY_GRANTED();

102:     error INVALID_GRANT();

103:     error INVALID_PARAM();

104:     error NOTHING_TO_VOID();

208:     function _withdraw(address _recipient, address _to) private {

225:     function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {

235:     function _getAmountOwned(Grant memory _grant) private view returns (uint128) {

239:     function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {

245:     function _calcAmount(

267:     function _validateGrant(Grant memory _grant) private pure {

273:     function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L82-L82) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L267-L267), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L273-L273)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

25:     ISigVerifyLib public immutable sigVerifyLib;

26:     IPEMCertChainLib public immutable pemCertLib;

29:     uint256 internal constant CPUSVN_LENGTH = 16;

33:     bytes32 internal constant ROOTCA_PUBKEY_HASH =

36:     uint8 internal constant INVALID_EXIT_CODE = 255;

38:     bool private _checkLocalEnclaveReport;

39:     mapping(bytes32 enclave => bool trusted) private _trustedUserMrEnclave;

40:     mapping(bytes32 signer => bool trusted) private _trustedUserMrSigner;

47:     mapping(uint256 idx => mapping(bytes serialNum => bool revoked)) private _serialNumIsRevoked;

49:     mapping(string fmspc => TCBInfoStruct.TCBInfo tcbInfo) public tcbInfo;

50:     EnclaveIdStruct.EnclaveId public qeIdentity;

52:     address public owner;

54:     constructor(address sigVerifyLibAddr, address pemCertLibAddr) {

60:     modifier onlyOwner() {

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {

73:     function addRevokedCertSerialNum(

88:     function removeRevokedCertSerialNum(

103:     function configureTcbInfoJson(

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)

122:     function toggleLocalReportCheck() external onlyOwner {

126:     function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)

138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {

175:     function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)

206:     function _checkTcbLevels(

229:     function _isCpuSvnHigherOrGreater(

248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)

303:     function _enclaveReportSigVerification(

364:     function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364-L364)


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

9:     function verifyAttestation(bytes calldata data) external returns (bool);

10:     function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L10-L10)


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

38:     function verifyAttStmtSignature(

48:     function verifyCertificateSignature(

58:     function verifyRS256Signature(

67:     function verifyRS1Signature(

76:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L76-L76)


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

36:     function splitCertificateChain(

44:     function decodeCert(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L44-L44)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

17:     string internal constant HEADER = "-----BEGIN CERTIFICATE-----";

18:     string internal constant FOOTER = "-----END CERTIFICATE-----";

19:     uint256 internal constant HEADER_LENGTH = 27;

20:     uint256 internal constant FOOTER_LENGTH = 25;

22:     string internal constant PCK_COMMON_NAME = "Intel SGX PCK Certificate";

23:     string internal constant PLATFORM_ISSUER_NAME = "Intel SGX PCK Platform CA";

24:     string internal constant PROCESSOR_ISSUER_NAME = "Intel SGX PCK Processor CA";

25:     bytes internal constant SGX_EXTENSION_OID = hex"2A864886F84D010D01";

26:     bytes internal constant TCB_OID = hex"2A864886F84D010D0102";

27:     bytes internal constant PCESVN_OID = hex"2A864886F84D010D010211";

28:     bytes internal constant PCEID_OID = hex"2A864886F84D010D0103";

29:     bytes internal constant FMSPC_OID = hex"2A864886F84D010D0104";

32:     uint256 constant SGX_TCB_CPUSVN_SIZE = 16;

40:     function splitCertificateChain(

74:     function decodeCert(

216:     function _removeHeadersAndFooters(string memory pemData)

252:     function _trimBytes(

269:     function _findPckTcbInfo(

341:     function _findTcb(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L341-L341)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

14:     uint256 internal constant MINIMUM_QUOTE_LENGTH = 1020;

15:     bytes2 internal constant SUPPORTED_QUOTE_VERSION = 0x0300;

16:     bytes2 internal constant SUPPORTED_ATTESTATION_KEY_TYPE = 0x0200;

18:     bytes4 internal constant SUPPORTED_TEE_TYPE = 0;

19:     bytes16 internal constant VALID_QE_VENDOR_ID = 0x939a7233f79c4ca9940a0db3957f0607;

21:     function parseInput(

62:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)

133:     function parseEnclaveReport(bytes memory rawEnclaveReport)

152:     function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {

165:     function parseAndVerifyHeader(bytes memory rawHeader)

203:     function parseAuthDataAndVerifyCertType(

267:     function parseCerificationChainBytes(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L267)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

14:     function ixs(uint256 self) internal pure returns (uint256) {

19:     function ixf(uint256 self) internal pure returns (uint256) {

24:     function ixl(uint256 self) internal pure returns (uint256) {

29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {

47:     function root(bytes memory der) internal pure returns (uint256) {

56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

66:     function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

87:     function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

187:     function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L187-L187)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

16:     function keccak(

39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

56:     function compare(

116:     function equals(

138:     function equals(

160:     function equals(

178:     function equals(bytes memory self, bytes memory other) internal pure returns (bool) {

188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {

198:     function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {

211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

224:     function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {

237:     function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {

255:     function readBytesN(

272:     function memcpy(uint256 dest, uint256 src, uint256 len) private pure {

284:     function substring(

310:     bytes constant BASE32_HEX_TABLE =

371:     function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L211-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L310-L310), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L371-L371)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

11:     function sha1(bytes memory data) internal pure returns (bytes20 ret) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L11-L11) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

18:     address private ES256VERIFIER;

20:     constructor(address es256Verifier) {

24:     function verifyAttStmtSignature(

54:     function verifyCertificateSignature(

79:     function verifyRS256Signature(

96:     function verifyRS1Signature(

113:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L113)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {

34:     function toUnixTimestamp(

71:     function isLeapYear(uint16 year) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L71-L71)


</details>


### [NC&#x2011;12] Contract does not follow the Solidity style guide's suggested layout ordering 
The [style guide](https://docs.soliditylang.org/en/v0.8.16/style-guide.html#order-of-layout) says that, within a contract, the ordering should be 1) Type declarations, 2) State variables, 3) Events, 4) Modifiers, and 5) Functions, but the contract(s) below do not follow this ordering


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/tiers/ITierProvider.sol

//@audit the variable definition is misplaced
39:     uint16 public constant TIER_OPTIMISTIC = 100;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L39-L39) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit the structure definition is misplaced
34:     struct PCKTCBFlags {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L34-L34) 


</details>


### [NC&#x2011;13] Contracts containing only utility functions should be made into libraries 



*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit the contract `PEMCertChainLib` contain only utility functions, it should turn to a `library`
12: contract PEMCertChainLib is IPEMCertChainLib {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L12-L12) 


</details>


### [NC&#x2011;14] Control structures do not follow the Solidity Style Guide 
See the [control structures](https://docs.soliditylang.org/en/latest/style-guide.html#control-structures) section of the Solidity Style Guide


*There are 191 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

38:     function setAddress(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L38-L38) 


```solidity

File: /contracts/common/EssentialContract.sol

95:     function __Essential_init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L95-L95) 


```solidity

File: /contracts/libs/Lib4844.sol

30:     function evaluatePoint(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L30-L30) 


```solidity

File: /contracts/libs/LibAddress.sol

46:     function supportsInterface(

61:     function isValidSignature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L61)


```solidity

File: /contracts/libs/LibTrieProof.sol

34:     function verifyMerkleProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L34-L34) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

31:     function init(

48:     function propose(

69:     function propose(

127:     function _execute(

140:     function _cancel(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L31-L31) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L140)


```solidity

File: /contracts/L1/hooks/IHook.sol

13:     function onBlockProposed(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L13-L13) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

62:     function onBlockProposed(

137:     function hashAssignment(

164:     function _getProverFee(

81:         if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L62-L62) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L164-L164), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L81-L81)


```solidity

File: /contracts/L1/ITaikoL1.sol

14:     function proposeBlock(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L14-L14) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

29:     function depositEtherToL2(

67:     function processDeposits(

122:     function canDepositEthToL2(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L122-L122)


```solidity

File: /contracts/L1/libs/LibProposing.sol

68:     function proposeBlock(

287:     function isBlobReusable(

299:     function _isProposerPermitted(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L287-L287), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L299-L299)


```solidity

File: /contracts/L1/libs/LibProving.sol

91:     function proveBlock(

269:     function _createTransition(

350:     function _overrideWithHigherProof(

401:     function _checkProverPermission(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L91) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L350-L350), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L401-L401)


```solidity

File: /contracts/L1/libs/LibUtils.sol

23:     function getTransition(

52:     function getBlock(

70:     function getTransitionId(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L70-L70)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

47:     function init(

85:     function verifyBlocks(

224:     function _syncChainData(

246:         if (

151:                     if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L246-L246), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L151-L151)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

35:     function approve(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L35-L35) 


```solidity

File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L53) 


```solidity

File: /contracts/L1/TaikoL1.sol

42:     function init(

55:     function proposeBlock(

75:     function proveBlock(

162:     function getTransition(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L42-L42) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L162-L162)


```solidity

File: /contracts/L1/TaikoToken.sol

25:     function init(

70:     function transferFrom(

83:     function _beforeTokenTransfer(

94:     function _afterTokenTransfer(

105:     function _mint(

115:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L115-L115)


```solidity

File: /contracts/L2/CrossChainOwned.sol

60:     function __CrossChainOwned_init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L60-L60) 


```solidity

File: /contracts/L2/Lib1559Math.sol

16:     function basefee(

33:     function _ethQty(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L33-L33)


```solidity

File: /contracts/L2/TaikoL2.sol

71:     function init(

107:     function anchor(

163:     function withdraw(

185:     function getBasefee(

252:     function _calc1559BaseFee(

116:         if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L71-L71) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L116-L116)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

25:     function setConfigAndExcess(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L25-L25) 


```solidity

File: /contracts/signal/ISignalService.sol

68:     function syncChainData(

84:     function proveSignalReceived(

105:     function isChainDataSynced(

122:     function getSyncedChainData(

137:     function signalForChainData(

68:     function syncChainData(

84:     function proveSignalReceived(

105:     function isChainDataSynced(

122:     function getSyncedChainData(

137:     function signalForChainData(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L137-L137)


```solidity

File: /contracts/signal/SignalService.sol

68:     function syncChainData(

83:     function proveSignalReceived(

137:     function isChainDataSynced(

158:     function getSyncedChainData(

177:     function signalForChainData(

194:     function getSignalSlot(

206:     function _verifyHopProof(

235:     function _syncChainData(

253:     function _sendSignal(

271:     function _cacheChainData(

298:     function _loadSignalValue(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L298-L298)


```solidity

File: /contracts/bridge/IBridge.sol

164:     function onMessageRecalled(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L164-L164) 


```solidity

File: /contracts/bridge/Bridge.sol

82:     function suspendMessages(

101:     function banAddress(

155:     function recallMessage(

217:     function processMessage(

310:     function retryMessage(

352:     function proveMessageFailed(

374:     function proveMessageReceived(

477:     function _invokeMessageCall(

577:     function _proveSignalReceived(

423:         if (

490:         if (

429:         } else if (

269:             if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L82-L82) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L310-L310), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L374-L374), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L477-L477), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L577-L577), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L423-L423), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L490-L490), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L429-L429), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L269-L269)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

52:     function init(

139:     function _beforeTokenTransfer(

152:     function _afterTokenTransfer(

163:     function _mint(

173:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L173)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

36:     function changeMigrationStatus(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L36-L36) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

31:     function init(

54:     function mint(

69:     function burn(

115:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L31-L31) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L115)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

38:     function init(

66:     function mint(

83:     function mintBatch(

100:     function burn(

125:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L125)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

127:     function onMessageRecalled(

160:     function onERC1155BatchReceived(

175:     function onERC1155Received(

214:     function _transferTokens(

240:     function _handleMessage(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L127-L127) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L214-L214), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L240-L240)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

148:     function changeBridgedToken(

285:     function onMessageRecalled(

320:     function _transferTokens(

348:     function _handleMessage(

174:             if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L148-L148) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L285-L285), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L320-L320), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L348-L348), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L174-L174)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

110:     function onMessageRecalled(

142:     function onERC721Received(

160:     function _transferTokens(

187:     function _handleMessage(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L110-L110) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L187-L187)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

11:     function validateInputs(

28:     function buildName(

43:     function buildURI(

20:         if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L20-L20)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25:     function excessivelySafeCall(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L25) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

15:     function slice(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L15-L15) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

277:     function _copy(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L277-L277) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

50:     function verifyInclusionProof(

68:     function get(

235:     function _getSharedNibbleLength(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L235-L235)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

19:     function verifyInclusionProof(

38:     function get(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L38-L38)


```solidity

File: /contracts/verifiers/IVerifier.sol

24:     function verifyProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L24-L24) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

23:     function verifyProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L23-L23) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

139:     function verifyProof(

171:     function getSignedHash(

195:     function _addInstances(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L139-L139) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L195-L195)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

27:     function init(

50:     function claimAndDelegate(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L50-L50)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

54:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L54) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

25:     function init(

47:     function claim(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L47-L47)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

45:     function setConfig(

56:     function __MerkleClaimable_init(

77:     function _verifyMerkleProof(

34:         if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L34-L34)


```solidity

File: /contracts/team/TimelockTokenPool.sol

111:     function init(

245:     function _calcAmount(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L245)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

73:     function addRevokedCertSerialNum(

88:     function removeRevokedCertSerialNum(

103:     function configureTcbInfoJson(

206:     function _checkTcbLevels(

229:     function _isCpuSvnHigherOrGreater(

303:     function _enclaveReportSigVerification(

406:             if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L406-L406)


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

38:     function verifyAttStmtSignature(

48:     function verifyCertificateSignature(

58:     function verifyRS256Signature(

67:     function verifyRS1Signature(

76:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L76-L76)


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

36:     function splitCertificateChain(

44:     function decodeCert(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L44-L44)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

40:     function splitCertificateChain(

74:     function decodeCert(

252:     function _trimBytes(

269:     function _findPckTcbInfo(

341:     function _findTcb(

134:             if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L341-L341), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L134-L134)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

21:     function parseInput(

203:     function parseAuthDataAndVerifyCertType(

267:     function parseCerificationChainBytes(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L267)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

16:     function keccak(

56:     function compare(

116:     function equals(

138:     function equals(

160:     function equals(

255:     function readBytesN(

284:     function substring(

320:     function base32HexDecodeWord(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L320)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

43:     function pkcs1Sha256(

191:     function pkcs1Sha256Raw(

212:     function pkcs1Sha1(

307:     function pkcs1Sha1Raw(

167:         if (


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L307-L307), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L167-L167)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

24:     function verifyAttStmtSignature(

54:     function verifyCertificateSignature(

79:     function verifyRS256Signature(

96:     function verifyRS1Signature(

113:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L113)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

34:     function toUnixTimestamp(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L34) 


</details>


### [NC&#x2011;15] Custom error has no error details 
Consider adding parameters to the error to indicate which user or values caused the failure


*There are 156 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

25:     error AM_INVALID_PARAMS();

26:     error AM_UNSUPPORTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L26-L26)


```solidity

File: /contracts/common/EssentialContract.sol

35:     error REENTRANT_CALL();

36:     error INVALID_PAUSE_STATUS();

37:     error ZERO_ADDR_MANAGER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L37-L37)


```solidity

File: /contracts/libs/Lib4844.sol

19:     error EVAL_FAILED_1();

20:     error EVAL_FAILED_2();

21:     error POINT_X_TOO_LARGE();

22:     error POINT_Y_TOO_LARGE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L22-L22)


```solidity

File: /contracts/libs/LibAddress.sol

16:     error ETH_TRANSFER_FAILED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L16-L16) 


```solidity

File: /contracts/libs/LibTrieProof.sol

20:     error LTP_INVALID_ACCOUNT_PROOF();

21:     error LTP_INVALID_INCLUSION_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L21-L21)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

25:     error TG_INVALID_SIGNATURES_LENGTH();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L25-L25) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

50:     error HOOK_ASSIGNMENT_EXPIRED();

51:     error HOOK_ASSIGNMENT_INVALID_SIG();

52:     error HOOK_TIER_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L52-L52)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

22:     error L1_INVALID_ETH_DEPOSIT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L22-L22) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

44:     error L1_BLOB_FOR_DA_DISABLED();

45:     error L1_BLOB_NOT_FOUND();

46:     error L1_BLOB_NOT_REUSABLE();

47:     error L1_BLOB_REUSE_DISABLED();

48:     error L1_INVALID_HOOK();

49:     error L1_INVALID_PARAM();

50:     error L1_INVALID_PROVER();

51:     error L1_LIVENESS_BOND_NOT_RECEIVED();

52:     error L1_PROPOSER_NOT_EOA();

53:     error L1_TOO_MANY_BLOCKS();

54:     error L1_TXLIST_OFFSET();

55:     error L1_TXLIST_SIZE();

56:     error L1_UNAUTHORIZED();

57:     error L1_UNEXPECTED_PARENT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L57-L57)


```solidity

File: /contracts/L1/libs/LibProving.sol

59:     error L1_ALREADY_CONTESTED();

60:     error L1_ALREADY_PROVED();

61:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

62:     error L1_BLOCK_MISMATCH();

63:     error L1_INVALID_BLOCK_ID();

64:     error L1_INVALID_PAUSE_STATUS();

65:     error L1_INVALID_TIER();

66:     error L1_INVALID_TRANSITION();

67:     error L1_MISSING_VERIFIER();

68:     error L1_NOT_ASSIGNED_PROVER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L68-L68)


```solidity

File: /contracts/L1/libs/LibUtils.sol

11:     error L1_BLOCK_MISMATCH();

12:     error L1_INVALID_BLOCK_ID();

13:     error L1_TRANSITION_NOT_FOUND();

14:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L14-L14)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

39:     error L1_BLOCK_MISMATCH();

40:     error L1_INVALID_CONFIG();

41:     error L1_TRANSITION_ID_ZERO();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L41-L41)


```solidity

File: /contracts/L1/provers/Guardians.sol

45:     error INVALID_GUARDIAN();

46:     error INVALID_GUARDIAN_SET();

47:     error INVALID_MIN_GUARDIANS();

48:     error INVALID_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L48-L48)


```solidity

File: /contracts/L1/TaikoErrors.sol

12:     error L1_ALREADY_CONTESTED();

13:     error L1_ALREADY_PROVED();

14:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

15:     error L1_BLOB_FOR_DA_DISABLED();

16:     error L1_BLOB_NOT_FOUND();

17:     error L1_BLOB_NOT_REUSABLE();

18:     error L1_BLOB_REUSE_DISABLED();

19:     error L1_BLOCK_MISMATCH();

20:     error L1_INVALID_BLOCK_ID();

21:     error L1_INVALID_CONFIG();

22:     error L1_INVALID_ETH_DEPOSIT();

23:     error L1_INVALID_HOOK();

24:     error L1_INVALID_PARAM();

25:     error L1_INVALID_PAUSE_STATUS();

26:     error L1_INVALID_PROVER();

27:     error L1_INVALID_TIER();

28:     error L1_INVALID_TRANSITION();

29:     error L1_LIVENESS_BOND_NOT_RECEIVED();

30:     error L1_NOT_ASSIGNED_PROVER();

31:     error L1_PROPOSER_NOT_EOA();

32:     error L1_PROVING_PAUSED();

33:     error L1_RECEIVE_DISABLED();

34:     error L1_MISSING_VERIFIER();

35:     error L1_TOO_MANY_BLOCKS();

36:     error L1_TOO_MANY_TIERS();

37:     error L1_TRANSITION_ID_ZERO();

38:     error L1_TRANSITION_NOT_FOUND();

39:     error L1_TXLIST_SIZE();

40:     error L1_UNAUTHORIZED();

41:     error L1_UNEXPECTED_PARENT();

42:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L42-L42)


```solidity

File: /contracts/L1/TaikoToken.sol

18:     error TKO_INVALID_ADDR();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L18-L18) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

17:     error TIER_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L17-L17) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

28:     error XCO_INVALID_OWNER_CHAINID();

29:     error XCO_INVALID_TX_ID();

30:     error XCO_PERMISSION_DENIED();

31:     error XCO_TX_REVERTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L31-L31)


```solidity

File: /contracts/L2/Lib1559Math.sol

11:     error EIP1559_INVALID_PARAMS();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L11-L11) 


```solidity

File: /contracts/L2/TaikoL2.sol

59:     error L2_BASEFEE_MISMATCH();

60:     error L2_INVALID_CHAIN_ID();

61:     error L2_INVALID_PARAM();

62:     error L2_INVALID_SENDER();

63:     error L2_PUBLIC_INPUT_HASH_MISMATCH();

64:     error L2_TOO_LATE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L64-L64)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

20:     error L2_INVALID_CONFIG();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L20-L20) 


```solidity

File: /contracts/signal/SignalService.sol

25:     error SS_EMPTY_PROOF();

26:     error SS_INVALID_SENDER();

27:     error SS_INVALID_LAST_HOP_CHAINID();

28:     error SS_INVALID_MID_HOP_CHAINID();

29:     error SS_INVALID_STATE();

30:     error SS_INVALID_VALUE();

31:     error SS_SIGNAL_NOT_FOUND();

32:     error SS_UNAUTHORIZED();

33:     error SS_UNSUPPORTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L33-L33)


```solidity

File: /contracts/bridge/Bridge.sol

50:     error B_INVALID_CHAINID();

51:     error B_INVALID_CONTEXT();

52:     error B_INVALID_GAS_LIMIT();

53:     error B_INVALID_STATUS();

54:     error B_INVALID_USER();

55:     error B_INVALID_VALUE();

56:     error B_MESSAGE_NOT_SENT();

57:     error B_NON_RETRIABLE();

58:     error B_NOT_FAILED();

59:     error B_NOT_RECEIVED();

60:     error B_PERMISSION_DENIED();

61:     error B_STATUS_MISMATCH();

62:     error B_INVOCATION_TOO_EARLY();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L62-L62)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

34:     error BTOKEN_CANNOT_RECEIVE();

35:     error BTOKEN_UNAUTHORIZED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L35-L35)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

29:     error BB_PERMISSION_DENIED();

30:     error BB_INVALID_PARAMS();

31:     error BB_MINT_DISALLOWED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L31-L31)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

21:     error BTOKEN_CANNOT_RECEIVE();

22:     error BTOKEN_INVALID_BURN();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L22-L22)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

29:     error BTOKEN_CANNOT_RECEIVE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L29-L29) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

133:     error VAULT_INVALID_TOKEN();

134:     error VAULT_INVALID_AMOUNT();

135:     error VAULT_INVALID_TO();

136:     error VAULT_INTERFACE_NOT_SUPPORTED();

137:     error VAULT_TOKEN_ARRAY_MISMATCH();

138:     error VAULT_MAX_TOKEN_PER_TXN_EXCEEDED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L133-L133) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L138-L138)


```solidity

File: /contracts/tokenvault/BaseVault.sol

20:     error VAULT_PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L20-L20) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

136:     error VAULT_BTOKEN_BLACKLISTED();

137:     error VAULT_CTOKEN_MISMATCH();

138:     error VAULT_INVALID_TOKEN();

139:     error VAULT_INVALID_AMOUNT();

140:     error VAULT_INVALID_NEW_BTOKEN();

141:     error VAULT_INVALID_TO();

142:     error VAULT_NOT_SAME_OWNER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L136-L136) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L142-L142)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

9:     error BTOKEN_INVALID_PARAMS();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L9-L9) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

13:     error PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L13-L13) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

74:     error SGX_ALREADY_ATTESTED();

75:     error SGX_INVALID_ATTESTATION();

76:     error SGX_INVALID_INSTANCE();

77:     error SGX_INVALID_PROOF();

78:     error SGX_RA_NOT_SUPPORTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L78-L78)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

37:     error WITHDRAWALS_NOT_ONGOING();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L37-L37) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

29:     error CLAIM_NOT_ONGOING();

30:     error CLAIMED_ALREADY();

31:     error INVALID_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L31-L31)


```solidity

File: /contracts/team/TimelockTokenPool.sol

101:     error ALREADY_GRANTED();

102:     error INVALID_GRANT();

103:     error INVALID_PARAM();

104:     error NOTHING_TO_VOID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L101-L101) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L104-L104)


</details>


### [NC&#x2011;16] Consider using `delete` rather than assigning `zero` to clear values 
The `delete` keyword more closely matches the semantics of what is being done, and draws more attention to the changing of state, which may lead to a more thorough audit of its associated logic


*There are 10 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProposing.sol

190:             meta_.txListByteOffset = 0;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L190-L190) 


```solidity

File: /contracts/L1/libs/LibProving.sol

300:             ts_.blockHash = 0;

301:             ts_.stateRoot = 0;

302:             ts_.validityBond = 0;

306:             ts_.tier = 0;

307:             ts_.contestations = 0;

197:                 blk.livenessBond = 0;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L300-L300) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L301-L301), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L302-L302), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L306-L306), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L307-L307), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L197-L197)


```solidity

File: /contracts/team/TimelockTokenPool.sol

231:         _grant.grantStart = 0;

232:         _grant.grantPeriod = 0;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L231-L231) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L232-L232)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

336:                 tbsPtr = 0; // exit


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L336-L336) 


</details>


### [NC&#x2011;17] `else`-block not required 
One level of nesting can be removed by not having an `else` block when the `if`-block returns:


*There are 22 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/LibAddress.sol

70:         if (Address.isContract(_addr)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L70-L70) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

68:         if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L68-L68) 


```solidity

File: /contracts/bridge/Bridge.sol

423:         if (

556:         if (block.chainid == 1) {

429:         } else if (

439:         } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L423-L423) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L556-L556), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L429-L429), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L439-L439)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

163:         if (prefix <= 0x7f) {

166:         } else if (prefix <= 0xb7) {

188:         } else if (prefix <= 0xbf) {

223:         } else if (prefix <= 0xf7) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L163-L163) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L223-L223)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

111:             if (currentNode.decoded.length == BRANCH_NODE_LENGTH) {

139:             } else if (currentNode.decoded.length == LEAF_OR_EXTENSION_NODE_LENGTH) {

112:                 if (currentKeyIndex == key.length) {

155:                 if (prefix == PREFIX_LEAF_EVEN || prefix == PREFIX_LEAF_ODD) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L155-L155)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

319:         if (qeReportDataIsValid) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L319-L319) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

158:         if (der[ptr.ixf()] == 0) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L158-L158) 


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

151:         if (digestAlgoWithParamLen == sha256ExplicitNullParam.length) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L151-L151) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

34:         if (alg == Algorithm.RS256) {

64:         if (alg == CertSigAlgorithm.Sha256WithRSAEncryption) {

39:         } else if (alg == Algorithm.ES256) {

69:         } else if (alg == CertSigAlgorithm.Sha1WithRSAEncryption) {

44:         } else if (alg == Algorithm.RS1) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L44-L44)


</details>


### [NC&#x2011;18] Empty bytes check is missing 
When developing smart contracts in Solidity, it's crucial to validate the inputs of your functions. This includes ensuring that the bytes parameters are not empty, especially when they represent crucial data such as addresses, identifiers, or raw data that the contract needs to process.
Missing empty bytes checks can lead to unexpected behaviour in your contract.For instance, certain operations might fail, produce incorrect results, or consume unnecessary gas when performed with empty bytes.Moreover, missing input validation can potentially expose your contract to malicious activity, including exploitation of unhandled edge cases.
To mitigate these issues, always validate that bytes parameters are not empty when the logic of your contract requires it.


*There are 102 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

//@audit  ,_name are not checked
38:     function setAddress(
39:         uint64 _chainId,
40:         bytes32 _name,
41:         address _newAddress
42:     )
43:         external
44:         virtual
45:         onlyOwner
46:     {

//@audit  ,_name are not checked
54:     function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {
55:         return __addresses[_chainId][_name];


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L38-L46) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L54-L55)


```solidity

File: /contracts/libs/Lib4844.sol

//@audit  ,_blobHash ,_commitment ,_pointProof are not checked
30:     function evaluatePoint(
31:         bytes32 _blobHash,
32:         uint256 _x,
33:         uint256 _y,
34:         bytes1[48] memory _commitment,
35:         bytes1[48] memory _pointProof
36:     )
37:         internal
38:         view
39:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L30-L39) 


```solidity

File: /contracts/libs/LibAddress.sol

//@audit  ,_interfaceId are not checked
46:     function supportsInterface(
47:         address _addr,
48:         bytes4 _interfaceId
49:     )
50:         internal
51:         view
52:         returns (bool result_)
53:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L53) 


```solidity

File: /contracts/libs/LibTrieProof.sol

//@audit  ,_rootHash ,_slot ,_value are not checked
34:     function verifyMerkleProof(
35:         bytes32 _rootHash,
36:         address _addr,
37:         bytes32 _slot,
38:         bytes32 _value,
39:         bytes[] memory _accountProof,
40:         bytes[] memory _storageProof
41:     )
42:         internal
43:         pure
44:         returns (bytes32 storageRoot_)
45:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L34-L45) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

//@audit  ,_interfaceId are not checked
89:     function supportsInterface(bytes4 _interfaceId)
90:         public
91:         view
92:         override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
93:         returns (bool)
94:     {

//@audit  ,_descriptionHash are not checked
127:     function _execute(
128:         uint256 _proposalId,
129:         address[] memory _targets,
130:         uint256[] memory _values,
131:         bytes[] memory _calldatas,
132:         bytes32 _descriptionHash
133:     )
134:         internal
135:         override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
136:     {

//@audit  ,_descriptionHash are not checked
140:     function _cancel(
141:         address[] memory _targets,
142:         uint256[] memory _values,
143:         bytes[] memory _calldatas,
144:         bytes32 _descriptionHash
145:     )
146:         internal
147:         override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
148:         returns (uint256)
149:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L89-L94) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L149)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

//@audit  ,_data are not checked
62:     function onBlockProposed(
63:         TaikoData.Block memory _blk,
64:         TaikoData.BlockMetadata memory _meta,
65:         bytes memory _data
66:     )
67:         external
68:         payable
69:         nonReentrant
70:         onlyFromNamed("taiko")
71:     {

//@audit  ,_blobHash are not checked
137:     function hashAssignment(
138:         ProverAssignment memory _assignment,
139:         address _taikoL1Address,
140:         bytes32 _blobHash
141:     )
142:         public
143:         view
144:         returns (bytes32)
145:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L62-L71) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L137-L145)


```solidity

File: /contracts/L1/libs/LibProposing.sol

//@audit  ,_data are not checked
68:     function proposeBlock(
69:         TaikoData.State storage _state,
70:         TaikoData.Config memory _config,
71:         IAddressResolver _resolver,
72:         bytes calldata _data,
73:         bytes calldata _txList
74:     )
75:         internal
76:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
77:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L77) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

//@audit  ,_parentHash are not checked
23:     function getTransition(
24:         TaikoData.State storage _state,
25:         TaikoData.Config memory _config,
26:         uint64 _blockId,
27:         bytes32 _parentHash
28:     )
29:         external
30:         view
31:         returns (TaikoData.TransitionState storage)
32:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L23-L32) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit  ,_genesisBlockHash are not checked
47:     function init(
48:         TaikoData.State storage _state,
49:         TaikoData.Config memory _config,
50:         bytes32 _genesisBlockHash
51:     )
52:         external
53:     {

//@audit  ,_stateRoot are not checked
224:     function _syncChainData(
225:         TaikoData.Config memory _config,
226:         IAddressResolver _resolver,
227:         uint64 _lastVerifiedBlockId,
228:         bytes32 _stateRoot
229:     )
230:         private
231:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L47-L53) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L224-L231)


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit  ,_hash are not checked
101:     function isApproved(bytes32 _hash) public view returns (bool) {
102:         return isApproved(_approvals[version][_hash]);

//@audit  ,_hash are not checked
111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {
112:         uint256 id = guardianIds[msg.sender];

//@audit  ,_hash are not checked
124:     function deleteApproval(bytes32 _hash) internal {
125:         delete _approvals[version][_hash];


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L101-L102) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L124-L125)


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit  ,_genesisBlockHash are not checked
42:     function init(
43:         address _owner,
44:         address _addressManager,
45:         bytes32 _genesisBlockHash
46:     )
47:         external
48:         initializer
49:     {

//@audit  ,_params ,_txList are not checked
55:     function proposeBlock(
56:         bytes calldata _params,
57:         bytes calldata _txList
58:     )
59:         external
60:         payable
61:         nonReentrant
62:         whenNotPaused
63:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
64:     {

//@audit  ,_input are not checked
75:     function proveBlock(
76:         uint64 _blockId,
77:         bytes calldata _input
78:     )
79:         external
80:         nonReentrant
81:         whenNotPaused
82:         whenProvingNotPaused
83:     {

//@audit  ,_blobHash are not checked
137:     function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
138:         return LibProposing.isBlobReusable(state, getConfig(), _blobHash);

//@audit  ,_parentHash are not checked
162:     function getTransition(
163:         uint64 _blockId,
164:         bytes32 _parentHash
165:     )
166:         public
167:         view
168:         returns (TaikoData.TransitionState memory)
169:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L42-L49) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L55-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L75-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L137-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L162-L169)


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit  ,_data are not checked
36:     function onMessageInvocation(bytes calldata _data)
37:         external
38:         payable
39:         whenNotPaused
40:         onlyFromNamed("bridge")
41:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L36-L41) 


```solidity

File: /contracts/signal/SignalService.sol

//@audit  ,_signal are not checked
63:     function sendSignal(bytes32 _signal) external returns (bytes32) {
64:         return _sendSignal(msg.sender, _signal, _signal);

//@audit  ,_kind ,_chainData are not checked
68:     function syncChainData(
69:         uint64 _chainId,
70:         bytes32 _kind,
71:         uint64 _blockId,
72:         bytes32 _chainData
73:     )
74:         external
75:         returns (bytes32)
76:     {

//@audit  ,_signal ,_proof are not checked
83:     function proveSignalReceived(
84:         uint64 _chainId,
85:         address _app,
86:         bytes32 _signal,
87:         bytes calldata _proof
88:     )
89:         public
90:         virtual
91:         validSender(_app)
92:         nonZeroValue(_signal)
93:     {

//@audit  ,_kind are not checked
137:     function isChainDataSynced(
138:         uint64 _chainId,
139:         bytes32 _kind,
140:         uint64 _blockId,
141:         bytes32 _chainData
142:     )
143:         public
144:         view
145:         nonZeroValue(_chainData)
146:         returns (bool)
147:     {

//@audit  ,_kind are not checked
158:     function getSyncedChainData(
159:         uint64 _chainId,
160:         bytes32 _kind,
161:         uint64 _blockId
162:     )
163:         public
164:         view
165:         returns (uint64 blockId_, bytes32 chainData_)
166:     {

//@audit  ,_kind are not checked
177:     function signalForChainData(
178:         uint64 _chainId,
179:         bytes32 _kind,
180:         uint64 _blockId
181:     )
182:         public
183:         pure
184:         returns (bytes32)
185:     {

//@audit  ,_signal are not checked
194:     function getSignalSlot(
195:         uint64 _chainId,
196:         address _app,
197:         bytes32 _signal
198:     )
199:         public
200:         pure
201:         returns (bytes32)
202:     {

//@audit  ,_signal ,_value are not checked
206:     function _verifyHopProof(
207:         uint64 _chainId,
208:         address _app,
209:         bytes32 _signal,
210:         bytes32 _value,
211:         HopProof memory _hop,
212:         address _signalService
213:     )
214:         internal
215:         virtual
216:         validSender(_app)
217:         nonZeroValue(_signal)
218:         nonZeroValue(_value)
219:         returns (bytes32)
220:     {

//@audit  ,_chainData are not checked
235:     function _syncChainData(
236:         uint64 _chainId,
237:         bytes32 _kind,
238:         uint64 _blockId,
239:         bytes32 _chainData
240:     )
241:         private
242:         returns (bytes32 signal_)
243:     {

//@audit  ,_signal ,_value are not checked
253:     function _sendSignal(
254:         address _app,
255:         bytes32 _signal,
256:         bytes32 _value
257:     )
258:         private
259:         validSender(_app)
260:         nonZeroValue(_signal)
261:         nonZeroValue(_value)
262:         returns (bytes32 slot_)
263:     {

//@audit  ,_signalRoot are not checked
271:     function _cacheChainData(
272:         HopProof memory _hop,
273:         uint64 _chainId,
274:         uint64 _blockId,
275:         bytes32 _signalRoot,
276:         bool _isFullProof,
277:         bool _isLastHop
278:     )
279:         private
280:     {

//@audit  ,_signal are not checked
298:     function _loadSignalValue(
299:         address _app,
300:         bytes32 _signal
301:     )
302:         private
303:         view
304:         validSender(_app)
305:         nonZeroValue(_signal)
306:         returns (bytes32 value_)
307:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L63-L64) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L68-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L137-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L158-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L177-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L194-L202), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L220), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L235-L243), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L253-L263), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L271-L280), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L298-L307)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit  ,_proof are not checked
155:     function recallMessage(
156:         Message calldata _message,
157:         bytes calldata _proof
158:     )
159:         external
160:         nonReentrant
161:         whenNotPaused
162:         sameChain(_message.srcChainId)
163:     {

//@audit  ,_proof are not checked
217:     function processMessage(
218:         Message calldata _message,
219:         bytes calldata _proof
220:     )
221:         external
222:         nonReentrant
223:         whenNotPaused
224:         sameChain(_message.destChainId)
225:     {

//@audit  ,_proof are not checked
352:     function proveMessageFailed(
353:         Message calldata _message,
354:         bytes calldata _proof
355:     )
356:         public
357:         view
358:         returns (bool)
359:     {

//@audit  ,_proof are not checked
374:     function proveMessageReceived(
375:         Message calldata _message,
376:         bytes calldata _proof
377:     )
378:         public
379:         view
380:         returns (bool)
381:     {

//@audit  ,_msgHash are not checked
456:     function signalForFailedMessage(bytes32 _msgHash) public pure returns (bytes32) {
457:         return _msgHash ^ bytes32(uint256(Status.FAILED));

//@audit  ,_msgHash are not checked
477:     function _invokeMessageCall(
478:         Message calldata _message,
479:         bytes32 _msgHash,
480:         uint256 _gasLimit
481:     )
482:         private
483:         returns (bool success_)
484:     {

//@audit  ,_msgHash are not checked
541:     function _storeContext(bytes32 _msgHash, address _from, uint64 _srcChainId) private {
542:         if (block.chainid == 1) {

//@audit  ,_signal ,_proof are not checked
577:     function _proveSignalReceived(
578:         address _signalService,
579:         bytes32 _signal,
580:         uint64 _chainId,
581:         bytes calldata _proof
582:     )
583:         private
584:         view
585:         returns (bool success_)
586:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L155-L163) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L217-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L352-L359), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L374-L381), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L456-L457), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L477-L484), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L541-L542), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L577-L586)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit  ,data are not checked
93:     function onMessageInvocation(bytes calldata data) external payable nonReentrant whenNotPaused {
94:         (

//@audit  ,msgHash are not checked
127:     function onMessageRecalled(
128:         IBridge.Message calldata message,
129:         bytes32 msgHash
130:     )
131:         external
132:         payable
133:         override
134:         nonReentrant
135:         whenNotPaused
136:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L93-L94) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L127-L136)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit  ,_data are not checked
253:     function onMessageInvocation(bytes calldata _data)
254:         external
255:         payable
256:         nonReentrant
257:         whenNotPaused
258:     {

//@audit  ,_msgHash are not checked
285:     function onMessageRecalled(
286:         IBridge.Message calldata _message,
287:         bytes32 _msgHash
288:     )
289:         external
290:         payable
291:         override
292:         nonReentrant
293:         whenNotPaused
294:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L253-L258) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L285-L294)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit  ,_data are not checked
77:     function onMessageInvocation(bytes calldata _data)
78:         external
79:         payable
80:         nonReentrant
81:         whenNotPaused
82:     {

//@audit  ,_msgHash are not checked
110:     function onMessageRecalled(
111:         IBridge.Message calldata _message,
112:         bytes32 _msgHash
113:     )
114:         external
115:         payable
116:         override
117:         nonReentrant
118:         whenNotPaused
119:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L77-L82) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L110-L119)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

//@audit  ,_calldata are not checked
25:     function excessivelySafeCall(
26:         address _target,
27:         uint256 _gas,
28:         uint256 _value,
29:         uint16 _maxCopy,
30:         bytes memory _calldata
31:     )
32:         internal
33:         returns (bool, bytes memory)
34:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L34) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

//@audit  ,_bytes are not checked
102:     function toNibbles(bytes memory _bytes) internal pure returns (bytes memory) {
103:         bytes memory _nibbles;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L102-L103) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

//@audit  ,_in are not checked
102:     function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {
103:         out_ = readList(toRLPItem(_in));

//@audit  ,_in are not checked
128:     function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {
129:         out_ = readBytes(toRLPItem(_in));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L102-L103) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L128-L129)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

//@audit  ,_key ,_value ,_root are not checked
50:     function verifyInclusionProof(
51:         bytes memory _key,
52:         bytes memory _value,
53:         bytes[] memory _proof,
54:         bytes32 _root
55:     )
56:         internal
57:         pure
58:         returns (bool valid_)
59:     {

//@audit  ,_root are not checked
68:     function get(
69:         bytes memory _key,
70:         bytes[] memory _proof,
71:         bytes32 _root
72:     )
73:         internal
74:         pure
75:         returns (bytes memory value_)
76:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L50-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68-L76)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

//@audit  ,_key ,_value ,_root are not checked
19:     function verifyInclusionProof(
20:         bytes memory _key,
21:         bytes memory _value,
22:         bytes[] memory _proof,
23:         bytes32 _root
24:     )
25:         internal
26:         pure
27:         returns (bool valid_)
28:     {

//@audit  ,_key ,_root are not checked
38:     function get(
39:         bytes memory _key,
40:         bytes[] memory _proof,
41:         bytes32 _root
42:     )
43:         internal
44:         pure
45:         returns (bytes memory value_)
46:     {

//@audit  ,_key are not checked
54:     function _getSecureKey(bytes memory _key) private pure returns (bytes memory hash_) {
55:         hash_ = abi.encodePacked(keccak256(_key));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L19-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L38-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L54-L55)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit  ,_metaHash are not checked
171:     function getSignedHash(
172:         TaikoData.Transition memory _tran,
173:         address _newInstance,
174:         address _prover,
175:         bytes32 _metaHash
176:     )
177:         public
178:         view
179:         returns (bytes32)
180:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L171-L180) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

//@audit  ,_merkleRoot are not checked
27:     function init(
28:         address _owner,
29:         uint64 _claimStart,
30:         uint64 _claimEnd,
31:         bytes32 _merkleRoot,
32:         address _token,
33:         address _vault
34:     )
35:         external
36:         initializer
37:     {

//@audit  ,delegationData are not checked
50:     function claimAndDelegate(
51:         address user,
52:         uint256 amount,
53:         bytes32[] calldata proof,
54:         bytes calldata delegationData
55:     )
56:         external
57:         nonReentrant
58:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L27-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L50-L58)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit  ,_merkleRoot are not checked
54:     function init(
55:         address _owner,
56:         uint64 _claimStart,
57:         uint64 _claimEnd,
58:         bytes32 _merkleRoot,
59:         address _token,
60:         address _vault,
61:         uint64 _withdrawalWindow
62:     )
63:         external
64:         initializer
65:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L65) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

//@audit  ,_merkleRoot are not checked
25:     function init(
26:         address _owner,
27:         uint64 _claimStart,
28:         uint64 _claimEnd,
29:         bytes32 _merkleRoot,
30:         address _token,
31:         address _vault
32:     )
33:         external
34:         initializer
35:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L25-L35) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

//@audit  ,_merkleRoot are not checked
45:     function setConfig(
46:         uint64 _claimStart,
47:         uint64 _claimEnd,
48:         bytes32 _merkleRoot
49:     )
50:         external
51:         onlyOwner
52:     {

//@audit  ,_merkleRoot are not checked
56:     function __MerkleClaimable_init(
57:         uint64 _claimStart,
58:         uint64 _claimEnd,
59:         bytes32 _merkleRoot
60:     )
61:         internal
62:         onlyInitializing
63:     {

//@audit  ,data are not checked
67:     function _verifyClaim(bytes memory data, bytes32[] calldata proof) internal ongoingClaim {
68:         bytes32 hash = keccak256(abi.encode("CLAIM_TAIKO_AIRDROP", data));

//@audit  ,_merkleRoot ,_value are not checked
77:     function _verifyMerkleProof(
78:         bytes32[] calldata _proof,
79:         bytes32 _merkleRoot,
80:         bytes32 _value
81:     )
82:         internal
83:         pure
84:         virtual
85:         returns (bool)
86:     {

//@audit  ,_merkleRoot are not checked
90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {
91:         claimStart = _claimStart;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L45-L52) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L56-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L67-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L77-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L91)


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit  ,_sig are not checked
168:     function withdraw(address _to, bytes memory _sig) external {
169:         if (_to == address(0)) revert INVALID_PARAM();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L168-L169) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit  ,_mrSigner are not checked
65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
66:         _trustedUserMrSigner[_mrSigner] = _trusted;

//@audit  ,_mrEnclave are not checked
69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
70:         _trustedUserMrEnclave[_mrEnclave] = _trusted;

//@audit  ,data are not checked
138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {
139:         (bool success,) = _verify(data);

//@audit  ,quote are not checked
162:     function _verify(bytes calldata quote) private view returns (bool, bytes memory) {
163:         bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);

//@audit  ,pckCertPubKey ,signedQuoteData are not checked
303:     function _enclaveReportSigVerification(
304:         bytes memory pckCertPubKey,
305:         bytes memory signedQuoteData,
306:         V3Struct.ECDSAQuoteV3AuthData memory authDataV3,
307:         V3Struct.EnclaveReport memory qeEnclaveReport
308:     )
309:         private
310:         view
311:         returns (bool)
312:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L66) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L70), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L162-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L312)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit  ,pemChain are not checked
40:     function splitCertificateChain(
41:         bytes memory pemChain,
42:         uint256 size
43:     )
44:         external
45:         pure
46:         returns (bool success, bytes[] memory certs)
47:     {

//@audit  ,input are not checked
252:     function _trimBytes(
253:         bytes memory input,
254:         uint256 expectedLength
255:     )
256:         private
257:         pure
258:         returns (bytes memory output)
259:     {

//@audit  ,der are not checked
341:     function _findTcb(
342:         bytes memory der,
343:         uint256 oidPtr
344:     )
345:         private
346:         pure
347:         returns (bool success, uint256 pcesvn, uint256[] memory cpusvns)
348:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L252-L259), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L341-L348)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit  ,rawEnclaveReport are not checked
133:     function parseEnclaveReport(bytes memory rawEnclaveReport)
134:         internal
135:         pure
136:         returns (V3Struct.EnclaveReport memory enclaveReport)
137:     {

//@audit  ,rawHeader are not checked
165:     function parseAndVerifyHeader(bytes memory rawHeader)
166:         private
167:         pure
168:         returns (bool success, V3Struct.Header memory header)
169:     {

//@audit  ,rawAuthData are not checked
203:     function parseAuthDataAndVerifyCertType(
204:         bytes memory rawAuthData,
205:         address pemCertLibAddr
206:     )
207:         private
208:         pure
209:         returns (bool success, V3Struct.ECDSAQuoteV3AuthData memory authDataV3)
210:     {

//@audit  ,certBytes are not checked
267:     function parseCerificationChainBytes(
268:         bytes memory certBytes,
269:         address pemCertLibAddr
270:     )
271:         internal
272:         pure
273:         returns (bytes[3] memory certChainData)
274:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133-L137) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L210), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L274)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit  ,der are not checked
47:     function root(bytes memory der) internal pure returns (uint256) {
48:         return _readNodeLength(der, 0);

//@audit  ,der are not checked
77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {
78:         return _readNodeLength(der, ptr.ixl() + 1);

//@audit  ,der are not checked
111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {
112:         return der.substring(ptr.ixf(), ptr.ixl() + 1 - ptr.ixf());

//@audit  ,der are not checked
121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {
122:         return der.substring(ptr.ixs(), ptr.ixl() + 1 - ptr.ixs());

//@audit  ,der are not checked
131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
132:         return der.readBytesN(ptr.ixf(), ptr.ixl() + 1 - ptr.ixf());

//@audit  ,der are not checked
165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
166:         return der.keccak(ptr.ixf(), ptr.ixl() + 1 - ptr.ixf());

//@audit  ,der are not checked
169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
170:         return der.keccak(ptr.ixs(), ptr.ixl() + 1 - ptr.ixs());


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L132), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L170)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit  ,self ,other are not checked
39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {
40:         return compare(self, 0, self.length, other, 0, other.length);

//@audit  ,self ,other are not checked
56:     function compare(
57:         bytes memory self,
58:         uint256 offset,
59:         uint256 len,
60:         bytes memory other,
61:         uint256 otheroffset,
62:         uint256 otherlen
63:     )
64:         internal
65:         pure
66:         returns (int256)
67:     {

//@audit  ,self are not checked
188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {
189:         return uint8(self[idx]);

//@audit  ,self are not checked
320:     function base32HexDecodeWord(
321:         bytes memory self,
322:         uint256 off,
323:         uint256 len
324:     )
325:         internal
326:         pure
327:         returns (bytes32)
328:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L189), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L328)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

//@audit  ,_s ,_e ,_m are not checked
43:     function pkcs1Sha256(
44:         bytes32 _sha256,
45:         bytes memory _s,
46:         bytes memory _e,
47:         bytes memory _m
48:     )
49:         internal
50:         view
51:         returns (bool)
52:     {

//@audit  ,_data ,_s ,_e ,_m are not checked
191:     function pkcs1Sha256Raw(
192:         bytes memory _data,
193:         bytes memory _s,
194:         bytes memory _e,
195:         bytes memory _m
196:     )
197:         internal
198:         view
199:         returns (bool)
200:     {

//@audit  ,_s ,_e ,_m are not checked
212:     function pkcs1Sha1(
213:         bytes20 _sha1,
214:         bytes memory _s,
215:         bytes memory _e,
216:         bytes memory _m
217:     )
218:         internal
219:         view
220:         returns (bool)
221:     {

//@audit  ,_data ,_s ,_e ,_m are not checked
307:     function pkcs1Sha1Raw(
308:         bytes memory _data,
309:         bytes memory _s,
310:         bytes memory _e,
311:         bytes memory _m
312:     )
313:         internal
314:         view
315:         returns (bool)
316:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L43-L52) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L191-L200), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L212-L221), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L307-L316)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

//@audit  ,data are not checked
11:     function sha1(bytes memory data) internal pure returns (bytes20 ret) {
12:         assembly {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L11-L12) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

//@audit  ,tbs ,signature are not checked
24:     function verifyAttStmtSignature(
25:         bytes memory tbs,
26:         bytes memory signature,
27:         PublicKey memory publicKey,
28:         Algorithm alg
29:     )
30:         public
31:         view
32:         returns (bool)
33:     {

//@audit  ,tbs ,signature are not checked
54:     function verifyCertificateSignature(
55:         bytes memory tbs,
56:         bytes memory signature,
57:         PublicKey memory publicKey,
58:         CertSigAlgorithm alg
59:     )
60:         public
61:         view
62:         returns (bool)
63:     {

//@audit  ,tbs ,signature ,publicKey are not checked
79:     function verifyRS256Signature(
80:         bytes memory tbs,
81:         bytes memory signature,
82:         bytes memory publicKey
83:     )
84:         public
85:         view
86:         returns (bool sigValid)
87:     {

//@audit  ,tbs ,signature ,publicKey are not checked
096:     function verifyRS1Signature(
097:         bytes memory tbs,
098:         bytes memory signature,
099:         bytes memory publicKey
100:     )
101:         public
102:         view
103:         returns (bool sigValid)
104:     {

//@audit  ,tbs are not checked
113:     function verifyES256Signature(
114:         bytes memory tbs,
115:         bytes memory signature,
116:         bytes memory publicKey
117:     )
118:         public
119:         view
120:         returns (bool sigValid)
121:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L33) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L79-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L96-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L121)


</details>


### [NC&#x2011;19] Events are missing sender information 
When an action is triggered based on a user's action, not being able to filter based on who triggered the action makes event processing a lot more cumbersome. Including the `msg.sender` the events of these types of action will make events much more useful to end users, especially when `msg.sender` is not `tx.origin`.


*There are 49 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

50:         emit AddressSet(_chainId, _name, _newAddress, oldAddress);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L50-L50) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

129:         emit BlockAssigned(_blk.assignedProver, _meta, assignment);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L129-L129) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

50:         emit EthDeposited(
51:             TaikoData.EthDeposit({
52:                 recipient: recipient_,
53:                 amount: uint96(msg.value),
54:                 id: _state.slotA.numEthDeposits
55:             })
56:         );


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L50-L56) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

273:         emit BlockProposed({
274:             blockId: blk.blockId,
275:             assignedProver: blk.assignedProver,
276:             livenessBond: _config.livenessBond,
277:             meta: meta_,
278:             depositsProcessed: deposits_
279:         });

166:                     emit BlobCached(meta_.blobHash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L273-L279) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L166-L166)


```solidity

File: /contracts/L1/libs/LibProving.sol

80:         emit ProvingPaused(_pause);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L80-L80) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

73:         emit BlockVerified({
74:             blockId: 0,
75:             assignedProver: address(0),
76:             prover: address(0),
77:             blockHash: _genesisBlockHash,
78:             stateRoot: 0,
79:             tier: 0,
80:             contestations: 0
81:         });

198:                 emit BlockVerified({
199:                     blockId: blockId,
200:                     assignedProver: blk.assignedProver,
201:                     prover: ts.prover,
202:                     blockHash: blockHash,
203:                     stateRoot: stateRoot,
204:                     tier: ts.tier,
205:                     contestations: ts.contestations
206:                 });


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L73-L81) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L198-L206)


```solidity

File: /contracts/L1/provers/Guardians.sol

95:         emit GuardiansUpdated(version, _newGuardians);

121:         emit Approved(_operationId, _approval, approved_);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L95-L95) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L121-L121)


```solidity

File: /contracts/L2/CrossChainOwned.sol

53:         emit TransactionExecuted(nextTxId++, bytes4(txdata));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L53-L53) 


```solidity

File: /contracts/L2/TaikoL2.sol

157:         emit Anchored(blockhash(parentId), gasExcess);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L157-L157) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

39:         emit ConfigAndExcessChanged(_newConfig, _newGasExcess);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L39-L39) 


```solidity

File: /contracts/signal/SignalService.sol

59:         emit Authorized(_addr, _authorize);

250:         emit ChainDataSynced(_chainId, _blockId, _kind, _chainData, signal_);

268:         emit SignalSent(_app, _signal, slot_, _value);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L268-L268)


```solidity

File: /contracts/bridge/Bridge.sol

93:             emit MessageSuspended(msgHash, _suspend);

111:         emit AddressBanned(_addr, _ban);

151:         emit MessageSent(msgHash_, message_);

208:             emit MessageRecalled(msgHash);

210:             emit MessageReceived(msgHash, _message, true);

301:             emit MessageExecuted(msgHash);

303:             emit MessageReceived(msgHash, _message, false);

336:         emit MessageRetried(msgHash);

519:         emit MessageStatusChanged(_msgHash, _status);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L93-L93) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L151-L151), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L210-L210), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L301-L301), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L336-L336), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L519-L519)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

51:         emit MigrationStatusChanged(_migratingAddress, _migratingInbound);

63:             emit MigratedTo(migratingAddress, _account, _amount);

80:             emit MigratedTo(migratingAddress, _account, _amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L80-L80)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

80:         emit TokenSent({
81:             msgHash: msgHash,
82:             from: message_.srcOwner,
83:             to: _op.to,
84:             destChainId: message_.destChainId,
85:             ctoken: ctoken.addr,
86:             token: _op.token,
87:             tokenIds: _op.tokenIds,
88:             amounts: _op.amounts
89:         });

114:         emit TokenReceived({
115:             msgHash: ctx.msgHash,
116:             from: from,
117:             to: to,
118:             srcChainId: ctx.srcChainId,
119:             ctoken: ctoken.addr,
120:             token: token,
121:             tokenIds: tokenIds,
122:             amounts: amounts
123:         });

149:         emit TokenReleased({
150:             msgHash: msgHash,
151:             from: message.srcOwner,
152:             ctoken: ctoken.addr,
153:             token: token,
154:             tokenIds: tokenIds,
155:             amounts: amounts
156:         });

314:         emit BridgedTokenDeployed({
315:             chainId: _ctoken.chainId,
316:             ctoken: _ctoken.addr,
317:             btoken: btoken_,
318:             ctokenSymbol: _ctoken.symbol,
319:             ctokenName: _ctoken.name
320:         });


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L80-L89) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L114-L123), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L149-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L314-L320)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

191:         emit BridgedTokenChanged({
192:             srcChainId: _ctoken.chainId,
193:             ctoken: _ctoken.addr,
194:             btokenOld: btokenOld_,
195:             btokenNew: _btokenNew,
196:             ctokenSymbol: _ctoken.symbol,
197:             ctokenName: _ctoken.name,
198:             ctokenDecimal: _ctoken.decimals
199:         });

241:         emit TokenSent({
242:             msgHash: msgHash,
243:             from: message_.srcOwner,
244:             to: _op.to,
245:             destChainId: _op.destChainId,
246:             ctoken: ctoken.addr,
247:             token: _op.token,
248:             amount: balanceChange
249:         });

273:         emit TokenReceived({
274:             msgHash: ctx.msgHash,
275:             from: from,
276:             to: to,
277:             srcChainId: ctx.srcChainId,
278:             ctoken: ctoken.addr,
279:             token: token,
280:             amount: amount
281:         });

306:         emit TokenReleased({
307:             msgHash: _msgHash,
308:             from: _message.srcOwner,
309:             ctoken: ctoken.addr,
310:             token: token,
311:             amount: amount
312:         });

425:         emit BridgedTokenDeployed({
426:             srcChainId: ctoken.chainId,
427:             ctoken: ctoken.addr,
428:             btoken: btoken,
429:             ctokenSymbol: ctoken.symbol,
430:             ctokenName: ctoken.name,
431:             ctokenDecimal: ctoken.decimals
432:         });


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L191-L199) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L241-L249), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L273-L281), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L306-L312), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L425-L432)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

64:         emit TokenSent({
65:             msgHash: msgHash,
66:             from: message_.srcOwner,
67:             to: _op.to,
68:             destChainId: message_.destChainId,
69:             ctoken: ctoken.addr,
70:             token: _op.token,
71:             tokenIds: _op.tokenIds,
72:             amounts: _op.amounts
73:         });

097:         emit TokenReceived({
098:             msgHash: ctx.msgHash,
099:             from: from,
100:             to: to,
101:             srcChainId: ctx.srcChainId,
102:             ctoken: ctoken.addr,
103:             token: token,
104:             tokenIds: tokenIds,
105:             amounts: new uint256[](tokenIds.length)
106:         });

131:         emit TokenReleased({
132:             msgHash: _msgHash,
133:             from: _message.srcOwner,
134:             ctoken: ctoken.addr,
135:             token: token,
136:             tokenIds: tokenIds,
137:             amounts: new uint256[](tokenIds.length)
138:         });

250:         emit BridgedTokenDeployed({
251:             chainId: _ctoken.chainId,
252:             ctoken: _ctoken.addr,
253:             btoken: btoken_,
254:             ctokenSymbol: _ctoken.symbol,
255:             ctokenName: _ctoken.name
256:         });


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L64-L73) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L97-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L131-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L250-L256)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

109:             emit InstanceDeleted(idx, instances[idx].addr);

220:             emit InstanceAdded(nextInstanceId, _instances[i], address(0), validSince);

230:         emit InstanceAdded(id, newInstance, oldInstance, block.timestamp);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L109-L109) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L220-L220), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L230-L230)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

93:         emit Withdrawn(user, amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L93-L93) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

74:         emit Claimed(hash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L74-L74) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

143:         emit Granted(_recipient, _grant);

157:         emit Voided(_recipient, amountVoided);

222:         emit Withdrawn(_recipient, _to, amountToWithdraw, costToWithdraw);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L143-L143) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L222-L222)


</details>


### [NC&#x2011;20] Events may be emitted out of order due to reentrancy 
Ensure that events follow the best practice of check-effects-interaction, and are emitted before external calls


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProposing.sol

273:         emit BlockProposed({


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L273-L273) 


```solidity

File: /contracts/L1/libs/LibProving.sol

254:                 emit TransitionContested({


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L254-L254) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

198:                 emit BlockVerified({


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L198-L198) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

93:         emit Withdrawn(user, amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L93-L93) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

222:         emit Withdrawn(_recipient, _to, amountToWithdraw, costToWithdraw);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L222-L222) 


</details>


### [NC&#x2011;21] Explicitly define visibility of state variables to prevent misconceptions on what can access the variable 
Such state variables should be marked as private as this is the default visibility


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

6:     uint256 constant LOW_28_MASK =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6-L6) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

32:     uint256 constant SGX_TCB_CPUSVN_SIZE = 16;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L32-L32) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

310:     bytes constant BASE32_HEX_TABLE =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L310-L310) 


</details>


### [NC&#x2011;22] Defining All External/Public Functions in Contract Interfaces 
It is preferable to have all the external and public function in an interface to make using them easier by developers. This helps ensure the whole API is extracted in a interface.


*There are 87 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

30:     function init(address _owner) external initializer {
31:         __Essential_init(_owner);

38:     function setAddress(
39:         uint64 _chainId,
40:         bytes32 _name,
41:         address _newAddress
42:     )
43:         external
44:         virtual
45:         onlyOwner
46:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L30-L31) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L38-L46)


```solidity

File: /contracts/common/EssentialContract.sol

69:     function pause() public virtual whenNotPaused {
70:         __paused = _TRUE;

78:     function unpause() public virtual whenPaused {
79:         __paused = _FALSE;

88:     function paused() public view returns (bool) {
89:         return __paused == _TRUE;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L69-L70) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L78-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L88-L89)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

31:     function init(
32:         address _owner,
33:         IVotesUpgradeable _token,
34:         TimelockControllerUpgradeable _timelock
35:     )
36:         external
37:         initializer
38:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L31-L38) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

15:     function init(address _owner, uint256 _minDelay) external initializer {
16:         __Essential_init(_owner);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L15-L16) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

57:     function init(address _owner, address _addressManager) external initializer {
58:         __Essential_init(_owner, _addressManager);

137:     function hashAssignment(
138:         ProverAssignment memory _assignment,
139:         address _taikoL1Address,
140:         bytes32 _blobHash
141:     )
142:         public
143:         view
144:         returns (bytes32)
145:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L57-L58) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L137-L145)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

25:     function init(address _owner, address _addressManager) external initializer {
26:         __Essential_init(_owner, _addressManager);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L25-L26) 


```solidity

File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(
54:         address[] memory _newGuardians,
55:         uint8 _minGuardians
56:     )
57:         external
58:         onlyOwner
59:         nonReentrant
60:     {

101:     function isApproved(bytes32 _hash) public view returns (bool) {
102:         return isApproved(_approvals[version][_hash]);

107:     function numGuardians() public view returns (uint256) {
108:         return guardians.length;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L101-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L107-L108)


```solidity

File: /contracts/L1/TaikoL1.sol

42:     function init(
43:         address _owner,
44:         address _addressManager,
45:         bytes32 _genesisBlockHash
46:     )
47:         external
48:         initializer
49:     {

111:     function pauseProving(bool _pause) external {
112:         _authorizePause(msg.sender);

119:     function depositEtherToL2(address _recipient) external payable nonReentrant whenNotPaused {
120:         LibDepositing.depositEtherToL2(state, getConfig(), this, _recipient);

132:     function canDepositEthToL2(uint256 _amount) public view returns (bool) {
133:         return LibDepositing.canDepositEthToL2(state, getConfig(), _amount);

137:     function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
138:         return LibProposing.isBlobReusable(state, getConfig(), _blobHash);

145:     function getBlock(uint64 _blockId)
146:         public
147:         view
148:         returns (TaikoData.Block memory blk_, TaikoData.TransitionState memory ts_)
149:     {

162:     function getTransition(
163:         uint64 _blockId,
164:         bytes32 _parentHash
165:     )
166:         public
167:         view
168:         returns (TaikoData.TransitionState memory)
169:     {

176:     function getStateVariables()
177:         public
178:         view
179:         returns (TaikoData.SlotA memory a_, TaikoData.SlotB memory b_)
180:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L42-L49) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L111-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L119-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L132-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L137-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L145-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L162-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L176-L180)


```solidity

File: /contracts/L1/TaikoToken.sol

25:     function init(
26:         address _owner,
27:         string calldata _name,
28:         string calldata _symbol,
29:         address _recipient
30:     )
31:         public
32:         initializer
33:     {

52:     function snapshot() public onlyFromOwnerOrNamed("snapshooter") {
53:         _snapshot();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L25-L33) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L52-L53)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

15:     function init(address _owner) external initializer {
16:         __Essential_init(_owner);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L15-L16) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

15:     function init(address _owner) external initializer {
16:         __Essential_init(_owner);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L15-L16) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

15:     function init(address _owner) external initializer {
16:         __Essential_init(_owner);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L15-L16) 


```solidity

File: /contracts/L2/TaikoL2.sol

71:     function init(
72:         address _owner,
73:         address _addressManager,
74:         uint64 _l1ChainId,
75:         uint64 _gasExcess
76:     )
77:         external
78:         initializer
79:     {

107:     function anchor(
108:         bytes32 _l1BlockHash,
109:         bytes32 _l1StateRoot,
110:         uint64 _l1BlockId,
111:         uint32 _parentGasUsed
112:     )
113:         external
114:         nonReentrant
115:     {

163:     function withdraw(
164:         address _token,
165:         address _to
166:     )
167:         external
168:         onlyFromOwnerOrNamed("withdrawer")
169:         nonReentrant
170:         whenNotPaused
171:     {

185:     function getBasefee(
186:         uint64 _l1BlockId,
187:         uint32 _parentGasUsed
188:     )
189:         public
190:         view
191:         returns (uint256 basefee_)
192:     {

200:     function getBlockHash(uint64 _blockId) public view returns (bytes32) {
201:         if (_blockId >= block.number) return 0;

219:     function skipFeeCheck() public pure virtual returns (bool) {
220:         return false;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L71-L79) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L107-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L185-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L200-L201), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L219-L220)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

25:     function setConfigAndExcess(
26:         Config memory _newConfig,
27:         uint64 _newGasExcess
28:     )
29:         external
30:         virtual
31:         onlyOwner
32:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L25-L32) 


```solidity

File: /contracts/signal/SignalService.sol

48:     function init(address _owner, address _addressManager) external initializer {
49:         __Essential_init(_owner, _addressManager);

56:     function authorize(address _addr, bool _authorize) external onlyOwner {
57:         if (isAuthorized[_addr] == _authorize) revert SS_INVALID_STATE();

194:     function getSignalSlot(
195:         uint64 _chainId,
196:         address _app,
197:         bytes32 _signal
198:     )
199:         public
200:         pure
201:         returns (bytes32)
202:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L48-L49) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L56-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L194-L202)


```solidity

File: /contracts/bridge/Bridge.sol

75:     function init(address _owner, address _addressManager) external initializer {
76:         __Essential_init(_owner, _addressManager);

82:     function suspendMessages(
83:         bytes32[] calldata _msgHashes,
84:         bool _suspend
85:     )
86:         external
87:         onlyFromOwnerOrNamed("bridge_watchdog")
88:     {

101:     function banAddress(
102:         address _addr,
103:         bool _ban
104:     )
105:         external
106:         onlyFromOwnerOrNamed("bridge_watchdog")
107:         nonReentrant
108:     {

352:     function proveMessageFailed(
353:         Message calldata _message,
354:         bytes calldata _proof
355:     )
356:         public
357:         view
358:         returns (bool)
359:     {

374:     function proveMessageReceived(
375:         Message calldata _message,
376:         bytes calldata _proof
377:     )
378:         public
379:         view
380:         returns (bool)
381:     {

392:     function isDestChainEnabled(uint64 _chainId)
393:         public
394:         view
395:         returns (bool enabled_, address destBridge_)
396:     {

417:     function getInvocationDelays()
418:         public
419:         view
420:         virtual
421:         returns (uint256 invocationDelay_, uint256 invocationExtraDelay_)
422:     {

456:     function signalForFailedMessage(bytes32 _msgHash) public pure returns (bytes32) {
457:         return _msgHash ^ bytes32(uint256(Status.FAILED));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L75-L76) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L82-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L101-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L352-L359), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L374-L381), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L392-L396), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L417-L422), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L456-L457)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

38:     function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
39:         __Essential_init(_owner, _addressManager);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L38-L39) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

52:     function init(
53:         address _owner,
54:         address _addressManager,
55:         address _srcToken,
56:         uint256 _srcChainId,
57:         uint8 _decimals,
58:         string memory _symbol,
59:         string memory _name
60:     )
61:         external
62:         initializer
63:     {

80:     function setSnapshoter(address _snapshooter) external onlyOwner {
81:         snapshooter = _snapshooter;

85:     function snapshot() external onlyOwnerOrSnapshooter {
86:         _snapshot();

125:     function canonical() public view returns (address, uint256) {
126:         return (srcToken, srcChainId);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L52-L63) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L81), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L85-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L125-L126)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

31:     function init(
32:         address _owner,
33:         address _addressManager,
34:         address _srcToken,
35:         uint256 _srcChainId,
36:         string memory _symbol,
37:         string memory _name
38:     )
39:         external
40:         initializer
41:     {

100:     function source() public view returns (address, uint256) {
101:         return (srcToken, srcChainId);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L31-L41) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L100-L101)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

38:     function init(
39:         address _owner,
40:         address _addressManager,
41:         address _srcToken,
42:         uint256 _srcChainId,
43:         string memory _symbol,
44:         string memory _name
45:     )
46:         external
47:         initializer
48:     {

83:     function mintBatch(
84:         address _to,
85:         uint256[] memory _tokenIds,
86:         uint256[] memory _amounts
87:     )
88:         public
89:         nonReentrant
90:         whenNotPaused
91:         onlyFromNamed("erc1155_vault")
92:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L38-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L83-L92)


```solidity

File: /contracts/tokenvault/BaseVault.sol

32:     function init(address _owner, address _addressManager) external initializer {
33:         __Essential_init(_owner, _addressManager);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L32-L33) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

39:     function sendToken(BridgeTransferOp memory _op)
40:         external
41:         payable
42:         nonReentrant
43:         whenNotPaused
44:         withValidOperation(_op)
45:         returns (IBridge.Message memory message_)
46:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L39-L46) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

148:     function changeBridgedToken(
149:         CanonicalERC20 calldata _ctoken,
150:         address _btokenNew
151:     )
152:         external
153:         nonReentrant
154:         whenNotPaused
155:         onlyOwner
156:         returns (address btokenOld_)
157:     {

207:     function sendToken(BridgeTransferOp calldata _op)
208:         external
209:         payable
210:         nonReentrant
211:         whenNotPaused
212:         returns (IBridge.Message memory message_)
213:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L148-L157) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L207-L213)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

26:     function sendToken(BridgeTransferOp memory _op)
27:         external
28:         payable
29:         nonReentrant
30:         whenNotPaused
31:         withValidOperation(_op)
32:         returns (IBridge.Message memory message_)
33:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L26-L33) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

18:     function init(address _owner, address _addressManager) external initializer {
19:         __Essential_init(_owner, _addressManager);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L18-L19) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

83:     function init(address _owner, address _addressManager) external initializer {
84:         __Essential_init(_owner, _addressManager);

90:     function addInstances(address[] calldata _instances)
91:         external
92:         onlyOwner
93:         returns (uint256[] memory)
94:     {

100:     function deleteInstances(uint256[] calldata _ids)
101:         external
102:         onlyFromOwnerOrNamed("rollup_watchdog")
103:     {

118:     function registerInstance(V3Struct.ParsedV3QuoteStruct calldata _attestation)
119:         external
120:         returns (uint256)
121:     {

171:     function getSignedHash(
172:         TaikoData.Transition memory _tran,
173:         address _newInstance,
174:         address _prover,
175:         bytes32 _metaHash
176:     )
177:         public
178:         view
179:         returns (bytes32)
180:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L83-L84) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L90-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L100-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L118-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L171-L180)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

27:     function init(
28:         address _owner,
29:         uint64 _claimStart,
30:         uint64 _claimEnd,
31:         bytes32 _merkleRoot,
32:         address _token,
33:         address _vault
34:     )
35:         external
36:         initializer
37:     {

50:     function claimAndDelegate(
51:         address user,
52:         uint256 amount,
53:         bytes32[] calldata proof,
54:         bytes calldata delegationData
55:     )
56:         external
57:         nonReentrant
58:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L27-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L50-L58)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

54:     function init(
55:         address _owner,
56:         uint64 _claimStart,
57:         uint64 _claimEnd,
58:         bytes32 _merkleRoot,
59:         address _token,
60:         address _vault,
61:         uint64 _withdrawalWindow
62:     )
63:         external
64:         initializer
65:     {

78:     function claim(address user, uint256 amount, bytes32[] calldata proof) external nonReentrant {
79:         // Check if this can be claimed

88:     function withdraw(address user) external ongoingWithdrawals {
89:         (, uint256 amount) = getBalance(user);

104:     function getBalance(address user)
105:         public
106:         view
107:         returns (uint256 balance, uint256 withdrawableAmount)
108:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L65) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L78-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L88-L89), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L104-L108)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

25:     function init(
26:         address _owner,
27:         uint64 _claimStart,
28:         uint64 _claimEnd,
29:         bytes32 _merkleRoot,
30:         address _token,
31:         address _vault
32:     )
33:         external
34:         initializer
35:     {

47:     function claim(
48:         address user,
49:         uint256[] calldata tokenIds,
50:         bytes32[] calldata proof
51:     )
52:         external
53:         nonReentrant
54:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L25-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L47-L54)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

45:     function setConfig(
46:         uint64 _claimStart,
47:         uint64 _claimEnd,
48:         bytes32 _merkleRoot
49:     )
50:         external
51:         onlyOwner
52:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L45-L52) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

111:     function init(
112:         address _owner,
113:         address _taikoToken,
114:         address _costToken,
115:         address _sharedVault
116:     )
117:         external
118:         initializer
119:     {

135:     function grant(address _recipient, Grant memory _grant) external onlyOwner {
136:         if (_recipient == address(0)) revert INVALID_PARAM();

150:     function void(address _recipient) external onlyOwner {
151:         Recipient storage r = recipients[_recipient];

161:     function withdraw() external {
162:         _withdraw(msg.sender, msg.sender);

168:     function withdraw(address _to, bytes memory _sig) external {
169:         if (_to == address(0)) revert INVALID_PARAM();

176:     function getMyGrantSummary(address _recipient)
177:         public
178:         view
179:         returns (
180:             uint128 amountOwned,
181:             uint128 amountUnlocked,
182:             uint128 amountWithdrawn,
183:             uint128 amountToWithdraw,
184:             uint128 costToWithdraw
185:         )
186:     {

204:     function getMyGrant(address _recipient) public view returns (Grant memory) {
205:         return recipients[_recipient].grant;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L111-L119) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L135-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L150-L151), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L161-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L168-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L176-L186), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L204-L205)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
66:         _trustedUserMrSigner[_mrSigner] = _trusted;

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
70:         _trustedUserMrEnclave[_mrEnclave] = _trusted;

73:     function addRevokedCertSerialNum(
74:         uint256 index,
75:         bytes[] calldata serialNumBatch
76:     )
77:         external
78:         onlyOwner
79:     {

88:     function removeRevokedCertSerialNum(
89:         uint256 index,
90:         bytes[] calldata serialNumBatch
91:     )
92:         external
93:         onlyOwner
94:     {

103:     function configureTcbInfoJson(
104:         string calldata fmspc,
105:         TCBInfoStruct.TCBInfo calldata tcbInfoInput
106:     )
107:         public
108:         onlyOwner
109:     {

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)
115:         external
116:         onlyOwner
117:     {

122:     function toggleLocalReportCheck() external onlyOwner {
123:         _checkLocalEnclaveReport = !_checkLocalEnclaveReport;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L66) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L70), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122-L123)


</details>


### [NC&#x2011;23] Function ordering does not follow the Solidity style guide 
According to the [Solidity style guide](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#order-of-functions), functions should be laid out in the following order :`constructor()`, `receive()`, `fallback()`, `external`, `public`, `internal`, `private`, but the cases below do not follow this pattern


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L114) 


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

9:     function verifyAttestation(bytes calldata data) external returns (bool);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L9-L9) 


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

38:     function verifyAttStmtSignature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38-L38) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

244:     function packQEReport(V3Struct.EnclaveReport memory enclaveReport)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L244-L244) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

284:     function substring(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284) 


</details>


### [NC&#x2011;24] `address`s shouldn't be hard-coded 
It is often better to declare `address`es as `immutable`, and assign them via constructor arguments. This allows the code to remain the same across deployments on different networks, and avoids recompilation when addresses need to change.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/TaikoL2.sol

//@audit hardcoded address : 0x0000777735367b36bC9B61C50022d9D0700dB4Ec
32:     address public constant GOLDEN_TOUCH_ADDRESS = 0x0000777735367b36bC9B61C50022d9D0700dB4Ec;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L32-L32) 


</details>


### [NC&#x2011;25] Array indicies should be referenced via `enum`s rather than via numeric literals 
Consider using an enum instead of hardcoding an index access to make the code easier to understand.


*There are 29 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit `tiers_`
49:         tiers_[0] = LibTiers.TIER_OPTIMISTIC;

//@audit `tiers_`
50:         tiers_[1] = LibTiers.TIER_GUARDIAN;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L50-L50)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit `tiers_`
60:         tiers_[0] = LibTiers.TIER_SGX;

//@audit `tiers_`
61:         tiers_[1] = LibTiers.TIER_SGX_ZKVM;

//@audit `tiers_`
62:         tiers_[2] = LibTiers.TIER_GUARDIAN;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L60-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L62-L62)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit `tiers_`
60:         tiers_[0] = LibTiers.TIER_OPTIMISTIC;

//@audit `tiers_`
61:         tiers_[1] = LibTiers.TIER_SGX;

//@audit `tiers_`
62:         tiers_[2] = LibTiers.TIER_GUARDIAN;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L60-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L62-L62)


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit `inputs`
240:         inputs[255] = bytes32(block.chainid);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L240-L240) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit `_in`
14:         if (_in.length == 1 && uint8(_in[0]) < 128) {

//@audit `out_`
45:             out_[0] = bytes1(uint8(lenLen) + uint8(_offset) + 55);

//@audit `out_`
35:             out_[0] = bytes1(uint8(_len) + uint8(_offset));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35-L35)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

//@audit `path`
141:                 uint8 prefix = uint8(path[0]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L141-L141) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit `_address`
133:         _address[0] = address(bytes20(_attestation.localEnclaveReport.reportData));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L133-L133) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit `parsedQuoteCerts`
442:             IPEMCertChainLib.ECSha256Certificate memory pckCert = parsedQuoteCerts[0];

//@audit `parsedQuoteCerts`
472:                 parsedQuoteCerts[0].pubKey,

//@audit `parsedQuoteCerts`
435:             string memory parsedFmspc = parsedQuoteCerts[0].pck.sgxExtension.fmspc;

//@audit `parsedQuoteCerts`
454:             (tcbVerified, tcbStatus) = _checkTcbLevels(parsedQuoteCerts[0].pck, fetchedTcbInfo);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L442-L442) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L472-L472), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L435-L435), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L454-L454)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit `quoteCerts`
285:         certChainData = [quoteCerts[0], quoteCerts[1], quoteCerts[2]];

//@audit `quoteCerts`
285:         certChainData = [quoteCerts[0], quoteCerts[1], quoteCerts[2]];

//@audit `quoteCerts`
285:         certChainData = [quoteCerts[0], quoteCerts[1], quoteCerts[2]];


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L285-L285) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L285-L285), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L285-L285)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

//@audit `decipher`
137:         if (decipher[0] != 0 || decipher[1] != 0x01) {

//@audit `decipher`
137:         if (decipher[0] != 0 || decipher[1] != 0x01) {

//@audit `decipher`
270:         if (decipher[0] != 0 || decipher[1] != 0x01) {

//@audit `decipher`
270:         if (decipher[0] != 0 || decipher[1] != 0x01) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L137-L137) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L270-L270), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L270-L270)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

//@audit `monthDays`
57:         if (isLeapYear(year)) monthDays[1] = 29;

//@audit `x509Time`
18:             if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;

//@audit `x509Time`
21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;

//@audit `x509Time`
21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21)


</details>


### [NC&#x2011;26] Hardcoded string that is repeatedly used can be replaced with a constant 
For better maintainability, please consider creating and using a constant for those strings instead of hardcoding 


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/Bytes.sol

//@audit `slice_overflow` is used multiple time consider using a constant for it.
25:             require(_length + 31 >= _length, "slice_overflow");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L25-L25) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

//@audit `RLPReader: length of an RLP item must be greater than zero to be decodable` is used multiple time consider using a constant for it.
39:             "RLPReader: length of an RLP item must be greater than zero to be decodable"


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L39-L39) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit `Not type INTEGER` is used multiple time consider using a constant for it.
142:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

//@audit `Not positive` is used multiple time consider using a constant for it.
143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L142-L142) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit `unexpected idx` is used multiple time consider using a constant for it.
212:         require(idx + 4 <= self.length, "unexpected idx");

//@audit `unexpected len` is used multiple time consider using a constant for it.
264:         require(len <= 32, "unexpected len");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L212-L212) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L264-L264)


</details>


### [NC&#x2011;27] Duplicated `require()` checks should be refactored to a modifier or function 
The compiler will inline the function, which will avoid `JUMP` instructions usually associated with functions


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/utils/Asn1Decode.sol

142:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L142-L142) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143)


</details>


### [NC&#x2011;28] Some if-statement can be converted to a ternary 
Improving code readability and compactness is an integral part of optimal programming practices. The use of ternary operators in place of if-else conditions is one such measure. Ternary operators allow us to write conditional statements in a more concise manner, thereby enhancing readability and simplicity. They follow the syntax `condition ? exprIfTrue : exprIfFalse`, which interprets as "if the condition is true, evaluate to `exprIfTrue`, else evaluate to `exprIfFalse`". By adopting this approach, we make our code more streamlined and intuitive, which could potentially aid in better understanding and maintenance of the codebase.


*There are 20 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/LibAddress.sol

70:         if (Address.isContract(_addr)) {
71:             return IERC1271(_addr).isValidSignature(_hash, _sig) == _EIP1271_MAGICVALUE;
72:         } else {
73:             return ECDSA.recover(_hash, _sig) == _addr;
74:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L70-L74) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

109:         if (assignment.feeToken == address(0)) {
110:             // Paying Ether
111:             _blk.assignedProver.sendEther(proverFee, MAX_GAS_PAYING_PROVER);
112:         } else {
113:             // Paying ERC20 tokens
114:             IERC20(assignment.feeToken).safeTransferFrom(
115:                 _meta.coinbase, _blk.assignedProver, proverFee
116:             );
117:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L109-L117) 


```solidity

File: /contracts/L1/libs/LibProving.sol

381:             if (reward > _tier.validityBond) {
382:                 _tko.transfer(msg.sender, reward - _tier.validityBond);
383:             } else {
384:                 _tko.transferFrom(msg.sender, address(this), _tier.validityBond - reward);
385:             }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L381-L385) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

80:         if (_state.transitions[_slot][1].key == _parentHash) {
81:             tid_ = 1;
82:         } else {
83:             tid_ = _state.transitionIds[_blk.blockId][_parentHash];
84:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L80-L84) 


```solidity

File: /contracts/L2/TaikoL2.sol

173:         if (_token == address(0)) {
174:             _to.sendEther(address(this).balance);
175:         } else {
176:             IERC20(_token).safeTransfer(_to, IERC20(_token).balanceOf(address(this)));
177:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L173-L177) 


```solidity

File: /contracts/bridge/Bridge.sol

490:         if (
491:             _message.data.length >= 4 // msg can be empty
492:                 && bytes4(_message.data) != IMessageInvocable.onMessageInvocation.selector
493:                 && _message.to.isContract()
494:         ) {
495:             success_ = false;
496:         } else {
497:             (success_,) = ExcessivelySafeCall.excessivelySafeCall(
498:                 _message.to,
499:                 _gasLimit,
500:                 _message.value,
501:                 64, // return max 64 bytes
502:                 _message.data
503:             );
504:         }

530:         if (block.chainid == 1) {
531:             _storeContext(bytes32(0), address(0), uint64(0));
532:         } else {
533:             _storeContext(bytes32(PLACEHOLDER), address(uint160(PLACEHOLDER)), uint64(PLACEHOLDER));
534:         }

209:         } else if (!isMessageProven) {
210:             emit MessageReceived(msgHash, _message, true);
211:         } else {
212:             revert B_INVOCATION_TOO_EARLY();
213:         }

302:         } else if (!isMessageProven) {
303:             emit MessageReceived(msgHash, _message, false);
304:         } else {
305:             revert B_INVOCATION_TOO_EARLY();
306:         }

439:         } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {
440:             // For all Taiko internal devnets
441:             return (5 minutes, 384 seconds);
442:         } else {
443:             // This is a Taiko L2 chain where no deleys are applied.
444:             return (0, 0);
445:         }

282:                 if (_invokeMessageCall(_message, msgHash, gasLimit)) {
283:                     _updateMessageStatus(msgHash, Status.DONE);
284:                 } else {
285:                     _updateMessageStatus(msgHash, Status.RETRIABLE);
286:                 }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L490-L504) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L530-L534), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L209-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L302-L306), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L439-L445), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L282-L286)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

14:         if (_in.length == 1 && uint8(_in[0]) < 128) {
15:             out_ = _in;
16:         } else {
17:             out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);
18:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14-L18) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

097:             } else if (currentNode.encoded.length >= 32) {
098:                 // Nodes 32 bytes or larger are hashed inside branch nodes.
099:                 require(
100:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
101:                     "MerkleTrie: invalid large internal hash"
102:                 );
103:             } else {
104:                 // Nodes smaller than 32 bytes aren't hashed.
105:                 require(
106:                     Bytes.equal(currentNode.encoded, currentNodeID),
107:                     "MerkleTrie: invalid internal node hash"
108:                 );
109:             }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L97-L109) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

56:             if (i > 0) {
57:                 input = LibString.slice(pemChainStr, index, index + len);
58:             } else {
59:                 input = pemChainStr;
60:             }

333:             if (tbsPtr.ixl() < tbsParentPtr.ixl()) {
334:                 tbsPtr = der.nextSiblingOf(tbsPtr);
335:             } else {
336:                 tbsPtr = 0; // exit
337:             }

323:                     if (extnValuePtr.ixl() < extnValueParentPtr.ixl()) {
324:                         extnValuePtr = der.nextSiblingOf(extnValuePtr);
325:                     } else {
326:                         break;
327:                     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L56-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L333-L337), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L323-L327)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

158:         if (der[ptr.ixf()] == 0) {
159:             return der.substring(ptr.ixf() + 1, valueLength - 1);
160:         } else {
161:             return der.substring(ptr.ixf(), valueLength);
162:         }

199:             } else if (lengthbytesLength == 2) {
200:                 length = der.readUint16(ix + 2);
201:             } else {
202:                 length = uint256(
203:                     der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8
204:                 );
205:             }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L158-L162) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L199-L205)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

90:                 if (shortest > 32) {
91:                     mask = type(uint256).max; // aka 0xffffff....
92:                 } else {
93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);
94:                 }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L90-L94) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

49:             if (isLeapYear(i)) {
50:                 timestamp += 31_622_400; // Leap year in seconds
51:             } else {
52:                 timestamp += 31_536_000; // Normal year in seconds
53:             }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L49-L53) 


</details>


### [NC&#x2011;29] Imports could be organized more systematically 
The contract used interfaces should be imported first, followed by all other files. The examples below do not follow this layout.


*There are 23 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/LibAddress.sol

6: import "@openzeppelin/contracts/utils/introspection/IERC165.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L6-L6) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

8: import "../ITaikoL1.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L8-L8) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

7: import "../hooks/IHook.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L7-L7) 


```solidity

File: /contracts/L1/libs/LibProving.sol

7: import "../../verifiers/IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L7-L7) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

7: import "../../signal/ISignalService.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L7-L7) 


```solidity

File: /contracts/L1/TaikoL1.sol

9: import "./ITaikoL1.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L9-L9) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

5: import "./ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L5-L5) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

5: import "./ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L5-L5) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

5: import "./ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L5-L5) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

6: import "../bridge/IBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L6-L6) 


```solidity

File: /contracts/L2/TaikoL2.sol

9: import "../signal/ISignalService.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L9-L9) 


```solidity

File: /contracts/signal/SignalService.sol

7: import "./ISignalService.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L7-L7) 


```solidity

File: /contracts/bridge/Bridge.sol

7: import "../signal/ISignalService.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L7-L7) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

5: import "./IBridgedERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L5-L5) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

6: import


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L6-L6) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

6: import "../bridge/IBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L6-L6) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

6: import "../bridge/IBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L6-L6) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

7: import "../bridge/IBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L7-L7) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

6: import "./IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L6-L6) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

5: import "../L1/ITaikoL1.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L5-L5) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

5: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L5-L5) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

6: import { IPEMCertChainLib } from "./lib/interfaces/IPEMCertChainLib.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L6-L6) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

8: import { IPEMCertChainLib } from "./interfaces/IPEMCertChainLib.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L8-L8) 


</details>


### [NC&#x2011;30] Import declarations should import specific identifiers, rather than the whole file 
Using import declarations of the form `import {<identifier_name>} from "some/ file.sol"` avoids polluting the symbol namespace making flattened files smaller, and speeds up compilation


*There are 176 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

4: import "./IAddressManager.sol";

5: import "./EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L5-L5)


```solidity

File: /contracts/common/EssentialContract.sol

4: import "@openzeppelin/contracts/proxy/utils/UUPSUpgradeable.sol";

5: import "@openzeppelin/contracts-upgradeable/access/Ownable2StepUpgradeable.sol";

6: import "./AddressResolver.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L6-L6)


```solidity

File: /contracts/libs/LibAddress.sol

4: import "@openzeppelin/contracts/utils/Address.sol";

5: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";

6: import "@openzeppelin/contracts/utils/introspection/IERC165.sol";

7: import "@openzeppelin/contracts/interfaces/IERC1271.sol";

8: import "../thirdparty/nomad-xyz/ExcessivelySafeCall.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L8-L8)


```solidity

File: /contracts/libs/LibTrieProof.sol

9: import "../thirdparty/optimism/rlp/RLPReader.sol";

10: import "../thirdparty/optimism/rlp/RLPWriter.sol";

11: import "../thirdparty/optimism/trie/SecureMerkleTrie.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L11-L11)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";

5: import

7: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesUpgradeable.sol";

8: import

10: import

12: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L12-L12)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

4: import "@openzeppelin/contracts-upgradeable/governance/TimelockControllerUpgradeable.sol";

5: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L5-L5)


```solidity

File: /contracts/L1/hooks/IHook.sol

4: import "../TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L4-L4) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

6: import "../../common/EssentialContract.sol";

7: import "../../libs/LibAddress.sol";

8: import "../ITaikoL1.sol";

9: import "./IHook.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L9-L9)


```solidity

File: /contracts/L1/ITaikoL1.sol

4: import "./TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L4-L4) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

4: import "../../common/IAddressResolver.sol";

5: import "../../libs/LibAddress.sol";

6: import "../../libs/LibMath.sol";

7: import "../TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L7-L7)


```solidity

File: /contracts/L1/libs/LibProposing.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "../../common/IAddressResolver.sol";

6: import "../../libs/LibAddress.sol";

7: import "../hooks/IHook.sol";

8: import "../tiers/ITierProvider.sol";

9: import "../TaikoData.sol";

10: import "./LibDepositing.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L10-L10)


```solidity

File: /contracts/L1/libs/LibProving.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "../../common/IAddressResolver.sol";

6: import "../../libs/LibMath.sol";

7: import "../../verifiers/IVerifier.sol";

8: import "../tiers/ITierProvider.sol";

9: import "../TaikoData.sol";

10: import "./LibUtils.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L10-L10)


```solidity

File: /contracts/L1/libs/LibUtils.sol

4: import "../TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L4-L4) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "../../common/IAddressResolver.sol";

6: import "../../libs/LibMath.sol";

7: import "../../signal/ISignalService.sol";

8: import "../../signal/LibSignals.sol";

9: import "../tiers/ITierProvider.sol";

10: import "../TaikoData.sol";

11: import "./LibUtils.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L11-L11)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

4: import "../tiers/ITierProvider.sol";

5: import "../ITaikoL1.sol";

6: import "./Guardians.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L6-L6)


```solidity

File: /contracts/L1/provers/Guardians.sol

4: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L4-L4) 


```solidity

File: /contracts/L1/TaikoEvents.sol

4: import "./TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L4-L4) 


```solidity

File: /contracts/L1/TaikoL1.sol

4: import "../common/EssentialContract.sol";

5: import "./libs/LibDepositing.sol";

6: import "./libs/LibProposing.sol";

7: import "./libs/LibProving.sol";

8: import "./libs/LibVerifying.sol";

9: import "./ITaikoL1.sol";

10: import "./TaikoErrors.sol";

11: import "./TaikoEvents.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L11-L11)


```solidity

File: /contracts/L1/TaikoToken.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/ERC20Upgradeable.sol";

5: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";

6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";

7: import "../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L7-L7)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

4: import "../../common/EssentialContract.sol";

5: import "./ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L5-L5)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

4: import "../../common/EssentialContract.sol";

5: import "./ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L5-L5)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

4: import "../../common/EssentialContract.sol";

5: import "./ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L5-L5)


```solidity

File: /contracts/L2/CrossChainOwned.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "../common/EssentialContract.sol";

6: import "../bridge/IBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L6-L6)


```solidity

File: /contracts/L2/Lib1559Math.sol

4: import "../thirdparty/solmate/LibFixedPointMath.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L4-L4) 


```solidity

File: /contracts/L2/TaikoL2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

7: import "../libs/LibAddress.sol";

8: import "../libs/LibMath.sol";

9: import "../signal/ISignalService.sol";

10: import "../signal/LibSignals.sol";

11: import "./Lib1559Math.sol";

12: import "./CrossChainOwned.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L12-L12)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

4: import "./TaikoL2.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L4-L4) 


```solidity

File: /contracts/signal/SignalService.sol

4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";

5: import "../common/EssentialContract.sol";

6: import "../libs/LibTrieProof.sol";

7: import "./ISignalService.sol";

8: import "./LibSignals.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L8-L8)


```solidity

File: /contracts/bridge/Bridge.sol

4: import "@openzeppelin/contracts/utils/Address.sol";

5: import "../common/EssentialContract.sol";

6: import "../libs/LibAddress.sol";

7: import "../signal/ISignalService.sol";

8: import "../thirdparty/nomad-xyz/ExcessivelySafeCall.sol";

9: import "./IBridge.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L9-L9)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

4: import "../BridgedERC20Base.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";

5: import "@openzeppelin/contracts/utils/Strings.sol";

6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";

7: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";

8: import "./LibBridgedToken.sol";

9: import "./BridgedERC20Base.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L9-L9)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

4: import "../common/EssentialContract.sol";

5: import "./IBridgedERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L5-L5)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol";

5: import "@openzeppelin/contracts/utils/Strings.sol";

6: import "../common/EssentialContract.sol";

7: import "./LibBridgedToken.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L7-L7)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";

5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/ERC1155Upgradeable.sol";

6: import

8: import "../common/EssentialContract.sol";

9: import "./LibBridgedToken.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L9-L9)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

4: import "./BaseVault.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

4: import "@openzeppelin/contracts-upgradeable/utils/introspection/IERC165Upgradeable.sol";

5: import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";

6: import "../bridge/IBridge.sol";

7: import "../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L7-L7)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

4: import "@openzeppelin/contracts/token/ERC1155/IERC1155.sol";

5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/utils/ERC1155ReceiverUpgradeable.sol";

6: import "../bridge/IBridge.sol";

7: import "../libs/LibAddress.sol";

8: import "./BaseNFTVault.sol";

9: import "./BridgedERC1155.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L9-L9)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";

6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

7: import "../bridge/IBridge.sol";

8: import "../libs/LibAddress.sol";

9: import "./BridgedERC20.sol";

10: import "./BaseVault.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L10-L10)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

5: import "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";

6: import "../bridge/IBridge.sol";

7: import "../libs/LibAddress.sol";

8: import "./BaseNFTVault.sol";

9: import "./BridgedERC721.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L9-L9)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L4-L4) 


```solidity

File: /contracts/verifiers/IVerifier.sol

4: import "../L1/TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L4-L4) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

4: import "../common/EssentialContract.sol";

5: import "../L1/TaikoData.sol";

6: import "./IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L6-L6)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";

5: import "../L1/ITaikoL1.sol";

6: import "../common/EssentialContract.sol";

7: import "../thirdparty/optimism/Bytes.sol";

8: import "../automata-attestation/interfaces/IAttestation.sol";

9: import "../automata-attestation/lib/QuoteV3Auth/V3Struct.sol";

10: import "./IVerifier.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L10-L10)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/governance/utils/IVotes.sol";

6: import "./MerkleClaimable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L6-L6)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "../../libs/LibMath.sol";

6: import "./MerkleClaimable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L6-L6)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

5: import "./MerkleClaimable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L5-L5)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

4: import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";

5: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L5-L5)


```solidity

File: /contracts/team/TimelockTokenPool.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";

5: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";

7: import "../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L7-L7)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

8: import "./BytesUtils.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L8-L8) 


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

5: import "./SHA1.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L5-L5) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

4: import "../interfaces/ISigVerifyLib.sol";

5: import "./RsaVerify.sol";

6: import "./BytesUtils.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L6-L6)


</details>


### [NC&#x2011;31] Inconsistent spacing in comments 
Some lines use `// x` and some use `//x`. The instances below point out the usages that don't follow the majority, within each file


*There are 21 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoData.sol

97:         bytes32 blobHash; //or txListHash (if Blob not yet supported), // slot 3


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L97-L97) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

26:                 cooldownWindow: 1440, //24 hours

37:                 cooldownWindow: 60, //1 hours


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L37-L37)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

26:                 cooldownWindow: 1440, //24 hours

37:                 cooldownWindow: 1440, //24 hours

48:                 cooldownWindow: 60, //1 hours


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L48-L48)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

26:                 cooldownWindow: 1440, //24 hours

37:                 cooldownWindow: 1440, //24 hours

48:                 cooldownWindow: 60, //1 hours


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L48-L48)


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

67:                 //update free-memory pointer

68:                 //allocating the array padded to 32 bytes like the compiler does now

71:             //if we want a zero-length slice let's just return a zero-length array

75:                 //zero out the 32 bytes slice we are about to return

76:                 //we need to do it because Solidity does not garbage collect


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L67-L67) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L71-L71), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L76-L76)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

1: //SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L1-L1) 


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

1: //SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L1-L1) 


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

1: //SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L1-L1) 


```solidity

File: /contracts/automata-attestation/lib/EnclaveIdStruct.sol

1: //SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L1-L1) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

1: //SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L1-L1) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

1: //SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L1-L1) 


```solidity

File: /contracts/automata-attestation/lib/TCBInfoStruct.sol

1: //SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L1-L1) 


</details>


### [NC&#x2011;32] Inconsistent usage of `require`/`error` 
Some parts of the codebase use `require` statements, while others use custom `error`s. Consider refactoring the code to use the same approach: the following findings represent the minority of `require` vs `error`, and they show the first occurance in each file, for brevity.


*There are 60 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/Bytes.sol

25:             require(_length + 31 >= _length, "slice_overflow");

26:             require(_start + _length >= _start, "slice_overflow");

27:             require(_bytes.length >= _start + _length, "slice_outOfBounds");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L27-L27)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

37:         require(

56:         require(

61:         require(

112:         require(

117:         require(

152:         require(

172:             require(

182:             require(

192:             require(

202:             require(

212:             require(

217:             require(

238:             require(

248:             require(

258:             require(

263:             require(

228:             require(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L182-L182), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L202-L202), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L217-L217), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L258-L258), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L263-L263), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L228-L228)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

77:         require(_key.length > 0, "MerkleTrie: empty key");

89:             require(currentKeyIndex <= key.length, "MerkleTrie: key index exceeds total key length");

93:                 require(

105:                 require(

99:                 require(

150:                 require(

119:                     require(

125:                     require(

162:                     require(

172:                     require(

178:                     require(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L77-L77) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L119-L119), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L178-L178)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

61:         require(msg.sender == owner, "onlyOwner");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L61-L61) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

77:         require(

82:         require(

87:         require(

91:         require(

94:         require(

100:         require(

116:         require(totalQuoteSize >= MINIMUM_QUOTE_LENGTH, "Invalid quote size");

279:         require(certParsedSuccessfully, "splitCertificateChain failed");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L77-L77) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L279-L279)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

57:         require(der[ptr.ixs()] == 0x03, "Not type BIT STRING");

67:         require(der[ptr.ixs()] == 0x04, "Not type OCTET STRING");

88:         require(der[ptr.ixs()] & 0x20 == 0x20, "Not a constructed type");

142:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

155:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

156:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

180:         require(der[ptr.ixs()] == 0x03, "ixs Not type BIT STRING 0x03");

182:         require(der[ptr.ixf()] == 0x00, "ixf Not 0");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L182-L182)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

25:         require(offset + len <= self.length, "invalid offset");

199:         require(idx + 2 <= self.length, "invalid idx");

212:         require(idx + 4 <= self.length, "unexpected idx");

225:         require(idx + 32 <= self.length, "unexpected idx");

238:         require(idx + 20 <= self.length, "unexpected idx");

264:         require(len <= 32, "unexpected len");

265:         require(idx + len <= self.length, "unexpected idx");

293:         require(offset + len <= self.length, "unexpected offset");

329:         require(len <= 52, "unexpected len");

335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

337:             require(decoded <= 0x20, "invalid decoded");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L265-L265), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L293-L293), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L329-L329), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L335-L335), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L337-L337)


</details>


### [NC&#x2011;33] Interfaces should be defined in separate files from their usage 
The interfaces below should be defined in separate files, so that it's easier for future projects to import them, and to avoid duplication later on if they need to be used elsewhere in the project


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/adapters/USDCAdapter.sol

//@audit the interface `IUSDC` is declared in this file and used in it here:
31:     IUSDC public usdc;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L31-L31) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit the interface `IERC1155NameAndSymbol` is declared in this file and used in it here:
262:                 IERC1155NameAndSymbol t = IERC1155NameAndSymbol(_op.token);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L262-L262) 


</details>


### [NC&#x2011;34] `internal` functions not called by the contract should be removed 
If the functions are required by an interface, the contract should inherit from that interface and use the `override` keyword


*There are 13 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

30:     function evaluatePoint(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L30-L30) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

224:     function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {

237:     function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {

320:     function base32HexDecodeWord(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L211-L211) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L320)


</details>


### [NC&#x2011;35] Large numeric literals should use underscores for readability 



*There are 23 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

13:     uint32 public constant FIELD_ELEMENTS_PER_BLOB = 4096;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L13-L13) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

112:         return 7200; // 1 day


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L112-L112) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

21:     uint256 public constant MAX_BYTES_PER_BLOB = 4096 * 32;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L21-L21) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

251:                 || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L251-L251) 


```solidity

File: /contracts/L1/TaikoL1.sol

209:             ethDepositRingBufferSize: 1024,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L209-L209) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

48:     uint16 public constant TIER_GUARDIAN = 1000;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L48-L48) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

26:                 cooldownWindow: 1440, //24 hours

38:                 provingWindow: 2880, // 48 hours


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L38-L38)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

68:         if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;

26:                 cooldownWindow: 1440, //24 hours

36:                 contestBond: 1000 ether, // TKO

37:                 cooldownWindow: 1440, //24 hours

49:                 provingWindow: 2880, // 48 hours


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L49-L49)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

26:                 cooldownWindow: 1440, //24 hours

36:                 contestBond: 1000 ether, // TKO

37:                 cooldownWindow: 1440, //24 hours

49:                 provingWindow: 2880, // 48 hours


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L49-L49)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

14:     uint256 internal constant MINIMUM_QUOTE_LENGTH = 1020;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L14-L14) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

48:         for (uint16 i = 1970; i < year; ++i) {

64:         timestamp += uint256(hour) * 3600; // Hours in seconds

19:             else yrs += 1900;

18:             if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;

21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21)


</details>


### [NC&#x2011;36] Long functions should be refactored into multiple, smaller, functions 



*There are 30 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/hooks/AssignmentHook.sol

62:     function onBlockProposed(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L62-L62) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

67:     function processDeposits(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L67-L67) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

68:     function proposeBlock(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L68) 


```solidity

File: /contracts/L1/libs/LibProving.sol

91:     function proveBlock(

269:     function _createTransition(

350:     function _overrideWithHigherProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L91) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L350-L350)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

85:     function verifyBlocks(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L85-L85) 


```solidity

File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L53) 


```solidity

File: /contracts/L2/TaikoL2.sol

107:     function anchor(

252:     function _calc1559BaseFee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L107-L107) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L252-L252)


```solidity

File: /contracts/signal/SignalService.sol

83:     function proveSignalReceived(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L83) 


```solidity

File: /contracts/bridge/Bridge.sol

155:     function recallMessage(

217:     function processMessage(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L155-L155) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L217-L217)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

39:     function sendToken(BridgeTransferOp memory _op)

240:     function _handleMessage(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L240-L240)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

148:     function changeBridgedToken(

207:     function sendToken(BridgeTransferOp calldata _op)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L148-L148) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L207-L207)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

26:     function sendToken(BridgeTransferOp memory _op)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L26-L26) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

144:     function _decodeLength(RLPItem memory _in)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L144-L144) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

68:     function get(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68-L68) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)

303:     function _enclaveReportSigVerification(

364:     function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L248) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364-L364)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

74:     function decodeCert(

269:     function _findPckTcbInfo(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L269)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

62:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L62) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

320:     function base32HexDecodeWord(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L320)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

43:     function pkcs1Sha256(

212:     function pkcs1Sha1(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L212-L212)


</details>


### [NC&#x2011;37] Long lines of code 
Usually lines in source code are limited to [80](https://softwareengineering.stackexchange.com/questions/148677/why-is-80-characters-the-standard-limit-for-code-width) characters. Today's screens are much larger so it's reasonable to stretch this in some cases. The solidity style guide recommends a maximumum line length of [120 characters](https://docs.soliditylang.org/en/v0.8.17/style-guide.html#maximum-line-length), so the lines below should be split when they reach that length.


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

293:         // https://github.com/ethereum/solidity/blob/34dd30d71b4da730488be72ff6af7083cf2a91f6/libsolidity/codegen/YulUtilFunctions.cpp#L102-L114


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L293-L293) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

28:     // https://github.com/intel/SGXDataCenterAttestationPrimitives/blob/e7604e02331b3377f3766ed3653250e03af72d45/QuoteVerification/QVL/Src/AttestationLibrary/src/CertVerification/X509Constants.h#L64

31:     // keccak256(hex"0ba9c4c0c0c86193a3fe23d6b02cda10a8bbd4e88e48b4458561a36e705525f567918e2edc88e40d860bd0cc4ee26aacc988e505a953558c453f6b0904ae7394")


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L31-L31)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

31:     // https://github.com/intel/SGXDataCenterAttestationPrimitives/blob/e7604e02331b3377f3766ed3653250e03af72d45/QuoteVerification/QVL/Src/AttestationLibrary/src/CertVerification/X509Constants.h#L64


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L31-L31) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

311:         hex"00010203040506070809FFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1FFFFFFFFFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1F";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L311-L311) 


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

27: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/dss/186-2rsatestvectors.zip


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L27-L27) 


</details>


### [NC&#x2011;38] Missing event and or timelock for critical parameter change 
Events help non-contract tools to track changes, and events prevent users from being surprised by changes


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/BridgedERC20.sol

80:     function setSnapshoter(address _snapshooter) external onlyOwner {
81:         snapshooter = _snapshooter;
82:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L82) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
66:         _trustedUserMrSigner[_mrSigner] = _trusted;
67:     }

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
70:         _trustedUserMrEnclave[_mrEnclave] = _trusted;
71:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L67) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L71)


</details>


### [NC&#x2011;39] Some error strings are not descriptive 
Consider adding more detail to these error strings


*There are 16 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/Bytes.sol

//@audit This message need more details : slice_overflow
25:             require(_length + 31 >= _length, "slice_overflow");

//@audit This message need more details : slice_overflow
26:             require(_start + _length >= _start, "slice_overflow");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L26-L26)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit This message need more details : onlyOwner
61:         require(msg.sender == owner, "onlyOwner");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L61-L61) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit This message need more details : Not positive
143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

//@audit This message need more details : Not positive
156:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

//@audit This message need more details : ixf Not 0
182:         require(der[ptr.ixf()] == 0x00, "ixf Not 0");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L182-L182)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit This message need more details : invalid offset
25:         require(offset + len <= self.length, "invalid offset");

//@audit This message need more details : invalid idx
199:         require(idx + 2 <= self.length, "invalid idx");

//@audit This message need more details : unexpected idx
212:         require(idx + 4 <= self.length, "unexpected idx");

//@audit This message need more details : unexpected idx
225:         require(idx + 32 <= self.length, "unexpected idx");

//@audit This message need more details : unexpected idx
238:         require(idx + 20 <= self.length, "unexpected idx");

//@audit This message need more details : unexpected len
264:         require(len <= 32, "unexpected len");

//@audit This message need more details : unexpected idx
265:         require(idx + len <= self.length, "unexpected idx");

//@audit This message need more details : unexpected len
329:         require(len <= 52, "unexpected len");

//@audit This message need more details : invalid char
335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

//@audit This message need more details : invalid decoded
337:             require(decoded <= 0x20, "invalid decoded");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L265-L265), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L329-L329), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L335-L335), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L337-L337)


</details>


### [NC&#x2011;40] The `nonReentrant` `modifier` should occur before all other modifiers 
This is a best-practice to protect against reentrancy in other modifiers


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/GuardianProver.sol

35:     function approve(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L35-L35) 


```solidity

File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L53) 


```solidity

File: /contracts/L2/TaikoL2.sol

163:     function withdraw(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L163) 


```solidity

File: /contracts/bridge/Bridge.sol

101:     function banAddress(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L101-L101) 


</details>


### [NC&#x2011;41] Events that mark critical parameter changes should contain both the old and the new value 
This should especially be done if the new value is not required to be different from the old value


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/Guardians.sol

37:     event GuardiansUpdated(uint32 version, address[] guardians);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L37-L37) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

18:     event ConfigAndExcessChanged(Config config, uint64 gasExcess);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L18-L18) 


```solidity

File: /contracts/bridge/IBridge.sol

92:     event MessageStatusChanged(bytes32 indexed msgHash, Status status);

102:     event AddressBanned(address indexed addr, bool banned);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L92-L92) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L102-L102)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

21:     event MigrationStatusChanged(address addr, bool inbound);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L21-L21) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

65:     event InstanceAdded(
66:         uint256 indexed id, address indexed instance, address replaced, uint256 validSince
67:     );

72:     event InstanceDeleted(uint256 indexed id, address indexed instance);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L65-L67) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L72-L72)


</details>


### [NC&#x2011;42] Use of `override` is unnecessary 
Starting with Solidity version [0.8.8](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding), using the `override` keyword when the function solely overrides an interface function, and the function doesn't exist in multiple base contracts, is unnecessary.


*There are 38 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

54:     function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {

58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58)


```solidity

File: /contracts/common/EssentialContract.sol

114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

111:     function votingDelay() public pure override returns (uint256) {

117:     function votingPeriod() public pure override returns (uint256) {

123:     function proposalThreshold() public pure override returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L123-L123)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

24:     function getMinDelay() public view override returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L24-L24) 


```solidity

File: /contracts/L1/TaikoL1.sol

124:     function unpause() public override {

186:     function getConfig() public view virtual override returns (TaikoData.Config memory) {

220:     function _authorizePause(address)
221:         internal
222:         view
223:         virtual
224:         override


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L124-L124) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L186-L186), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L224)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

47:     function getTierIds() public pure override returns (uint16[] memory tiers_) {

54:     function getMinTier(uint256) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L54-L54)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

58:     function getTierIds() public pure override returns (uint16[] memory tiers_) {

66:     function getMinTier(uint256 _rand) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L66-L66)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

58:     function getTierIds() public pure override returns (uint16[] memory tiers_) {

66:     function getMinTier(uint256 _rand) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L66-L66)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

43:     function getConfig() public view override returns (Config memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L43-L43) 


```solidity

File: /contracts/signal/SignalService.sol

231:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231) 


```solidity

File: /contracts/bridge/Bridge.sol

115:     function sendMessage(Message calldata _message)
116:         external
117:         payable
118:         override

461:     function _authorizePause(address)
462:         internal
463:         view
464:         virtual
465:         override


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L115-L118) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L461-L465)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

43:     function _mintToken(address _account, uint256 _amount) internal override {

47:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

129:     function _mintToken(address _account, uint256 _amount) internal override {

133:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L129-L129) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L133-L133)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

115:     function _beforeTokenTransfer(
116:         address, /*_from*/
117:         address _to,
118:         uint256, /*_firstTokenId*/
119:         uint256 /*_batchSize*/
120:     )
121:         internal
122:         virtual
123:         override


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L123) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

125:     function _beforeTokenTransfer(
126:         address, /*_operator*/
127:         address, /*_from*/
128:         address _to,
129:         uint256[] memory, /*_ids*/
130:         uint256[] memory, /*_amounts*/
131:         bytes memory /*_data*/
132:     )
133:         internal
134:         virtual
135:         override


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L135) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

39:     function supportsInterface(bytes4 _interfaceId) public view virtual override returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L39-L39) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

127:     function onMessageRecalled(
128:         IBridge.Message calldata message,
129:         bytes32 msgHash
130:     )
131:         external
132:         payable
133:         override

204:     function name() public pure override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L127-L133) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L204-L204)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

285:     function onMessageRecalled(
286:         IBridge.Message calldata _message,
287:         bytes32 _msgHash
288:     )
289:         external
290:         payable
291:         override

316:     function name() public pure override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L285-L291) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L316-L316)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

110:     function onMessageRecalled(
111:         IBridge.Message calldata _message,
112:         bytes32 _msgHash
113:     )
114:         external
115:         payable
116:         override

156:     function name() public pure override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L110-L116) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L156-L156)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {

355:     function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
356:         external
357:         view
358:         override


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L138) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355-L358)


</details>


### [NC&#x2011;43] Use OpenZeppelin's `MerkleProof` rather than rolling your own 
Use [MerkleProof](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/8b2ed0f5706fe1a7ab6ade84b27bf875dc611fda/contracts/utils/cryptography/MerkleProof.sol#L6-L20) for handling Merkle tree proofs, since the general advice is don't roll your own crypto


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

1: // SPDX-License-Identifier: MIT


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L1-L1) 


</details>


### [NC&#x2011;44] Functions which are either private or internal should have a preceding _ in their name 
Add a preceding underscore to the function name, take care to refactor where there functions are called 


*There are 95 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

30:     function evaluatePoint(
31:         bytes32 _blobHash,
32:         uint256 _x,
33:         uint256 _y,
34:         bytes1[48] memory _commitment,
35:         bytes1[48] memory _pointProof
36:     )
37:         internal
38:         view
39:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L30-L39) 


```solidity

File: /contracts/libs/LibAddress.sol

22:     function sendEther(address _to, uint256 _amount, uint256 _gasLimit) internal {

42:     function sendEther(address _to, uint256 _amount) internal {

46:     function supportsInterface(
47:         address _addr,
48:         bytes4 _interfaceId
49:     )
50:         internal
51:         view
52:         returns (bool result_)

61:     function isValidSignature(
62:         address _addr,
63:         bytes32 _hash,
64:         bytes memory _sig
65:     )
66:         internal
67:         view
68:         returns (bool)

77:     function isSenderEOA() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L77-L77)


```solidity

File: /contracts/libs/LibMath.sol

12:     function min(uint256 _a, uint256 _b) internal pure returns (uint256) {

20:     function max(uint256 _a, uint256 _b) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L20-L20)


```solidity

File: /contracts/libs/LibTrieProof.sol

34:     function verifyMerkleProof(
35:         bytes32 _rootHash,
36:         address _addr,
37:         bytes32 _slot,
38:         bytes32 _value,
39:         bytes[] memory _accountProof,
40:         bytes[] memory _storageProof
41:     )
42:         internal
43:         pure
44:         returns (bytes32 storageRoot_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L34-L44) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

29:     function depositEtherToL2(
30:         TaikoData.State storage _state,
31:         TaikoData.Config memory _config,
32:         IAddressResolver _resolver,
33:         address _recipient
34:     )
35:         internal
36:     {

67:     function processDeposits(
68:         TaikoData.State storage _state,
69:         TaikoData.Config memory _config,
70:         address _feeRecipient
71:     )
72:         internal
73:         returns (TaikoData.EthDeposit[] memory deposits_)

122:     function canDepositEthToL2(
123:         TaikoData.State storage _state,
124:         TaikoData.Config memory _config,
125:         uint256 _amount
126:     )
127:         internal
128:         view
129:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L29-L36) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L67-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L122-L129)


```solidity

File: /contracts/L1/libs/LibProposing.sol

68:     function proposeBlock(
69:         TaikoData.State storage _state,
70:         TaikoData.Config memory _config,
71:         IAddressResolver _resolver,
72:         bytes calldata _data,
73:         bytes calldata _txList
74:     )
75:         internal
76:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)

287:     function isBlobReusable(
288:         TaikoData.State storage _state,
289:         TaikoData.Config memory _config,
290:         bytes32 _blobHash
291:     )
292:         internal
293:         view
294:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L76) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L287-L294)


```solidity

File: /contracts/L1/libs/LibProving.sol

091:     function proveBlock(
092:         TaikoData.State storage _state,
093:         TaikoData.Config memory _config,
094:         IAddressResolver _resolver,
095:         TaikoData.BlockMetadata memory _meta,
096:         TaikoData.Transition memory _tran,
097:         TaikoData.TierProof memory _proof
098:     )
099:         internal
100:         returns (uint8 maxBlocksToVerify_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L100) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

70:     function getTransitionId(
71:         TaikoData.State storage _state,
72:         TaikoData.Block storage _blk,
73:         uint64 _slot,
74:         bytes32 _parentHash
75:     )
76:         internal
77:         view
78:         returns (uint32 tid_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L70-L78) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

85:     function verifyBlocks(
86:         TaikoData.State storage _state,
87:         TaikoData.Config memory _config,
88:         IAddressResolver _resolver,
89:         uint64 _maxBlocksToVerify
90:     )
91:         internal
92:     {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L85-L92) 


```solidity

File: /contracts/L1/provers/Guardians.sol

111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {

124:     function deleteApproval(bytes32 _hash) internal {

128:     function isApproved(uint256 _approvalBits) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L128-L128)


```solidity

File: /contracts/L2/Lib1559Math.sol

16:     function basefee(
17:         uint256 _gasExcess,
18:         uint256 _adjustmentFactor
19:     )
20:         internal
21:         pure
22:         returns (uint256)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L16-L22) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

47:     function checkProcessMessageContext()
48:         internal
49:         view
50:         onlyFromBridge
51:         returns (IBridge.Context memory ctx_)

58:     function checkRecallMessageContext()
59:         internal
60:         view
61:         onlyFromBridge
62:         returns (IBridge.Context memory ctx_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L47-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L58-L62)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

11:     function validateInputs(
12:         address _srcToken,
13:         uint256 _srcChainId,
14:         string memory _symbol,
15:         string memory _name
16:     )
17:         internal
18:         view
19:     {

28:     function buildName(
29:         string memory _name,
30:         uint256 _srcChainId
31:     )
32:         internal
33:         pure
34:         returns (string memory)

39:     function buildSymbol(string memory _symbol) internal pure returns (string memory) {

43:     function buildURI(
44:         address _srcToken,
45:         uint256 _srcChainId
46:     )
47:         internal
48:         pure
49:         returns (string memory)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L11-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L49)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25:     function excessivelySafeCall(
26:         address _target,
27:         uint256 _gas,
28:         uint256 _value,
29:         uint16 _maxCopy,
30:         bytes memory _calldata
31:     )
32:         internal
33:         returns (bool, bytes memory)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L33) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

15:     function slice(
16:         bytes memory _bytes,
17:         uint256 _start,
18:         uint256 _length
19:     )
20:         internal
21:         pure
22:         returns (bytes memory)

91:     function slice(bytes memory _bytes, uint256 _start) internal pure returns (bytes memory) {

102:     function toNibbles(bytes memory _bytes) internal pure returns (bytes memory) {

149:     function equal(bytes memory _bytes, bytes memory _other) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L15-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L149-L149)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

35:     function toRLPItem(bytes memory _in) internal pure returns (RLPItem memory out_) {

53:     function readList(RLPItem memory _in) internal pure returns (RLPItem[] memory out_) {

102:     function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {

109:     function readBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {

128:     function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {

135:     function readRawBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L135-L135)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

13:     function writeBytes(bytes memory _in) internal pure returns (bytes memory out_) {

24:     function writeUint(uint256 _in) internal pure returns (bytes memory out_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L24-L24)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

50:     function verifyInclusionProof(
51:         bytes memory _key,
52:         bytes memory _value,
53:         bytes[] memory _proof,
54:         bytes32 _root
55:     )
56:         internal
57:         pure
58:         returns (bool valid_)

68:     function get(
69:         bytes memory _key,
70:         bytes[] memory _proof,
71:         bytes32 _root
72:     )
73:         internal
74:         pure
75:         returns (bytes memory value_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L50-L58) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68-L75)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

19:     function verifyInclusionProof(
20:         bytes memory _key,
21:         bytes memory _value,
22:         bytes[] memory _proof,
23:         bytes32 _root
24:     )
25:         internal
26:         pure
27:         returns (bool valid_)

38:     function get(
39:         bytes memory _key,
40:         bytes[] memory _proof,
41:         bytes32 _root
42:     )
43:         internal
44:         pure
45:         returns (bytes memory value_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L19-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L38-L45)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

21:     function parseInput(
22:         bytes memory quote,
23:         address pemCertLibAddr
24:     )
25:         internal
26:         pure
27:         returns (bool success, V3Struct.ParsedV3QuoteStruct memory v3ParsedQuote)

62:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
63:         internal
64:         pure
65:         returns (

133:     function parseEnclaveReport(bytes memory rawEnclaveReport)
134:         internal
135:         pure
136:         returns (V3Struct.EnclaveReport memory enclaveReport)

152:     function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {

165:     function parseAndVerifyHeader(bytes memory rawHeader)
166:         private
167:         pure
168:         returns (bool success, V3Struct.Header memory header)

203:     function parseAuthDataAndVerifyCertType(
204:         bytes memory rawAuthData,
205:         address pemCertLibAddr
206:     )
207:         private
208:         pure
209:         returns (bool success, V3Struct.ECDSAQuoteV3AuthData memory authDataV3)

244:     function packQEReport(V3Struct.EnclaveReport memory enclaveReport)
245:         internal
246:         pure
247:         returns (bytes memory packedQEReport)

267:     function parseCerificationChainBytes(
268:         bytes memory certBytes,
269:         address pemCertLibAddr
270:     )
271:         internal
272:         pure
273:         returns (bytes[3] memory certChainData)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L209), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L244-L247), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L273)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

14:     function ixs(uint256 self) internal pure returns (uint256) {

19:     function ixf(uint256 self) internal pure returns (uint256) {

24:     function ixl(uint256 self) internal pure returns (uint256) {

29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {

47:     function root(bytes memory der) internal pure returns (uint256) {

56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

66:     function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

87:     function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

16:     function keccak(
17:         bytes memory self,
18:         uint256 offset,
19:         uint256 len
20:     )
21:         internal
22:         pure
23:         returns (bytes32 ret)

39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

56:     function compare(
57:         bytes memory self,
58:         uint256 offset,
59:         uint256 len,
60:         bytes memory other,
61:         uint256 otheroffset,
62:         uint256 otherlen
63:     )
64:         internal
65:         pure
66:         returns (int256)

116:     function equals(
117:         bytes memory self,
118:         uint256 offset,
119:         bytes memory other,
120:         uint256 otherOffset,
121:         uint256 len
122:     )
123:         internal
124:         pure
125:         returns (bool)

138:     function equals(
139:         bytes memory self,
140:         uint256 offset,
141:         bytes memory other,
142:         uint256 otherOffset
143:     )
144:         internal
145:         pure
146:         returns (bool)

160:     function equals(
161:         bytes memory self,
162:         uint256 offset,
163:         bytes memory other
164:     )
165:         internal
166:         pure
167:         returns (bool)

178:     function equals(bytes memory self, bytes memory other) internal pure returns (bool) {

188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {

198:     function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {

211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

224:     function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {

237:     function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {

255:     function readBytesN(
256:         bytes memory self,
257:         uint256 idx,
258:         uint256 len
259:     )
260:         internal
261:         pure
262:         returns (bytes32 ret)

272:     function memcpy(uint256 dest, uint256 src, uint256 len) private pure {

284:     function substring(
285:         bytes memory self,
286:         uint256 offset,
287:         uint256 len
288:     )
289:         internal
290:         pure
291:         returns (bytes memory)

320:     function base32HexDecodeWord(
321:         bytes memory self,
322:         uint256 off,
323:         uint256 len
324:     )
325:         internal
326:         pure
327:         returns (bytes32)

371:     function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L16-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L125), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L146), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L167), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L211-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L255-L262), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L291), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L327), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L371-L371)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

43:     function pkcs1Sha256(
44:         bytes32 _sha256,
45:         bytes memory _s,
46:         bytes memory _e,
47:         bytes memory _m
48:     )
49:         internal
50:         view
51:         returns (bool)

191:     function pkcs1Sha256Raw(
192:         bytes memory _data,
193:         bytes memory _s,
194:         bytes memory _e,
195:         bytes memory _m
196:     )
197:         internal
198:         view
199:         returns (bool)

212:     function pkcs1Sha1(
213:         bytes20 _sha1,
214:         bytes memory _s,
215:         bytes memory _e,
216:         bytes memory _m
217:     )
218:         internal
219:         view
220:         returns (bool)

307:     function pkcs1Sha1Raw(
308:         bytes memory _data,
309:         bytes memory _s,
310:         bytes memory _e,
311:         bytes memory _m
312:     )
313:         internal
314:         view
315:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L43-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L191-L199), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L212-L220), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L307-L315)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

11:     function sha1(bytes memory data) internal pure returns (bytes20 ret) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L11-L11) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {

34:     function toUnixTimestamp(
35:         uint16 year,
36:         uint8 month,
37:         uint8 day,
38:         uint8 hour,
39:         uint8 minute,
40:         uint8 second
41:     )
42:         internal
43:         pure
44:         returns (uint256)

71:     function isLeapYear(uint16 year) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L44), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L71-L71)


</details>


### [NC&#x2011;45] Private and internal state variables should have a preceding _ in their name unless they are constants 
Add a preceding underscore to the state variable name, take care to refactor where there variables are read/wrote


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/utils/SigVerifyLib.sol

18:     address private ES256VERIFIER;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L18-L18) 


</details>


### [NC&#x2011;46] `public` functions not called by the contract should be declared `external` instead 
Contracts [are allowed](https://docs.soliditylang.org/en/latest/contracts.html#function-overriding) to override their parents' functions and change the visibility from `external` to `public`.


*There are 36 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

69:     function pause() public virtual whenNotPaused {

78:     function unpause() public virtual whenPaused {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L78-L78)


```solidity

File: /contracts/L1/provers/Guardians.sol

107:     function numGuardians() public view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L107-L107) 


```solidity

File: /contracts/L1/TaikoL1.sol

132:     function canDepositEthToL2(uint256 _amount) public view returns (bool) {

137:     function isBlobReusable(bytes32 _blobHash) public view returns (bool) {

145:     function getBlock(uint64 _blockId)

162:     function getTransition(

176:     function getStateVariables()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L132-L132) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L176-L176)


```solidity

File: /contracts/L1/TaikoToken.sol

25:     function init(

47:     function burn(address _from, uint256 _amount) public onlyOwner {

52:     function snapshot() public onlyFromOwnerOrNamed("snapshooter") {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L52-L52)


```solidity

File: /contracts/L2/TaikoL2.sol

185:     function getBasefee(

200:     function getBlockHash(uint64 _blockId) public view returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L185-L185) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L200-L200)


```solidity

File: /contracts/signal/SignalService.sol

83:     function proveSignalReceived(

137:     function isChainDataSynced(

153:     function isSignalSent(address _app, bytes32 _signal) public view returns (bool) {

158:     function getSyncedChainData(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L83) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L153-L153), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L158-L158)


```solidity

File: /contracts/bridge/Bridge.sol

340:     function isMessageSent(Message calldata _message) public view returns (bool) {

352:     function proveMessageFailed(

374:     function proveMessageReceived(

403:     function context() public view returns (Context memory ctx_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L340-L340) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L374-L374), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L403-L403)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

125:     function canonical() public view returns (address, uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L125-L125) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

57:     function mint(address _account, uint256 _amount) public nonReentrant whenNotPaused {

75:     function burn(address _account, uint256 _amount) public nonReentrant whenNotPaused {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L75-L75)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

54:     function mint(

69:     function burn(

100:     function source() public view returns (address, uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L100-L100)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

66:     function mint(

83:     function mintBatch(

100:     function burn(

115:     function name() public view returns (string memory) {

121:     function symbol() public view returns (string memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L66-L66) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L115-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L121-L121)


```solidity

File: /contracts/team/TimelockTokenPool.sol

204:     function getMyGrant(address _recipient) public view returns (Grant memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L204-L204) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

103:     function configureTcbInfoJson(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L103) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

24:     function verifyAttStmtSignature(

54:     function verifyCertificateSignature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L54)


</details>


### [NC&#x2011;47] Adding a `return` statement when the function defines a named return variable, is redundant 
Once the return variable has been assigned (or has its default value), there is no need to explicitly return it at the end of the function, since it's returned automatically.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

288:             return out_;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L288-L288) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

130:                     return value_;

183:                     return value_;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L130-L130) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L183-L183)


</details>


### [NC&#x2011;48] Redundant inheritance specifier 
The contracts below already extend the specified contract, so there is no need to list it in the inheritance list again


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

//@audit `GovernorVotesUpgradeable` is already inherited by `GovernorVotesQuorumFractionUpgradeable` 
16: contract TaikoGovernor is
17:     EssentialContract,
18:     GovernorCompatibilityBravoUpgradeable,
19:     GovernorVotesUpgradeable,
20:     GovernorVotesQuorumFractionUpgradeable,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L16-L20) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit `IERC20MetadataUpgradeable` is already inherited by `ERC20SnapshotUpgradeable` 
15: contract BridgedERC20 is
16:     BridgedERC20Base,
17:     IERC20MetadataUpgradeable,
18:     ERC20SnapshotUpgradeable,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L15-L18) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit `IERC1155MetadataURIUpgradeable` is already inherited by `ERC1155Upgradeable` 
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L14-L14) 


</details>


### [NC&#x2011;49] `require()` / `revert()` statements should have descriptive reason strings 



*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

198:         revert("MerkleTrie: ran out of proof elements");

194:                 revert("MerkleTrie: received an unparseable node");

191:                     revert("MerkleTrie: received a node with an unknown prefix");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L198-L198) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L191-L191)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

365:             revert("unexpected len");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L365-L365) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

75:             revert("Unsupported algorithm");

50:             revert("Unsupported algorithm");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L75-L75) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L50-L50)


</details>


### [NC&#x2011;50] Setters should prevent re-setting of the same value 
This especially problematic when the setter also emits the same value, which may be confusing to offline parsers


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/Guardians.sol

//@audit `minGuardians` and `_minGuardians` are never checked for the same value setting
53:     function setGuardians(
54:         address[] memory _newGuardians,
55:         uint8 _minGuardians
56:     )
57:         external
58:         onlyOwner
59:         nonReentrant
60:     {
61:         // We need at least MIN_NUM_GUARDIANS and at most 255 guardians (so the approval bits fit in
62:         // a uint256)
63:         if (_newGuardians.length < MIN_NUM_GUARDIANS || _newGuardians.length > type(uint8).max) {
64:             revert INVALID_GUARDIAN_SET();
65:         }
66:         // Minimum number of guardians to approve is at least equal or greater than half the
67:         // guardians (rounded up) and less or equal than the total number of guardians
68:         if (_minGuardians < (_newGuardians.length + 1) >> 1 || _minGuardians > _newGuardians.length)
69:         {
70:             revert INVALID_MIN_GUARDIANS();
71:         }
72: 
73:         // Delete the current guardians
74:         for (uint256 i; i < guardians.length; ++i) {
75:             delete guardianIds[guardians[i]];
76:         }
77:         delete guardians;
78: 
79:         // Set the new guardians
80:         for (uint256 i = 0; i < _newGuardians.length; ++i) {
81:             address guardian = _newGuardians[i];
82:             if (guardian == address(0)) revert INVALID_GUARDIAN();
83:             // This makes sure there are not duplicate addresses
84:             if (guardianIds[guardian] != 0) revert INVALID_GUARDIAN_SET();
85: 
86:             // Save and index the guardian
87:             guardians.push(guardian);
88:             guardianIds[guardian] = guardians.length;
89:         }
90: 
91:         // Bump the version so previous approvals get invalidated
92:         ++version;
93: 
94:         minGuardians = _minGuardians;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L94) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

//@audit `customConfig` and `_newConfig` are never checked for the same value setting
25:     function setConfigAndExcess(
26:         Config memory _newConfig,
27:         uint64 _newGasExcess
28:     )
29:         external
30:         virtual
31:         onlyOwner
32:     {
33:         if (_newConfig.gasTargetPerL1Block == 0) revert L2_INVALID_CONFIG();
34:         if (_newConfig.basefeeAdjustmentQuotient == 0) revert L2_INVALID_CONFIG();
35: 
36:         customConfig = _newConfig;

//@audit `gasExcess` and `_newGasExcess` are never checked for the same value setting
25:     function setConfigAndExcess(
26:         Config memory _newConfig,
27:         uint64 _newGasExcess
28:     )
29:         external
30:         virtual
31:         onlyOwner
32:     {
33:         if (_newConfig.gasTargetPerL1Block == 0) revert L2_INVALID_CONFIG();
34:         if (_newConfig.basefeeAdjustmentQuotient == 0) revert L2_INVALID_CONFIG();
35: 
36:         customConfig = _newConfig;
37:         gasExcess = _newGasExcess;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L25-L36) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L25-L37)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit `snapshooter` and `_snapshooter` are never checked for the same value setting
80:     function setSnapshoter(address _snapshooter) external onlyOwner {
81:         snapshooter = _snapshooter;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L81) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

//@audit `claimStart` and `_claimStart` are never checked for the same value setting
90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {
91:         claimStart = _claimStart;

//@audit `claimEnd` and `_claimEnd` are never checked for the same value setting
90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {
91:         claimStart = _claimStart;
92:         claimEnd = _claimEnd;

//@audit `merkleRoot` and `_merkleRoot` are never checked for the same value setting
90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {
91:         claimStart = _claimStart;
92:         claimEnd = _claimEnd;
93:         merkleRoot = _merkleRoot;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L91) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L93)


</details>


### [NC&#x2011;51] NatSpec `@return` argument is missing 



*There are 20 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

// @audit the @return is missing
@dev See {IGovernor-propose}

// @audit the @return is missing
@notice An overwrite of GovernorCompatibilityBravoUpgradeable's propose() as that one does
 not check that the length of signatures equal the calldata.
 @dev See vulnerability description here:
 https://github.com/taikoxyz/taiko-mono/security/dependabot/114
 See fix in OZ 4.8.3 here (URL broken down for readability):
 https://github.com/OpenZeppelin/openzeppelin-contracts/blob/
 0a25c1940ca220686588c4af3ec526f725fe2582/contracts/governance/compatibility/GovernorCompatibilityBravo.sol#L72
 See {GovernorCompatibilityBravoUpgradeable-propose}

// @audit the @return is missing
@dev See {GovernorUpgradeable-supportsInterface}

// @audit the @return is missing
@dev See {GovernorUpgradeable-state}


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L48-L1) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L69-L1), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L89-L1), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L99-L1)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

// @audit the @return is missing
@dev Processes the ETH deposits in a batched manner.

// @audit the @return is missing
@dev Checks if Ether deposit is allowed for Layer 2.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L67-L1) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L122-L1)


```solidity

File: /contracts/L1/libs/LibProving.sol

// @audit the @return is missing
@dev Proves or contests a block transition.
 @param _state Current TaikoData.State.
 @param _config Actual TaikoData.Config.
 @param _resolver Address resolver interface.
 @param _meta The block's metadata.
 @param _tran The transition data.
 @param _proof The proof.
 @param maxBlocksToVerify_ The number of blocks to be verified with this transaction.

// @audit the @return is missing
@dev Handle the transition initialization logic


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L1) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L269-L1)


```solidity

File: /contracts/L1/libs/LibUtils.sol

// @audit the @return is missing
@dev Retrieves a block based on its ID.
 @param _state Current TaikoData.State.
 @param _config Actual TaikoData.Config.
 @param _blockId Id of the block.

// @audit the @return is missing
@dev Retrieves the ID of the transition with a given parentHash.
 This function will return 0 if the transition is not found.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L52-L1) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L70-L1)


```solidity

File: /contracts/L1/TaikoL1.sol

// @audit the @return is missing
@notice See {LibProposing-isBlobReusable}.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L137-L1) 


```solidity

File: /contracts/L2/Lib1559Math.sol

// @audit the @return is missing
@dev eth_qty(excess_gas_issued) / (TARGET * ADJUSTMENT_QUOTIENT)
 @param _gasExcess TBD
 @param _adjustmentFactor The product of gasTarget and adjustmentQuotient

// @audit the @return is missing
@dev exp(gas_qty / TARGET / ADJUSTMENT_QUOTIENT)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L16-L1) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L33-L1)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

// @audit the @return is missing
@notice Returns the name of the token.

// @audit the @return is missing
@notice Returns the symbol of the token.

// @audit the @return is missing
@notice See {ERC1155ReceiverUpgradeable-onERC1155BatchReceived}.

// @audit the @return is missing
@notice See {ERC1155ReceiverUpgradeable-onERC1155Received}.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L18-L1) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L21-L1), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L160-L1), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L175-L1)


```solidity

File: /contracts/team/TimelockTokenPool.sol

// @audit the @return is missing
@notice Returns the summary of the grant for a given recipient.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L176-L1) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

// @audit the @return is missing
@dev Provide the raw quote binary as input
 @dev The attestation data (or the returned data of this method)
 is constructed depending on the validity of the quote verification.
 @dev After confirming that a quote has been verified, the attestation's validity then
 depends on the
 status of the associated TCB.
 @dev Example scenarios as below:
 --------------------------------
 @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
 @dev For all valid quote verification, the validity of the attestation depends on the status
 of a
 matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
 overwritten
 in derived contracts. (Except for "Revoked" status, which also returns (false,
 INVALID_EXIT_CODE) value)
 @dev For all valid quote verification, returns the following data:
 (_attestationTcbIsValid(), abi.encodePacked(sha256(quote), uint8 exitCode))
 @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum

// @audit the @return is missing
@dev Provide the parsed quote binary as input
 @dev The attestation data (or the returned data of this method)
 is constructed depending on the validity of the quote verification.
 @dev After confirming that a quote has been verified, the attestation's validity then
 depends on the
 status of the associated TCB.
 @dev Example scenarios as below:
 --------------------------------
 @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
 @dev For all valid quote verification, the validity of the attestation depends on the status
 of a
 matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
 overwritten
 in derived contracts. (Except for "Revoked" status, which also returns (false,
 INVALID_EXIT_CODE) value)
 @dev For all valid quote verification, returns the following data:
 (_attestationTcbIsValid())
 @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L162-L1) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355-L1)


</details>


### [NC&#x2011;52] Consider using `SafeTransferLib.safeTransferETH()` or `Address.sendValue()` for clearer semantic meaning 
These Functions indicate their purpose with their name more clearly than using low-level calls.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/CrossChainOwned.sol

50:         (bool success,) = address(this).call(txdata);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L50-L50) 


</details>


### [NC&#x2011;53] Polymorphic functions make security audits more time-consuming and error-prone 
The instances below point to one of two functions with the same name. Consider naming each function differently, in order to make code navigation and analysis easier.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

69:     function propose(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L69-L69) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

204:     function name() public pure override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L204-L204) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

168:     function withdraw(address _to, bytes memory _sig) external {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L168-L168) 


</details>


### [NC&#x2011;54] Large multiples of ten should use scientific notation (e.g. `1e6`) rather than decimal literals (e.g. `1000000`), for readability 
While the compiler knows to optimize away the exponentiation, it's still better coding practice to use idioms that do not require compiler optimization, if they exist


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

//@audit `10_000`
124:         return 1_000_000_000 ether / 10_000; // 0.01% of Taiko Token


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L124-L124) 


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit `10_000`
213:             ethDepositMaxAmount: 10_000 ether,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L213-L213) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

//@audit `1000`
48:     uint16 public constant TIER_GUARDIAN = 1000;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L48-L48) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit `1000`
68:         if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;

//@audit `1000`
36:                 contestBond: 1000 ether, // TKO


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L36-L36)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit `1000`
36:                 contestBond: 1000 ether, // TKO


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L36-L36) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

//@audit `1000`
21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21) 


</details>


### [NC&#x2011;55] Empty `receive()`/`payable fallback()` function does not authorize requests 
If the intention is for the Ether to be used, the function should call another function, otherwise it should revert (e.g. `require(msg.sender == address(weth))`). Having no access control on the function means that someone may send Ether to the contract, and have no way to get anything back out, which is a loss of funds. If the concern is having to spend a small amount of gas to check the sender against an immutable address, the code should at least have a function to rescue unused Ether.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/bridge/Bridge.sol

70:     receive() external payable { }
71: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L70-L71) 


</details>


### [NC&#x2011;56] State variables should have `Natspec` comments 
Consider adding some `Natspec` comments on critical state variables to explain what they are supposed to do: this will help for future code reviews.


*There are 73 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

//@audit __gap need comments
14:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L14-L14) 


```solidity

File: /contracts/common/EssentialContract.sol

//@audit _FALSE need comments
11:     uint8 private constant _FALSE = 1;

//@audit _TRUE need comments
13:     uint8 private constant _TRUE = 2;

//@audit __paused need comments
23:     uint8 private __paused;

//@audit __gap need comments
25:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L25-L25)


```solidity

File: /contracts/libs/LibAddress.sol

//@audit _EIP1271_MAGICVALUE need comments
14:     bytes4 private constant _EIP1271_MAGICVALUE = 0x1626ba7e;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L14-L14) 


```solidity

File: /contracts/libs/LibTrieProof.sol

//@audit _ACCOUNT_FIELD_INDEX_STORAGE_HASH need comments
18:     uint256 private constant _ACCOUNT_FIELD_INDEX_STORAGE_HASH = 2;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L18-L18) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

//@audit __gap need comments
23:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L23-L23) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

//@audit __gap need comments
10:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L10-L10) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

//@audit __gap need comments
40:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L40-L40) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

//@audit __gap need comments
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L11-L11) 


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit __gap need comments
32:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L32-L32) 


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit __gap need comments
26:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L26-L26) 


```solidity

File: /contracts/L1/TaikoToken.sol

//@audit __gap need comments
16:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L16-L16) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit __gap need comments
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit __gap need comments
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit __gap need comments
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit __gap need comments
21:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L21-L21) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit __gap need comments
52:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L52-L52) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

//@audit __gap need comments
13:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L13-L13) 


```solidity

File: /contracts/signal/SignalService.sol

//@audit __gap need comments
23:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L23-L23) 


```solidity

File: /contracts/bridge/Bridge.sol

//@audit __gap need comments
48:     uint256[43] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L48-L48) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

//@audit __gap need comments
32:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit __srcDecimals need comments
24:     uint8 private __srcDecimals;

//@audit __gap need comments
32:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L32-L32)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

//@audit __gap need comments
16:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L16-L16) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

//@audit __gap need comments
19:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L19-L19) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit __gap need comments
27:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L27-L27) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

//@audit __gap need comments
61:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L61-L61) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit __gap need comments
18:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L18-L18) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit __gap need comments
32:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit __gap need comments
54:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L54-L54) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit __gap need comments
19:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L19-L19) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

//@audit LOW_28_MASK need comments
6:     uint256 constant LOW_28_MASK =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6-L6) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

//@audit __gap need comments
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L11-L11) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit __gap need comments
57:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L57-L57) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

//@audit __gap need comments
18:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L18-L18) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit __gap need comments
30:     uint256[45] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L30-L30) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

//@audit __gap need comments
16:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L16-L16) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

//@audit __gap need comments
23:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L23-L23) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit __gap need comments
82:     uint128[44] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L82-L82) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit sigVerifyLib need comments
25:     ISigVerifyLib public immutable sigVerifyLib;

//@audit pemCertLib need comments
26:     IPEMCertChainLib public immutable pemCertLib;

//@audit CPUSVN_LENGTH need comments
29:     uint256 internal constant CPUSVN_LENGTH = 16;

//@audit ROOTCA_PUBKEY_HASH need comments
33:     bytes32 internal constant ROOTCA_PUBKEY_HASH =

//@audit INVALID_EXIT_CODE need comments
36:     uint8 internal constant INVALID_EXIT_CODE = 255;

//@audit _checkLocalEnclaveReport need comments
38:     bool private _checkLocalEnclaveReport;

//@audit _trustedUserMrEnclave need comments
39:     mapping(bytes32 enclave => bool trusted) private _trustedUserMrEnclave;

//@audit _trustedUserMrSigner need comments
40:     mapping(bytes32 signer => bool trusted) private _trustedUserMrSigner;

//@audit _serialNumIsRevoked need comments
47:     mapping(uint256 idx => mapping(bytes serialNum => bool revoked)) private _serialNumIsRevoked;

//@audit tcbInfo need comments
49:     mapping(string fmspc => TCBInfoStruct.TCBInfo tcbInfo) public tcbInfo;

//@audit qeIdentity need comments
50:     EnclaveIdStruct.EnclaveId public qeIdentity;

//@audit owner need comments
52:     address public owner;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L52-L52)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit HEADER need comments
17:     string internal constant HEADER = "-----BEGIN CERTIFICATE-----";

//@audit FOOTER need comments
18:     string internal constant FOOTER = "-----END CERTIFICATE-----";

//@audit HEADER_LENGTH need comments
19:     uint256 internal constant HEADER_LENGTH = 27;

//@audit FOOTER_LENGTH need comments
20:     uint256 internal constant FOOTER_LENGTH = 25;

//@audit PCK_COMMON_NAME need comments
22:     string internal constant PCK_COMMON_NAME = "Intel SGX PCK Certificate";

//@audit PLATFORM_ISSUER_NAME need comments
23:     string internal constant PLATFORM_ISSUER_NAME = "Intel SGX PCK Platform CA";

//@audit PROCESSOR_ISSUER_NAME need comments
24:     string internal constant PROCESSOR_ISSUER_NAME = "Intel SGX PCK Processor CA";

//@audit SGX_EXTENSION_OID need comments
25:     bytes internal constant SGX_EXTENSION_OID = hex"2A864886F84D010D01";

//@audit TCB_OID need comments
26:     bytes internal constant TCB_OID = hex"2A864886F84D010D0102";

//@audit PCESVN_OID need comments
27:     bytes internal constant PCESVN_OID = hex"2A864886F84D010D010211";

//@audit PCEID_OID need comments
28:     bytes internal constant PCEID_OID = hex"2A864886F84D010D0103";

//@audit FMSPC_OID need comments
29:     bytes internal constant FMSPC_OID = hex"2A864886F84D010D0104";

//@audit SGX_TCB_CPUSVN_SIZE need comments
32:     uint256 constant SGX_TCB_CPUSVN_SIZE = 16;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L32-L32)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit MINIMUM_QUOTE_LENGTH need comments
14:     uint256 internal constant MINIMUM_QUOTE_LENGTH = 1020;

//@audit SUPPORTED_QUOTE_VERSION need comments
15:     bytes2 internal constant SUPPORTED_QUOTE_VERSION = 0x0300;

//@audit SUPPORTED_ATTESTATION_KEY_TYPE need comments
16:     bytes2 internal constant SUPPORTED_ATTESTATION_KEY_TYPE = 0x0200;

//@audit SUPPORTED_TEE_TYPE need comments
18:     bytes4 internal constant SUPPORTED_TEE_TYPE = 0;

//@audit VALID_QE_VENDOR_ID need comments
19:     bytes16 internal constant VALID_QE_VENDOR_ID = 0x939a7233f79c4ca9940a0db3957f0607;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L19-L19)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit BASE32_HEX_TABLE need comments
310:     bytes constant BASE32_HEX_TABLE =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L310-L310) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

//@audit ES256VERIFIER need comments
18:     address private ES256VERIFIER;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L18-L18) 


</details>


### [NC&#x2011;57] Contracts should have full test coverage 
While 100% code coverage does not guarantee that there are no bugs, it often will catch easy-to-find bugs, and will ensure that there are fewer regressions when the code invariably has to be modified. Furthermore, in order to get full coverage, code authors will often have to re-organize their code so that it is more modular, so that each component can be tested separately, which reduces interdependencies between modules and layers, and makes for code that is easier to reason about and audit.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

@audit Multiple files
1: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L1-L1) 


</details>


### [NC&#x2011;58] Numeric values having to do with time should use time units for readability 
There are [units](https://docs.soliditylang.org/en/latest/units-and-global-variables.html#time-units) for seconds, minutes, hours, days, and weeks, and since they're defined, they should be use


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/utils/X509DateUtils.sol

//@audit the value 86_400,1, should use time units
63:         timestamp += uint256(day - 1) * 86_400; // Days in seconds

//@audit the value 3600, should use time units
64:         timestamp += uint256(hour) * 3600; // Hours in seconds

//@audit the value 60, should use time units
65:         timestamp += uint256(minute) * 60; // Minutes in seconds

//@audit the value 86_400,1, should use time units
60:             timestamp += uint256(monthDays[i - 1]) * 86_400; // Days in seconds

//@audit the value 31_536_000 should use time units
52:                 timestamp += 31_536_000; // Normal year in seconds

//@audit the value 31_622_400 should use time units
50:                 timestamp += 31_622_400; // Leap year in seconds


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L63-L63) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L50-L50)


</details>


### [NC&#x2011;59] [NatSpec] Natspec `@title` is missing from `contract` 



*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/tiers/ITierProvider.sol

36: /// @dev Tier ID cannot be zero!
37: library LibTiers {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L36-L37) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5-L5) 


</details>


### [NC&#x2011;60] Open TODOs 
TODOs may signal that a feature is missing or not ready for audit, consider resolving the issue and removing the TODO comment


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

423:                 // todo! move decodeCert offchain


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L423-L423) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

40:         // todo! In encoded path, we need to calculate the size of certDataArray


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L40-L40) 


</details>


### [NC&#x2011;61] Top level pragma declarations should be separated by two blank lines 



*There are 56 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

2: pragma solidity 0.8.24;
3: 
4: import "./IAddressManager.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L2-L4) 


```solidity

File: /contracts/common/EssentialContract.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/proxy/utils/UUPSUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L2-L4) 


```solidity

File: /contracts/libs/LibAddress.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/Address.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L2-L4) 


```solidity

File: /contracts/libs/LibTrieProof.sol

7: pragma solidity 0.8.24;
8: 
9: import "../thirdparty/optimism/rlp/RLPReader.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L7-L9) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L2-L4) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts-upgradeable/governance/TimelockControllerUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L2-L4) 


```solidity

File: /contracts/L1/hooks/IHook.sol

2: pragma solidity 0.8.24;
3: 
4: import "../TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L2-L4) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L2-L4) 


```solidity

File: /contracts/L1/ITaikoL1.sol

2: pragma solidity 0.8.24;
3: 
4: import "./TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L2-L4) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

2: pragma solidity 0.8.24;
3: 
4: import "../../common/IAddressResolver.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L2-L4) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L2-L4) 


```solidity

File: /contracts/L1/libs/LibProving.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L2-L4) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

2: pragma solidity 0.8.24;
3: 
4: import "../TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L2-L4) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L2-L4) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

2: pragma solidity 0.8.24;
3: 
4: import "../tiers/ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L2-L4) 


```solidity

File: /contracts/L1/provers/Guardians.sol

2: pragma solidity 0.8.24;
3: 
4: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L2-L4) 


```solidity

File: /contracts/L1/TaikoEvents.sol

2: pragma solidity 0.8.24;
3: 
4: import "./TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L2-L4) 


```solidity

File: /contracts/L1/TaikoL1.sol

2: pragma solidity 0.8.24;
3: 
4: import "../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L2-L4) 


```solidity

File: /contracts/L1/TaikoToken.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts-upgradeable/token/ERC20/ERC20Upgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L2-L4) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

2: pragma solidity 0.8.24;
3: 
4: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L2-L4) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

2: pragma solidity 0.8.24;
3: 
4: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L2-L4) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

2: pragma solidity 0.8.24;
3: 
4: import "../../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L2-L4) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L2-L4) 


```solidity

File: /contracts/L2/Lib1559Math.sol

2: pragma solidity 0.8.24;
3: 
4: import "../thirdparty/solmate/LibFixedPointMath.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L2-L4) 


```solidity

File: /contracts/L2/TaikoL2.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L2-L4) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

2: pragma solidity 0.8.24;
3: 
4: import "./TaikoL2.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L2-L4) 


```solidity

File: /contracts/signal/SignalService.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L2-L4) 


```solidity

File: /contracts/bridge/Bridge.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/Address.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

2: pragma solidity 0.8.24;
3: 
4: import "../BridgedERC20Base.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

2: pragma solidity 0.8.24;
3: 
4: import "../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

2: pragma solidity 0.8.24;
3: 
4: import "./BaseVault.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts-upgradeable/utils/introspection/IERC165Upgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC1155/IERC1155.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L2-L4) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L2-L4) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

3: pragma solidity 0.8.24;
4: 
5: library ExcessivelySafeCall {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L3-L5) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

2: pragma solidity 0.8.24;
3: 
4: import { Bytes } from "../Bytes.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L2-L4) 


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

2: pragma solidity 0.8.24;
3: 
4: import { MerkleTrie } from "./MerkleTrie.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L2-L4) 


```solidity

File: /contracts/verifiers/IVerifier.sol

2: pragma solidity 0.8.24;
3: 
4: import "../L1/TaikoData.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L2-L4) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

2: pragma solidity 0.8.24;
3: 
4: import "../common/EssentialContract.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L2-L4) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L2-L4) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L2-L4) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L2-L4) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L2-L4) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L2-L4) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

2: pragma solidity 0.8.24;
3: 
4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L2-L4) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

2: pragma solidity 0.8.24;
3: 
4: import { V3Struct } from "./lib/QuoteV3Auth/V3Struct.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L2-L4) 


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

2: pragma solidity 0.8.24;
3: 
4: import { V3Struct } from "../lib/QuoteV3Auth/V3Struct.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L2-L4) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

2: pragma solidity 0.8.24;
3: 
4: import { LibString } from "solady/src/utils/LibString.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L2-L4) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

2: pragma solidity 0.8.24;
3: 
4: import { Base64 } from "solady/src/utils/Base64.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L2-L4) 


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

3: pragma solidity 0.8.24;
4: 
5: import "./SHA1.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L3-L5) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

2: pragma solidity 0.8.24;
3: 
4: import "../interfaces/ISigVerifyLib.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L2-L4) 


</details>


### [NC&#x2011;62] Critical functions should be a two step procedure 
Critical functions in Solidity contracts should follow a two-step procedure to enhance security, minimize human error, and ensure proper access control. By dividing sensitive operations into distinct phases, such as initiation and confirmation, developers can introduce a safeguard against unintended actions or unauthorized access.


*There are 14 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L53) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

25:     function setConfigAndExcess(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L25-L25) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {

73:     function addRevokedCertSerialNum(

88:     function removeRevokedCertSerialNum(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L88)


```solidity

File: /contracts/bridge/Bridge.sol

101:     function banAddress(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L101-L101) 


```solidity

File: /contracts/common/AddressManager.sol

38:     function setAddress(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L38-L38) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

45:     function setConfig(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L45-L45) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

80:     function setSnapshoter(address _snapshooter) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L80) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

36:     function changeMigrationStatus(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L36-L36) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

148:     function changeBridgedToken(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L148-L148) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

90:     function addInstances(address[] calldata _instances)

100:     function deleteInstances(uint256[] calldata _ids)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L90-L90) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L100-L100)


</details>


### [NC&#x2011;63] `2**<n> - 1` should be re-written as `type(uint<n>).max` 
Earlier versions of solidity can use `uint<n>(-1)` instead. Expressions not including the `- 1` can often be re-written to accomodate the change (e.g. by using a `>` rather than a `>=`, which will also save some gas)


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/utils/BytesUtils.sol

93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93) 


</details>


### [NC&#x2011;64] Uncommented fields in a struct 
Consider adding comments for all the fields in a struct to improve the readability of the codebase.


*There are 43 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/hooks/AssignmentHook.sol

//@audit Add explanational comments to the following items `feeToken`, `expiry`, `maxBlockId`, `maxProposedIn`, `metaHash`, `parentMetaHash`, `tierFees`, `signature`, 
18:     struct ProverAssignment {
19:         address feeToken;
20:         uint64 expiry;
21:         uint64 maxBlockId;
22:         uint64 maxProposedIn;
23:         bytes32 metaHash;
24:         bytes32 parentMetaHash;
25:         TaikoData.TierFee[] tierFees;
26:         bytes signature;
27:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L18-L27) 


```solidity

File: /contracts/L1/TaikoData.sol

//@audit Add explanational comments to the following items `chainId`, `blockMaxProposals`, `blockRingBufferSize`, `maxBlocksToVerifyPerProposal`, `blockMaxGasLimit`, `blockMaxTxListBytes`, `blobExpiry`, `blobAllowedForDA`, `blobReuseEnabled`, `livenessBond`, `ethDepositRingBufferSize`, `ethDepositMinCountPerBlock`, `ethDepositMaxCountPerBlock`, `ethDepositMinAmount`, `ethDepositMaxAmount`, `ethDepositGas`, `ethDepositMaxFee`, `blockSyncThreshold`, 
10:     struct Config {
11:         // ---------------------------------------------------------------------
12:         // Group 1: General configs
13:         // ---------------------------------------------------------------------
14:         // The chain ID of the network where Taiko contracts are deployed.
15:         uint64 chainId;
16:         // ---------------------------------------------------------------------
17:         // Group 2: Block level configs
18:         // ---------------------------------------------------------------------
19:         // The maximum number of proposals allowed in a single block.
20:         uint64 blockMaxProposals;
21:         // Size of the block ring buffer, allowing extra space for proposals.
22:         uint64 blockRingBufferSize;
23:         // The maximum number of verifications allowed when a block is proposed.
24:         uint64 maxBlocksToVerifyPerProposal;
25:         // The maximum gas limit allowed for a block.
26:         uint32 blockMaxGasLimit;
27:         // The maximum allowed bytes for the proposed transaction list calldata.
28:         uint24 blockMaxTxListBytes;
29:         // The max period in seconds that a blob can be reused for DA.
30:         uint24 blobExpiry;
31:         // True if EIP-4844 is enabled for DA
32:         bool blobAllowedForDA;
33:         // True if blob can be reused
34:         bool blobReuseEnabled;
35:         // ---------------------------------------------------------------------
36:         // Group 3: Proof related configs
37:         // ---------------------------------------------------------------------
38:         // The amount of Taiko token as a prover liveness bond
39:         uint96 livenessBond;
40:         // ---------------------------------------------------------------------
41:         // Group 4: ETH deposit related configs
42:         // ---------------------------------------------------------------------
43:         // The size of the ETH deposit ring buffer.
44:         uint256 ethDepositRingBufferSize;
45:         // The minimum number of ETH deposits allowed per block.
46:         uint64 ethDepositMinCountPerBlock;
47:         // The maximum number of ETH deposits allowed per block.
48:         uint64 ethDepositMaxCountPerBlock;
49:         // The minimum amount of ETH required for a deposit.
50:         uint96 ethDepositMinAmount;
51:         // The maximum amount of ETH allowed for a deposit.
52:         uint96 ethDepositMaxAmount;
53:         // The gas cost for processing an ETH deposit.
54:         uint256 ethDepositGas;
55:         // The maximum fee allowed for an ETH deposit.
56:         uint256 ethDepositMaxFee;
57:         // The max number of L2 blocks that can stay unsynced on L1 (a value of zero disables
58:         // syncing)
59:         uint8 blockSyncThreshold;
60:     }

//@audit Add explanational comments to the following items `tier`, `fee`, 
63:     struct TierFee {
64:         uint16 tier;
65:         uint128 fee;
66:     }

//@audit Add explanational comments to the following items `tier`, 
68:     struct TierProof {
69:         uint16 tier;
70:         bytes data;
71:     }

//@audit Add explanational comments to the following items `hook`, 
73:     struct HookCall {
74:         address hook;
75:         bytes data;
76:     }

//@audit Add explanational comments to the following items `assignedProver`, `coinbase`, `extraData`, `blobHash`, `txListByteOffset`, `txListByteSize`, `cacheBlobForReuse`, `parentMetaHash`, `hookCalls`, 
78:     struct BlockParams {
79:         address assignedProver;
80:         address coinbase;
81:         bytes32 extraData;
82:         bytes32 blobHash;
83:         uint24 txListByteOffset;
84:         uint24 txListByteSize;
85:         bool cacheBlobForReuse;
86:         bytes32 parentMetaHash;
87:         HookCall[] hookCalls;
88:     }

//@audit Add explanational comments to the following items `gasLimit`, `l1Height`, `txListByteOffset`, `txListByteSize`, `minTier`, `blobUsed`, 
094:     struct BlockMetadata {
095:         bytes32 l1Hash; // slot 1
096:         bytes32 difficulty; // slot 2
097:         bytes32 blobHash; //or txListHash (if Blob not yet supported), // slot 3
098:         bytes32 extraData; // slot 4
099:         bytes32 depositsHash; // slot 5
100:         address coinbase; // L2 coinbase, // slot 6
101:         uint64 id;
102:         uint32 gasLimit;
103:         uint64 timestamp; // slot 7
104:         uint64 l1Height;
105:         uint24 txListByteOffset;
106:         uint24 txListByteSize;
107:         uint16 minTier;
108:         bool blobUsed;
109:         bytes32 parentMetaHash; // slot 8
110:     }

//@audit Add explanational comments to the following items `parentHash`, `blockHash`, `stateRoot`, `graffiti`, 
113:     struct Transition {
114:         bytes32 parentHash;
115:         bytes32 blockHash;
116:         bytes32 stateRoot;
117:         bytes32 graffiti;
118:     }

//@audit Add explanational comments to the following items `validityBond`, `contestBond`, `tier`, `contestations`, 
122:     struct TransitionState {
123:         bytes32 key; // slot 1, only written/read for the 1st state transition.
124:         bytes32 blockHash; // slot 2
125:         bytes32 stateRoot; // slot 3
126:         address prover; // slot 4
127:         uint96 validityBond;
128:         address contester; // slot 5
129:         uint96 contestBond;
130:         uint64 timestamp; // slot 6 (90 bits)
131:         uint16 tier;
132:         uint8 contestations;
133:     }

//@audit Add explanational comments to the following items `livenessBond`, `nextTransitionId`, `verifiedTransitionId`, 
137:     struct Block {
138:         bytes32 metaHash; // slot 1
139:         address assignedProver; // slot 2
140:         uint96 livenessBond;
141:         uint64 blockId; // slot 3
142:         uint64 proposedAt; // timestamp
143:         uint64 proposedIn; // L1 block number
144:         uint32 nextTransitionId;
145:         uint32 verifiedTransitionId;
146:     }

//@audit Add explanational comments to the following items `recipient`, `amount`, 
150:     struct EthDeposit {
151:         address recipient;
152:         uint96 amount;
153:         uint64 id;
154:     }

//@audit Add explanational comments to the following items `genesisHeight`, `genesisTimestamp`, `numEthDeposits`, `nextEthDepositToProcess`, 
161:     struct SlotA {
162:         uint64 genesisHeight;
163:         uint64 genesisTimestamp;
164:         uint64 numEthDeposits;
165:         uint64 nextEthDepositToProcess;
166:     }

//@audit Add explanational comments to the following items `numBlocks`, `lastVerifiedBlockId`, `provingPaused`, `__reserved1`, `__reserved2`, `__reserved3`, `lastUnpausedAt`, 
168:     struct SlotB {
169:         uint64 numBlocks;
170:         uint64 lastVerifiedBlockId;
171:         bool provingPaused;
172:         uint8 __reserved1;
173:         uint16 __reserved2;
174:         uint32 __reserved3;
175:         uint64 lastUnpausedAt;
176:     }

//@audit Add explanational comments to the following items `blocks`, `transitionIds`, `transitions`, `ethDeposits`, `reusableBlobs`, `__gap`, 
179:     struct State {
180:         // Ring buffer for proposed blocks and a some recent verified blocks.
181:         mapping(uint64 blockId_mod_blockRingBufferSize => Block blk) blocks;
182:         // Indexing to transition ids (ring buffer not possible)
183:         mapping(uint64 blockId => mapping(bytes32 parentHash => uint32 transitionId)) transitionIds;
184:         // Ring buffer for transitions
185:         mapping(
186:             uint64 blockId_mod_blockRingBufferSize
187:                 => mapping(uint32 transitionId => TransitionState ts)
188:             ) transitions;
189:         // Ring buffer for Ether deposits
190:         mapping(uint256 depositId_mod_ethDepositRingBufferSize => uint256 depositAmount) ethDeposits;
191:         // Reusable blobs
192:         mapping(bytes32 blobHash => uint256 since) reusableBlobs;
193:         SlotA slotA; // slot 6
194:         SlotB slotB; // slot 7
195:         uint256[43] __gap;
196:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L10-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L63-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L68-L71), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L73-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L78-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L94-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L113-L118), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L122-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L137-L146), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L150-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L161-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L168-L176), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L179-L196)


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

//@audit Add explanational comments to the following items `verifierName`, `validityBond`, `contestBond`, `maxBlocksToVerifyPerProof`, 
08:     struct Tier {
09:         bytes32 verifierName;
10:         uint96 validityBond;
11:         uint96 contestBond;
12:         uint24 cooldownWindow; // in minutes
13:         uint16 provingWindow; // in minutes
14:         uint8 maxBlocksToVerifyPerProof;
15:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L8-L15) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit Add explanational comments to the following items `gasTargetPerL1Block`, `basefeeAdjustmentQuotient`, 
26:     struct Config {
27:         uint32 gasTargetPerL1Block;
28:         uint8 basefeeAdjustmentQuotient;
29:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L26-L29) 


```solidity

File: /contracts/signal/ISignalService.sol

//@audit Add explanational comments to the following items `rootHash`, `cacheOption`, `accountProof`, `storageProof`, 
20:     struct HopProof {
21:         uint64 chainId;
22:         uint64 blockId;
23:         bytes32 rootHash;
24:         CacheOption cacheOption;
25:         bytes[] accountProof;
26:         bytes[] storageProof;
27:     }

//@audit Add explanational comments to the following items `rootHash`, `cacheOption`, `accountProof`, `storageProof`, 
20:     struct HopProof {
21:         uint64 chainId;
22:         uint64 blockId;
23:         bytes32 rootHash;
24:         CacheOption cacheOption;
25:         bytes[] accountProof;
26:         bytes[] storageProof;
27:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L27)


```solidity

File: /contracts/bridge/IBridge.sol

//@audit Add explanational comments to the following items `from`, `srcChainId`, `destChainId`, `srcOwner`, `refundTo`, `value`, `gasLimit`, `memo`, 
17:     struct Message {
18:         // Message ID whose value is automatically assigned.
19:         uint128 id;
20:         // The address, EOA or contract, that interacts with this bridge.
21:         // The value is automatically assigned.
22:         address from;
23:         // Source chain ID whose value is automatically assigned.
24:         uint64 srcChainId;
25:         // Destination chain ID where the `to` address lives.
26:         uint64 destChainId;
27:         // The owner of the message on the source chain.
28:         address srcOwner;
29:         // The owner of the message on the destination chain.
30:         address destOwner;
31:         // The destination address on the destination chain.
32:         address to;
33:         // Alternate address to send any refund on the destination chain.
34:         // If blank, defaults to destOwner.
35:         address refundTo;
36:         // value to invoke on the destination chain.
37:         uint256 value;
38:         // Processing fee for the relayer. Zero if owner will process themself.
39:         uint256 fee;
40:         // gasLimit to invoke on the destination chain.
41:         uint256 gasLimit;
42:         // callData to invoke on the destination chain.
43:         bytes data;
44:         // Optional memo.
45:         string memo;
46:     }

//@audit Add explanational comments to the following items `receivedAt`, `preferredExecutor`, 
49:     struct ProofReceipt {
50:         // The time a message is marked as received on the destination chain
51:         uint64 receivedAt;
52:         // The address that can execute the message after the invocation delay without an extra
53:         // delay.
54:         // For a failed message, preferredExecutor's value doesn't matter as only the owner can
55:         // invoke the message.
56:         address preferredExecutor;
57:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L17-L46) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L49-L57)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

//@audit Add explanational comments to the following items `destOwner`, `gasLimit`, `fee`, `refundTo`, `memo`, 
23:     struct BridgeTransferOp {
24:         // Destination chain ID.
25:         uint64 destChainId;
26:         // The owner of the bridge message on the destination chain.
27:         address destOwner;
28:         // Recipient address.
29:         address to;
30:         // Address of the token.
31:         address token;
32:         // IDs of the tokens to transfer.
33:         uint256[] tokenIds;
34:         // Amounts of tokens to transfer.
35:         uint256[] amounts;
36:         // Gas limit for the operation.
37:         uint256 gasLimit;
38:         // Processing fee for the relayer.
39:         uint256 fee;
40:         // Address for refund, if needed.
41:         address refundTo;
42:         // Optional memo.
43:         string memo;
44:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L23-L44) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit Add explanational comments to the following items `decimals`, 
23:     struct CanonicalERC20 {
24:         uint64 chainId;
25:         address addr;
26:         uint8 decimals;
27:         string symbol;
28:         string name;
29:     }

//@audit Add explanational comments to the following items `destOwner`, `gasLimit`, `fee`, `refundTo`, `memo`, 
32:     struct BridgeTransferOp {
33:         uint64 destChainId;
34:         address destOwner;
35:         address to;
36:         address token;
37:         uint256 amount;
38:         uint256 gasLimit;
39:         uint256 fee;
40:         address refundTo;
41:         string memo;
42:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L23-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L32-L42)


```solidity

File: /contracts/verifiers/IVerifier.sol

//@audit Add explanational comments to the following items `metaHash`, `blobHash`, `prover`, `blockId`, `isContesting`, `blobUsed`, `msgSender`, 
10:     struct Context {
11:         bytes32 metaHash;
12:         bytes32 blobHash;
13:         address prover;
14:         uint64 blockId;
15:         bool isContesting;
16:         bool blobUsed;
17:         address msgSender;
18:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L10-L18) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit Add explanational comments to the following items `costPerToken`, `grantStart`, `grantCliff`, `grantPeriod`, `unlockStart`, `unlockCliff`, `unlockPeriod`, 
28:     struct Grant {
29:         uint128 amount;
30:         // If non-zero, each TKO (1E18) will need some USD stable to purchase.
31:         uint128 costPerToken;
32:         // If non-zero, indicates the start time for the recipient to receive
33:         // tokens, subject to an unlocking schedule.
34:         uint64 grantStart;
35:         // If non-zero, indicates the time after which the token to be received
36:         // will be actually non-zero
37:         uint64 grantCliff;
38:         // If non-zero, specifies the total seconds required for the recipient
39:         // to fully own all granted tokens.
40:         uint32 grantPeriod;
41:         // If non-zero, indicates the start time for the recipient to unlock
42:         // tokens.
43:         uint64 unlockStart;
44:         // If non-zero, indicates the time after which the unlock will be
45:         // actually non-zero
46:         uint64 unlockCliff;
47:         // If non-zero, specifies the total seconds required for the recipient
48:         // to fully unlock all owned tokens.
49:         uint32 unlockPeriod;
50:     }

//@audit Add explanational comments to the following items `amountWithdrawn`, `costPaid`, 
52:     struct Recipient {
53:         uint128 amountWithdrawn;
54:         uint128 costPaid;
55:         Grant grant;
56:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L28-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L52-L56)


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

//@audit Add explanational comments to the following items `keyType`, `pubKey`, 
12:     struct PublicKey {
13:         KeyType keyType;
14:         // If RSA, pubKey = abi.encodePacked(exponent, modulus)
15:         // If ECDSA, pubKey = abi.encodePacked(gx, gy)
16:         bytes pubKey;
17:     }

//@audit Add explanational comments to the following items `tbsCertificate`, `publicKey`, `signature`, `sigAlg`, 
24:     struct Certificate {
25:         // Asn.1 DER encoding of the to-be-signed certificate
26:         bytes tbsCertificate;
27:         PublicKey publicKey;
28:         bytes signature;
29:         CertSigAlgorithm sigAlg;
30:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L12-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L24-L30)


```solidity

File: /contracts/automata-attestation/lib/EnclaveIdStruct.sol

//@audit Add explanational comments to the following items `miscselect`, `miscselectMask`, `isvprodid`, `attributes`, `attributesMask`, `mrsigner`, `tcbLevels`, 
07:     struct EnclaveId {
08:         bytes4 miscselect;
09:         bytes4 miscselectMask;
10:         uint16 isvprodid;
11:         bytes16 attributes;
12:         bytes16 attributesMask;
13:         bytes32 mrsigner;
14:         TcbLevel[] tcbLevels;
15:     }

//@audit Add explanational comments to the following items `tcb`, `tcbStatus`, 
17:     struct TcbLevel {
18:         TcbObj tcb;
19:         EnclaveIdStatus tcbStatus;
20:     }

//@audit Add explanational comments to the following items `isvsvn`, 
22:     struct TcbObj {
23:         uint16 isvsvn;
24:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L7-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L17-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L22-L24)


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

//@audit Add explanational comments to the following items `notBefore`, `notAfter`, `serialNumber`, `tbsCertificate`, `pubKey`, `signature`, `isPck`, `pck`, 
07:     struct ECSha256Certificate {
08:         uint256 notBefore;
09:         uint256 notAfter;
10:         bytes serialNumber;
11:         bytes tbsCertificate;
12:         bytes pubKey;
13:         bytes signature;
14:         bool isPck;
15:         PCKCertificateField pck;
16:     }

//@audit Add explanational comments to the following items `commonName`, `issuerName`, `sgxExtension`, 
18:     struct PCKCertificateField {
19:         string commonName;
20:         string issuerName;
21:         PCKTCBInfo sgxExtension;
22:     }

//@audit Add explanational comments to the following items `pceid`, `fmspc`, `pcesvn`, `sgxTcbCompSvnArr`, 
24:     struct PCKTCBInfo {
25:         string pceid;
26:         string fmspc;
27:         uint256 pcesvn;
28:         uint256[] sgxTcbCompSvnArr;
29:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L7-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L18-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L24-L29)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit Add explanational comments to the following items `fmspcFound`, `pceidFound`, `tcbFound`, 
34:     struct PCKTCBFlags {
35:         bool fmspcFound;
36:         bool pceidFound;
37:         bool tcbFound;
38:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L34-L38) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

//@audit Add explanational comments to the following items `version`, `attestationKeyType`, `teeType`, `qeSvn`, `pceSvn`, `qeVendorId`, `userData`, 
07:     struct Header {
08:         bytes2 version;
09:         bytes2 attestationKeyType;
10:         bytes4 teeType;
11:         bytes2 qeSvn;
12:         bytes2 pceSvn;
13:         bytes16 qeVendorId;
14:         bytes20 userData;
15:     }

//@audit Add explanational comments to the following items `cpuSvn`, `miscSelect`, `reserved1`, `attributes`, `mrEnclave`, `reserved2`, `mrSigner`, `isvProdId`, `isvSvn`, 
17:     struct EnclaveReport {
18:         bytes16 cpuSvn;
19:         bytes4 miscSelect;
20:         bytes28 reserved1;
21:         bytes16 attributes;
22:         bytes32 mrEnclave;
23:         bytes32 reserved2;
24:         bytes32 mrSigner;
25:         bytes reserved3; // 96 bytes
26:         uint16 isvProdId;
27:         uint16 isvSvn;
28:         bytes reserved4; // 60 bytes
29:         bytes reportData; // 64 bytes - For QEReports, this contains the hash of the concatenation
30:             // of attestation key and QEAuthData
31:     }

//@audit Add explanational comments to the following items `parsedDataSize`, `data`, 
33:     struct QEAuthData {
34:         uint16 parsedDataSize;
35:         bytes data;
36:     }

//@audit Add explanational comments to the following items `certType`, `certDataSize`, 
38:     struct CertificationData {
39:         uint16 certType;
40:         // todo! In encoded path, we need to calculate the size of certDataArray
41:         // certDataSize = len(join((BEGIN_CERT, certArray[i], END_CERT) for i in 0..3))
42:         // But for plain bytes path, we don't need that.
43:         uint32 certDataSize;
44:         bytes[3] decodedCertDataArray; // base64 decoded cert bytes array
45:     }

//@audit Add explanational comments to the following items `qeAuthData`, `certification`, 
47:     struct ECDSAQuoteV3AuthData {
48:         bytes ecdsa256BitSignature; // 64 bytes
49:         bytes ecdsaAttestationKey; // 64 bytes
50:         EnclaveReport pckSignedQeReport; // 384 bytes
51:         bytes qeReportSignature; // 64 bytes
52:         QEAuthData qeAuthData;
53:         CertificationData certification;
54:     }

//@audit Add explanational comments to the following items `header`, `localEnclaveReport`, `v3AuthData`, 
56:     struct ParsedV3QuoteStruct {
57:         Header header;
58:         EnclaveReport localEnclaveReport;
59:         ECDSAQuoteV3AuthData v3AuthData;
60:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L7-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L17-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L33-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L38-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L47-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L56-L60)


```solidity

File: /contracts/automata-attestation/lib/TCBInfoStruct.sol

//@audit Add explanational comments to the following items `pceid`, `fmspc`, `tcbLevels`, 
07:     struct TCBInfo {
08:         string pceid;
09:         string fmspc;
10:         TCBLevelObj[] tcbLevels;
11:     }

//@audit Add explanational comments to the following items `pcesvn`, `sgxTcbCompSvnArr`, `status`, 
13:     struct TCBLevelObj {
14:         uint256 pcesvn;
15:         uint8[] sgxTcbCompSvnArr;
16:         TCBStatus status;
17:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L7-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L13-L17)


</details>


### [NC&#x2011;65] Using underscore at the end of variable name 
The use of underscore at the end of the variable name is uncommon and also suggests that the variable name was not completely changed. Consider refactoring variableName_ to variableName.


*There are 99 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

130:     function _loadReentryLock() internal view virtual returns (uint8 reentry_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L130-L130) 


```solidity

File: /contracts/libs/LibAddress.sol

52:         returns (bool result_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L52-L52) 


```solidity

File: /contracts/libs/LibTrieProof.sol

44:         returns (bytes32 storageRoot_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L44-L44) 


```solidity

File: /contracts/L1/ITaikoL1.sol

20:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_);

20:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L20-L20)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

73:         returns (TaikoData.EthDeposit[] memory deposits_)

44:         address recipient_ = _recipient == address(0) ? msg.sender : _recipient;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L44-L44)


```solidity

File: /contracts/L1/libs/LibProposing.sol

76:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)

76:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L76-L76)


```solidity

File: /contracts/L1/libs/LibProving.sol

100:         returns (uint8 maxBlocksToVerify_)

276:         returns (uint32 tid_, TaikoData.TransitionState storage ts_)

276:         returns (uint32 tid_, TaikoData.TransitionState storage ts_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L100-L100) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L276-L276), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L276-L276)


```solidity

File: /contracts/L1/libs/LibUtils.sol

59:         returns (TaikoData.Block storage blk_, uint64 slot_)

59:         returns (TaikoData.Block storage blk_, uint64 slot_)

78:         returns (uint32 tid_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L78-L78)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

43:         returns (bool approved_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L43-L43) 


```solidity

File: /contracts/L1/provers/Guardians.sol

111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111) 


```solidity

File: /contracts/L1/TaikoL1.sol

63:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)

63:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)

148:         returns (TaikoData.Block memory blk_, TaikoData.TransitionState memory ts_)

148:         returns (TaikoData.Block memory blk_, TaikoData.TransitionState memory ts_)

179:         returns (TaikoData.SlotA memory a_, TaikoData.SlotB memory b_)

179:         returns (TaikoData.SlotA memory a_, TaikoData.SlotB memory b_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L63-L63) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L179-L179)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

47:     function getTierIds() public pure override returns (uint16[] memory tiers_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L47-L47) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

58:     function getTierIds() public pure override returns (uint16[] memory tiers_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L58-L58) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

58:     function getTierIds() public pure override returns (uint16[] memory tiers_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L58-L58) 


```solidity

File: /contracts/L2/TaikoL2.sol

191:         returns (uint256 basefee_)

208:     function getConfig() public view virtual returns (Config memory config_) {

259:         returns (uint256 basefee_, uint64 gasExcess_)

259:         returns (uint256 basefee_, uint64 gasExcess_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L191-L191) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L259-L259), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L259-L259)


```solidity

File: /contracts/signal/ISignalService.sol

59:     function sendSignal(bytes32 _signal) external returns (bytes32 slot_);

75:         returns (bytes32 signal_);

129:         returns (uint64 blockId_, bytes32 chainData_);

129:         returns (uint64 blockId_, bytes32 chainData_);

144:         returns (bytes32 signal_);

59:     function sendSignal(bytes32 _signal) external returns (bytes32 slot_);

75:         returns (bytes32 signal_);

129:         returns (uint64 blockId_, bytes32 chainData_);

129:         returns (uint64 blockId_, bytes32 chainData_);

144:         returns (bytes32 signal_);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L144-L144)


```solidity

File: /contracts/signal/SignalService.sol

165:         returns (uint64 blockId_, bytes32 chainData_)

165:         returns (uint64 blockId_, bytes32 chainData_)

242:         returns (bytes32 signal_)

262:         returns (bytes32 slot_)

306:         returns (bytes32 value_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L165-L165) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L242-L242), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L262-L262), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L306-L306)


```solidity

File: /contracts/bridge/IBridge.sol

112:         returns (bytes32 msgHash_, Message memory message_);

112:         returns (bytes32 msgHash_, Message memory message_);

145:     function context() external view returns (Context memory ctx_);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L112-L112) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L145-L145)


```solidity

File: /contracts/bridge/Bridge.sol

121:         returns (bytes32 msgHash_, Message memory message_)

121:         returns (bytes32 msgHash_, Message memory message_)

395:         returns (bool enabled_, address destBridge_)

395:         returns (bool enabled_, address destBridge_)

403:     function context() public view returns (Context memory ctx_) {

421:         returns (uint256 invocationDelay_, uint256 invocationExtraDelay_)

421:         returns (uint256 invocationDelay_, uint256 invocationExtraDelay_)

483:         returns (bool success_)

585:         returns (bool success_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L121-L121) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L395-L395), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L395-L395), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L403-L403), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L483-L483), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L585-L585)


```solidity

File: /contracts/tokenvault/BaseVault.sol

51:         returns (IBridge.Context memory ctx_)

62:         returns (IBridge.Context memory ctx_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L62-L62)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

45:         returns (IBridge.Message memory message_)

245:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

245:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

290:         returns (address btoken_)

303:     function _deployBridgedToken(CanonicalNFT memory _ctoken) private returns (address btoken_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L290-L290), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L303-L303)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

156:         returns (address btokenOld_)

212:         returns (IBridge.Message memory message_)

326:         returns (address token_)

355:         returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)

355:         returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)

355:         returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L156-L156) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L326-L326), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L355-L355), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L355-L355), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L355-L355)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

32:         returns (IBridge.Message memory message_)

166:         returns (address token_)

192:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

192:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

226:         returns (address btoken_)

240:     function _deployBridgedToken(CanonicalNFT memory _ctoken) private returns (address btoken_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L240-L240)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

35:     function toRLPItem(bytes memory _in) internal pure returns (RLPItem memory out_) {

53:     function readList(RLPItem memory _in) internal pure returns (RLPItem[] memory out_) {

102:     function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {

109:     function readBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {

128:     function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {

135:     function readRawBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {

147:         returns (uint256 offset_, uint256 length_, RLPItemType type_)

147:         returns (uint256 offset_, uint256 length_, RLPItemType type_)

147:         returns (uint256 offset_, uint256 length_, RLPItemType type_)

284:         returns (bytes memory out_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L284-L284)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

13:     function writeBytes(bytes memory _in) internal pure returns (bytes memory out_) {

24:     function writeUint(uint256 _in) internal pure returns (bytes memory out_) {

32:     function _writeLength(uint256 _len, uint256 _offset) private pure returns (bytes memory out_) {

55:     function _toBinary(uint256 _x) private pure returns (bytes memory out_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L55-L55)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

58:         returns (bool valid_)

75:         returns (bytes memory value_)

205:     function _parseProof(bytes[] memory _proof) private pure returns (TrieNode[] memory proof_) {

220:     function _getNodeID(RLPReader.RLPItem memory _node) private pure returns (bytes memory id_) {

227:     function _getNodePath(TrieNode memory _node) private pure returns (bytes memory nibbles_) {

241:         returns (uint256 shared_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L205-L205), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L220-L220), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L241-L241)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

27:         returns (bool valid_)

45:         returns (bytes memory value_)

54:     function _getSecureKey(bytes memory _key) private pure returns (bytes memory hash_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L54-L54)


</details>


### [NC&#x2011;66] Event is missing `indexed` fields 
Index event fields make the field more quickly accessible to off-chain tools that parse events. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields). Each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question. If there are fewer than three fields, all of the fields should be indexed.


*There are 41 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

21:     event AddressSet(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L21-L21) 


```solidity

File: /contracts/common/EssentialContract.sol

29:     event Paused(address account);

33:     event Unpaused(address account);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L33-L33)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

46:     event BlockAssigned(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L46-L46) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

19:     event EthDeposited(TaikoData.EthDeposit deposit);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L19-L19) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

31:     event BlockProposed(

41:     event BlobCached(bytes32 blobHash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L31-L31) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L41-L41)


```solidity

File: /contracts/L1/libs/LibProving.sol

32:     event TransitionProved(

46:     event TransitionContested(

56:     event ProvingPaused(bool paused);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L56-L56)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

18:     event GuardianApproval(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L18-L18) 


```solidity

File: /contracts/L1/provers/Guardians.sol

37:     event GuardiansUpdated(uint32 version, address[] guardians);

43:     event Approved(uint256 indexed operationId, uint256 approvalBits, bool proofSubmitted);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L43-L43)


```solidity

File: /contracts/L1/TaikoEvents.sol

21:     event BlockProposed(

53:     event TransitionProved(

67:     event TransitionContested(

77:     event BlobCached(bytes32 blobHash);

81:     event ProvingPaused(bool paused);

86:     event EthDeposited(TaikoData.EthDeposit deposit);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L86-L86)


```solidity

File: /contracts/L2/TaikoL2.sol

57:     event Anchored(bytes32 parentHash, uint64 gasExcess);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L57-L57) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

18:     event ConfigAndExcessChanged(Config config, uint64 gasExcess);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L18-L18) 


```solidity

File: /contracts/signal/ISignalService.sol

49:     event SignalSent(address app, bytes32 signal, bytes32 slot, bytes32 value);

54:     event Authorized(address indexed addr, bool authrized);

49:     event SignalSent(address app, bytes32 signal, bytes32 slot, bytes32 value);

54:     event Authorized(address indexed addr, bool authrized);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L54-L54)


```solidity

File: /contracts/bridge/IBridge.sol

69:     event MessageSent(bytes32 indexed msgHash, Message message);

75:     event MessageReceived(bytes32 indexed msgHash, Message message, bool isRecall);

92:     event MessageStatusChanged(bytes32 indexed msgHash, Status status);

97:     event MessageSuspended(bytes32 msgHash, bool suspended);

102:     event AddressBanned(address indexed addr, bool banned);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L102-L102)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

21:     event MigrationStatusChanged(address addr, bool inbound);

27:     event MigratedTo(address indexed fromToken, address indexed account, uint256 amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L27-L27)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

104:     event TokenReleased(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L104-L104) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

80:     event BridgedTokenChanged(

114:     event TokenReleased(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L80-L80) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L114-L114)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

65:     event InstanceAdded(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L65-L65) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

35:     event Withdrawn(address user, uint256 amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L35-L35) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

27:     event Claimed(bytes32 hash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L27-L27) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

87:     event Granted(address indexed recipient, Grant grant);

92:     event Voided(address indexed recipient, uint128 amount);

99:     event Withdrawn(address indexed recipient, address to, uint128 amount, uint128 cost);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L87-L87) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L99-L99)


</details>


### [NC&#x2011;67] Unused `error` definition 
Note that there may be cases where an error superficially appears to be used, but this is only because there are multiple definitions of the error in different files. In such cases, the error definition should be moved into a separate file. The instances below are the unused definitions.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoErrors.sol

36:     error L1_TOO_MANY_TIERS();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L36-L36) 


</details>


### [NC&#x2011;68] Unused Import 
Some files/Items are imported but never used


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/provers/GuardianProver.sol

//@audit `ITierProvider` is not used
4: import "../tiers/ITierProvider.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L4-L4) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit `IERC20` is not used
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L4-L4) 


```solidity

File: /contracts/signal/SignalService.sol

//@audit `SafeCast` is not used
4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit `Strings` is not used
5: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L5-L5) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit `Strings` is not used
4: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit `ERC1967Proxy` is not used
5: import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L5-L5) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit `Base64` is not used
13: import { Base64 } from "solady/src/utils/Base64.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L13-L13) 


</details>


### [NC&#x2011;69] Unused `internal`/`private` contract variable 
If these serve no purpose, they should be safely removed


*There are 35 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

//@audit the variable `__gap` is declared but never used
14:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L14-L14) 


```solidity

File: /contracts/common/EssentialContract.sol

//@audit the variable `__gap` is declared but never used
25:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L25-L25) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

//@audit the variable `__gap` is declared but never used
23:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L23-L23) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

//@audit the variable `__gap` is declared but never used
10:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L10-L10) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

//@audit the variable `__gap` is declared but never used
40:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L40-L40) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

//@audit the variable `__gap` is declared but never used
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L11-L11) 


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit the variable `__gap` is declared but never used
32:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L32-L32) 


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit the variable `__gap` is declared but never used
26:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L26-L26) 


```solidity

File: /contracts/L1/TaikoToken.sol

//@audit the variable `__gap` is declared but never used
16:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L16-L16) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit the variable `__gap` is declared but never used
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit the variable `__gap` is declared but never used
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit the variable `__gap` is declared but never used
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit the variable `__gap` is declared but never used
21:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L21-L21) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit the variable `__gap` is declared but never used
52:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L52-L52) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

//@audit the variable `__gap` is declared but never used
13:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L13-L13) 


```solidity

File: /contracts/signal/SignalService.sol

//@audit the variable `__gap` is declared but never used
23:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L23-L23) 


```solidity

File: /contracts/bridge/Bridge.sol

//@audit the variable `__gap` is declared but never used
48:     uint256[43] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L48-L48) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

//@audit the variable `__gap` is declared but never used
32:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit the variable `__gap` is declared but never used
32:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

//@audit the variable `__gap` is declared but never used
16:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L16-L16) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

//@audit the variable `__gap` is declared but never used
19:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L19-L19) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit the variable `__gap` is declared but never used
27:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L27-L27) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

//@audit the variable `__gap` is declared but never used
61:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L61-L61) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit the variable `__gap` is declared but never used
18:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L18-L18) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit the variable `__gap` is declared but never used
32:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit the variable `__gap` is declared but never used
54:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L54-L54) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit the variable `__gap` is declared but never used
19:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L19-L19) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

//@audit the variable `LOW_28_MASK` is declared but never used
6:     uint256 constant LOW_28_MASK =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6-L6) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

//@audit the variable `__gap` is declared but never used
11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L11-L11) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit the variable `__gap` is declared but never used
57:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L57-L57) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

//@audit the variable `__gap` is declared but never used
18:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L18-L18) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit the variable `__gap` is declared but never used
30:     uint256[45] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L30-L30) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

//@audit the variable `__gap` is declared but never used
16:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L16-L16) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

//@audit the variable `__gap` is declared but never used
23:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L23-L23) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit the variable `__gap` is declared but never used
82:     uint128[44] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L82-L82) 


</details>


### [NC&#x2011;70] Missing upgradability functionality 
At the begining of a project, there is always the need to modify of add something to the source code especialy if any vulnerability is discovered. Therefore, having such system is crusial at least at the first stages of the project


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

7: interface IAddressManager {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L7-L7) 


</details>


### [NC&#x2011;71] Cast to `bytes` or `bytes32` for clearer semantic meaning 
Using a [cast](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739) on a single argument, rather than `abi.encodePacked()` makes the intended operation more clear, leading to less reviewer confusion.


*There are 8 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/LibTrieProof.sol

48:                 SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L48-L48) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

56:         bytes memory b = abi.encodePacked(_x);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L56-L56) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

81:         bytes memory currentNodeID = abi.encodePacked(_root);

94:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),

100:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L81-L81) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L100-L100)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

55:         hash_ = abi.encodePacked(keccak256(_key));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L55-L55) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

163:         bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);

369:         bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L163-L163) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L369-L369)


</details>


### [NC&#x2011;72] Use `bytes.concat()` on bytes instead of `abi.encodePacked()` for clearer semantic meaning 
Starting with version 0.8.4, Solidity has the `bytes.concat()` function, which allows one to concatenate a list of bytes/strings, without extra padding. Using this function rather than `abi.encodePacked()` makes the intended operation more clear, leading to less reviewer confusion.


*There are 8 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProposing.sol

204:         meta_.difficulty = keccak256(abi.encodePacked(block.prevrandao, b.numBlocks, block.number));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L204-L204) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

109:             abi.encodePacked(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L109-L109) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

54:             abi.encodePacked(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L54-L54) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

17:             out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L17-L17) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

315:             abi.encodePacked(authDataV3.ecdsaAttestationKey, authDataV3.qeAuthData.data);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L315-L315) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

181:             cert.signature = abi.encodePacked(sigX, sigY);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L181-L181) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

119:         bytes memory headerBytes = abi.encodePacked(

129:         signedQuoteData = abi.encodePacked(headerBytes, V3Parser.packQEReport(localEnclaveReport));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L119-L119) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L129-L129)


</details>


### [NC&#x2011;73] Use `string.concat()` on strings instead of `abi.encodePacked()` for clearer semantic meaning 
Starting with version 0.8.12, Solidity has the `string.concat()` function, which allows one to concatenate a list of strings, without extra padding. Using this function rather than `abi.encodePacked()` makes the intended operation more clear, leading to less reviewer confusion.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/BridgedERC721.sol

109:             abi.encodePacked(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L109-L109) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

54:             abi.encodePacked(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L54-L54) 


</details>


### [NC&#x2011;74] Constants should be defined rather than using magic numbers 
Even [assembly](https://github.com/code-423n4/2022-05-opensea-seaport/blob/9d7ce4d08bf3c3010304a0476a785c70c0e90ae7/contracts/lib/TokenTransferrer.sol#L35-L39) can benefit from using readable constants instead of hex/numeric literals


*There are 395 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

//@audit Try to make a `constant` with `64` value
49:         if (ret.length != 64) revert EVAL_FAILED_2();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L49-L49) 


```solidity

File: /contracts/libs/LibAddress.sol

//@audit Try to make a `constant` with `64` value
31:             64, // return max 64 bytes


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L31-L31) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

//@audit Try to make a `constant` with `4` value
43:         __GovernorVotesQuorumFraction_init(4);

//@audit Try to make a `constant` with `7200` value
112:         return 7200; // 1 day

//@audit Try to make a `constant` with `50_400` value
118:         return 50_400; // 1 week

//@audit Try to make a `constant` with `10_000` value
124:         return 1_000_000_000 ether / 10_000; // 0.01% of Taiko Token


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L124-L124)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

//@audit Try to make a `constant` with `96` value
89:                     recipient: address(uint160(data >> 96)),

//@audit Try to make a `constant` with `96` value
151:         return (uint256(uint160(_addr)) << 96) | _amount;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L89-L89) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L151-L151)


```solidity

File: /contracts/L1/libs/LibProving.sol

//@audit Try to make a `constant` with `32` value
192:             bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32

//@audit Try to make a `constant` with `60` value
415:             + _tier.provingWindow * 60 >= block.timestamp;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L192-L192) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L415-L415)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit Try to make a `constant` with `60` value
152:                         uint256(ITierProvider(tierProvider).getTier(ts.tier).cooldownWindow) * 60

//@audit Try to make a `constant` with `32` value
256:             || _config.ethDepositMaxCountPerBlock > 32

//@audit Try to make a `constant` with `128` value
251:                 || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K

//@audit Try to make a `constant` with `1024` value
251:                 || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L152-L152) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L256-L256), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L251-L251), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L251-L251)


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit Try to make a `constant` with `167_008` value
192:             chainId: 167_008,

//@audit Try to make a `constant` with `864_000` value
195:             blockMaxProposals: 864_000,

//@audit Try to make a `constant` with `864_100` value
196:             blockRingBufferSize: 864_100,

//@audit Try to make a `constant` with `10` value
198:             maxBlocksToVerifyPerProposal: 10,

//@audit Try to make a `constant` with `15_000_000` value
199:             blockMaxGasLimit: 15_000_000,

//@audit Try to make a `constant` with `120_000` value
203:             blockMaxTxListBytes: 120_000,

//@audit Try to make a `constant` with `24` value
204:             blobExpiry: 24 hours,

//@audit Try to make a `constant` with `250e18` value
207:             livenessBond: 250e18, // 250 Taiko token

//@audit Try to make a `constant` with `1024` value
209:             ethDepositRingBufferSize: 1024,

//@audit Try to make a `constant` with `8` value
210:             ethDepositMinCountPerBlock: 8,

//@audit Try to make a `constant` with `32` value
211:             ethDepositMaxCountPerBlock: 32,

//@audit Try to make a `constant` with `10_000` value
213:             ethDepositMaxAmount: 10_000 ether,

//@audit Try to make a `constant` with `21_000` value
214:             ethDepositGas: 21_000,

//@audit Try to make a `constant` with `16` value
216:             blockSyncThreshold: 16

//@audit Try to make a `constant` with `10` value
215:             ethDepositMaxFee: 1 ether / 10,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L192-L192) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L204-L204), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L209-L209), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L210-L210), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L211-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L214-L214), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L215-L215)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit Try to make a `constant` with `250` value
24:                 validityBond: 250 ether, // TKO

//@audit Try to make a `constant` with `500` value
25:                 contestBond: 500 ether, // TKO

//@audit Try to make a `constant` with `1440` value
26:                 cooldownWindow: 1440, //24 hours

//@audit Try to make a `constant` with `120` value
27:                 provingWindow: 120, // 2 hours

//@audit Try to make a `constant` with `16` value
28:                 maxBlocksToVerifyPerProof: 16

//@audit Try to make a `constant` with `60` value
37:                 cooldownWindow: 60, //1 hours

//@audit Try to make a `constant` with `2880` value
38:                 provingWindow: 2880, // 48 hours

//@audit Try to make a `constant` with `16` value
39:                 maxBlocksToVerifyPerProof: 16


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L39-L39)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit Try to make a `constant` with `250` value
24:                 validityBond: 250 ether, // TKO

//@audit Try to make a `constant` with `500` value
25:                 contestBond: 500 ether, // TKO

//@audit Try to make a `constant` with `1440` value
26:                 cooldownWindow: 1440, //24 hours

//@audit Try to make a `constant` with `60` value
27:                 provingWindow: 60, // 1 hours

//@audit Try to make a `constant` with `8` value
28:                 maxBlocksToVerifyPerProof: 8

//@audit Try to make a `constant` with `500` value
35:                 validityBond: 500 ether, // TKO

//@audit Try to make a `constant` with `1000` value
36:                 contestBond: 1000 ether, // TKO

//@audit Try to make a `constant` with `1440` value
37:                 cooldownWindow: 1440, //24 hours

//@audit Try to make a `constant` with `240` value
38:                 provingWindow: 240, // 4 hours

//@audit Try to make a `constant` with `4` value
39:                 maxBlocksToVerifyPerProof: 4

//@audit Try to make a `constant` with `60` value
48:                 cooldownWindow: 60, //1 hours

//@audit Try to make a `constant` with `2880` value
49:                 provingWindow: 2880, // 48 hours

//@audit Try to make a `constant` with `16` value
50:                 maxBlocksToVerifyPerProof: 16

//@audit Try to make a `constant` with `3` value
59:         tiers_ = new uint16[](3);

//@audit Try to make a `constant` with `1000` value
68:         if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L68-L68)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit Try to make a `constant` with `250` value
24:                 validityBond: 250 ether, // TKO

//@audit Try to make a `constant` with `500` value
25:                 contestBond: 500 ether, // TKO

//@audit Try to make a `constant` with `1440` value
26:                 cooldownWindow: 1440, //24 hours

//@audit Try to make a `constant` with `30` value
27:                 provingWindow: 30, // 0.5 hours

//@audit Try to make a `constant` with `12` value
28:                 maxBlocksToVerifyPerProof: 12

//@audit Try to make a `constant` with `500` value
35:                 validityBond: 500 ether, // TKO

//@audit Try to make a `constant` with `1000` value
36:                 contestBond: 1000 ether, // TKO

//@audit Try to make a `constant` with `1440` value
37:                 cooldownWindow: 1440, //24 hours

//@audit Try to make a `constant` with `60` value
38:                 provingWindow: 60, // 1 hours

//@audit Try to make a `constant` with `8` value
39:                 maxBlocksToVerifyPerProof: 8

//@audit Try to make a `constant` with `60` value
48:                 cooldownWindow: 60, //1 hours

//@audit Try to make a `constant` with `2880` value
49:                 provingWindow: 2880, // 48 hours

//@audit Try to make a `constant` with `16` value
50:                 maxBlocksToVerifyPerProof: 16

//@audit Try to make a `constant` with `3` value
59:         tiers_ = new uint16[](3);

//@audit Try to make a `constant` with `10` value
68:         if (_rand % 10 == 0) return LibTiers.TIER_SGX;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L68-L68)


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit Try to make a `constant` with `256` value
202:         if (_blockId + 256 >= block.number) return blockhash(_blockId);

//@audit Try to make a `constant` with `8` value
214:         config_.basefeeAdjustmentQuotient = 8;

//@audit Try to make a `constant` with `4` value
213:         config_.gasTargetPerL1Block = 15 * 1e6 * 4;

//@audit Try to make a `constant` with `15` value
213:         config_.gasTargetPerL1Block = 15 * 1e6 * 4;

//@audit Try to make a `constant` with `255` value
234:             for (uint256 i; i < 255 && _blockId >= i + 1; ++i) {

//@audit Try to make a `constant` with `255` value
246:         inputs[_blockId % 255] = blockhash(_blockId);

//@audit Try to make a `constant` with `255` value
236:                 inputs[j % 255] = blockhash(j);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L202-L202) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L214-L214), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L234-L234), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L246-L246), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L236-L236)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit Try to make a `constant` with `11_155_111` value
435:                 || block.chainid == 11_155_111 // Sepolia

//@audit Try to make a `constant` with `384` value
428:             return (1 hours, 384 seconds);

//@audit Try to make a `constant` with `17_000` value
434:                 || block.chainid == 17_000 // Holesky

//@audit Try to make a `constant` with `32_300` value
439:         } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {

//@audit Try to make a `constant` with `32_400` value
439:         } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {

//@audit Try to make a `constant` with `30` value
438:             return (30 minutes, 384 seconds);

//@audit Try to make a `constant` with `384` value
438:             return (30 minutes, 384 seconds);

//@audit Try to make a `constant` with `42` value
433:                 || block.chainid == 42 // Kovan

//@audit Try to make a `constant` with `5` value
441:             return (5 minutes, 384 seconds);

//@audit Try to make a `constant` with `384` value
441:             return (5 minutes, 384 seconds);

//@audit Try to make a `constant` with `5` value
432:                 || block.chainid == 5 // Goerli

//@audit Try to make a `constant` with `4` value
431:                 || block.chainid == 4 // Rinkeby

//@audit Try to make a `constant` with `4` value
491:             _message.data.length >= 4 // msg can be empty

//@audit Try to make a `constant` with `64` value
501:                 64, // return max 64 bytes


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L435-L435) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L428-L428), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L434-L434), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L439-L439), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L439-L439), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L438-L438), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L438-L438), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L433-L433), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L441-L441), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L441-L441), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L432-L432), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L431-L431), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L491-L491), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L501-L501)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit Try to make a `constant` with `4` value
140:         (bytes memory data) = abi.decode(message.data[4:], (bytes));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L140-L140) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit Try to make a `constant` with `4` value
298:         (bytes memory data) = abi.decode(_message.data[4:], (bytes));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L298-L298) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit Try to make a `constant` with `4` value
123:         (bytes memory data) = abi.decode(_message.data[4:], (bytes));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L123-L123) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

//@audit Try to make a `constant` with `20` value
56:                 Strings.toHexString(uint160(_srcToken), 20),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L56-L56) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

//@audit Try to make a `constant` with `31` value
25:             require(_length + 31 >= _length, "slice_overflow");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L25-L25) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

//@audit Try to make a `constant` with `0x7f` value
163:         if (prefix <= 0x7f) {

//@audit Try to make a `constant` with `0xb7` value
166:         } else if (prefix <= 0xb7) {

//@audit Try to make a `constant` with `0xbf` value
188:         } else if (prefix <= 0xbf) {

//@audit Try to make a `constant` with `0xf7` value
223:         } else if (prefix <= 0xf7) {

//@audit Try to make a `constant` with `0x80` value
170:             uint256 strLen = prefix - 0x80;

//@audit Try to make a `constant` with `0xb7` value
190:             uint256 lenOfStrLen = prefix - 0xb7;

//@audit Try to make a `constant` with `0xf7` value
236:             uint256 lenOfListLen = prefix - 0xf7;

//@audit Try to make a `constant` with `0xc0` value
226:             uint256 listLen = prefix - 0xc0;

//@audit Try to make a `constant` with `55` value
213:                 strLen > 55,

//@audit Try to make a `constant` with `0x80` value
183:                 strLen != 1 || firstByteOfContent >= 0x80,

//@audit Try to make a `constant` with `55` value
259:                 listLen > 55,


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L163-L163) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L170-L170), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L190-L190), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L236-L236), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L183-L183), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L259-L259)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit Try to make a `constant` with `128` value
14:         if (_in.length == 1 && uint8(_in[0]) < 128) {

//@audit Try to make a `constant` with `128` value
17:             out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);

//@audit Try to make a `constant` with `56` value
33:         if (_len < 56) {

//@audit Try to make a `constant` with `256` value
41:                 i *= 256;

//@audit Try to make a `constant` with `55` value
45:             out_[0] = bytes1(uint8(lenLen) + uint8(_offset) + 55);

//@audit Try to make a `constant` with `256` value
47:                 out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));

//@audit Try to make a `constant` with `256` value
47:                 out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));

//@audit Try to make a `constant` with `32` value
59:         for (; i < 32; i++) {

//@audit Try to make a `constant` with `32` value
65:         out_ = new bytes(32 - i);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L65-L65)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

//@audit Try to make a `constant` with `32` value
97:             } else if (currentNode.encoded.length >= 32) {

//@audit Try to make a `constant` with `32` value
221:         id_ = _node.length < 32 ? RLPReader.readRawBytes(_node) : RLPReader.readBytes(_node);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L97-L97) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L221-L221)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit Try to make a `constant` with `89` value
152:         if (_proof.data.length != 89) revert SGX_INVALID_PROOF();

//@audit Try to make a `constant` with `24` value
156:         bytes memory signature = Bytes.slice(_proof.data, 24);

//@audit Try to make a `constant` with `4` value
154:         uint32 id = uint32(bytes4(Bytes.slice(_proof.data, 0, 4)));

//@audit Try to make a `constant` with `4` value
155:         address newInstance = address(bytes20(Bytes.slice(_proof.data, 4, 20)));

//@audit Try to make a `constant` with `20` value
155:         address newInstance = address(bytes20(Bytes.slice(_proof.data, 4, 20)));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L152-L152) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L155-L155)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit Try to make a `constant` with `32` value
313:         bytes32 expectedAuthDataHash = bytes32(qeEnclaveReport.reportData.substring(0, 32));

//@audit Try to make a `constant` with `3` value
420:             for (uint256 i; i < 3; ++i) {

//@audit Try to make a `constant` with `3` value
419:             parsedQuoteCerts = new IPEMCertChainLib.ECSha256Certificate[](3);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L313-L313) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L420-L420), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L419-L419)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit Try to make a `constant` with `32` value
174:             bytes memory sigX = _trimBytes(der.bytesAt(sigPtr), 32);

//@audit Try to make a `constant` with `32` value
177:             bytes memory sigY = _trimBytes(der.bytesAt(sigPtr), 32);

//@audit Try to make a `constant` with `64` value
180:             cert.pubKey = _trimBytes(der.bytesAt(subjectPublicKeyInfoPtr), 64);

//@audit Try to make a `constant` with `0xA3` value
189:             if (der[tbsPtr.ixs()] != 0xA3) {

//@audit Try to make a `constant` with `3` value
171:             sigPtr = NodePtr.getPtr(sigPtr.ixs() + 3, sigPtr.ixf() + 3, sigPtr.ixl());

//@audit Try to make a `constant` with `3` value
171:             sigPtr = NodePtr.getPtr(sigPtr.ixs() + 3, sigPtr.ixf() + 3, sigPtr.ixl());

//@audit Try to make a `constant` with `0x17` value
135:                 (notBeforeTag != 0x17 && notBeforeTag == 0x18)

//@audit Try to make a `constant` with `0x18` value
135:                 (notBeforeTag != 0x17 && notBeforeTag == 0x18)

//@audit Try to make a `constant` with `0x17` value
136:                     || (notAfterTag != 0x17 && notAfterTag != 0x18)

//@audit Try to make a `constant` with `0x18` value
136:                     || (notAfterTag != 0x17 && notAfterTag != 0x18)

//@audit Try to make a `constant` with `0x06` value
288:             if (der[internalPtr.ixs()] != 0x06) {

//@audit Try to make a `constant` with `0x06` value
303:                     if (der[extnValueOidPtr.ixs()] != 0x06) {

//@audit Try to make a `constant` with `256` value
359:                 ? uint16(bytes2(svnValueBytes)) / 256


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L174-L174) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L189-L189), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L288-L288), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L359-L359)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit Try to make a `constant` with `48` value
38:         bytes memory rawHeader = quote.substring(0, 48);

//@audit Try to make a `constant` with `48` value
51:         bytes memory rawLocalEnclaveReport = quote.substring(48, 384);

//@audit Try to make a `constant` with `384` value
51:         bytes memory rawLocalEnclaveReport = quote.substring(48, 384);

//@audit Try to make a `constant` with `432` value
33:         uint256 localAuthDataSize = littleEndianDecode(quote.substring(432, 4));

//@audit Try to make a `constant` with `4` value
33:         uint256 localAuthDataSize = littleEndianDecode(quote.substring(432, 4));

//@audit Try to make a `constant` with `436` value
34:         if (quote.length - 436 != localAuthDataSize) {

//@audit Try to make a `constant` with `436` value
46:             parseAuthDataAndVerifyCertType(quote.substring(436, localAuthDataSize), pemCertLibAddr);

//@audit Try to make a `constant` with `3 certs in chain` value
92:             v3Quote.v3AuthData.certification.decodedCertDataArray.length == 3, "3 certs in chain"

//@audit Try to make a `constant` with `5` value
88:             v3Quote.v3AuthData.certification.certType == 5,

//@audit Try to make a `constant` with `3` value
92:             v3Quote.v3AuthData.certification.decodedCertDataArray.length == 3, "3 certs in chain"

//@audit Try to make a `constant` with `4` value
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit Try to make a `constant` with `64` value
79:                 && localEnclaveReport.reportData.length == 64,

//@audit Try to make a `constant` with `64` value
84:                 && pckSignedQeReport.reportData.length == 64,

//@audit Try to make a `constant` with `64` value
97:                 && v3Quote.v3AuthData.qeReportSignature.length == 64,

//@audit Try to make a `constant` with `96` value
78:             localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60

//@audit Try to make a `constant` with `60` value
78:             localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60

//@audit Try to make a `constant` with `96` value
83:             pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60

//@audit Try to make a `constant` with `60` value
83:             pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60

//@audit Try to make a `constant` with `64` value
95:             v3Quote.v3AuthData.ecdsa256BitSignature.length == 64

//@audit Try to make a `constant` with `64` value
96:                 && v3Quote.v3AuthData.ecdsaAttestationKey.length == 64

//@audit Try to make a `constant` with `64` value
111:             + 64 // qeReportSignature

//@audit Try to make a `constant` with `384` value
110:             + 384 // QE report

//@audit Try to make a `constant` with `64` value
109:             + 64 // ecdsaAttestationKey

//@audit Try to make a `constant` with `64` value
108:             + 64 // ecdsa256BitSignature

//@audit Try to make a `constant` with `48` value
106:         uint32 totalQuoteSize = 48 // header

//@audit Try to make a `constant` with `384` value
107:             + 384 // local QE report

//@audit Try to make a `constant` with `160` value
145:         enclaveReport.reserved3 = rawEnclaveReport.substring(160, 96);

//@audit Try to make a `constant` with `96` value
145:         enclaveReport.reserved3 = rawEnclaveReport.substring(160, 96);

//@audit Try to make a `constant` with `260` value
148:         enclaveReport.reserved4 = rawEnclaveReport.substring(260, 60);

//@audit Try to make a `constant` with `60` value
148:         enclaveReport.reserved4 = rawEnclaveReport.substring(260, 60);

//@audit Try to make a `constant` with `320` value
149:         enclaveReport.reportData = rawEnclaveReport.substring(320, 64);

//@audit Try to make a `constant` with `64` value
149:         enclaveReport.reportData = rawEnclaveReport.substring(320, 64);

//@audit Try to make a `constant` with `16` value
138:         enclaveReport.cpuSvn = bytes16(rawEnclaveReport.substring(0, 16));

//@audit Try to make a `constant` with `16` value
139:         enclaveReport.miscSelect = bytes4(rawEnclaveReport.substring(16, 4));

//@audit Try to make a `constant` with `4` value
139:         enclaveReport.miscSelect = bytes4(rawEnclaveReport.substring(16, 4));

//@audit Try to make a `constant` with `20` value
140:         enclaveReport.reserved1 = bytes28(rawEnclaveReport.substring(20, 28));

//@audit Try to make a `constant` with `28` value
140:         enclaveReport.reserved1 = bytes28(rawEnclaveReport.substring(20, 28));

//@audit Try to make a `constant` with `48` value
141:         enclaveReport.attributes = bytes16(rawEnclaveReport.substring(48, 16));

//@audit Try to make a `constant` with `16` value
141:         enclaveReport.attributes = bytes16(rawEnclaveReport.substring(48, 16));

//@audit Try to make a `constant` with `64` value
142:         enclaveReport.mrEnclave = bytes32(rawEnclaveReport.substring(64, 32));

//@audit Try to make a `constant` with `32` value
142:         enclaveReport.mrEnclave = bytes32(rawEnclaveReport.substring(64, 32));

//@audit Try to make a `constant` with `96` value
143:         enclaveReport.reserved2 = bytes32(rawEnclaveReport.substring(96, 32));

//@audit Try to make a `constant` with `32` value
143:         enclaveReport.reserved2 = bytes32(rawEnclaveReport.substring(96, 32));

//@audit Try to make a `constant` with `128` value
144:         enclaveReport.mrSigner = bytes32(rawEnclaveReport.substring(128, 32));

//@audit Try to make a `constant` with `32` value
144:         enclaveReport.mrSigner = bytes32(rawEnclaveReport.substring(128, 32));

//@audit Try to make a `constant` with `256` value
146:         enclaveReport.isvProdId = uint16(littleEndianDecode(rawEnclaveReport.substring(256, 2)));

//@audit Try to make a `constant` with `258` value
147:         enclaveReport.isvSvn = uint16(littleEndianDecode(rawEnclaveReport.substring(258, 2)));

//@audit Try to make a `constant` with `16` value
155:             uint256 upperDigit = digits / 16;

//@audit Try to make a `constant` with `16` value
156:             uint256 lowerDigit = digits % 16;

//@audit Try to make a `constant` with `16` value
158:             uint256 acc = lowerDigit * (16 ** (2 * i));

//@audit Try to make a `constant` with `16` value
159:             acc += upperDigit * (16 ** ((2 * i) + 1));

//@audit Try to make a `constant` with `4` value
180:         bytes4 teeType = bytes4(rawHeader.substring(4, 4));

//@audit Try to make a `constant` with `4` value
180:         bytes4 teeType = bytes4(rawHeader.substring(4, 4));

//@audit Try to make a `constant` with `12` value
185:         bytes16 qeVendorId = bytes16(rawHeader.substring(12, 16));

//@audit Try to make a `constant` with `16` value
185:         bytes16 qeVendorId = bytes16(rawHeader.substring(12, 16));

//@audit Try to make a `constant` with `8` value
194:             qeSvn: bytes2(rawHeader.substring(8, 2)),

//@audit Try to make a `constant` with `10` value
195:             pceSvn: bytes2(rawHeader.substring(10, 2)),

//@audit Try to make a `constant` with `28` value
197:             userData: bytes20(rawHeader.substring(28, 20))

//@audit Try to make a `constant` with `20` value
197:             userData: bytes20(rawHeader.substring(28, 20))

//@audit Try to make a `constant` with `578` value
215:         uint256 offset = 578 + qeAuthData.parsedDataSize;

//@audit Try to make a `constant` with `4` value
223:         offset += 4;

//@audit Try to make a `constant` with `128` value
229:         bytes memory rawQeReport = rawAuthData.substring(128, 384);

//@audit Try to make a `constant` with `384` value
229:         bytes memory rawQeReport = rawAuthData.substring(128, 384);

//@audit Try to make a `constant` with `578` value
213:         qeAuthData.data = rawAuthData.substring(578, qeAuthData.parsedDataSize);

//@audit Try to make a `constant` with `5` value
218:         if (cert.certType < 1 || cert.certType > 5) {

//@audit Try to make a `constant` with `64` value
227:         authDataV3.ecdsa256BitSignature = rawAuthData.substring(0, 64);

//@audit Try to make a `constant` with `64` value
228:         authDataV3.ecdsaAttestationKey = rawAuthData.substring(64, 64);

//@audit Try to make a `constant` with `64` value
228:         authDataV3.ecdsaAttestationKey = rawAuthData.substring(64, 64);

//@audit Try to make a `constant` with `512` value
231:         authDataV3.qeReportSignature = rawAuthData.substring(512, 64);

//@audit Try to make a `constant` with `64` value
231:         authDataV3.qeReportSignature = rawAuthData.substring(512, 64);

//@audit Try to make a `constant` with `576` value
212:         qeAuthData.parsedDataSize = uint16(littleEndianDecode(rawAuthData.substring(576, 2)));

//@audit Try to make a `constant` with `4` value
222:         cert.certDataSize = uint32(littleEndianDecode(rawAuthData.substring(offset, 4)));

//@audit Try to make a `constant` with `8` value
249:         uint16 isvProdIdPackBE = (enclaveReport.isvProdId >> 8) | (enclaveReport.isvProdId << 8);

//@audit Try to make a `constant` with `8` value
249:         uint16 isvProdIdPackBE = (enclaveReport.isvProdId >> 8) | (enclaveReport.isvProdId << 8);

//@audit Try to make a `constant` with `8` value
250:         uint16 isvSvnPackBE = (enclaveReport.isvSvn >> 8) | (enclaveReport.isvSvn << 8);

//@audit Try to make a `constant` with `8` value
250:         uint16 isvSvnPackBE = (enclaveReport.isvSvn >> 8) | (enclaveReport.isvSvn << 8);

//@audit Try to make a `constant` with `3` value
278:             pemCertLib.splitCertificateChain(certBytes, 3);

//@audit Try to make a `constant` with `3` value
281:         for (uint256 i; i < 3; ++i) {

//@audit Try to make a `constant` with `3` value
280:         parsedQuoteCerts = new IPEMCertChainLib.ECSha256Certificate[](3);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L108-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L146-L146), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L194-L194), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L197-L197), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L197-L197), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L215-L215), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L213-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L218-L218), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L222-L222), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L249-L249), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L250-L250), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L278-L278), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L281-L281), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L280-L280)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit Try to make a `constant` with `80` value
20:         return uint80(self >> 80);

//@audit Try to make a `constant` with `160` value
25:         return uint80(self >> 160);

//@audit Try to make a `constant` with `80` value
30:         _ixs |= _ixf << 80;

//@audit Try to make a `constant` with `160` value
31:         _ixs |= _ixl << 160;

//@audit Try to make a `constant` with `0x03` value
57:         require(der[ptr.ixs()] == 0x03, "Not type BIT STRING");

//@audit Try to make a `constant` with `0x04` value
67:         require(der[ptr.ixs()] == 0x04, "Not type OCTET STRING");

//@audit Try to make a `constant` with `0x20` value
88:         require(der[ptr.ixs()] & 0x20 == 0x20, "Not a constructed type");

//@audit Try to make a `constant` with `0x20` value
88:         require(der[ptr.ixs()] & 0x20 == 0x20, "Not a constructed type");

//@audit Try to make a `constant` with `0x80` value
143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

//@audit Try to make a `constant` with `8` value
145:         return uint256(der.readBytesN(ptr.ixf(), len) >> (32 - len) * 8);

//@audit Try to make a `constant` with `32` value
145:         return uint256(der.readBytesN(ptr.ixf(), len) >> (32 - len) * 8);

//@audit Try to make a `constant` with `0x80` value
156:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

//@audit Try to make a `constant` with `0x03` value
180:         require(der[ptr.ixs()] == 0x03, "ixs Not type BIT STRING 0x03");

//@audit Try to make a `constant` with `0x80` value
191:         if ((der[ix + 1] & 0x80) == 0) {

//@audit Try to make a `constant` with `0x7F` value
196:             uint8 lengthbytesLength = uint8(der[ix + 1] & 0x7F);

//@audit Try to make a `constant` with `8` value
203:                     der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8

//@audit Try to make a `constant` with `32` value
203:                     der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L203-L203)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit Try to make a `constant` with `32` value
80:         for (uint256 idx = 0; idx < shortest; idx += 32) {

//@audit Try to make a `constant` with `32` value
100:             selfptr += 32;

//@audit Try to make a `constant` with `32` value
101:             otherptr += 32;

//@audit Try to make a `constant` with `32` value
90:                 if (shortest > 32) {

//@audit Try to make a `constant` with `8` value
93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);

//@audit Try to make a `constant` with `32` value
93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);

//@audit Try to make a `constant` with `4` value
212:         require(idx + 4 <= self.length, "unexpected idx");

//@audit Try to make a `constant` with `32` value
225:         require(idx + 32 <= self.length, "unexpected idx");

//@audit Try to make a `constant` with `20` value
238:         require(idx + 20 <= self.length, "unexpected idx");

//@audit Try to make a `constant` with `32` value
264:         require(len <= 32, "unexpected len");

//@audit Try to make a `constant` with `5` value
344:         uint256 bitlen = len * 5;

//@audit Try to make a `constant` with `52` value
329:         require(len <= 52, "unexpected len");

//@audit Try to make a `constant` with `8` value
345:         if (len % 8 == 0) {

//@audit Try to make a `constant` with `8` value
348:         } else if (len % 8 == 2) {

//@audit Try to make a `constant` with `4` value
352:         } else if (len % 8 == 4) {

//@audit Try to make a `constant` with `0x20` value
337:             require(decoded <= 0x20, "invalid decoded");

//@audit Try to make a `constant` with `8` value
352:         } else if (len % 8 == 4) {

//@audit Try to make a `constant` with `5` value
356:         } else if (len % 8 == 5) {

//@audit Try to make a `constant` with `256` value
368:         return bytes32(ret << (256 - bitlen));

//@audit Try to make a `constant` with `0x30` value
335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

//@audit Try to make a `constant` with `0x7A` value
335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

//@audit Try to make a `constant` with `8` value
356:         } else if (len % 8 == 5) {

//@audit Try to make a `constant` with `7` value
360:         } else if (len % 8 == 7) {

//@audit Try to make a `constant` with `4` value
355:             bitlen -= 4;

//@audit Try to make a `constant` with `0x30` value
336:             decoded = uint8(BASE32_HEX_TABLE[uint256(uint8(char)) - 0x30]);

//@audit Try to make a `constant` with `5` value
341:             ret = (ret << 5) | decoded;

//@audit Try to make a `constant` with `8` value
360:         } else if (len % 8 == 7) {

//@audit Try to make a `constant` with `5` value
347:             ret = (ret << 5) | decoded;

//@audit Try to make a `constant` with `3` value
363:             bitlen -= 3;

//@audit Try to make a `constant` with `3` value
350:             ret = (ret << 3) | (decoded >> 2);

//@audit Try to make a `constant` with `4` value
354:             ret = (ret << 1) | (decoded >> 4);

//@audit Try to make a `constant` with `4` value
358:             ret = (ret << 4) | (decoded >> 1);

//@audit Try to make a `constant` with `3` value
362:             ret = (ret << 2) | (decoded >> 3);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L80-L80) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L344-L344), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L329-L329), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L345-L345), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L348-L348), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L337-L337), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L356-L356), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L368-L368), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L335-L335), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L335-L335), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L356-L356), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L360-L360), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L355-L355), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L336-L336), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L341-L341), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L360-L360), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L347-L347), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L363-L363), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L350-L350), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L354-L354), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L358-L358), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L362-L362)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

//@audit Try to make a `constant` with `0x30` value
54:             0x30,

//@audit Try to make a `constant` with `0x31` value
55:             0x31,

//@audit Try to make a `constant` with `0x30` value
56:             0x30,

//@audit Try to make a `constant` with `0x0d` value
57:             0x0d,

//@audit Try to make a `constant` with `0x06` value
58:             0x06,

//@audit Try to make a `constant` with `0x09` value
59:             0x09,

//@audit Try to make a `constant` with `0x60` value
60:             0x60,

//@audit Try to make a `constant` with `0x86` value
61:             0x86,

//@audit Try to make a `constant` with `0x48` value
62:             0x48,

//@audit Try to make a `constant` with `0x65` value
64:             0x65,

//@audit Try to make a `constant` with `0x03` value
65:             0x03,

//@audit Try to make a `constant` with `0x04` value
66:             0x04,

//@audit Try to make a `constant` with `0x05` value
69:             0x05,

//@audit Try to make a `constant` with `0x30` value
74:             0x30,

//@audit Try to make a `constant` with `0x2f` value
75:             0x2f,

//@audit Try to make a `constant` with `0x30` value
76:             0x30,

//@audit Try to make a `constant` with `0x0b` value
77:             0x0b,

//@audit Try to make a `constant` with `0x06` value
78:             0x06,

//@audit Try to make a `constant` with `0x09` value
79:             0x09,

//@audit Try to make a `constant` with `0x60` value
80:             0x60,

//@audit Try to make a `constant` with `0x86` value
81:             0x86,

//@audit Try to make a `constant` with `0x48` value
82:             0x48,

//@audit Try to make a `constant` with `0x65` value
84:             0x65,

//@audit Try to make a `constant` with `0x03` value
85:             0x03,

//@audit Try to make a `constant` with `0x04` value
86:             0x04,

//@audit Try to make a `constant` with `0x31` value
125:         if (uint8(decipher[decipherlen - 50]) == 0x31) {

//@audit Try to make a `constant` with `32` value
135:         uint256 paddingLen = decipherlen - 5 - digestAlgoWithParamLen - 32;

//@audit Try to make a `constant` with `0x2f` value
128:         } else if (uint8(decipher[decipherlen - 48]) == 0x2f) {

//@audit Try to make a `constant` with `0x04` value
168:             decipher[3 + paddingLen + digestAlgoWithParamLen] != 0x04

//@audit Try to make a `constant` with `0x20` value
169:                 || decipher[4 + paddingLen + digestAlgoWithParamLen] != 0x20

//@audit Try to make a `constant` with `5` value
135:         uint256 paddingLen = decipherlen - 5 - digestAlgoWithParamLen - 32;

//@audit Try to make a `constant` with `0xff` value
141:             if (decipher[i] != 0xff) {

//@audit Try to make a `constant` with `50` value
125:         if (uint8(decipher[decipherlen - 50]) == 0x31) {

//@audit Try to make a `constant` with `48` value
128:         } else if (uint8(decipher[decipherlen - 48]) == 0x2f) {

//@audit Try to make a `constant` with `3` value
168:             decipher[3 + paddingLen + digestAlgoWithParamLen] != 0x04

//@audit Try to make a `constant` with `4` value
169:                 || decipher[4 + paddingLen + digestAlgoWithParamLen] != 0x20

//@audit Try to make a `constant` with `5` value
175:             if (decipher[5 + paddingLen + digestAlgoWithParamLen + i] != _sha256[i]) {

//@audit Try to make a `constant` with `3` value
159:                 if (decipher[3 + paddingLen + i] != bytes1(sha256ImplicitNullParam[i])) {

//@audit Try to make a `constant` with `3` value
153:                 if (decipher[3 + paddingLen + i] != bytes1(sha256ExplicitNullParam[i])) {

//@audit Try to make a `constant` with `0x30` value
223:             0x30,

//@audit Try to make a `constant` with `0x21` value
224:             0x21,

//@audit Try to make a `constant` with `0x30` value
225:             0x30,

//@audit Try to make a `constant` with `0x09` value
226:             0x09,

//@audit Try to make a `constant` with `0x06` value
227:             0x06,

//@audit Try to make a `constant` with `0x05` value
228:             0x05,

//@audit Try to make a `constant` with `0x2b` value
229:             0x2b,

//@audit Try to make a `constant` with `0x0e` value
230:             0x0e,

//@audit Try to make a `constant` with `0x03` value
231:             0x03,

//@audit Try to make a `constant` with `0x1a` value
233:             0x1a,

//@audit Try to make a `constant` with `0x05` value
234:             0x05,

//@audit Try to make a `constant` with `0x04` value
236:             0x04,

//@audit Try to make a `constant` with `0x14` value
237:             0x14

//@audit Try to make a `constant` with `20` value
268:         uint256 paddingLen = decipherlen - 3 - sha1Prefix.length - 20;

//@audit Try to make a `constant` with `3` value
268:         uint256 paddingLen = decipherlen - 3 - sha1Prefix.length - 20;

//@audit Try to make a `constant` with `0xff` value
274:             if (decipher[i] != 0xff) {

//@audit Try to make a `constant` with `3` value
284:             if (decipher[3 + paddingLen + i] != bytes1(sha1Prefix[i])) {

//@audit Try to make a `constant` with `3` value
291:             if (decipher[3 + paddingLen + sha1Prefix.length + i] != _sha1[i]) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L80-L80), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L81-L81), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L86-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L153-L153), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L230-L230), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L234-L234), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L236-L236), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L268-L268), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L268-L268), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L274-L274), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L291-L291)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

//@audit Try to make a `constant` with `3` value
89:         bytes memory exponent = publicKey.substring(0, 3);

//@audit Try to make a `constant` with `3` value
90:         bytes memory modulus = publicKey.substring(3, publicKey.length - 3);

//@audit Try to make a `constant` with `3` value
90:         bytes memory modulus = publicKey.substring(3, publicKey.length - 3);

//@audit Try to make a `constant` with `3` value
106:         bytes memory exponent = publicKey.substring(0, 3);

//@audit Try to make a `constant` with `3` value
107:         bytes memory modulus = publicKey.substring(3, publicKey.length - 3);

//@audit Try to make a `constant` with `3` value
107:         bytes memory modulus = publicKey.substring(3, publicKey.length - 3);

//@audit Try to make a `constant` with `64` value
123:         if (signature.length != 64) {

//@audit Try to make a `constant` with `64` value
129:         if (publicKey.length != 64) {

//@audit Try to make a `constant` with `32` value
126:         uint256 r = uint256(bytes32(signature.substring(0, 32)));

//@audit Try to make a `constant` with `32` value
127:         uint256 s = uint256(bytes32(signature.substring(32, 32)));

//@audit Try to make a `constant` with `32` value
127:         uint256 s = uint256(bytes32(signature.substring(32, 32)));

//@audit Try to make a `constant` with `32` value
132:         uint256 gx = uint256(bytes32(publicKey.substring(0, 32)));

//@audit Try to make a `constant` with `32` value
133:         uint256 gy = uint256(bytes32(publicKey.substring(32, 32)));

//@audit Try to make a `constant` with `32` value
133:         uint256 gy = uint256(bytes32(publicKey.substring(32, 32)));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L89-L89) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L133-L133)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

//@audit Try to make a `constant` with `13` value
17:         if (x509Time.length == 13) {

//@audit Try to make a `constant` with `48` value
24:         yrs += (uint8(x509Time[offset + 0]) - 48) * 10 + uint8(x509Time[offset + 1]) - 48;

//@audit Try to make a `constant` with `48` value
25:         mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;

//@audit Try to make a `constant` with `48` value
26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;

//@audit Try to make a `constant` with `48` value
27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;

//@audit Try to make a `constant` with `48` value
28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;

//@audit Try to make a `constant` with `48` value
29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;

//@audit Try to make a `constant` with `5` value
18:             if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;

//@audit Try to make a `constant` with `48` value
18:             if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;

//@audit Try to make a `constant` with `1900` value
19:             else yrs += 1900;

//@audit Try to make a `constant` with `2000` value
18:             if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;

//@audit Try to make a `constant` with `10` value
24:         yrs += (uint8(x509Time[offset + 0]) - 48) * 10 + uint8(x509Time[offset + 1]) - 48;

//@audit Try to make a `constant` with `10` value
25:         mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;

//@audit Try to make a `constant` with `10` value
26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;

//@audit Try to make a `constant` with `10` value
27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;

//@audit Try to make a `constant` with `10` value
28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;

//@audit Try to make a `constant` with `10` value
29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;

//@audit Try to make a `constant` with `1000` value
21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;

//@audit Try to make a `constant` with `100` value
21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;

//@audit Try to make a `constant` with `48` value
24:         yrs += (uint8(x509Time[offset + 0]) - 48) * 10 + uint8(x509Time[offset + 1]) - 48;

//@audit Try to make a `constant` with `48` value
25:         mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;

//@audit Try to make a `constant` with `3` value
25:         mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;

//@audit Try to make a `constant` with `48` value
26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;

//@audit Try to make a `constant` with `5` value
26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;

//@audit Try to make a `constant` with `48` value
27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;

//@audit Try to make a `constant` with `7` value
27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;

//@audit Try to make a `constant` with `48` value
28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;

//@audit Try to make a `constant` with `9` value
28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;

//@audit Try to make a `constant` with `48` value
29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;

//@audit Try to make a `constant` with `11` value
29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;

//@audit Try to make a `constant` with `48` value
21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;

//@audit Try to make a `constant` with `48` value
21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;

//@audit Try to make a `constant` with `4` value
26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;

//@audit Try to make a `constant` with `6` value
27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;

//@audit Try to make a `constant` with `8` value
28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;

//@audit Try to make a `constant` with `10` value
29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;

//@audit Try to make a `constant` with `1970` value
48:         for (uint16 i = 1970; i < year; ++i) {

//@audit Try to make a `constant` with `31` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `28` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `31` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `30` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `31` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `30` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `31` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `31` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `30` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `31` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `30` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `31` value
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];

//@audit Try to make a `constant` with `29` value
57:         if (isLeapYear(year)) monthDays[1] = 29;

//@audit Try to make a `constant` with `86_400` value
63:         timestamp += uint256(day - 1) * 86_400; // Days in seconds

//@audit Try to make a `constant` with `3600` value
64:         timestamp += uint256(hour) * 3600; // Hours in seconds

//@audit Try to make a `constant` with `60` value
65:         timestamp += uint256(minute) * 60; // Minutes in seconds

//@audit Try to make a `constant` with `86_400` value
60:             timestamp += uint256(monthDays[i - 1]) * 86_400; // Days in seconds

//@audit Try to make a `constant` with `31_536_000` value
52:                 timestamp += 31_536_000; // Normal year in seconds

//@audit Try to make a `constant` with `31_622_400` value
50:                 timestamp += 31_622_400; // Leap year in seconds

//@audit Try to make a `constant` with `4` value
72:         if (year % 4 != 0) return false;

//@audit Try to make a `constant` with `100` value
73:         if (year % 100 != 0) return true;

//@audit Try to make a `constant` with `400` value
74:         if (year % 400 != 0) return false;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L72-L72), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L74-L74)


</details>


### [NC&#x2011;75] Use `@inheritdoc` rather than using a non-standard annotation 



*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

47:     /// @dev See {IGovernor-propose}

88:     /// @dev See {GovernorUpgradeable-supportsInterface}

98:     /// @dev See {GovernorUpgradeable-state}


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L98-L98)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

189:     /// @dev See {BaseVault-supportsInterface}.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L189-L189) 


</details>


### [NC&#x2011;76] Use OpenZeppelin's `ReentrancyGuard` / `ReentrancyGuardUpgradeable` rather than writing your own 
The OpenZeppelin version has been gas-optimized, and thoroughly test, so consider using it rather than writing your own


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

46:     modifier nonReentrant() {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L46-L46) 


</details>


### [NC&#x2011;77] Use a single file for system wide constants 
Consider grouping all the system constants under a single file. This finding shows only the first constant for each file.


*There are 21 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

11:     uint8 private constant _FALSE = 1;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L11-L11) 


```solidity

File: /contracts/libs/Lib4844.sol

10:     address public constant POINT_EVALUATION_PRECOMPILE_ADDRESS = address(0x0A);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L10-L10) 


```solidity

File: /contracts/libs/LibAddress.sol

14:     bytes4 private constant _EIP1271_MAGICVALUE = 0x1626ba7e;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L14-L14) 


```solidity

File: /contracts/libs/LibTrieProof.sol

18:     uint256 private constant _ACCOUNT_FIELD_INDEX_STORAGE_HASH = 2;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L18-L18) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

38:     uint256 public constant MAX_GAS_PAYING_PROVER = 50_000;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L38-L38) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

21:     uint256 public constant MAX_BYTES_PER_BLOB = 4096 * 32;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L21-L21) 


```solidity

File: /contracts/L1/libs/LibProving.sol

20:     bytes32 public constant RETURN_LIVENESS_BOND = keccak256("RETURN_LIVENESS_BOND");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L20-L20) 


```solidity

File: /contracts/L1/provers/Guardians.sol

11:     uint256 public constant MIN_NUM_GUARDIANS = 5;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

39:     uint16 public constant TIER_OPTIMISTIC = 100;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L39-L39) 


```solidity

File: /contracts/L2/TaikoL2.sol

32:     address public constant GOLDEN_TOUCH_ADDRESS = 0x0000777735367b36bC9B61C50022d9D0700dB4Ec;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L32-L32) 


```solidity

File: /contracts/signal/LibSignals.sol

8:     bytes32 public constant STATE_ROOT = keccak256("STATE_ROOT");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/LibSignals.sol#L8-L8) 


```solidity

File: /contracts/bridge/Bridge.sol

23:     bytes32 private constant _CTX_SLOT =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L23-L23) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

47:     bytes4 public constant ERC1155_INTERFACE_ID = 0xd9b67a26;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L47-L47) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

6:     uint256 constant LOW_28_MASK =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6-L6) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

30:     uint256 internal constant MAX_LIST_LENGTH = 32;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L30-L30) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

21:     uint256 internal constant TREE_RADIX = 16;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L21-L21) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

30:     uint64 public constant INSTANCE_EXPIRY = 180 days;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L30-L30) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

29:     uint256 internal constant CPUSVN_LENGTH = 16;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L29-L29) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

17:     string internal constant HEADER = "-----BEGIN CERTIFICATE-----";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L17-L17) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

14:     uint256 internal constant MINIMUM_QUOTE_LENGTH = 1020;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L14-L14) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

310:     bytes constant BASE32_HEX_TABLE =


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L310-L310) 


</details>


### [NC&#x2011;78] Consider using SMTChecker 
The SMTChecker is a valuable tool for Solidity developers as it helps detect potential vulnerabilities and logical errors in the contract's code. By utilizing Satisfiability Modulo Theories (SMT) solvers, it can reason about the potential states a contract can be in, and therefore, identify conditions that could lead to undesirable behavior. This automatic formal verification can catch issues that might otherwise be missed in manual code reviews or standard testing, enhancing the overall contract's security and reliability.


*There are 79 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L2-L2) 


```solidity

File: /contracts/common/AddressManager.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L2-L2) 


```solidity

File: /contracts/common/EssentialContract.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L2-L2) 


```solidity

File: /contracts/libs/Lib4844.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L2-L2) 


```solidity

File: /contracts/libs/LibAddress.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L2-L2) 


```solidity

File: /contracts/libs/LibMath.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L2-L2) 


```solidity

File: /contracts/libs/LibTrieProof.sol

7: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L7-L7) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L2-L2) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L2-L2) 


```solidity

File: /contracts/L1/hooks/IHook.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L2-L2) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L2-L2) 


```solidity

File: /contracts/L1/ITaikoL1.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L2-L2) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L2-L2) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L2-L2) 


```solidity

File: /contracts/L1/libs/LibProving.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L2-L2) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L2-L2) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L2-L2) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L2-L2) 


```solidity

File: /contracts/L1/provers/Guardians.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L2-L2) 


```solidity

File: /contracts/L1/TaikoData.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L2-L2) 


```solidity

File: /contracts/L1/TaikoErrors.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L2-L2) 


```solidity

File: /contracts/L1/TaikoEvents.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L2-L2) 


```solidity

File: /contracts/L1/TaikoL1.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L2-L2) 


```solidity

File: /contracts/L1/TaikoToken.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L2-L2) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L2-L2) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L2-L2) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L2-L2) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L2-L2) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L2-L2) 


```solidity

File: /contracts/L2/Lib1559Math.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L2-L2) 


```solidity

File: /contracts/L2/TaikoL2.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L2-L2) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L2-L2) 


```solidity

File: /contracts/signal/ISignalService.sol

2: pragma solidity 0.8.24;

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L2-L2) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L2-L2)


```solidity

File: /contracts/signal/LibSignals.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/LibSignals.sol#L2-L2) 


```solidity

File: /contracts/signal/SignalService.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L2-L2) 


```solidity

File: /contracts/bridge/IBridge.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L2-L2) 


```solidity

File: /contracts/bridge/Bridge.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/IBridgedERC20.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L2-L2) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

3: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L3-L3) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L2-L2) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L2-L2) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L2-L2) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L2-L2) 


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L2-L2) 


```solidity

File: /contracts/verifiers/IVerifier.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L2-L2) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L2-L2) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L2-L2) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L2-L2) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L2-L2) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L2-L2) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L2-L2) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/lib/EnclaveIdStruct.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/lib/TCBInfoStruct.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

3: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L3-L3) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

3: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L3-L3) 


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

3: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L3-L3) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

3: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L3-L3) 


</details>


### [NC&#x2011;79] Whitespace in Expressions 
See the [Whitespace in Expressions](https://docs.soliditylang.org/en/latest/style-guide.html#whitespace-in-expressions) section of the Solidity Style Guide


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/TaikoL2.sol

//@audit remove the whiteSpace before the ')' char
243:             publicInputHashOld := keccak256(inputs, 8192 /*mul(256, 32)*/ )
244:         }

//@audit remove the whiteSpace before the ')' char
248:             publicInputHashNew := keccak256(inputs, 8192 /*mul(256, 32)*/ )
249:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L243-L244) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L248-L249)


</details>


### [NC&#x2011;80] Complex function controle flow 
Due to multiple if, loop and conditions the following functions has a very complex controle flow that could make auditing very difficult to cover all possible path\nTherefore, consider breaking down these blocks into more manageable units, by splitting things into utility functions, by reducing nesting, and by using early returns


*There are 15 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProposing.sol

068:     function proposeBlock(
069:         TaikoData.State storage _state,
070:         TaikoData.Config memory _config,
071:         IAddressResolver _resolver,
072:         bytes calldata _data,
073:         bytes calldata _txList
074:     )
075:         internal
076:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
077:     {
078:         TaikoData.BlockParams memory params = abi.decode(_data, (TaikoData.BlockParams));
079: 
080:         // We need a prover that will submit proofs after the block has been submitted
081:         if (params.assignedProver == address(0)) {
082:             revert L1_INVALID_PROVER();
083:         }
084: 
085:         if (params.coinbase == address(0)) {
086:             params.coinbase = msg.sender;
087:         }
088: 
089:         // Taiko, as a Based Rollup, enables permissionless block proposals.
090:         // However, if the "proposer" address is set to a non-zero value, we
091:         // ensure that only that specific address has the authority to propose
092:         // blocks.
093:         TaikoData.SlotB memory b = _state.slotB;
094:         if (!_isProposerPermitted(b, _resolver)) revert L1_UNAUTHORIZED();
095: 
096:         // It's essential to ensure that the ring buffer for proposed blocks
097:         // still has space for at least one more block.
098:         if (b.numBlocks >= b.lastVerifiedBlockId + _config.blockMaxProposals + 1) {
099:             revert L1_TOO_MANY_BLOCKS();
100:         }
101: 
102:         bytes32 parentMetaHash =
103:             _state.blocks[(b.numBlocks - 1) % _config.blockRingBufferSize].metaHash;
104: 
105:         // Check if parent block has the right meta hash
106:         // This is to allow the proposer to make sure the block builds on the expected latest chain
107:         // state
108:         if (params.parentMetaHash != 0 && parentMetaHash != params.parentMetaHash) {
109:             revert L1_UNEXPECTED_PARENT();
110:         }
111: 
112:         // Each transaction must handle a specific quantity of L1-to-L2
113:         // Ether deposits.
114:         deposits_ = LibDepositing.processDeposits(_state, _config, params.coinbase);
115: 
116:         // Initialize metadata to compute a metaHash, which forms a part of
117:         // the block data to be stored on-chain for future integrity checks.
118:         // If we choose to persist all data fields in the metadata, it will
119:         // require additional storage slots.
120:         unchecked {
121:             meta_ = TaikoData.BlockMetadata({
122:                 l1Hash: blockhash(block.number - 1),
123:                 difficulty: 0, // to be initialized below
124:                 blobHash: 0, // to be initialized below
125:                 extraData: params.extraData,
126:                 depositsHash: keccak256(abi.encode(deposits_)),
127:                 coinbase: params.coinbase,
128:                 id: b.numBlocks,
129:                 gasLimit: _config.blockMaxGasLimit,
130:                 timestamp: uint64(block.timestamp),
131:                 l1Height: uint64(block.number - 1),
132:                 txListByteOffset: 0, // to be initialized below
133:                 txListByteSize: 0, // to be initialized below
134:                 minTier: 0, // to be initialized below
135:                 blobUsed: _txList.length == 0,
136:                 parentMetaHash: parentMetaHash
137:             });
138:         }
139: 
140:         // Update certain meta fields
141:         if (meta_.blobUsed) {
142:             if (!_config.blobAllowedForDA) revert L1_BLOB_FOR_DA_DISABLED();
143: 
144:             if (params.blobHash != 0) {
145:                 if (!_config.blobReuseEnabled) revert L1_BLOB_REUSE_DISABLED();
146: 
147:                 // We try to reuse an old blob
148:                 if (!isBlobReusable(_state, _config, params.blobHash)) {
149:                     revert L1_BLOB_NOT_REUSABLE();
150:                 }
151:                 meta_.blobHash = params.blobHash;
152:             } else {
153:                 // Always use the first blob in this transaction. If the
154:                 // proposeBlock functions are called more than once in the same
155:                 // L1 transaction, these multiple L2 blocks will share the same
156:                 // blob.
157:                 meta_.blobHash = blobhash(0);
158: 
159:                 if (meta_.blobHash == 0) revert L1_BLOB_NOT_FOUND();
160: 
161:                 // Depends on the blob data price, it may not make sense to
162:                 // cache the blob which costs 20,000 (sstore) + 631 (event)
163:                 // extra gas.
164:                 if (_config.blobReuseEnabled && params.cacheBlobForReuse) {
165:                     _state.reusableBlobs[meta_.blobHash] = block.timestamp;
166:                     emit BlobCached(meta_.blobHash);
167:                 }
168:             }
169: 
170:             // Check that the txList data range is within the max size of a blob
171:             if (uint256(params.txListByteOffset) + params.txListByteSize > MAX_BYTES_PER_BLOB) {
172:                 revert L1_TXLIST_OFFSET();
173:             }
174: 
175:             meta_.txListByteOffset = params.txListByteOffset;
176:             meta_.txListByteSize = params.txListByteSize;
177:         } else {
178:             // The proposer must be an Externally Owned Account (EOA) for
179:             // calldata usage. This ensures that the transaction is not an
180:             // internal one, making calldata retrieval more straightforward for
181:             // Taiko node software.
182:             if (!LibAddress.isSenderEOA()) revert L1_PROPOSER_NOT_EOA();
183: 
184:             // The txList is the full byte array without any offset
185:             if (params.txListByteOffset != 0) {
186:                 revert L1_INVALID_PARAM();
187:             }
188: 
189:             meta_.blobHash = keccak256(_txList);
190:             meta_.txListByteOffset = 0;
191:             meta_.txListByteSize = uint24(_txList.length);
192:         }
193: 
194:         // Check that the tx length is non-zero and within the supported range
195:         if (meta_.txListByteSize == 0 || meta_.txListByteSize > _config.blockMaxTxListBytes) {
196:             revert L1_TXLIST_SIZE();
197:         }
198: 
199:         // Following the Merge, the L1 mixHash incorporates the
200:         // prevrandao value from the beacon chain. Given the possibility
201:         // of multiple Taiko blocks being proposed within a single
202:         // Ethereum block, we choose to introduce a salt to this random
203:         // number as the L2 mixHash.
204:         meta_.difficulty = keccak256(abi.encodePacked(block.prevrandao, b.numBlocks, block.number));
205: 
206:         // Use the difficulty as a random number
207:         meta_.minTier = ITierProvider(_resolver.resolve("tier_provider", false)).getMinTier(
208:             uint256(meta_.difficulty)
209:         );
210: 
211:         // Create the block that will be stored onchain
212:         TaikoData.Block memory blk = TaikoData.Block({
213:             metaHash: keccak256(abi.encode(meta_)),
214:             // Safeguard the liveness bond to ensure its preservation,
215:             // particularly in scenarios where it might be altered after the
216:             // block's proposal but before it has been proven or verified.
217:             livenessBond: _config.livenessBond,
218:             blockId: b.numBlocks,
219:             proposedAt: meta_.timestamp,
220:             proposedIn: uint64(block.number),
221:             // For a new block, the next transition ID is always 1, not 0.
222:             nextTransitionId: 1,
223:             // For unverified block, its verifiedTransitionId is always 0.
224:             verifiedTransitionId: 0,
225:             assignedProver: params.assignedProver
226:         });
227: 
228:         // Store the block in the ring buffer
229:         _state.blocks[b.numBlocks % _config.blockRingBufferSize] = blk;
230: 
231:         // Increment the counter (cursor) by 1.
232:         unchecked {
233:             ++_state.slotB.numBlocks;
234:         }
235: 
236:         {
237:             IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));
238:             uint256 tkoBalance = tko.balanceOf(address(this));
239: 
240:             // Run all hooks.
241:             // Note that address(this).balance has been updated with msg.value,
242:             // prior to any code in this function has been executed.
243:             address prevHook;
244:             for (uint256 i; i < params.hookCalls.length; ++i) {
245:                 if (uint160(prevHook) >= uint160(params.hookCalls[i].hook)) {
246:                     revert L1_INVALID_HOOK();
247:                 }
248: 
249:                 // When a hook is called, all ether in this contract will be send to the hook.
250:                 // If the ether sent to the hook is not used entirely, the hook shall send the Ether
251:                 // back to this contract for the next hook to use.
252:                 // Proposers shall choose use extra hooks wisely.
253:                 IHook(params.hookCalls[i].hook).onBlockProposed{ value: address(this).balance }(
254:                     blk, meta_, params.hookCalls[i].data
255:                 );
256: 
257:                 prevHook = params.hookCalls[i].hook;
258:             }
259:             // Refund Ether
260:             if (address(this).balance != 0) {
261:                 msg.sender.sendEther(address(this).balance);
262:             }
263: 
264:             // Check that after hooks, the Taiko Token balance of this contract
265:             // have increased by the same amount as _config.livenessBond (to prevent)
266:             // multiple draining payments by a malicious proposer nesting the same
267:             // hook.
268:             if (tko.balanceOf(address(this)) != tkoBalance + _config.livenessBond) {
269:                 revert L1_LIVENESS_BOND_NOT_RECEIVED();
270:             }
271:         }
272: 
273:         emit BlockProposed({
274:             blockId: blk.blockId,
275:             assignedProver: blk.assignedProver,
276:             livenessBond: _config.livenessBond,
277:             meta: meta_,
278:             depositsProcessed: deposits_
279:         });
280:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L280) 


```solidity

File: /contracts/L1/libs/LibProving.sol

091:     function proveBlock(
092:         TaikoData.State storage _state,
093:         TaikoData.Config memory _config,
094:         IAddressResolver _resolver,
095:         TaikoData.BlockMetadata memory _meta,
096:         TaikoData.Transition memory _tran,
097:         TaikoData.TierProof memory _proof
098:     )
099:         internal
100:         returns (uint8 maxBlocksToVerify_)
101:     {
102:         // Make sure parentHash is not zero
103:         // To contest an existing transition, simply use any non-zero value as
104:         // the blockHash and stateRoot.
105:         if (_tran.parentHash == 0 || _tran.blockHash == 0 || _tran.stateRoot == 0) {
106:             revert L1_INVALID_TRANSITION();
107:         }
108: 
109:         // Check that the block has been proposed but has not yet been verified.
110:         TaikoData.SlotB memory b = _state.slotB;
111:         if (_meta.id <= b.lastVerifiedBlockId || _meta.id >= b.numBlocks) {
112:             revert L1_INVALID_BLOCK_ID();
113:         }
114: 
115:         uint64 slot = _meta.id % _config.blockRingBufferSize;
116:         TaikoData.Block storage blk = _state.blocks[slot];
117: 
118:         // Check the integrity of the block data. It's worth noting that in
119:         // theory, this check may be skipped, but it's included for added
120:         // caution.
121:         if (blk.blockId != _meta.id || blk.metaHash != keccak256(abi.encode(_meta))) {
122:             revert L1_BLOCK_MISMATCH();
123:         }
124: 
125:         // Each transition is uniquely identified by the parentHash, with the
126:         // blockHash and stateRoot open for later updates as higher-tier proofs
127:         // become available. In cases where a transition with the specified
128:         // parentHash does not exist, the transition ID (tid) will be set to 0.
129:         (uint32 tid, TaikoData.TransitionState storage ts) =
130:             _createTransition(_state, blk, _tran, slot);
131: 
132:         // The new proof must meet or exceed the minimum tier required by the
133:         // block or the previous proof; it cannot be on a lower tier.
134:         if (_proof.tier == 0 || _proof.tier < _meta.minTier || _proof.tier < ts.tier) {
135:             revert L1_INVALID_TIER();
136:         }
137: 
138:         // Retrieve the tier configurations. If the tier is not supported, the
139:         // subsequent action will result in a revert.
140:         ITierProvider.Tier memory tier =
141:             ITierProvider(_resolver.resolve("tier_provider", false)).getTier(_proof.tier);
142: 
143:         // Check if this prover is allowed to submit a proof for this block
144:         _checkProverPermission(_state, blk, ts, tid, tier);
145: 
146:         // We must verify the proof, and any failure in proof verification will
147:         // result in a revert.
148:         //
149:         // It's crucial to emphasize that the proof can be assessed in two
150:         // potential modes: "proving mode" and "contesting mode." However, the
151:         // precise verification logic is defined within each tier's IVerifier
152:         // contract implementation. We simply specify to the verifier contract
153:         // which mode it should utilize - if the new tier is higher than the
154:         // previous tier, we employ the proving mode; otherwise, we employ the
155:         // contesting mode (the new tier cannot be lower than the previous tier,
156:         // this has been checked above).
157:         //
158:         // It's obvious that proof verification is entirely decoupled from
159:         // Taiko's core protocol.
160:         {
161:             address verifier = _resolver.resolve(tier.verifierName, true);
162: 
163:             if (verifier != address(0)) {
164:                 bool isContesting = _proof.tier == ts.tier && tier.contestBond != 0;
165: 
166:                 IVerifier.Context memory ctx = IVerifier.Context({
167:                     metaHash: blk.metaHash,
168:                     blobHash: _meta.blobHash,
169:                     // Separate msgSender to allow the prover to be any address in the future.
170:                     prover: msg.sender,
171:                     msgSender: msg.sender,
172:                     blockId: blk.blockId,
173:                     isContesting: isContesting,
174:                     blobUsed: _meta.blobUsed
175:                 });
176: 
177:                 IVerifier(verifier).verifyProof(ctx, _tran, _proof);
178:             } else if (tier.verifierName != TIER_OP) {
179:                 // The verifier can be address-zero, signifying that there are no
180:                 // proof checks for the tier. In practice, this only applies to
181:                 // optimistic proofs.
182:                 revert L1_MISSING_VERIFIER();
183:             }
184:         }
185: 
186:         bool isTopTier = tier.contestBond == 0;
187:         IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));
188: 
189:         if (isTopTier) {
190:             // A special return value from the top tier prover can signal this
191:             // contract to return all liveness bond.
192:             bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32
193:                 && bytes32(_proof.data) == RETURN_LIVENESS_BOND;
194: 
195:             if (returnLivenessBond) {
196:                 tko.transfer(blk.assignedProver, blk.livenessBond);
197:                 blk.livenessBond = 0;
198:             }
199:         }
200: 
201:         bool sameTransition = _tran.blockHash == ts.blockHash && _tran.stateRoot == ts.stateRoot;
202: 
203:         if (_proof.tier > ts.tier) {
204:             // Handles the case when an incoming tier is higher than the current transition's tier.
205:             // Reverts when the incoming proof tries to prove the same transition
206:             // (L1_ALREADY_PROVED).
207:             _overrideWithHigherProof(ts, _tran, _proof, tier, tko, sameTransition);
208: 
209:             emit TransitionProved({
210:                 blockId: blk.blockId,
211:                 tran: _tran,
212:                 prover: msg.sender,
213:                 validityBond: tier.validityBond,
214:                 tier: _proof.tier
215:             });
216:         } else {
217:             // New transition and old transition on the same tier - and if this transaction tries to
218:             // prove the same, it reverts
219:             if (sameTransition) revert L1_ALREADY_PROVED();
220: 
221:             if (isTopTier) {
222:                 // The top tier prover re-proves.
223:                 assert(tier.validityBond == 0);
224:                 assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0));
225: 
226:                 ts.prover = msg.sender;
227:                 ts.blockHash = _tran.blockHash;
228:                 ts.stateRoot = _tran.stateRoot;
229: 
230:                 emit TransitionProved({
231:                     blockId: blk.blockId,
232:                     tran: _tran,
233:                     prover: msg.sender,
234:                     validityBond: 0,
235:                     tier: _proof.tier
236:                 });
237:             } else {
238:                 // Contesting but not on the highest tier
239:                 if (ts.contester != address(0)) revert L1_ALREADY_CONTESTED();
240: 
241:                 // Burn the contest bond from the prover.
242:                 tko.transferFrom(msg.sender, address(this), tier.contestBond);
243: 
244:                 // We retain the contest bond within the transition, just in
245:                 // case this configuration is altered to a different value
246:                 // before the contest is resolved.
247:                 //
248:                 // It's worth noting that the previous value of ts.contestBond
249:                 // doesn't have any significance.
250:                 ts.contestBond = tier.contestBond;
251:                 ts.contester = msg.sender;
252:                 ts.contestations += 1;
253: 
254:                 emit TransitionContested({
255:                     blockId: blk.blockId,
256:                     tran: _tran,
257:                     contester: msg.sender,
258:                     contestBond: tier.contestBond,
259:                     tier: _proof.tier
260:                 });
261:             }
262:         }
263: 
264:         ts.timestamp = uint64(block.timestamp);
265:         return tier.maxBlocksToVerifyPerProof;
266:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L266) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

085:     function verifyBlocks(
086:         TaikoData.State storage _state,
087:         TaikoData.Config memory _config,
088:         IAddressResolver _resolver,
089:         uint64 _maxBlocksToVerify
090:     )
091:         internal
092:     {
093:         if (_maxBlocksToVerify == 0) {
094:             return;
095:         }
096: 
097:         // Retrieve the latest verified block and the associated transition used
098:         // for its verification.
099:         TaikoData.SlotB memory b = _state.slotB;
100:         uint64 blockId = b.lastVerifiedBlockId;
101: 
102:         uint64 slot = blockId % _config.blockRingBufferSize;
103: 
104:         TaikoData.Block storage blk = _state.blocks[slot];
105:         if (blk.blockId != blockId) revert L1_BLOCK_MISMATCH();
106: 
107:         uint32 tid = blk.verifiedTransitionId;
108: 
109:         // The following scenario should never occur but is included as a
110:         // precaution.
111:         if (tid == 0) revert L1_TRANSITION_ID_ZERO();
112: 
113:         // The `blockHash` variable represents the most recently trusted
114:         // blockHash on L2.
115:         bytes32 blockHash = _state.transitions[slot][tid].blockHash;
116:         bytes32 stateRoot;
117:         uint64 numBlocksVerified;
118:         address tierProvider;
119: 
120:         // Unchecked is safe:
121:         // - assignment is within ranges
122:         // - blockId and numBlocksVerified values incremented will still be OK in the
123:         // next 584K years if we verifying one block per every second
124:         unchecked {
125:             ++blockId;
126: 
127:             while (blockId < b.numBlocks && numBlocksVerified < _maxBlocksToVerify) {
128:                 slot = blockId % _config.blockRingBufferSize;
129: 
130:                 blk = _state.blocks[slot];
131:                 if (blk.blockId != blockId) revert L1_BLOCK_MISMATCH();
132: 
133:                 tid = LibUtils.getTransitionId(_state, blk, slot, blockHash);
134:                 // When `tid` is 0, it indicates that there is no proven
135:                 // transition with its parentHash equal to the blockHash of the
136:                 // most recently verified block.
137:                 if (tid == 0) break;
138: 
139:                 // A transition with the correct `parentHash` has been located.
140:                 TaikoData.TransitionState storage ts = _state.transitions[slot][tid];
141: 
142:                 // It's not possible to verify this block if either the
143:                 // transition is contested and awaiting higher-tier proof or if
144:                 // the transition is still within its cooldown period.
145:                 if (ts.contester != address(0)) {
146:                     break;
147:                 } else {
148:                     if (tierProvider == address(0)) {
149:                         tierProvider = _resolver.resolve("tier_provider", false);
150:                     }
151:                     if (
152:                         uint256(ITierProvider(tierProvider).getTier(ts.tier).cooldownWindow) * 60
153:                             + uint256(ts.timestamp).max(_state.slotB.lastUnpausedAt) > block.timestamp
154:                     ) {
155:                         // If cooldownWindow is 0, the block can theoretically
156:                         // be proved and verified within the same L1 block.
157:                         break;
158:                     }
159:                 }
160: 
161:                 // Mark this block as verified
162:                 blk.verifiedTransitionId = tid;
163: 
164:                 // Update variables
165:                 blockHash = ts.blockHash;
166:                 stateRoot = ts.stateRoot;
167: 
168:                 // We consistently return the liveness bond and the validity
169:                 // bond to the actual prover of the transition utilized for
170:                 // block verification. If the actual prover happens to be the
171:                 // block's assigned prover, he will receive both deposits,
172:                 // ultimately earning the proving fee paid during block
173:                 // proposal. In contrast, if the actual prover is different from
174:                 // the block's assigned prover, the liveness bond serves as a
175:                 // reward to the actual prover, while the assigned prover
176:                 // forfeits his liveness bond due to failure to fulfill their
177:                 // commitment.
178:                 uint256 bondToReturn = uint256(ts.validityBond) + blk.livenessBond;
179: 
180:                 // Nevertheless, it's possible for the actual prover to be the
181:                 // same individual or entity as the block's assigned prover.
182:                 // Consequently, we have chosen to grant the actual prover only
183:                 // half of the liveness bond as a reward.
184:                 if (ts.prover != blk.assignedProver) {
185:                     bondToReturn -= blk.livenessBond >> 1;
186:                 }
187: 
188:                 IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));
189:                 tko.transfer(ts.prover, bondToReturn);
190: 
191:                 // Note: We exclusively address the bonds linked to the
192:                 // transition used for verification. While there may exist
193:                 // other transitions for this block, we disregard them entirely.
194:                 // The bonds for these other transitions are burned either when
195:                 // the transitions are generated or proven. In such cases, both
196:                 // the provers and contesters of those transitions forfeit their bonds.
197: 
198:                 emit BlockVerified({
199:                     blockId: blockId,
200:                     assignedProver: blk.assignedProver,
201:                     prover: ts.prover,
202:                     blockHash: blockHash,
203:                     stateRoot: stateRoot,
204:                     tier: ts.tier,
205:                     contestations: ts.contestations
206:                 });
207: 
208:                 ++blockId;
209:                 ++numBlocksVerified;
210:             }
211: 
212:             if (numBlocksVerified > 0) {
213:                 uint64 lastVerifiedBlockId = b.lastVerifiedBlockId + numBlocksVerified;
214: 
215:                 // Update protocol level state variables
216:                 _state.slotB.lastVerifiedBlockId = lastVerifiedBlockId;
217: 
218:                 // sync chain data
219:                 _syncChainData(_config, _resolver, lastVerifiedBlockId, stateRoot);
220:             }
221:         }
222:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L85-L222) 


```solidity

File: /contracts/signal/SignalService.sol

083:     function proveSignalReceived(
084:         uint64 _chainId,
085:         address _app,
086:         bytes32 _signal,
087:         bytes calldata _proof
088:     )
089:         public
090:         virtual
091:         validSender(_app)
092:         nonZeroValue(_signal)
093:     {
094:         HopProof[] memory hopProofs = abi.decode(_proof, (HopProof[]));
095:         if (hopProofs.length == 0) revert SS_EMPTY_PROOF();
096: 
097:         uint64 chainId = _chainId;
098:         address app = _app;
099:         bytes32 signal = _signal;
100:         bytes32 value = _signal;
101:         address signalService = resolve(chainId, "signal_service", false);
102: 
103:         HopProof memory hop;
104:         for (uint256 i; i < hopProofs.length; ++i) {
105:             hop = hopProofs[i];
106: 
107:             bytes32 signalRoot = _verifyHopProof(chainId, app, signal, value, hop, signalService);
108:             bool isLastHop = i == hopProofs.length - 1;
109: 
110:             if (isLastHop) {
111:                 if (hop.chainId != block.chainid) revert SS_INVALID_LAST_HOP_CHAINID();
112:                 signalService = address(this);
113:             } else {
114:                 if (hop.chainId == 0 || hop.chainId == block.chainid) {
115:                     revert SS_INVALID_MID_HOP_CHAINID();
116:                 }
117:                 signalService = resolve(hop.chainId, "signal_service", false);
118:             }
119: 
120:             bool isFullProof = hop.accountProof.length > 0;
121: 
122:             _cacheChainData(hop, chainId, hop.blockId, signalRoot, isFullProof, isLastHop);
123: 
124:             bytes32 kind = isFullProof ? LibSignals.STATE_ROOT : LibSignals.SIGNAL_ROOT;
125:             signal = signalForChainData(chainId, kind, hop.blockId);
126:             value = hop.rootHash;
127:             chainId = hop.chainId;
128:             app = signalService;
129:         }
130: 
131:         if (value == 0 || value != _loadSignalValue(address(this), signal)) {
132:             revert SS_SIGNAL_NOT_FOUND();
133:         }
134:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L134) 


```solidity

File: /contracts/bridge/Bridge.sol

155:     function recallMessage(
156:         Message calldata _message,
157:         bytes calldata _proof
158:     )
159:         external
160:         nonReentrant
161:         whenNotPaused
162:         sameChain(_message.srcChainId)
163:     {
164:         bytes32 msgHash = hashMessage(_message);
165: 
166:         if (messageStatus[msgHash] != Status.NEW) revert B_STATUS_MISMATCH();
167: 
168:         uint64 receivedAt = proofReceipt[msgHash].receivedAt;
169:         bool isMessageProven = receivedAt != 0;
170: 
171:         if (!isMessageProven) {
172:             address signalService = resolve("signal_service", false);
173: 
174:             if (!ISignalService(signalService).isSignalSent(address(this), msgHash)) {
175:                 revert B_MESSAGE_NOT_SENT();
176:             }
177: 
178:             bytes32 failureSignal = signalForFailedMessage(msgHash);
179:             if (!_proveSignalReceived(signalService, failureSignal, _message.destChainId, _proof)) {
180:                 revert B_NOT_FAILED();
181:             }
182: 
183:             receivedAt = uint64(block.timestamp);
184:             proofReceipt[msgHash].receivedAt = receivedAt;
185:         }
186: 
187:         (uint256 invocationDelay,) = getInvocationDelays();
188: 
189:         if (block.timestamp >= invocationDelay + receivedAt) {
190:             delete proofReceipt[msgHash];
191:             messageStatus[msgHash] = Status.RECALLED;
192: 
193:             // Execute the recall logic based on the contract's support for the
194:             // IRecallableSender interface
195:             if (_message.from.supportsInterface(type(IRecallableSender).interfaceId)) {
196:                 _storeContext(msgHash, address(this), _message.srcChainId);
197: 
198:                 // Perform recall
199:                 IRecallableSender(_message.from).onMessageRecalled{ value: _message.value }(
200:                     _message, msgHash
201:                 );
202: 
203:                 // Must reset the context after the message call
204:                 _resetContext();
205:             } else {
206:                 _message.srcOwner.sendEther(_message.value);
207:             }
208:             emit MessageRecalled(msgHash);
209:         } else if (!isMessageProven) {
210:             emit MessageReceived(msgHash, _message, true);
211:         } else {
212:             revert B_INVOCATION_TOO_EARLY();
213:         }
214:     }

217:     function processMessage(
218:         Message calldata _message,
219:         bytes calldata _proof
220:     )
221:         external
222:         nonReentrant
223:         whenNotPaused
224:         sameChain(_message.destChainId)
225:     {
226:         bytes32 msgHash = hashMessage(_message);
227:         if (messageStatus[msgHash] != Status.NEW) revert B_STATUS_MISMATCH();
228: 
229:         address signalService = resolve("signal_service", false);
230:         uint64 receivedAt = proofReceipt[msgHash].receivedAt;
231:         bool isMessageProven = receivedAt != 0;
232: 
233:         (uint256 invocationDelay, uint256 invocationExtraDelay) = getInvocationDelays();
234: 
235:         if (!isMessageProven) {
236:             if (!_proveSignalReceived(signalService, msgHash, _message.srcChainId, _proof)) {
237:                 revert B_NOT_RECEIVED();
238:             }
239: 
240:             receivedAt = uint64(block.timestamp);
241: 
242:             if (invocationDelay != 0) {
243:                 proofReceipt[msgHash] = ProofReceipt({
244:                     receivedAt: receivedAt,
245:                     preferredExecutor: _message.gasLimit == 0 ? _message.destOwner : msg.sender
246:                 });
247:             }
248:         }
249: 
250:         if (invocationDelay != 0 && msg.sender != proofReceipt[msgHash].preferredExecutor) {
251:             // If msg.sender is not the one that proved the message, then there
252:             // is an extra delay.
253:             unchecked {
254:                 invocationDelay += invocationExtraDelay;
255:             }
256:         }
257: 
258:         if (block.timestamp >= invocationDelay + receivedAt) {
259:             // If the gas limit is set to zero, only the owner can process the message.
260:             if (_message.gasLimit == 0 && msg.sender != _message.destOwner) {
261:                 revert B_PERMISSION_DENIED();
262:             }
263: 
264:             delete proofReceipt[msgHash];
265: 
266:             uint256 refundAmount;
267: 
268:             // Process message differently based on the target address
269:             if (
270:                 _message.to == address(0) || _message.to == address(this)
271:                     || _message.to == signalService || addressBanned[_message.to]
272:             ) {
273:                 // Handle special addresses that don't require actual invocation but
274:                 // mark message as DONE
275:                 refundAmount = _message.value;
276:                 _updateMessageStatus(msgHash, Status.DONE);
277:             } else {
278:                 // Use the specified message gas limit if called by the owner, else
279:                 // use remaining gas
280:                 uint256 gasLimit = msg.sender == _message.destOwner ? gasleft() : _message.gasLimit;
281: 
282:                 if (_invokeMessageCall(_message, msgHash, gasLimit)) {
283:                     _updateMessageStatus(msgHash, Status.DONE);
284:                 } else {
285:                     _updateMessageStatus(msgHash, Status.RETRIABLE);
286:                 }
287:             }
288: 
289:             // Determine the refund recipient
290:             address refundTo =
291:                 _message.refundTo == address(0) ? _message.destOwner : _message.refundTo;
292: 
293:             // Refund the processing fee
294:             if (msg.sender == refundTo) {
295:                 refundTo.sendEther(_message.fee + refundAmount);
296:             } else {
297:                 // If sender is another address, reward it and refund the rest
298:                 msg.sender.sendEther(_message.fee);
299:                 refundTo.sendEther(refundAmount);
300:             }
301:             emit MessageExecuted(msgHash);
302:         } else if (!isMessageProven) {
303:             emit MessageReceived(msgHash, _message, false);
304:         } else {
305:             revert B_INVOCATION_TOO_EARLY();
306:         }
307:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L155-L214) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L217-L307)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

068:     function get(
069:         bytes memory _key,
070:         bytes[] memory _proof,
071:         bytes32 _root
072:     )
073:         internal
074:         pure
075:         returns (bytes memory value_)
076:     {
077:         require(_key.length > 0, "MerkleTrie: empty key");
078: 
079:         TrieNode[] memory proof = _parseProof(_proof);
080:         bytes memory key = Bytes.toNibbles(_key);
081:         bytes memory currentNodeID = abi.encodePacked(_root);
082:         uint256 currentKeyIndex = 0;
083: 
084:         // Proof is top-down, so we start at the first element (root).
085:         for (uint256 i = 0; i < proof.length; i++) {
086:             TrieNode memory currentNode = proof[i];
087: 
088:             // Key index should never exceed total key length or we'll be out of bounds.
089:             require(currentKeyIndex <= key.length, "MerkleTrie: key index exceeds total key length");
090: 
091:             if (currentKeyIndex == 0) {
092:                 // First proof element is always the root node.
093:                 require(
094:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
095:                     "MerkleTrie: invalid root hash"
096:                 );
097:             } else if (currentNode.encoded.length >= 32) {
098:                 // Nodes 32 bytes or larger are hashed inside branch nodes.
099:                 require(
100:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
101:                     "MerkleTrie: invalid large internal hash"
102:                 );
103:             } else {
104:                 // Nodes smaller than 32 bytes aren't hashed.
105:                 require(
106:                     Bytes.equal(currentNode.encoded, currentNodeID),
107:                     "MerkleTrie: invalid internal node hash"
108:                 );
109:             }
110: 
111:             if (currentNode.decoded.length == BRANCH_NODE_LENGTH) {
112:                 if (currentKeyIndex == key.length) {
113:                     // Value is the last element of the decoded list (for branch nodes). There's
114:                     // some ambiguity in the Merkle trie specification because bytes(0) is a
115:                     // valid value to place into the trie, but for branch nodes bytes(0) can exist
116:                     // even when the value wasn't explicitly placed there. Geth treats a value of
117:                     // bytes(0) as "key does not exist" and so we do the same.
118:                     value_ = RLPReader.readBytes(currentNode.decoded[TREE_RADIX]);
119:                     require(
120:                         value_.length > 0,
121:                         "MerkleTrie: value length must be greater than zero (branch)"
122:                     );
123: 
124:                     // Extra proof elements are not allowed.
125:                     require(
126:                         i == proof.length - 1,
127:                         "MerkleTrie: value node must be last node in proof (branch)"
128:                     );
129: 
130:                     return value_;
131:                 } else {
132:                     // We're not at the end of the key yet.
133:                     // Figure out what the next node ID should be and continue.
134:                     uint8 branchKey = uint8(key[currentKeyIndex]);
135:                     RLPReader.RLPItem memory nextNode = currentNode.decoded[branchKey];
136:                     currentNodeID = _getNodeID(nextNode);
137:                     currentKeyIndex += 1;
138:                 }
139:             } else if (currentNode.decoded.length == LEAF_OR_EXTENSION_NODE_LENGTH) {
140:                 bytes memory path = _getNodePath(currentNode);
141:                 uint8 prefix = uint8(path[0]);
142:                 uint8 offset = 2 - (prefix % 2);
143:                 bytes memory pathRemainder = Bytes.slice(path, offset);
144:                 bytes memory keyRemainder = Bytes.slice(key, currentKeyIndex);
145:                 uint256 sharedNibbleLength = _getSharedNibbleLength(pathRemainder, keyRemainder);
146: 
147:                 // Whether this is a leaf node or an extension node, the path remainder MUST be a
148:                 // prefix of the key remainder (or be equal to the key remainder) or the proof is
149:                 // considered invalid.
150:                 require(
151:                     pathRemainder.length == sharedNibbleLength,
152:                     "MerkleTrie: path remainder must share all nibbles with key"
153:                 );
154: 
155:                 if (prefix == PREFIX_LEAF_EVEN || prefix == PREFIX_LEAF_ODD) {
156:                     // Prefix of 2 or 3 means this is a leaf node. For the leaf node to be valid,
157:                     // the key remainder must be exactly equal to the path remainder. We already
158:                     // did the necessary byte comparison, so it's more efficient here to check that
159:                     // the key remainder length equals the shared nibble length, which implies
160:                     // equality with the path remainder (since we already did the same check with
161:                     // the path remainder and the shared nibble length).
162:                     require(
163:                         keyRemainder.length == sharedNibbleLength,
164:                         "MerkleTrie: key remainder must be identical to path remainder"
165:                     );
166: 
167:                     // Our Merkle Trie is designed specifically for the purposes of the Ethereum
168:                     // state trie. Empty values are not allowed in the state trie, so we can safely
169:                     // say that if the value is empty, the key should not exist and the proof is
170:                     // invalid.
171:                     value_ = RLPReader.readBytes(currentNode.decoded[1]);
172:                     require(
173:                         value_.length > 0,
174:                         "MerkleTrie: value length must be greater than zero (leaf)"
175:                     );
176: 
177:                     // Extra proof elements are not allowed.
178:                     require(
179:                         i == proof.length - 1,
180:                         "MerkleTrie: value node must be last node in proof (leaf)"
181:                     );
182: 
183:                     return value_;
184:                 } else if (prefix == PREFIX_EXTENSION_EVEN || prefix == PREFIX_EXTENSION_ODD) {
185:                     // Prefix of 0 or 1 means this is an extension node. We move onto the next node
186:                     // in the proof and increment the key index by the length of the path remainder
187:                     // which is equal to the shared nibble length.
188:                     currentNodeID = _getNodeID(currentNode.decoded[1]);
189:                     currentKeyIndex += sharedNibbleLength;
190:                 } else {
191:                     revert("MerkleTrie: received a node with an unknown prefix");
192:                 }
193:             } else {
194:                 revert("MerkleTrie: received an unparseable node");
195:             }
196:         }
197: 
198:         revert("MerkleTrie: ran out of proof elements");
199:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68-L199) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

245:     function _calcAmount(
246:         uint128 _amount,
247:         uint64 _start,
248:         uint64 _cliff,
249:         uint64 _period
250:     )
251:         private
252:         view
253:         returns (uint128)
254:     {
255:         if (_amount == 0) return 0;
256:         if (_start == 0) return _amount;
257:         if (block.timestamp <= _start) return 0;
258: 
259:         if (_period == 0) return _amount;
260:         if (block.timestamp >= _start + _period) return _amount;
261: 
262:         if (block.timestamp <= _cliff) return 0;
263: 
264:         return _amount * uint64(block.timestamp - _start) / _period;
265:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L265) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
249:         private
250:         view
251:         returns (bool)
252:     {
253:         uint256 n = certs.length;
254:         bool certRevoked;
255:         bool certNotExpired;
256:         bool verified;
257:         bool certChainCanBeTrusted;
258: 
259:         for (uint256 i; i < n; ++i) {
260:             IPEMCertChainLib.ECSha256Certificate memory issuer;
261:             if (i == n - 1) {
262:                 // rootCA
263:                 issuer = certs[i];
264:             } else {
265:                 issuer = certs[i + 1];
266:                 if (i == n - 2) {
267:                     // this cert is expected to be signed by the root
268:                     certRevoked = _serialNumIsRevoked[uint256(IPEMCertChainLib.CRL.ROOT)][certs[i]
269:                         .serialNumber];
270:                 } else if (certs[i].isPck) {
271:                     certRevoked = _serialNumIsRevoked[uint256(IPEMCertChainLib.CRL.PCK)][certs[i]
272:                         .serialNumber];
273:                 }
274:                 if (certRevoked) {
275:                     break;
276:                 }
277:             }
278: 
279:             certNotExpired =
280:                 block.timestamp > certs[i].notBefore && block.timestamp < certs[i].notAfter;
281:             if (!certNotExpired) {
282:                 break;
283:             }
284: 
285:             verified = sigVerifyLib.verifyES256Signature(
286:                 certs[i].tbsCertificate, certs[i].signature, issuer.pubKey
287:             );
288:             if (!verified) {
289:                 break;
290:             }
291: 
292:             bytes32 issuerPubKeyHash = keccak256(issuer.pubKey);
293: 
294:             if (issuerPubKeyHash == ROOTCA_PUBKEY_HASH) {
295:                 certChainCanBeTrusted = true;
296:                 break;
297:             }
298:         }
299: 
300:         return !certRevoked && certNotExpired && verified && certChainCanBeTrusted;
301:     }

364:     function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
365:         internal
366:         view
367:         returns (bool, bytes memory)
368:     {
369:         bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);
370: 
371:         // // Step 1: Parse the quote input = 152k gas
372:         (
373:             bool successful,
374:             ,
375:             ,
376:             bytes memory signedQuoteData,
377:             V3Struct.ECDSAQuoteV3AuthData memory authDataV3
378:         ) = V3Parser.validateParsedInput(v3quote);
379:         if (!successful) {
380:             return (false, retData);
381:         }
382: 
383:         // Step 2: Verify application enclave report MRENCLAVE and MRSIGNER
384:         {
385:             if (_checkLocalEnclaveReport) {
386:                 // 4k gas
387:                 bool mrEnclaveIsTrusted =
388:                     _trustedUserMrEnclave[v3quote.localEnclaveReport.mrEnclave];
389:                 bool mrSignerIsTrusted = _trustedUserMrSigner[v3quote.localEnclaveReport.mrSigner];
390: 
391:                 if (!mrEnclaveIsTrusted || !mrSignerIsTrusted) {
392:                     return (false, retData);
393:                 }
394:             }
395:         }
396: 
397:         // Step 3: Verify enclave identity = 43k gas
398:         EnclaveIdStruct.EnclaveIdStatus qeTcbStatus;
399:         {
400:             bool verifiedEnclaveIdSuccessfully;
401:             (verifiedEnclaveIdSuccessfully, qeTcbStatus) =
402:                 _verifyQEReportWithIdentity(v3quote.v3AuthData.pckSignedQeReport);
403:             if (!verifiedEnclaveIdSuccessfully) {
404:                 return (false, retData);
405:             }
406:             if (
407:                 !verifiedEnclaveIdSuccessfully
408:                     || qeTcbStatus == EnclaveIdStruct.EnclaveIdStatus.SGX_ENCLAVE_REPORT_ISVSVN_REVOKED
409:             ) {
410:                 return (false, retData);
411:             }
412:         }
413: 
414:         // Step 4: Parse Quote CertChain
415:         IPEMCertChainLib.ECSha256Certificate[] memory parsedQuoteCerts;
416:         TCBInfoStruct.TCBInfo memory fetchedTcbInfo;
417:         {
418:             // 536k gas
419:             parsedQuoteCerts = new IPEMCertChainLib.ECSha256Certificate[](3);
420:             for (uint256 i; i < 3; ++i) {
421:                 bool isPckCert = i == 0; // additional parsing for PCKCert
422:                 bool certDecodedSuccessfully;
423:                 // todo! move decodeCert offchain
424:                 (certDecodedSuccessfully, parsedQuoteCerts[i]) = pemCertLib.decodeCert(
425:                     authDataV3.certification.decodedCertDataArray[i], isPckCert
426:                 );
427:                 if (!certDecodedSuccessfully) {
428:                     return (false, retData);
429:                 }
430:             }
431:         }
432: 
433:         // Step 5: basic PCK and TCB check = 381k gas
434:         {
435:             string memory parsedFmspc = parsedQuoteCerts[0].pck.sgxExtension.fmspc;
436:             fetchedTcbInfo = tcbInfo[parsedFmspc];
437:             bool tcbConfigured = LibString.eq(parsedFmspc, fetchedTcbInfo.fmspc);
438:             if (!tcbConfigured) {
439:                 return (false, retData);
440:             }
441: 
442:             IPEMCertChainLib.ECSha256Certificate memory pckCert = parsedQuoteCerts[0];
443:             bool pceidMatched = LibString.eq(pckCert.pck.sgxExtension.pceid, fetchedTcbInfo.pceid);
444:             if (!pceidMatched) {
445:                 return (false, retData);
446:             }
447:         }
448: 
449:         // Step 6: Verify TCB Level
450:         TCBInfoStruct.TCBStatus tcbStatus;
451:         {
452:             // 4k gas
453:             bool tcbVerified;
454:             (tcbVerified, tcbStatus) = _checkTcbLevels(parsedQuoteCerts[0].pck, fetchedTcbInfo);
455:             if (!tcbVerified) {
456:                 return (false, retData);
457:             }
458:         }
459: 
460:         // Step 7: Verify cert chain for PCK
461:         {
462:             // 660k gas (rootCA pubkey is trusted)
463:             bool pckCertChainVerified = _verifyCertChain(parsedQuoteCerts);
464:             if (!pckCertChainVerified) {
465:                 return (false, retData);
466:             }
467:         }
468: 
469:         // Step 8: Verify the local attestation sig and qe report sig = 670k gas
470:         {
471:             bool enclaveReportSigsVerified = _enclaveReportSigVerification(
472:                 parsedQuoteCerts[0].pubKey,
473:                 signedQuoteData,
474:                 authDataV3,
475:                 v3quote.v3AuthData.pckSignedQeReport
476:             );
477:             if (!enclaveReportSigsVerified) {
478:                 return (false, retData);
479:             }
480:         }
481: 
482:         retData = abi.encodePacked(sha256(abi.encode(v3quote)), tcbStatus);
483: 
484:         return (_attestationTcbIsValid(tcbStatus), retData);
485:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L301) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364-L485)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

074:     function decodeCert(
075:         bytes memory der,
076:         bool isPckCert
077:     )
078:         external
079:         pure
080:         returns (bool success, ECSha256Certificate memory cert)
081:     {
082:         uint256 root = der.root();
083: 
084:         // Entering tbsCertificate sequence
085:         uint256 tbsParentPtr = der.firstChildOf(root);
086: 
087:         // Begin iterating through the descendants of tbsCertificate
088:         uint256 tbsPtr = der.firstChildOf(tbsParentPtr);
089: 
090:         // The Serial Number is located one element below Version
091: 
092:         // The issuer commonName value is contained in the Issuer sequence
093:         // which is 3 elements below the first element of the tbsCertificate sequence
094: 
095:         // The Validity sequence is located 4 elements below the first element of the tbsCertificate
096:         // sequence
097: 
098:         // The subject commanName value is contained in the Subject sequence
099:         // which is 5 elements below the first element of the tbsCertificate sequence
100: 
101:         // The PublicKey is located in the second element of subjectPublicKeyInfo sequence
102:         // which is 6 elements below the first element of the tbsCertificate sequence
103: 
104:         tbsPtr = der.nextSiblingOf(tbsPtr);
105: 
106:         {
107:             bytes memory serialNumBytes = der.bytesAt(tbsPtr);
108:             cert.serialNumber = serialNumBytes;
109:         }
110: 
111:         tbsPtr = der.nextSiblingOf(tbsPtr);
112:         tbsPtr = der.nextSiblingOf(tbsPtr);
113: 
114:         if (isPckCert) {
115:             uint256 issuerPtr = der.firstChildOf(tbsPtr);
116:             issuerPtr = der.firstChildOf(issuerPtr);
117:             issuerPtr = der.firstChildOf(issuerPtr);
118:             issuerPtr = der.nextSiblingOf(issuerPtr);
119:             cert.pck.issuerName = string(der.bytesAt(issuerPtr));
120:             bool issuerNameIsValid = LibString.eq(cert.pck.issuerName, PLATFORM_ISSUER_NAME)
121:                 || LibString.eq(cert.pck.issuerName, PROCESSOR_ISSUER_NAME);
122:             if (!issuerNameIsValid) {
123:                 return (false, cert);
124:             }
125:         }
126: 
127:         tbsPtr = der.nextSiblingOf(tbsPtr);
128: 
129:         {
130:             uint256 notBeforePtr = der.firstChildOf(tbsPtr);
131:             uint256 notAfterPtr = der.nextSiblingOf(notBeforePtr);
132:             bytes1 notBeforeTag = der[notBeforePtr.ixs()];
133:             bytes1 notAfterTag = der[notAfterPtr.ixs()];
134:             if (
135:                 (notBeforeTag != 0x17 && notBeforeTag == 0x18)
136:                     || (notAfterTag != 0x17 && notAfterTag != 0x18)
137:             ) {
138:                 return (false, cert);
139:             }
140:             cert.notBefore = X509DateUtils.toTimestamp(der.bytesAt(notBeforePtr));
141:             cert.notAfter = X509DateUtils.toTimestamp(der.bytesAt(notAfterPtr));
142:         }
143: 
144:         tbsPtr = der.nextSiblingOf(tbsPtr);
145: 
146:         if (isPckCert) {
147:             uint256 subjectPtr = der.firstChildOf(tbsPtr);
148:             subjectPtr = der.firstChildOf(subjectPtr);
149:             subjectPtr = der.firstChildOf(subjectPtr);
150:             subjectPtr = der.nextSiblingOf(subjectPtr);
151:             cert.pck.commonName = string(der.bytesAt(subjectPtr));
152:             if (!LibString.eq(cert.pck.commonName, PCK_COMMON_NAME)) {
153:                 return (false, cert);
154:             }
155:         }
156: 
157:         tbsPtr = der.nextSiblingOf(tbsPtr);
158: 
159:         {
160:             // Entering subjectPublicKeyInfo sequence
161:             uint256 subjectPublicKeyInfoPtr = der.firstChildOf(tbsPtr);
162:             subjectPublicKeyInfoPtr = der.nextSiblingOf(subjectPublicKeyInfoPtr);
163: 
164:             // The Signature sequence is located two sibling elements below the tbsCertificate
165:             // element
166:             uint256 sigPtr = der.nextSiblingOf(tbsParentPtr);
167:             sigPtr = der.nextSiblingOf(sigPtr);
168: 
169:             // Skip three bytes to the right
170:             // the three bytes in question: 0x034700 or 0x034800 or 0x034900
171:             sigPtr = NodePtr.getPtr(sigPtr.ixs() + 3, sigPtr.ixf() + 3, sigPtr.ixl());
172: 
173:             sigPtr = der.firstChildOf(sigPtr);
174:             bytes memory sigX = _trimBytes(der.bytesAt(sigPtr), 32);
175: 
176:             sigPtr = der.nextSiblingOf(sigPtr);
177:             bytes memory sigY = _trimBytes(der.bytesAt(sigPtr), 32);
178: 
179:             cert.tbsCertificate = der.allBytesAt(tbsParentPtr);
180:             cert.pubKey = _trimBytes(der.bytesAt(subjectPublicKeyInfoPtr), 64);
181:             cert.signature = abi.encodePacked(sigX, sigY);
182:         }
183: 
184:         if (isPckCert) {
185:             // entering Extension sequence
186:             tbsPtr = der.nextSiblingOf(tbsPtr);
187: 
188:             // check for the extension tag
189:             if (der[tbsPtr.ixs()] != 0xA3) {
190:                 return (false, cert);
191:             }
192: 
193:             tbsPtr = der.firstChildOf(tbsPtr);
194:             tbsPtr = der.firstChildOf(tbsPtr);
195: 
196:             bool sgxExtnTraversedSuccessfully;
197:             uint256 pcesvn;
198:             uint256[] memory cpuSvns;
199:             bytes memory fmspcBytes;
200:             bytes memory pceidBytes;
201:             (sgxExtnTraversedSuccessfully, pcesvn, cpuSvns, fmspcBytes, pceidBytes) =
202:                 _findPckTcbInfo(der, tbsPtr, tbsParentPtr);
203:             if (!sgxExtnTraversedSuccessfully) {
204:                 return (false, cert);
205:             }
206:             cert.pck.sgxExtension.pcesvn = pcesvn;
207:             cert.pck.sgxExtension.sgxTcbCompSvnArr = cpuSvns;
208:             cert.pck.sgxExtension.pceid = LibString.toHexStringNoPrefix(pceidBytes);
209:             cert.pck.sgxExtension.fmspc = LibString.toHexStringNoPrefix(fmspcBytes);
210:             cert.isPck = true;
211:         }
212: 
213:         success = true;
214:     }

269:     function _findPckTcbInfo(
270:         bytes memory der,
271:         uint256 tbsPtr,
272:         uint256 tbsParentPtr
273:     )
274:         private
275:         pure
276:         returns (
277:             bool success,
278:             uint256 pcesvn,
279:             uint256[] memory cpusvns,
280:             bytes memory fmspcBytes,
281:             bytes memory pceidBytes
282:         )
283:     {
284:         // iterate through the elements in the Extension sequence
285:         // until we locate the SGX Extension OID
286:         while (tbsPtr != 0) {
287:             uint256 internalPtr = der.firstChildOf(tbsPtr);
288:             if (der[internalPtr.ixs()] != 0x06) {
289:                 return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);
290:             }
291: 
292:             if (BytesUtils.compareBytes(der.bytesAt(internalPtr), SGX_EXTENSION_OID)) {
293:                 // 1.2.840.113741.1.13.1
294:                 internalPtr = der.nextSiblingOf(internalPtr);
295:                 uint256 extnValueParentPtr = der.rootOfOctetStringAt(internalPtr);
296:                 uint256 extnValuePtr = der.firstChildOf(extnValueParentPtr);
297: 
298:                 // Copy flags to memory to avoid stack too deep
299:                 PCKTCBFlags memory flags;
300: 
301:                 while (!(flags.fmspcFound && flags.pceidFound && flags.tcbFound)) {
302:                     uint256 extnValueOidPtr = der.firstChildOf(extnValuePtr);
303:                     if (der[extnValueOidPtr.ixs()] != 0x06) {
304:                         return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);
305:                     }
306:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), TCB_OID)) {
307:                         // 1.2.840.113741.1.13.1.2
308:                         (flags.tcbFound, pcesvn, cpusvns) = _findTcb(der, extnValueOidPtr);
309:                     }
310:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), PCEID_OID)) {
311:                         // 1.2.840.113741.1.13.1.3
312:                         uint256 pceidPtr = der.nextSiblingOf(extnValueOidPtr);
313:                         pceidBytes = der.bytesAt(pceidPtr);
314:                         flags.pceidFound = true;
315:                     }
316:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), FMSPC_OID)) {
317:                         // 1.2.840.113741.1.13.1.4
318:                         uint256 fmspcPtr = der.nextSiblingOf(extnValueOidPtr);
319:                         fmspcBytes = der.bytesAt(fmspcPtr);
320:                         flags.fmspcFound = true;
321:                     }
322: 
323:                     if (extnValuePtr.ixl() < extnValueParentPtr.ixl()) {
324:                         extnValuePtr = der.nextSiblingOf(extnValuePtr);
325:                     } else {
326:                         break;
327:                     }
328:                 }
329:                 success = flags.fmspcFound && flags.pceidFound && flags.tcbFound;
330:                 break;
331:             }
332: 
333:             if (tbsPtr.ixl() < tbsParentPtr.ixl()) {
334:                 tbsPtr = der.nextSiblingOf(tbsPtr);
335:             } else {
336:                 tbsPtr = 0; // exit
337:             }
338:         }
339:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L74-L214) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L339)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

320:     function base32HexDecodeWord(
321:         bytes memory self,
322:         uint256 off,
323:         uint256 len
324:     )
325:         internal
326:         pure
327:         returns (bytes32)
328:     {
329:         require(len <= 52, "unexpected len");
330: 
331:         uint256 ret = 0;
332:         uint8 decoded;
333:         for (uint256 i; i < len; ++i) {
334:             bytes1 char = self[off + i];
335:             require(char >= 0x30 && char <= 0x7A, "invalid char");
336:             decoded = uint8(BASE32_HEX_TABLE[uint256(uint8(char)) - 0x30]);
337:             require(decoded <= 0x20, "invalid decoded");
338:             if (i == len - 1) {
339:                 break;
340:             }
341:             ret = (ret << 5) | decoded;
342:         }
343: 
344:         uint256 bitlen = len * 5;
345:         if (len % 8 == 0) {
346:             // Multiple of 8 characters, no padding
347:             ret = (ret << 5) | decoded;
348:         } else if (len % 8 == 2) {
349:             // Two extra characters - 1 byte
350:             ret = (ret << 3) | (decoded >> 2);
351:             bitlen -= 2;
352:         } else if (len % 8 == 4) {
353:             // Four extra characters - 2 bytes
354:             ret = (ret << 1) | (decoded >> 4);
355:             bitlen -= 4;
356:         } else if (len % 8 == 5) {
357:             // Five extra characters - 3 bytes
358:             ret = (ret << 4) | (decoded >> 1);
359:             bitlen -= 1;
360:         } else if (len % 8 == 7) {
361:             // Seven extra characters - 4 bytes
362:             ret = (ret << 2) | (decoded >> 3);
363:             bitlen -= 3;
364:         } else {
365:             revert("unexpected len");
366:         }
367: 
368:         return bytes32(ret << (256 - bitlen));
369:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L369) 


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

043:     function pkcs1Sha256(
044:         bytes32 _sha256,
045:         bytes memory _s,
046:         bytes memory _e,
047:         bytes memory _m
048:     )
049:         internal
050:         view
051:         returns (bool)
052:     {
053:         uint8[17] memory sha256ExplicitNullParam = [
054:             0x30,
055:             0x31,
056:             0x30,
057:             0x0d,
058:             0x06,
059:             0x09,
060:             0x60,
061:             0x86,
062:             0x48,
063:             0x01,
064:             0x65,
065:             0x03,
066:             0x04,
067:             0x02,
068:             0x01,
069:             0x05,
070:             0x00
071:         ];
072: 
073:         uint8[15] memory sha256ImplicitNullParam = [
074:             0x30,
075:             0x2f,
076:             0x30,
077:             0x0b,
078:             0x06,
079:             0x09,
080:             0x60,
081:             0x86,
082:             0x48,
083:             0x01,
084:             0x65,
085:             0x03,
086:             0x04,
087:             0x02,
088:             0x01
089:         ];
090: 
091:         // decipher
092: 
093:         bytes memory input =
094:             bytes.concat(bytes32(_s.length), bytes32(_e.length), bytes32(_m.length), _s, _e, _m);
095:         uint256 inputlen = input.length;
096: 
097:         uint256 decipherlen = _m.length;
098:         bytes memory decipher = new bytes(decipherlen);
099:         assembly {
100:             pop(
101:                 staticcall(
102:                     sub(gas(), 2000),
103:                     5,
104:                     add(input, 0x20),
105:                     inputlen,
106:                     add(decipher, 0x20),
107:                     decipherlen
108:                 )
109:             )
110:         }
111: 
112:         // Check that is well encoded:
113:         //
114:         // 0x00 || 0x01 || PS || 0x00 || DigestInfo
115:         // PS is padding filled with 0xff
116:         // DigestInfo ::= SEQUENCE {
117:         //    digestAlgorithm AlgorithmIdentifier,
118:         //      [optional algorithm parameters]
119:         //    digest OCTET STRING
120:         // }
121: 
122:         bool hasNullParam;
123:         uint256 digestAlgoWithParamLen;
124: 
125:         if (uint8(decipher[decipherlen - 50]) == 0x31) {
126:             hasNullParam = true;
127:             digestAlgoWithParamLen = sha256ExplicitNullParam.length;
128:         } else if (uint8(decipher[decipherlen - 48]) == 0x2f) {
129:             hasNullParam = false;
130:             digestAlgoWithParamLen = sha256ImplicitNullParam.length;
131:         } else {
132:             return false;
133:         }
134: 
135:         uint256 paddingLen = decipherlen - 5 - digestAlgoWithParamLen - 32;
136: 
137:         if (decipher[0] != 0 || decipher[1] != 0x01) {
138:             return false;
139:         }
140:         for (uint256 i = 2; i < 2 + paddingLen; ++i) {
141:             if (decipher[i] != 0xff) {
142:                 return false;
143:             }
144:         }
145:         if (decipher[2 + paddingLen] != 0) {
146:             return false;
147:         }
148: 
149:         // check digest algorithm
150: 
151:         if (digestAlgoWithParamLen == sha256ExplicitNullParam.length) {
152:             for (uint256 i; i < digestAlgoWithParamLen; ++i) {
153:                 if (decipher[3 + paddingLen + i] != bytes1(sha256ExplicitNullParam[i])) {
154:                     return false;
155:                 }
156:             }
157:         } else {
158:             for (uint256 i; i < digestAlgoWithParamLen; ++i) {
159:                 if (decipher[3 + paddingLen + i] != bytes1(sha256ImplicitNullParam[i])) {
160:                     return false;
161:                 }
162:             }
163:         }
164: 
165:         // check digest
166: 
167:         if (
168:             decipher[3 + paddingLen + digestAlgoWithParamLen] != 0x04
169:                 || decipher[4 + paddingLen + digestAlgoWithParamLen] != 0x20
170:         ) {
171:             return false;
172:         }
173: 
174:         for (uint256 i; i < _sha256.length; ++i) {
175:             if (decipher[5 + paddingLen + digestAlgoWithParamLen + i] != _sha256[i]) {
176:                 return false;
177:             }
178:         }
179: 
180:         return true;
181:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L43-L181) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

24:     function verifyAttStmtSignature(
25:         bytes memory tbs,
26:         bytes memory signature,
27:         PublicKey memory publicKey,
28:         Algorithm alg
29:     )
30:         public
31:         view
32:         returns (bool)
33:     {
34:         if (alg == Algorithm.RS256) {
35:             if (publicKey.keyType != KeyType.RSA) {
36:                 return false;
37:             }
38:             return verifyRS256Signature(tbs, signature, publicKey.pubKey);
39:         } else if (alg == Algorithm.ES256) {
40:             if (publicKey.keyType != KeyType.ECDSA) {
41:                 return false;
42:             }
43:             return verifyES256Signature(tbs, signature, publicKey.pubKey);
44:         } else if (alg == Algorithm.RS1) {
45:             if (publicKey.keyType != KeyType.RSA) {
46:                 return false;
47:             }
48:             return verifyRS1Signature(tbs, signature, publicKey.pubKey);
49:         } else {
50:             revert("Unsupported algorithm");
51:         }
52:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L52) 


</details>


### [NC&#x2011;81] Consider bounding input array length 
The functions below take in an unbounded array, and make function calls for entries in the array. While the function will revert if it eventually runs out of gas, it may be a nicer user experience to `require()` that the length of the array is below some reasonable maximum, so that the user doesn't have to use up a full transaction's gas only to see that the transaction reverts.


*There are 12 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/hooks/AssignmentHook.sol

//@audit array name _tierFees
164:     function _getProverFee(
165:         TaikoData.TierFee[] memory _tierFees,
166:         uint16 _tierId
167:     )
168:         private
169:         pure
170:         returns (uint256)
171:     {
172:         for (uint256 i; i < _tierFees.length; ++i) {
173:             if (_tierFees[i].tier == _tierId) return _tierFees[i].fee;
174:         }
175:         revert HOOK_TIER_NOT_FOUND();
176:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L164-L176) 


```solidity

File: /contracts/bridge/Bridge.sol

//@audit array name _msgHashes
82:     function suspendMessages(
83:         bytes32[] calldata _msgHashes,
84:         bool _suspend
85:     )
86:         external
87:         onlyFromOwnerOrNamed("bridge_watchdog")
88:     {
89:         uint64 _timestamp = _suspend ? type(uint64).max : uint64(block.timestamp);
90:         for (uint256 i; i < _msgHashes.length; ++i) {
91:             bytes32 msgHash = _msgHashes[i];
92:             proofReceipt[msgHash].receivedAt = _timestamp;
93:             emit MessageSuspended(msgHash, _suspend);
94:         }
95:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L82-L95) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit array name _tokenIds
160:     function _transferTokens(
161:         CanonicalNFT memory _ctoken,
162:         address _to,
163:         uint256[] memory _tokenIds
164:     )
165:         private
166:         returns (address token_)
167:     {
168:         if (_ctoken.chainId == block.chainid) {
169:             token_ = _ctoken.addr;
170:             for (uint256 i; i < _tokenIds.length; ++i) {
171:                 IERC721(token_).safeTransferFrom(address(this), _to, _tokenIds[i]);
172:             }
173:         } else {
174:             token_ = _getOrDeployBridgedToken(_ctoken);
175:             for (uint256 i; i < _tokenIds.length; ++i) {
176:                 BridgedERC721(token_).mint(_to, _tokenIds[i]);
177:             }
178:         }
179:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L160-L179) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

//@audit array name _proof
205:     function _parseProof(bytes[] memory _proof) private pure returns (TrieNode[] memory proof_) {
206:         uint256 length = _proof.length;
207:         proof_ = new TrieNode[](length);
208:         for (uint256 i = 0; i < length;) {
209:             proof_[i] = TrieNode({ encoded: _proof[i], decoded: RLPReader.readList(_proof[i]) });
210:             unchecked {
211:                 ++i;
212:             }
213:         }
214:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L205-L214) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit array name _ids
100:     function deleteInstances(uint256[] calldata _ids)
101:         external
102:         onlyFromOwnerOrNamed("rollup_watchdog")
103:     {
104:         for (uint256 i; i < _ids.length; ++i) {
105:             uint256 idx = _ids[i];
106: 
107:             if (instances[idx].addr == address(0)) revert SGX_INVALID_INSTANCE();
108: 
109:             emit InstanceDeleted(idx, instances[idx].addr);
110: 
111:             delete instances[idx];
112:         }
113:     }

//@audit array name _instances
195:     function _addInstances(
196:         address[] memory _instances,
197:         bool instantValid
198:     )
199:         private
200:         returns (uint256[] memory ids)
201:     {
202:         ids = new uint256[](_instances.length);
203: 
204:         uint64 validSince = uint64(block.timestamp);
205: 
206:         if (!instantValid) {
207:             validSince += INSTANCE_VALIDITY_DELAY;
208:         }
209: 
210:         for (uint256 i; i < _instances.length; ++i) {
211:             if (addressRegistered[_instances[i]]) revert SGX_ALREADY_ATTESTED();
212: 
213:             addressRegistered[_instances[i]] = true;
214: 
215:             if (_instances[i] == address(0)) revert SGX_INVALID_INSTANCE();
216: 
217:             instances[nextInstanceId] = Instance(_instances[i], validSince);
218:             ids[i] = nextInstanceId;
219: 
220:             emit InstanceAdded(nextInstanceId, _instances[i], address(0), validSince);
221: 
222:             nextInstanceId++;
223:         }
224:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L100-L113) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L195-L224)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

//@audit array name tokenIds
47:     function claim(
48:         address user,
49:         uint256[] calldata tokenIds,
50:         bytes32[] calldata proof
51:     )
52:         external
53:         nonReentrant
54:     {
55:         // Check if this can be claimed
56:         _verifyClaim(abi.encode(user, tokenIds), proof);
57: 
58:         // Transfer the tokens
59:         for (uint256 i; i < tokenIds.length; ++i) {
60:             IERC721(token).safeTransferFrom(vault, user, tokenIds[i]);
61:         }
62:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L47-L62) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

//@audit array name serialNumBatch
73:     function addRevokedCertSerialNum(
74:         uint256 index,
75:         bytes[] calldata serialNumBatch
76:     )
77:         external
78:         onlyOwner
79:     {
80:         for (uint256 i; i < serialNumBatch.length; ++i) {
81:             if (_serialNumIsRevoked[index][serialNumBatch[i]]) {
82:                 continue;
83:             }
84:             _serialNumIsRevoked[index][serialNumBatch[i]] = true;
85:         }
86:     }

//@audit array name serialNumBatch
088:     function removeRevokedCertSerialNum(
089:         uint256 index,
090:         bytes[] calldata serialNumBatch
091:     )
092:         external
093:         onlyOwner
094:     {
095:         for (uint256 i; i < serialNumBatch.length; ++i) {
096:             if (!_serialNumIsRevoked[index][serialNumBatch[i]]) {
097:                 continue;
098:             }
099:             delete _serialNumIsRevoked[index][serialNumBatch[i]];
100:         }
101:     }

//@audit array name pckCpuSvns
229:     function _isCpuSvnHigherOrGreater(
230:         uint256[] memory pckCpuSvns,
231:         uint8[] memory tcbCpuSvns
232:     )
233:         private
234:         pure
235:         returns (bool)
236:     {
237:         if (pckCpuSvns.length != CPUSVN_LENGTH || tcbCpuSvns.length != CPUSVN_LENGTH) {
238:             return false;
239:         }
240:         for (uint256 i; i < CPUSVN_LENGTH; ++i) {
241:             if (pckCpuSvns[i] < tcbCpuSvns[i]) {
242:                 return false;
243:             }
244:         }
245:         return true;
246:     }

//@audit array name tcbCpuSvns
229:     function _isCpuSvnHigherOrGreater(
230:         uint256[] memory pckCpuSvns,
231:         uint8[] memory tcbCpuSvns
232:     )
233:         private
234:         pure
235:         returns (bool)
236:     {
237:         if (pckCpuSvns.length != CPUSVN_LENGTH || tcbCpuSvns.length != CPUSVN_LENGTH) {
238:             return false;
239:         }
240:         for (uint256 i; i < CPUSVN_LENGTH; ++i) {
241:             if (pckCpuSvns[i] < tcbCpuSvns[i]) {
242:                 return false;
243:             }
244:         }
245:         return true;
246:     }

//@audit array name certs
248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
249:         private
250:         view
251:         returns (bool)
252:     {
253:         uint256 n = certs.length;
254:         bool certRevoked;
255:         bool certNotExpired;
256:         bool verified;
257:         bool certChainCanBeTrusted;
258: 
259:         for (uint256 i; i < n; ++i) {
260:             IPEMCertChainLib.ECSha256Certificate memory issuer;
261:             if (i == n - 1) {
262:                 // rootCA
263:                 issuer = certs[i];
264:             } else {
265:                 issuer = certs[i + 1];
266:                 if (i == n - 2) {
267:                     // this cert is expected to be signed by the root
268:                     certRevoked = _serialNumIsRevoked[uint256(IPEMCertChainLib.CRL.ROOT)][certs[i]
269:                         .serialNumber];
270:                 } else if (certs[i].isPck) {
271:                     certRevoked = _serialNumIsRevoked[uint256(IPEMCertChainLib.CRL.PCK)][certs[i]
272:                         .serialNumber];
273:                 }
274:                 if (certRevoked) {
275:                     break;
276:                 }
277:             }
278: 
279:             certNotExpired =
280:                 block.timestamp > certs[i].notBefore && block.timestamp < certs[i].notAfter;
281:             if (!certNotExpired) {
282:                 break;
283:             }
284: 
285:             verified = sigVerifyLib.verifyES256Signature(
286:                 certs[i].tbsCertificate, certs[i].signature, issuer.pubKey
287:             );
288:             if (!verified) {
289:                 break;
290:             }
291: 
292:             bytes32 issuerPubKeyHash = keccak256(issuer.pubKey);
293: 
294:             if (issuerPubKeyHash == ROOTCA_PUBKEY_HASH) {
295:                 certChainCanBeTrusted = true;
296:                 break;
297:             }
298:         }
299: 
300:         return !certRevoked && certNotExpired && verified && certChainCanBeTrusted;
301:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L86) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L246), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L246), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L301)


</details>


### [NC&#x2011;82] A function which defines named returns in it's declaration doesn't need to use return 
Remove the return statement once ensuring it is safe to do so


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProving.sol

091:     function proveBlock(
092:         TaikoData.State storage _state,
093:         TaikoData.Config memory _config,
094:         IAddressResolver _resolver,
095:         TaikoData.BlockMetadata memory _meta,
096:         TaikoData.Transition memory _tran,
097:         TaikoData.TierProof memory _proof
098:     )
099:         internal
100:         returns (uint8 maxBlocksToVerify_)
101:     {
102:         // Make sure parentHash is not zero
103:         // To contest an existing transition, simply use any non-zero value as
104:         // the blockHash and stateRoot.
105:         if (_tran.parentHash == 0 || _tran.blockHash == 0 || _tran.stateRoot == 0) {
106:             revert L1_INVALID_TRANSITION();
107:         }
108: 
109:         // Check that the block has been proposed but has not yet been verified.
110:         TaikoData.SlotB memory b = _state.slotB;
111:         if (_meta.id <= b.lastVerifiedBlockId || _meta.id >= b.numBlocks) {
112:             revert L1_INVALID_BLOCK_ID();
113:         }
114: 
115:         uint64 slot = _meta.id % _config.blockRingBufferSize;
116:         TaikoData.Block storage blk = _state.blocks[slot];
117: 
118:         // Check the integrity of the block data. It's worth noting that in
119:         // theory, this check may be skipped, but it's included for added
120:         // caution.
121:         if (blk.blockId != _meta.id || blk.metaHash != keccak256(abi.encode(_meta))) {
122:             revert L1_BLOCK_MISMATCH();
123:         }
124: 
125:         // Each transition is uniquely identified by the parentHash, with the
126:         // blockHash and stateRoot open for later updates as higher-tier proofs
127:         // become available. In cases where a transition with the specified
128:         // parentHash does not exist, the transition ID (tid) will be set to 0.
129:         (uint32 tid, TaikoData.TransitionState storage ts) =
130:             _createTransition(_state, blk, _tran, slot);
131: 
132:         // The new proof must meet or exceed the minimum tier required by the
133:         // block or the previous proof; it cannot be on a lower tier.
134:         if (_proof.tier == 0 || _proof.tier < _meta.minTier || _proof.tier < ts.tier) {
135:             revert L1_INVALID_TIER();
136:         }
137: 
138:         // Retrieve the tier configurations. If the tier is not supported, the
139:         // subsequent action will result in a revert.
140:         ITierProvider.Tier memory tier =
141:             ITierProvider(_resolver.resolve("tier_provider", false)).getTier(_proof.tier);
142: 
143:         // Check if this prover is allowed to submit a proof for this block
144:         _checkProverPermission(_state, blk, ts, tid, tier);
145: 
146:         // We must verify the proof, and any failure in proof verification will
147:         // result in a revert.
148:         //
149:         // It's crucial to emphasize that the proof can be assessed in two
150:         // potential modes: "proving mode" and "contesting mode." However, the
151:         // precise verification logic is defined within each tier's IVerifier
152:         // contract implementation. We simply specify to the verifier contract
153:         // which mode it should utilize - if the new tier is higher than the
154:         // previous tier, we employ the proving mode; otherwise, we employ the
155:         // contesting mode (the new tier cannot be lower than the previous tier,
156:         // this has been checked above).
157:         //
158:         // It's obvious that proof verification is entirely decoupled from
159:         // Taiko's core protocol.
160:         {
161:             address verifier = _resolver.resolve(tier.verifierName, true);
162: 
163:             if (verifier != address(0)) {
164:                 bool isContesting = _proof.tier == ts.tier && tier.contestBond != 0;
165: 
166:                 IVerifier.Context memory ctx = IVerifier.Context({
167:                     metaHash: blk.metaHash,
168:                     blobHash: _meta.blobHash,
169:                     // Separate msgSender to allow the prover to be any address in the future.
170:                     prover: msg.sender,
171:                     msgSender: msg.sender,
172:                     blockId: blk.blockId,
173:                     isContesting: isContesting,
174:                     blobUsed: _meta.blobUsed
175:                 });
176: 
177:                 IVerifier(verifier).verifyProof(ctx, _tran, _proof);
178:             } else if (tier.verifierName != TIER_OP) {
179:                 // The verifier can be address-zero, signifying that there are no
180:                 // proof checks for the tier. In practice, this only applies to
181:                 // optimistic proofs.
182:                 revert L1_MISSING_VERIFIER();
183:             }
184:         }
185: 
186:         bool isTopTier = tier.contestBond == 0;
187:         IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));
188: 
189:         if (isTopTier) {
190:             // A special return value from the top tier prover can signal this
191:             // contract to return all liveness bond.
192:             bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32
193:                 && bytes32(_proof.data) == RETURN_LIVENESS_BOND;
194: 
195:             if (returnLivenessBond) {
196:                 tko.transfer(blk.assignedProver, blk.livenessBond);
197:                 blk.livenessBond = 0;
198:             }
199:         }
200: 
201:         bool sameTransition = _tran.blockHash == ts.blockHash && _tran.stateRoot == ts.stateRoot;
202: 
203:         if (_proof.tier > ts.tier) {
204:             // Handles the case when an incoming tier is higher than the current transition's tier.
205:             // Reverts when the incoming proof tries to prove the same transition
206:             // (L1_ALREADY_PROVED).
207:             _overrideWithHigherProof(ts, _tran, _proof, tier, tko, sameTransition);
208: 
209:             emit TransitionProved({
210:                 blockId: blk.blockId,
211:                 tran: _tran,
212:                 prover: msg.sender,
213:                 validityBond: tier.validityBond,
214:                 tier: _proof.tier
215:             });
216:         } else {
217:             // New transition and old transition on the same tier - and if this transaction tries to
218:             // prove the same, it reverts
219:             if (sameTransition) revert L1_ALREADY_PROVED();
220: 
221:             if (isTopTier) {
222:                 // The top tier prover re-proves.
223:                 assert(tier.validityBond == 0);
224:                 assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0));
225: 
226:                 ts.prover = msg.sender;
227:                 ts.blockHash = _tran.blockHash;
228:                 ts.stateRoot = _tran.stateRoot;
229: 
230:                 emit TransitionProved({
231:                     blockId: blk.blockId,
232:                     tran: _tran,
233:                     prover: msg.sender,
234:                     validityBond: 0,
235:                     tier: _proof.tier
236:                 });
237:             } else {
238:                 // Contesting but not on the highest tier
239:                 if (ts.contester != address(0)) revert L1_ALREADY_CONTESTED();
240: 
241:                 // Burn the contest bond from the prover.
242:                 tko.transferFrom(msg.sender, address(this), tier.contestBond);
243: 
244:                 // We retain the contest bond within the transition, just in
245:                 // case this configuration is altered to a different value
246:                 // before the contest is resolved.
247:                 //
248:                 // It's worth noting that the previous value of ts.contestBond
249:                 // doesn't have any significance.
250:                 ts.contestBond = tier.contestBond;
251:                 ts.contester = msg.sender;
252:                 ts.contestations += 1;
253: 
254:                 emit TransitionContested({
255:                     blockId: blk.blockId,
256:                     tran: _tran,
257:                     contester: msg.sender,
258:                     contestBond: tier.contestBond,
259:                     tier: _proof.tier
260:                 });
261:             }
262:         }
263: 
264:         ts.timestamp = uint64(block.timestamp);
265:         return tier.maxBlocksToVerifyPerProof;
266:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L266) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

126:     function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)
127:         internal
128:         pure
129:         virtual
130:         returns (bool valid)
131:     {
132:         return status == TCBInfoStruct.TCBStatus.OK
133:             || status == TCBInfoStruct.TCBStatus.TCB_SW_HARDENING_NEEDED
134:             || status == TCBInfoStruct.TCBStatus.TCB_CONFIGURATION_AND_SW_HARDENING_NEEDED
135:             || status == TCBInfoStruct.TCBStatus.TCB_OUT_OF_DATE_CONFIGURATION_NEEDED;
136:     }

175:     function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)
176:         private
177:         view
178:         returns (bool, EnclaveIdStruct.EnclaveIdStatus status)
179:     {
180:         EnclaveIdStruct.EnclaveId memory enclaveId = qeIdentity;
181:         bool miscselectMatched =
182:             quoteEnclaveReport.miscSelect & enclaveId.miscselectMask == enclaveId.miscselect;
183: 
184:         bool attributesMatched =
185:             quoteEnclaveReport.attributes & enclaveId.attributesMask == enclaveId.attributes;
186:         bool mrsignerMatched = quoteEnclaveReport.mrSigner == enclaveId.mrsigner;
187: 
188:         bool isvprodidMatched = quoteEnclaveReport.isvProdId == enclaveId.isvprodid;
189: 
190:         bool tcbFound;
191:         for (uint256 i; i < enclaveId.tcbLevels.length; ++i) {
192:             EnclaveIdStruct.TcbLevel memory tcb = enclaveId.tcbLevels[i];
193:             if (tcb.tcb.isvsvn <= quoteEnclaveReport.isvSvn) {
194:                 tcbFound = true;
195:                 status = tcb.tcbStatus;
196:                 break;
197:             }
198:         }
199:         return (
200:             miscselectMatched && attributesMatched && mrsignerMatched && isvprodidMatched
201:                 && tcbFound,
202:             status
203:         );
204:     }

206:     function _checkTcbLevels(
207:         IPEMCertChainLib.PCKCertificateField memory pck,
208:         TCBInfoStruct.TCBInfo memory tcb
209:     )
210:         private
211:         pure
212:         returns (bool, TCBInfoStruct.TCBStatus status)
213:     {
214:         for (uint256 i; i < tcb.tcbLevels.length; ++i) {
215:             TCBInfoStruct.TCBLevelObj memory current = tcb.tcbLevels[i];
216:             bool pceSvnIsHigherOrGreater = pck.sgxExtension.pcesvn >= current.pcesvn;
217:             bool cpuSvnsAreHigherOrGreater = _isCpuSvnHigherOrGreater(
218:                 pck.sgxExtension.sgxTcbCompSvnArr, current.sgxTcbCompSvnArr
219:             );
220:             if (pceSvnIsHigherOrGreater && cpuSvnsAreHigherOrGreater) {
221:                 status = current.status;
222:                 bool tcbIsRevoked = status == TCBInfoStruct.TCBStatus.TCB_REVOKED;
223:                 return (!tcbIsRevoked, status);
224:             }
225:         }
226:         return (true, TCBInfoStruct.TCBStatus.TCB_UNRECOGNIZED);
227:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126-L136) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175-L204), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L227)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {
189:         return uint8(self[idx]);
190:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L190) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

113:     function verifyES256Signature(
114:         bytes memory tbs,
115:         bytes memory signature,
116:         bytes memory publicKey
117:     )
118:         public
119:         view
120:         returns (bool sigValid)
121:     {
122:         // Parse signature
123:         if (signature.length != 64) {
124:             return false;
125:         }
126:         uint256 r = uint256(bytes32(signature.substring(0, 32)));
127:         uint256 s = uint256(bytes32(signature.substring(32, 32)));
128:         // Parse public key
129:         if (publicKey.length != 64) {
130:             return false;
131:         }
132:         uint256 gx = uint256(bytes32(publicKey.substring(0, 32)));
133:         uint256 gy = uint256(bytes32(publicKey.substring(32, 32)));
134: 
135:         // Verify signature
136:         bytes memory args = abi.encode(sha256(tbs), r, s, gx, gy);
137:         (bool success, bytes memory ret) = ES256VERIFIER.staticcall(args);
138:         assert(success); // never reverts, always returns 0 or 1
139: 
140:         return abi.decode(ret, (uint256)) == 1;
141:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L141) 


</details>


### [NC&#x2011;83] [NatSpec] Natspec `@dev` is missing from `contract` 



*There are 683 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

4: /// @title IAddressManager
5: /// @notice Manages a mapping of (chainId, name) pairs to Ethereum addresses.
6: /// @custom:security-contact security@taiko.xyz
7: interface IAddressManager {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L4-L7) 


```solidity

File: /contracts/common/AddressManager.sol

07: /// @title AddressManager
08: /// @notice See the documentation in {IAddressManager}.
09: /// @custom:security-contact security@taiko.xyz
10: contract AddressManager is EssentialContract, IAddressManager {

16:     /// @notice Emitted when an address is set.
17:     /// @param chainId The chainId for the address mapping.
18:     /// @param name The name for the address mapping.
19:     /// @param newAddress The new address.
20:     /// @param oldAddress The old address.

25:     error AM_INVALID_PARAMS();

26:     error AM_UNSUPPORTED();

28:     /// @notice Initializes the contract.
29:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.

34:     /// @notice Sets the address for a specific chainId-name pair.
35:     /// @param _chainId The chainId to which the address will be mapped.
36:     /// @param _name The name to which the address will be mapped.
37:     /// @param _newAddress The Ethereum address to be mapped.

53:     /// @inheritdoc IAddressManager

58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L16-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L28-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L34-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58)


```solidity

File: /contracts/common/EssentialContract.sol

08: /// @title EssentialContract
09: /// @custom:security-contact security@taiko.xyz
10: abstract contract EssentialContract is UUPSUpgradeable, Ownable2StepUpgradeable, AddressResolver {

27:     /// @notice Emitted when the contract is paused.
28:     /// @param account The account that paused the contract.

31:     /// @notice Emitted when the contract is unpaused.
32:     /// @param account The account that unpaused the contract.

35:     error REENTRANT_CALL();

36:     error INVALID_PAUSE_STATUS();

37:     error ZERO_ADDR_MANAGER();

46:     modifier nonReentrant() {

53:     modifier whenPaused() {

58:     modifier whenNotPaused() {

63:     /// @custom:oz-upgrades-unsafe-allow constructor

68:     /// @notice Pauses the contract.

77:     /// @notice Unpauses the contract.

86:     /// @notice Returns true if the contract is paused, and false otherwise.
87:     /// @return True if paused, false otherwise.

92:     /// @notice Initializes the contract.
93:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
94:     /// @param _addressManager The address of the {AddressManager} contract.

109:     function __Essential_init(address _owner) internal virtual {

114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }

116:     function _authorizePause(address) internal virtual onlyOwner { }

119:     function _storeReentryLock(uint8 _reentry) internal virtual {

130:     function _loadReentryLock() internal view virtual returns (uint8 reentry_) {

140:     function _inNonReentrant() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L27-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L31-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L86-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L92-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L119-L119), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L140-L140)


```solidity

File: /contracts/libs/Lib4844.sol

19:     error EVAL_FAILED_1();

20:     error EVAL_FAILED_2();

21:     error POINT_X_TOO_LARGE();

22:     error POINT_Y_TOO_LARGE();

24:     /// @notice Evaluates the 4844 point using the precompile.
25:     /// @param _blobHash The versioned hash
26:     /// @param _x The evaluation point
27:     /// @param _y The expected output
28:     /// @param _commitment The input kzg point
29:     /// @param _pointProof The quotient kzg


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L24-L29)


```solidity

File: /contracts/libs/LibAddress.sol

16:     error ETH_TRANSFER_FAILED();

46:     function supportsInterface(

61:     function isValidSignature(

77:     function isSenderEOA() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L77-L77)


```solidity

File: /contracts/libs/LibTrieProof.sol

13: /// @title LibTrieProof
14: /// @custom:security-contact security@taiko.xyz
15: library LibTrieProof {

20:     error LTP_INVALID_ACCOUNT_PROOF();

21:     error LTP_INVALID_INCLUSION_PROOF();

23:     /// @notice Verifies that the value of a slot in the storage of an account is value.
24:     ///
25:     /// @param _rootHash The merkle root of state tree or the account tree. If accountProof's length
26:     /// is zero, it is used as the account's storage root, otherwise it will be used as the state
27:     /// root.
28:     /// @param _addr The address of contract.
29:     /// @param _slot The slot in the contract.
30:     /// @param _value The value to be verified.
31:     /// @param _accountProof The account proof
32:     /// @param _storageProof The storage proof
33:     /// @return storageRoot_ The account's storage root


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L13-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L23-L33)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

14: /// @title TaikoGovernor
15: /// @custom:security-contact security@taiko.xyz
16: contract TaikoGovernor is

25:     error TG_INVALID_SIGNATURES_LENGTH();

27:     /// @notice Initializes the contract.
28:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
29:     /// @param _token The Taiko token.
30:     /// @param _timelock The timelock contract address.

108:     /// @notice How long after a proposal is created should voting power be fixed. A
109:     /// large voting delay gives users time to unstake tokens if necessary.
110:     /// @return The duration of the voting delay.

115:     /// @notice How long does a proposal remain open to votes.
116:     /// @return The duration of the voting period.

121:     /// @notice The number of votes required in order for a voter to become a proposer.
122:     /// @return The number of votes required.

127:     function _execute(

140:     function _cancel(

153:     function _executor()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L14-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L27-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L108-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L115-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L121-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L153-L153)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

7: /// @title TaikoTimelockController
8: /// @custom:security-contact security@taiko.xyz
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {

12:     /// @notice Initializes the contract.
13:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
14:     /// @param _minDelay The minimal delay.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L7-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L12-L14)


```solidity

File: /contracts/L1/hooks/IHook.sol

6: /// @title IHook
7: /// @custom:security-contact security@taiko.xyz
8: interface IHook {

09:     /// @notice Called when a block is proposed.
10:     /// @param _blk The proposed block.
11:     /// @param _meta The metadata of the proposed block.
12:     /// @param _data The data of the proposed block.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L9-L12)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

11: /// @title AssignmentHook
12: /// @notice A hook that handles prover assignment verification and fee processing.
13: /// @custom:security-contact security@taiko.xyz
14: contract AssignmentHook is EssentialContract, IHook {

18:     struct ProverAssignment {

29:     struct Input {

42:     /// @notice Emitted when a block is assigned to a prover.
43:     /// @param assignedProver The address of the assigned prover.
44:     /// @param meta The metadata of the assigned block.
45:     /// @param assignment The prover assignment.

50:     error HOOK_ASSIGNMENT_EXPIRED();

51:     error HOOK_ASSIGNMENT_INVALID_SIG();

52:     error HOOK_TIER_NOT_FOUND();

54:     /// @notice Initializes the contract.
55:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
56:     /// @param _addressManager The address of the {AddressManager} contract.

61:     /// @inheritdoc IHook

132:     /// @notice Hashes the prover assignment.
133:     /// @param _assignment The prover assignment.
134:     /// @param _taikoL1Address The address of the TaikoL1 contract.
135:     /// @param _blobHash The blob hash.
136:     /// @return The hash of the prover assignment.

164:     function _getProverFee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L11-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L42-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L54-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L132-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L164-L164)


```solidity

File: /contracts/L1/ITaikoL1.sol

6: /// @title ITaikoL1
7: /// @custom:security-contact security@taiko.xyz
8: interface ITaikoL1 {

09:     /// @notice Proposes a Taiko L2 block.
10:     /// @param _params Block parameters, currently an encoded BlockParams object.
11:     /// @param _txList txList data if calldata is used for DA.
12:     /// @return meta_ The metadata of the proposed L2 block.
13:     /// @return deposits_ The Ether deposits processed.

22:     /// @notice Proves or contests a block transition.
23:     /// @param _blockId The index of the block to prove. This is also used to
24:     /// select the right implementation version.
25:     /// @param _input An abi-encoded (TaikoData.BlockMetadata, TaikoData.Transition,
26:     /// TaikoData.TierProof) tuple.

29:     /// @notice Verifies up to a certain number of blocks.
30:     /// @param _maxBlocksToVerify Max number of blocks to verify.

33:     /// @notice Gets the configuration of the TaikoL1 contract.
34:     /// @return Config struct containing configuration parameters.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L9-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L22-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L29-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L33-L34)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

09: /// @title LibDepositing
10: /// @notice A library for handling Ether deposits in the Taiko protocol.
11: /// @custom:security-contact security@taiko.xyz
12: library LibDepositing {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L9-L12) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

12: /// @title LibProposing
13: /// @notice A library for handling block proposals in the Taiko protocol.
14: /// @custom:security-contact security@taiko.xyz
15: library LibProposing {

24:     /// @notice Emitted when a block is proposed.
25:     /// @param blockId The ID of the proposed block.
26:     /// @param assignedProver The address of the assigned prover.
27:     /// @param livenessBond The liveness bond of the proposed block.
28:     /// @param meta The metadata of the proposed block.
29:     /// @param depositsProcessed The EthDeposit array about processed deposits in this proposed
30:     /// block.

39:     /// @notice Emitted when a blob is cached.
40:     /// @param blobHash The hash of the cached blob.

44:     error L1_BLOB_FOR_DA_DISABLED();

45:     error L1_BLOB_NOT_FOUND();

46:     error L1_BLOB_NOT_REUSABLE();

47:     error L1_BLOB_REUSE_DISABLED();

48:     error L1_INVALID_HOOK();

49:     error L1_INVALID_PARAM();

50:     error L1_INVALID_PROVER();

51:     error L1_LIVENESS_BOND_NOT_RECEIVED();

52:     error L1_PROPOSER_NOT_EOA();

53:     error L1_TOO_MANY_BLOCKS();

54:     error L1_TXLIST_OFFSET();

55:     error L1_TXLIST_SIZE();

56:     error L1_UNAUTHORIZED();

57:     error L1_UNEXPECTED_PARENT();

282:     /// @notice Checks if a blob is reusable.
283:     /// @param _state Current TaikoData.State.
284:     /// @param _config The TaikoData.Config.
285:     /// @param _blobHash The blob hash
286:     /// @return true if the blob is reusable, false otherwise.

299:     function _isProposerPermitted(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L12-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L24-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L39-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L282-L286), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L299-L299)


```solidity

File: /contracts/L1/libs/LibProving.sol

12: /// @title LibProving
13: /// @notice A library for handling block contestation and proving in the Taiko
14: /// protocol.
15: /// @custom:security-contact security@taiko.xyz
16: library LibProving {

26:     /// @notice Emitted when a transition is proved.
27:     /// @param blockId The block ID.
28:     /// @param tran The transition data.
29:     /// @param prover The prover's address.
30:     /// @param validityBond The validity bond amount.
31:     /// @param tier The tier of the proof.

40:     /// @notice Emitted when a transition is contested.
41:     /// @param blockId The block ID.
42:     /// @param tran The transition data.
43:     /// @param contester The contester's address.
44:     /// @param contestBond The contest bond amount.
45:     /// @param tier The tier of the proof.

54:     /// @notice Emitted when proving is paused or unpaused.
55:     /// @param paused The pause status.

59:     error L1_ALREADY_CONTESTED();

60:     error L1_ALREADY_PROVED();

61:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

62:     error L1_BLOCK_MISMATCH();

63:     error L1_INVALID_BLOCK_ID();

64:     error L1_INVALID_PAUSE_STATUS();

65:     error L1_INVALID_TIER();

66:     error L1_INVALID_TRANSITION();

67:     error L1_MISSING_VERIFIER();

68:     error L1_NOT_ASSIGNED_PROVER();

70:     /// @notice Pauses or unpauses the proving process.
71:     /// @param _state Current TaikoData.State.
72:     /// @param _pause The pause status.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L12-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L26-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L40-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L54-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L70-L72)


```solidity

File: /contracts/L1/libs/LibUtils.sol

6: /// @title LibUtils
7: /// @notice A library that offers helper functions.
8: /// @custom:security-contact security@taiko.xyz
9: library LibUtils {

11:     error L1_BLOCK_MISMATCH();

12:     error L1_INVALID_BLOCK_ID();

13:     error L1_TRANSITION_NOT_FOUND();

14:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L6-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L14-L14)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

13: /// @title LibVerifying
14: /// @notice A library for handling block verification in the Taiko protocol.
15: /// @custom:security-contact security@taiko.xyz
16: library LibVerifying {

20:     /// @notice Emitted when a block is verified.
21:     /// @param blockId The block ID.
22:     /// @param assignedProver The assigned prover of the block.
23:     /// @param prover The actual prover of the block.
24:     /// @param blockHash The block hash.
25:     /// @param stateRoot The state root.
26:     /// @param tier The tier of the transition used for verification.
27:     /// @param contestations The number of contestations.

39:     error L1_BLOCK_MISMATCH();

40:     error L1_INVALID_CONFIG();

41:     error L1_TRANSITION_ID_ZERO();

43:     /// @notice Initializes the Taiko protocol state.
44:     /// @param _state The state to initialize.
45:     /// @param _config The configuration for the Taiko protocol.
46:     /// @param _genesisBlockHash The block hash of the genesis block.

224:     function _syncChainData(

245:     function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L13-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L20-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L43-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L245-L245)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

08: /// @title GuardianProver
09: /// @custom:security-contact security@taiko.xyz
10: contract GuardianProver is Guardians {

13:     /// @notice Emitted when a guardian proof is approved.
14:     /// @param addr The address of the guardian.
15:     /// @param blockId The block ID.
16:     /// @param blockHash The block hash.
17:     /// @param approved If the proof is approved.

22:     /// @notice Initializes the contract.
23:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
24:     /// @param _addressManager The address of the {AddressManager} contract.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L13-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L22-L24)


```solidity

File: /contracts/L1/provers/Guardians.sol

6: /// @title Guardians
7: /// @notice A contract that manages a set of guardians and their approvals.
8: /// @custom:security-contact security@taiko.xyz
9: abstract contract Guardians is EssentialContract {

34:     /// @notice Emitted when the set of guardians is updated
35:     /// @param version The new version
36:     /// @param guardians The new set of guardians

39:     /// @notice Emitted when an approval is made
40:     /// @param operationId The operation ID
41:     /// @param approvalBits The new approval bits
42:     /// @param proofSubmitted If the proof was submitted

45:     error INVALID_GUARDIAN();

46:     error INVALID_GUARDIAN_SET();

47:     error INVALID_MIN_GUARDIANS();

48:     error INVALID_PROOF();

50:     /// @notice Set the set of guardians
51:     /// @param _newGuardians The new set of guardians
52:     /// @param _minGuardians The minimum required to sign

098:     /// @notice Returns if the hash is approved
099:     /// @param _hash The hash to check
100:     /// @return true if the hash is approved

105:     /// @notice Returns the number of guardians
106:     /// @return The number of guardians

111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {

124:     function deleteApproval(bytes32 _hash) internal {

128:     function isApproved(uint256 _approvalBits) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L6-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L34-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L39-L42), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L50-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L98-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L105-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L128-L128)


```solidity

File: /contracts/L1/TaikoData.sol

4: /// @title TaikoData
5: /// @notice This library defines various data structures used in the Taiko
6: /// protocol.
7: /// @custom:security-contact security@taiko.xyz
8: library TaikoData {

68:     struct TierProof {

73:     struct HookCall {

78:     struct BlockParams {

168:     struct SlotB {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L4-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L168-L168)


```solidity

File: /contracts/L1/TaikoErrors.sol

12:     error L1_ALREADY_CONTESTED();

13:     error L1_ALREADY_PROVED();

14:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

15:     error L1_BLOB_FOR_DA_DISABLED();

16:     error L1_BLOB_NOT_FOUND();

17:     error L1_BLOB_NOT_REUSABLE();

18:     error L1_BLOB_REUSE_DISABLED();

19:     error L1_BLOCK_MISMATCH();

20:     error L1_INVALID_BLOCK_ID();

21:     error L1_INVALID_CONFIG();

22:     error L1_INVALID_ETH_DEPOSIT();

23:     error L1_INVALID_HOOK();

24:     error L1_INVALID_PARAM();

25:     error L1_INVALID_PAUSE_STATUS();

26:     error L1_INVALID_PROVER();

27:     error L1_INVALID_TIER();

28:     error L1_INVALID_TRANSITION();

29:     error L1_LIVENESS_BOND_NOT_RECEIVED();

30:     error L1_NOT_ASSIGNED_PROVER();

31:     error L1_PROPOSER_NOT_EOA();

32:     error L1_PROVING_PAUSED();

33:     error L1_RECEIVE_DISABLED();

34:     error L1_MISSING_VERIFIER();

35:     error L1_TOO_MANY_BLOCKS();

36:     error L1_TOO_MANY_TIERS();

37:     error L1_TRANSITION_ID_ZERO();

38:     error L1_TRANSITION_NOT_FOUND();

39:     error L1_TXLIST_SIZE();

40:     error L1_UNAUTHORIZED();

41:     error L1_UNEXPECTED_PARENT();

42:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L42-L42)


```solidity

File: /contracts/L1/TaikoL1.sol

28:     modifier whenProvingNotPaused() {

38:     /// @notice Initializes the contract.
39:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
40:     /// @param _addressManager The address of the {AddressManager} contract.
41:     /// @param _genesisBlockHash The block hash of the genesis block.

54:     /// @inheritdoc ITaikoL1

74:     /// @inheritdoc ITaikoL1

99:     /// @inheritdoc ITaikoL1

109:     /// @notice Pause block proving.
110:     /// @param _pause True if paused.

116:     /// @notice Deposits Ether to Layer 2.
117:     /// @param _recipient Address of the recipient for the deposited Ether on
118:     /// Layer 2.

123:     /// @inheritdoc EssentialContract

129:     /// @notice Checks if Ether deposit is allowed for Layer 2.
130:     /// @param _amount Amount of Ether to be deposited.
131:     /// @return true if Ether deposit is allowed, false otherwise.

136:     /// @notice See {LibProposing-isBlobReusable}.

141:     /// @notice Gets the details of a block.
142:     /// @param _blockId Index of the block.
143:     /// @return blk_ The block.
144:     /// @return ts_ The transition used to verify this block.

158:     /// @notice Gets the state transition for a specific block.
159:     /// @param _blockId Index of the block.
160:     /// @param _parentHash Parent hash of the block.
161:     /// @return The state transition data of the block.

173:     /// @notice Gets the state variables of the TaikoL1 contract.
174:     /// @return a_ State variables stored at SlotA.
175:     /// @return b_ State variables stored at SlotB.

185:     /// @inheritdoc ITaikoL1

220:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L38-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L109-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L116-L118), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L129-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L141-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L158-L161), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L173-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L220)


```solidity

File: /contracts/L1/TaikoToken.sol

18:     error TKO_INVALID_ADDR();

20:     /// @notice Initializes the contract.
21:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
22:     /// @param _name The name of the token.
23:     /// @param _symbol The symbol of the token.
24:     /// @param _recipient The address to receive initial token minting.

44:     /// @notice Burns tokens from the specified address.
45:     /// @param _from The address to burn tokens from.
46:     /// @param _amount The amount of tokens to burn.

51:     /// @notice Creates a new token snapshot.

56:     /// @notice Transfers tokens to a specified address.
57:     /// @param _to The address to transfer tokens to.
58:     /// @param _amount The amount of tokens to transfer.
59:     /// @return A boolean indicating whether the transfer was successful or not.

65:     /// @notice Transfers tokens from one address to another.
66:     /// @param _from The address to transfer tokens from.
67:     /// @param _to The address to transfer tokens to.
68:     /// @param _amount The amount of tokens to transfer.
69:     /// @return A boolean indicating whether the transfer was successful or not.

83:     function _beforeTokenTransfer(

94:     function _afterTokenTransfer(

105:     function _mint(

115:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L20-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L44-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L56-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L65-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L115-L115)


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

4: /// @title ITierProvider
5: /// @notice Defines interface to return tier configuration.
6: /// @custom:security-contact security@taiko.xyz
7: interface ITierProvider {

8:     struct Tier {

17:     error TIER_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L4-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L17-L17)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

13:     /// @notice Initializes the contract.
14:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.

19:     /// @inheritdoc ITierProvider

46:     /// @inheritdoc ITierProvider

53:     /// @inheritdoc ITierProvider


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L13-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L53-L53)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

13:     /// @notice Initializes the contract.
14:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.

19:     /// @inheritdoc ITierProvider

57:     /// @inheritdoc ITierProvider

65:     /// @inheritdoc ITierProvider


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L13-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L65-L65)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

13:     /// @notice Initializes the contract.
14:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.

19:     /// @inheritdoc ITierProvider

57:     /// @inheritdoc ITierProvider

65:     /// @inheritdoc ITierProvider


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L13-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L65-L65)


```solidity

File: /contracts/L2/CrossChainOwned.sol

23:     /// @notice Emitted when a transaction is executed.
24:     /// @param txId The transaction ID.
25:     /// @param selector The function selector.

28:     error XCO_INVALID_OWNER_CHAINID();

29:     error XCO_INVALID_TX_ID();

30:     error XCO_PERMISSION_DENIED();

31:     error XCO_TX_REVERTED();

56:     /// @notice Initializes the contract.
57:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
58:     /// @param _addressManager The address of the {AddressManager} contract.
59:     /// @param _ownerChainId The owner's deployment chain ID.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L23-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L56-L59)


```solidity

File: /contracts/L2/Lib1559Math.sol

11:     error EIP1559_INVALID_PARAMS();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L11-L11) 


```solidity

File: /contracts/L2/TaikoL2.sol

14: /// @title TaikoL2
15: /// @notice Taiko L2 is a smart contract that handles cross-layer message
16: /// verification and manages EIP-1559 gas pricing for Layer 2 (L2) operations.
17: /// It is used to anchor the latest L1 block details to L2 for cross-layer
18: /// communication, manage EIP-1559 parameters for gas pricing, and store
19: /// verified L1 block information.
20: /// @custom:security-contact security@taiko.xyz
21: contract TaikoL2 is CrossChainOwned {

26:     struct Config {

54:     /// @notice Emitted when the latest L1 block details are anchored to L2.
55:     /// @param parentHash The hash of the parent block.
56:     /// @param gasExcess The gas excess value used to calculate the base fee.

59:     error L2_BASEFEE_MISMATCH();

60:     error L2_INVALID_CHAIN_ID();

61:     error L2_INVALID_PARAM();

62:     error L2_INVALID_SENDER();

63:     error L2_PUBLIC_INPUT_HASH_MISMATCH();

64:     error L2_TOO_LATE();

66:     /// @notice Initializes the contract.
67:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
68:     /// @param _addressManager The address of the {AddressManager} contract.
69:     /// @param _l1ChainId The ID of the base layer.
70:     /// @param _gasExcess The initial gasExcess.

100:     /// @notice Anchors the latest L1 block details to L2 for cross-layer
101:     /// message verification.
102:     /// @param _l1BlockHash The latest L1 block hash when this block was
103:     /// proposed.
104:     /// @param _l1StateRoot The latest L1 block's state root.
105:     /// @param _l1BlockId The latest L1 block height when this block was proposed.
106:     /// @param _parentGasUsed The gas used in the parent block.

160:     /// @notice Withdraw token or Ether from this address
161:     /// @param _token Token address or address(0) if Ether.
162:     /// @param _to Withdraw to address.

180:     /// @notice Gets the basefee and gas excess using EIP-1559 configuration for
181:     /// the given parameters.
182:     /// @param _l1BlockId The synced L1 height in the next Taiko block
183:     /// @param _parentGasUsed Gas used in the parent block.
184:     /// @return basefee_ The calculated EIP-1559 base fee per gas.

196:     /// @notice Retrieves the block hash for the given L2 block number.
197:     /// @param _blockId The L2 block number to retrieve the block hash for.
198:     /// @return The block hash for the specified L2 block id, or zero if the
199:     /// block id is greater than or equal to the current block number.

206:     /// @notice Returns EIP1559 related configurations.
207:     /// @return config_ struct containing configuration parameters.

217:     /// @notice Tells if we need to validate basefee (for simulation).
218:     /// @return Returns true to skip checking basefee mismatch.

223:     function _calcPublicInputHash(uint256 _blockId)

252:     function _calc1559BaseFee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L14-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L54-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L66-L70), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L100-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L160-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L180-L184), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L196-L199), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L206-L207), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L217-L218), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L252-L252)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

6: /// @title TaikoL2EIP1559Configurable
7: /// @notice TaikoL2 with a setter to change EIP-1559 configurations and states.
8: /// @custom:security-contact security@taiko.xyz
9: contract TaikoL2EIP1559Configurable is TaikoL2 {

15:     /// @notice Emits when the EIP-1559 configuration and gas excess are changed.
16:     /// @param config The new EIP-1559 config.
17:     /// @param gasExcess The new gas excess.

20:     error L2_INVALID_CONFIG();

22:     /// @notice Sets EIP1559 configuration and gas excess.
23:     /// @param _newConfig The new EIP1559 config.
24:     /// @param _newGasExcess The new gas excess

42:     /// @inheritdoc TaikoL2


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L6-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L15-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L22-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L42-L42)


```solidity

File: /contracts/signal/ISignalService.sol

04: /// @title ISignalService
05: /// @notice The SignalService contract serves as a secure cross-chain message
06: /// passing system. It defines methods for sending and verifying signals with
07: /// merkle proofs. The trust assumption is that the target chain has secure
08: /// access to the merkle root (such as Taiko injects it in the anchor
09: /// transaction). With this, verifying a signal is reduced to simply verifying
10: /// a merkle proof.
11: /// @custom:security-contact security@taiko.xyz
12: interface ISignalService {

20:     struct HopProof {

29:     /// @notice Emitted when a remote chain's state root or signal root is
30:     /// synced locally as a signal.
31:     /// @param chainId The remote chainId.
32:     /// @param blockId The chain data's corresponding blockId.
33:     /// @param kind A value to mark the data type.
34:     /// @param data The remote data.
35:     /// @param signal The signal for this chain data.

44:     /// @notice Emitted when a signal is sent.
45:     /// @param app The address that initiated the signal.
46:     /// @param signal The signal (message) that was sent.
47:     /// @param slot The location in storage where this signal is stored.
48:     /// @param value The value of the signal.

51:     /// @notice Emitted when an address is authorized or deauthorized.
52:     /// @param addr The address to be authorized or deauthorized.
53:     /// @param authrized True if authorized, false otherwise.

56:     /// @notice Send a signal (message) by setting the storage slot to a value of 1.
57:     /// @param _signal The signal (message) to send.
58:     /// @return slot_ The location in storage where this signal is stored.

61:     /// @notice Sync a data from a remote chain locally as a signal. The signal is calculated
62:     /// uniquely from chainId, kind, and data.
63:     /// @param _chainId The remote chainId.
64:     /// @param _kind A value to mark the data type.
65:     /// @param _blockId The chain data's corresponding blockId
66:     /// @param _chainData The remote data.
67:     /// @return signal_ The signal for this chain data.

77:     /// @notice Verifies if a signal has been received on the target chain.
78:     /// @param _chainId The identifier for the source chain from which the
79:     /// signal originated.
80:     /// @param _app The address that initiated the signal.
81:     /// @param _signal The signal (message) to send.
82:     /// @param _proof Merkle proof that the signal was persisted on the
83:     /// source chain.

92:     /// @notice Verifies if a particular signal has already been sent.
93:     /// @param _app The address that initiated the signal.
94:     /// @param _signal The signal (message) that was sent.
95:     /// @return true if the signal has been sent, otherwise false.

098:     /// @notice Checks if a chain data has been synced.
099:     /// uniquely from chainId, kind, and data.
100:     /// @param _chainId The remote chainId.
101:     /// @param _kind A value to mark the data type.
102:     /// @param _blockId The chain data's corresponding blockId
103:     /// @param _chainData The remote data.
104:     /// @return true if the data has been synced, otherwise false.

115:     /// @notice Returns the given block's  chain data.
116:     /// @param _chainId Indenitifer of the chainId.
117:     /// @param _kind A value to mark the data type.
118:     /// @param _blockId The chain data's corresponding block id. If this value is 0, use the top
119:     /// block id.
120:     /// @return blockId_ The actual block id.
121:     /// @return chainData_ The synced chain data.

131:     /// @notice Returns the data to be used for caching slot generation.
132:     /// @param _chainId Indenitifer of the chainId.
133:     /// @param _kind A value to mark the data type.
134:     /// @param _blockId The chain data's corresponding block id. If this value is 0, use the top
135:     /// block id.
136:     /// @return signal_ The signal used for caching slot creation.

04: /// @title ISignalService
05: /// @notice The SignalService contract serves as a secure cross-chain message
06: /// passing system. It defines methods for sending and verifying signals with
07: /// merkle proofs. The trust assumption is that the target chain has secure
08: /// access to the merkle root (such as Taiko injects it in the anchor
09: /// transaction). With this, verifying a signal is reduced to simply verifying
10: /// a merkle proof.
11: /// @custom:security-contact security@taiko.xyz
12: interface ISignalService {

20:     struct HopProof {

29:     /// @notice Emitted when a remote chain's state root or signal root is
30:     /// synced locally as a signal.
31:     /// @param chainId The remote chainId.
32:     /// @param blockId The chain data's corresponding blockId.
33:     /// @param kind A value to mark the data type.
34:     /// @param data The remote data.
35:     /// @param signal The signal for this chain data.

44:     /// @notice Emitted when a signal is sent.
45:     /// @param app The address that initiated the signal.
46:     /// @param signal The signal (message) that was sent.
47:     /// @param slot The location in storage where this signal is stored.
48:     /// @param value The value of the signal.

51:     /// @notice Emitted when an address is authorized or deauthorized.
52:     /// @param addr The address to be authorized or deauthorized.
53:     /// @param authrized True if authorized, false otherwise.

56:     /// @notice Send a signal (message) by setting the storage slot to a value of 1.
57:     /// @param _signal The signal (message) to send.
58:     /// @return slot_ The location in storage where this signal is stored.

61:     /// @notice Sync a data from a remote chain locally as a signal. The signal is calculated
62:     /// uniquely from chainId, kind, and data.
63:     /// @param _chainId The remote chainId.
64:     /// @param _kind A value to mark the data type.
65:     /// @param _blockId The chain data's corresponding blockId
66:     /// @param _chainData The remote data.
67:     /// @return signal_ The signal for this chain data.

77:     /// @notice Verifies if a signal has been received on the target chain.
78:     /// @param _chainId The identifier for the source chain from which the
79:     /// signal originated.
80:     /// @param _app The address that initiated the signal.
81:     /// @param _signal The signal (message) to send.
82:     /// @param _proof Merkle proof that the signal was persisted on the
83:     /// source chain.

92:     /// @notice Verifies if a particular signal has already been sent.
93:     /// @param _app The address that initiated the signal.
94:     /// @param _signal The signal (message) that was sent.
95:     /// @return true if the signal has been sent, otherwise false.

098:     /// @notice Checks if a chain data has been synced.
099:     /// uniquely from chainId, kind, and data.
100:     /// @param _chainId The remote chainId.
101:     /// @param _kind A value to mark the data type.
102:     /// @param _blockId The chain data's corresponding blockId
103:     /// @param _chainData The remote data.
104:     /// @return true if the data has been synced, otherwise false.

115:     /// @notice Returns the given block's  chain data.
116:     /// @param _chainId Indenitifer of the chainId.
117:     /// @param _kind A value to mark the data type.
118:     /// @param _blockId The chain data's corresponding block id. If this value is 0, use the top
119:     /// block id.
120:     /// @return blockId_ The actual block id.
121:     /// @return chainData_ The synced chain data.

131:     /// @notice Returns the data to be used for caching slot generation.
132:     /// @param _chainId Indenitifer of the chainId.
133:     /// @param _kind A value to mark the data type.
134:     /// @param _blockId The chain data's corresponding block id. If this value is 0, use the top
135:     /// block id.
136:     /// @return signal_ The signal used for caching slot creation.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L4-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L29-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L44-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L51-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L56-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L61-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L77-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L92-L95), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L98-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L115-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L131-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L4-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L29-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L44-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L51-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L56-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L61-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L77-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L92-L95), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L98-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L115-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L131-L136)


```solidity

File: /contracts/signal/LibSignals.sol

4: /// @title LibSignals
5: /// @custom:security-contact security@taiko.xyz
6: library LibSignals {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/LibSignals.sol#L4-L6) 


```solidity

File: /contracts/signal/SignalService.sol

25:     error SS_EMPTY_PROOF();

26:     error SS_INVALID_SENDER();

27:     error SS_INVALID_LAST_HOP_CHAINID();

28:     error SS_INVALID_MID_HOP_CHAINID();

29:     error SS_INVALID_STATE();

30:     error SS_INVALID_VALUE();

31:     error SS_SIGNAL_NOT_FOUND();

32:     error SS_UNAUTHORIZED();

33:     error SS_UNSUPPORTED();

35:     modifier validSender(address _app) {

40:     modifier nonZeroValue(bytes32 _input) {

45:     /// @notice Initializes the contract.
46:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
47:     /// @param _addressManager The address of the {AddressManager} contract.

62:     /// @inheritdoc ISignalService

67:     /// @inheritdoc ISignalService

136:     /// @inheritdoc ISignalService

152:     /// @inheritdoc ISignalService

157:     /// @inheritdoc ISignalService

176:     /// @inheritdoc ISignalService

189:     /// @notice Returns the slot for a signal.
190:     /// @param _chainId The chainId of the signal.
191:     /// @param _app The address that initiated the signal.
192:     /// @param _signal The signal (message) that was sent.
193:     /// @return The slot for the signal.

206:     function _verifyHopProof(

231:     function _authorizePause(address) internal pure override {

235:     function _syncChainData(

253:     function _sendSignal(

271:     function _cacheChainData(

298:     function _loadSignalValue(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L45-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L189-L193), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L298-L298)


```solidity

File: /contracts/bridge/IBridge.sol

158: /// @title IRecallableSender
159: /// @notice An interface that all recallable message senders shall implement.
160: interface IRecallableSender {

172: /// @title IMessageInvocable
173: /// @notice An interface that all bridge message receiver shall implement
174: interface IMessageInvocable {

17:     struct Message {

49:     struct ProofReceipt {

60:     struct Context {

66:     /// @notice Emitted when a message is sent.
67:     /// @param msgHash The hash of the message.
68:     /// @param message The message.

71:     /// @notice Emitted when a message is received.
72:     /// @param msgHash The hash of the message.
73:     /// @param message The message.
74:     /// @param isRecall True if the message is a recall.

77:     /// @notice Emitted when a message is recalled.
78:     /// @param msgHash The hash of the message.

81:     /// @notice Emitted when a message is executed.
82:     /// @param msgHash The hash of the message.

85:     /// @notice Emitted when a message is retried.
86:     /// @param msgHash The hash of the message.

89:     /// @notice Emitted when the status of a message changes.
90:     /// @param msgHash The hash of the message.
91:     /// @param status The new status of the message.

94:     /// @notice Emitted when a message is suspended or unsuspended.
95:     /// @param msgHash The hash of the message.
96:     /// @param suspended True if the message is suspended.

099:     /// @notice Emitted when an address is banned or unbanned.
100:     /// @param addr The address to ban or unban.
101:     /// @param banned True if the address is banned.

104:     /// @notice Sends a message to the destination chain and takes custody
105:     /// of Ether required in this contract. All extra Ether will be refunded.
106:     /// @param _message The message to be sent.
107:     /// @return msgHash_ The hash of the sent message.
108:     /// @return message_ The updated message sent.

143:     /// @notice Returns the bridge state context.
144:     /// @return ctx_ The context of the current bridge operation.

147:     /// @notice Checks if the message was sent.
148:     /// @param _message The message.
149:     /// @return true if the message was sent.

152:     /// @notice Hash the message
153:     /// @param _message The message struct variable to be hashed.
154:     /// @return The message's hash.

161:     /// @notice Called when a message is recalled.
162:     /// @param _message The recalled message.
163:     /// @param _msgHash The hash of the recalled message.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L158-L160) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L172-L174), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L66-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L71-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L77-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L81-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L85-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L89-L91), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L94-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L99-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L104-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L143-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L147-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L152-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L161-L163)


```solidity

File: /contracts/bridge/Bridge.sol

50:     error B_INVALID_CHAINID();

51:     error B_INVALID_CONTEXT();

52:     error B_INVALID_GAS_LIMIT();

53:     error B_INVALID_STATUS();

54:     error B_INVALID_USER();

55:     error B_INVALID_VALUE();

56:     error B_MESSAGE_NOT_SENT();

57:     error B_NON_RETRIABLE();

58:     error B_NOT_FAILED();

59:     error B_NOT_RECEIVED();

60:     error B_PERMISSION_DENIED();

61:     error B_STATUS_MISMATCH();

62:     error B_INVOCATION_TOO_EARLY();

64:     modifier sameChain(uint64 _chainId) {

69:     /// @notice Function to receive Ether.

72:     /// @notice Initializes the contract.
73:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
74:     /// @param _addressManager The address of the {AddressManager} contract.

79:     /// @notice Suspend or unsuspend invocation for a list of messages.
80:     /// @param _msgHashes The array of msgHashes to be suspended.
81:     /// @param _suspend True if suspend, false if unsuspend.

097:     /// @notice Ban or unban an address. A banned addresses will not be invoked upon
098:     /// with message calls.
099:     /// @param _addr The address to ban or unban.
100:     /// @param _ban True if ban, false if unban.

114:     /// @inheritdoc IBridge

154:     /// @inheritdoc IBridge

216:     /// @inheritdoc IBridge

309:     /// @inheritdoc IBridge

339:     /// @inheritdoc IBridge

348:     /// @notice Checks if a msgHash has failed on its destination chain.
349:     /// @param _message The message.
350:     /// @param _proof The merkle inclusion proof.
351:     /// @return true if the message has failed, false otherwise.

370:     /// @notice Checks if a msgHash has failed on its destination chain.
371:     /// @param _message The message.
372:     /// @param _proof The merkle inclusion proof.
373:     /// @return true if the message has failed, false otherwise.

388:     /// @notice Checks if the destination chain is enabled.
389:     /// @param _chainId The destination chain ID.
390:     /// @return enabled_ True if the destination chain is enabled.
391:     /// @return destBridge_ The bridge of the destination chain.

401:     /// @notice Gets the current context.
402:     /// @inheritdoc IBridge

448:     /// @inheritdoc IBridge

453:     /// @notice Returns a signal representing a failed/recalled message.
454:     /// @param _msgHash The message hash.
455:     /// @return The failed representation of it as bytes32.

460:     /// @notice Checks if the given address can pause and unpause the bridge.

528:     /// @notice Resets the call context

537:     /// @notice Stores the call context
538:     /// @param _msgHash The message hash.
539:     /// @param _from The sender's address.
540:     /// @param _srcChainId The source chain ID.

553:     /// @notice Loads and returns the call context.
554:     /// @return ctx_ The call context.

571:     /// @notice Checks if the signal was received.
572:     /// @param _signalService The signal service address.
573:     /// @param _signal The signal.
574:     /// @param _chainId The ID of the chain the signal is stored on.
575:     /// @param _proof The merkle inclusion proof.
576:     /// @return success_ True if the message was received.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L72-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L79-L81), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L97-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L309-L309), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L339-L339), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L348-L351), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L370-L373), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L388-L391), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L401-L402), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L448-L448), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L453-L455), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L460-L460), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L528-L528), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L537-L540), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L553-L554), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L571-L576)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

6: /// @title IUSDC
7: /// @custom:security-contact security@taiko.xyz
8: interface IUSDC {

26: /// @title USDCAdapter
27: /// @custom:security-contact security@taiko.xyz
28: contract USDCAdapter is BridgedERC20Base {

09:     /// @notice Burns a specific amount of tokens.
10:     /// @param _amount The amount of token to be burned.

13:     /// @notice Mints a specific amount of new tokens to an address.
14:     /// @param _to The address that will receive the minted tokens.
15:     /// @param _amount The amount of tokens to mint.

18:     /// @notice Transfers tokens from one address to another.
19:     /// @param from The address which you want to send tokens from.
20:     /// @param _to The address which you want to transfer to.
21:     /// @param _amount The amount of tokens to be transferred.
22:     /// @return true if the transfer was successful, otherwise false.

34:     /// @notice Initializes the contract.
35:     /// @param _owner The owner of this contract.
36:     /// @param _addressManager The address of the {AddressManager} contract.
37:     /// @param _usdc The USDC instance.

43:     function _mintToken(address _account, uint256 _amount) internal override {

47:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L26-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L9-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L13-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L18-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L34-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

11: /// @title BridgedERC20
12: /// @notice An upgradeable ERC20 contract that represents tokens bridged from
13: /// another chain.
14: /// @custom:security-contact security@taiko.xyz
15: contract BridgedERC20 is

34:     error BTOKEN_CANNOT_RECEIVE();

35:     error BTOKEN_UNAUTHORIZED();

37:     modifier onlyOwnerOrSnapshooter() {

44:     /// @notice Initializes the contract.
45:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
46:     /// @param _addressManager The address of the {AddressManager} contract.
47:     /// @param _srcToken The source token address.
48:     /// @param _srcChainId The source chain ID.
49:     /// @param _decimals The number of decimal places of the source token.
50:     /// @param _symbol The symbol of the token.
51:     /// @param _name The name of the token.

78:     /// @notice Set the snapshoter address.
79:     /// @param _snapshooter snapshooter address.

84:     /// @notice Creates a new token snapshot.

89:     /// @notice Gets the name of the token.
90:     /// @return The name.

100:     /// @notice Gets the symbol of the bridged token.
101:     /// @return The symbol.

111:     /// @notice Gets the number of decimal places of the token.
112:     /// @return The number of decimal places of the token.

122:     /// @notice Gets the canonical token's address and chain ID.
123:     /// @return The canonical token's address.
124:     /// @return The canonical token's chain ID.

129:     function _mintToken(address _account, uint256 _amount) internal override {

133:     function _burnToken(address _from, uint256 _amount) internal override {

152:     function _afterTokenTransfer(

163:     function _mint(

173:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L11-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L44-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L78-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L89-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L100-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L111-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L122-L124), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L173)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

7: /// @title BridgedERC20Base
8: /// @custom:security-contact security@taiko.xyz
9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {

18:     /// @notice Emitted when the migration status is changed.
19:     /// @param addr The address migrating 'to' or 'from'.
20:     /// @param inbound If false then signals migrating 'from', true if migrating 'into'.

23:     /// @notice Emitted when tokens are migrated to or from the bridged token.
24:     /// @param fromToken The address of the bridged token.
25:     /// @param account The address of the account.
26:     /// @param amount The amount of tokens migrated.

29:     error BB_PERMISSION_DENIED();

30:     error BB_INVALID_PARAMS();

31:     error BB_MINT_DISALLOWED();

33:     /// @notice Start or stop migration to/from a specified contract.
34:     /// @param _migratingAddress The address migrating 'to' or 'from'.
35:     /// @param _migratingInbound If false then signals migrating 'from', true if migrating 'into'.

54:     /// @notice Mints tokens to the specified account.
55:     /// @param _account The address of the account to receive the tokens.
56:     /// @param _amount The amount of tokens to mint.

72:     /// @notice Burns tokens from the specified account.
73:     /// @param _account The address of the account to burn the tokens from.
74:     /// @param _amount The amount of tokens to burn.

91:     /// @notice Returns the owner.
92:     /// @return The address of the owner.

97:     function _mintToken(address _account, uint256 _amount) internal virtual;

99:     function _burnToken(address _from, uint256 _amount) internal virtual;

101:     function _isMigratingOut() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L7-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L18-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L23-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L33-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L54-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L72-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L91-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L101-L101)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

09: /// @title BridgedERC721
10: /// @notice Contract for bridging ERC721 tokens across different chains.
11: /// @custom:security-contact security@taiko.xyz
12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {

21:     error BTOKEN_CANNOT_RECEIVE();

22:     error BTOKEN_INVALID_BURN();

24:     /// @notice Initializes the contract.
25:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
26:     /// @param _addressManager The address of the {AddressManager} contract.
27:     /// @param _srcToken Address of the source token.
28:     /// @param _srcChainId Source chain ID.
29:     /// @param _symbol Symbol of the bridged token.
30:     /// @param _name Name of the bridged token.

85:     /// @notice Gets the name of the token.
86:     /// @return The name.

91:     /// @notice Gets the symbol of the bridged token.
92:     /// @return The symbol.

97:     /// @notice Gets the source token and source chain ID being bridged.
98:     /// @return The source token's address.
99:     /// @return The source token's chain ID.

104:     /// @notice Returns the token URI.
105:     /// @param _tokenId The token id.
106:     /// @return The token URI following EIP-681.

115:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L9-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L24-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L85-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L91-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L97-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L104-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L115)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

11: /// @title BridgedERC1155
12: /// @notice Contract for bridging ERC1155 tokens across different chains.
13: /// @custom:security-contact security@taiko.xyz
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {

29:     error BTOKEN_CANNOT_RECEIVE();

31:     /// @notice Initializes the contract.
32:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
33:     /// @param _addressManager The address of the {AddressManager} contract.
34:     /// @param _srcToken Address of the source token.
35:     /// @param _srcChainId Source chain ID.
36:     /// @param _symbol Symbol of the bridged token.
37:     /// @param _name Name of the bridged token.

113:     /// @notice Gets the name of the bridged token.
114:     /// @return The name.

119:     /// @notice Gets the symbol of the bridged token.
120:     /// @return The symbol.

125:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L11-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L31-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L113-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L119-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L125)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

6: /// @title BaseNFTVault
7: /// @notice Abstract contract for bridging NFTs across different chains.
8: /// @custom:security-contact security@taiko.xyz
9: abstract contract BaseNFTVault is BaseVault {

11:     struct CanonicalNFT {

23:     struct BridgeTransferOp {

63:     /// @notice Emitted when a new bridged token is deployed.
64:     /// @param chainId The chain ID of the bridged token.
65:     /// @param ctoken The address of the canonical token.
66:     /// @param btoken The address of the bridged token.
67:     /// @param ctokenSymbol The symbol of the canonical token.
68:     /// @param ctokenName The name of the canonical token.

77:     /// @notice Emitted when a token is sent to another chain.
78:     /// @param msgHash The hash of the message.
79:     /// @param from The sender of the message.
80:     /// @param to The recipient of the message.
81:     /// @param destChainId The destination chain ID.
82:     /// @param ctoken The address of the canonical token.
83:     /// @param token The address of the bridged token.
84:     /// @param tokenIds The IDs of the tokens.
85:     /// @param amounts The amounts of the tokens.

097:     /// @notice Emitted when a token is released on the current chain.
098:     /// @param msgHash The hash of the message.
099:     /// @param from The sender of the message.
100:     /// @param ctoken The address of the canonical token.
101:     /// @param token The address of the bridged token.
102:     /// @param tokenIds The IDs of the tokens.
103:     /// @param amounts The amounts of the tokens.

113:     /// @notice Emitted when a token is received from another chain.
114:     /// @param msgHash The hash of the message.
115:     /// @param from The sender of the message.
116:     /// @param to The recipient of the message.
117:     /// @param srcChainId The source chain ID.
118:     /// @param ctoken The address of the canonical token.
119:     /// @param token The address of the bridged token.
120:     /// @param tokenIds The IDs of the tokens.
121:     /// @param amounts The amounts of the tokens.

133:     error VAULT_INVALID_TOKEN();

134:     error VAULT_INVALID_AMOUNT();

135:     error VAULT_INVALID_TO();

136:     error VAULT_INTERFACE_NOT_SUPPORTED();

137:     error VAULT_TOKEN_ARRAY_MISMATCH();

138:     error VAULT_MAX_TOKEN_PER_TXN_EXCEEDED();

140:     modifier withValidOperation(BridgeTransferOp memory _op) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L6-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L63-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L77-L85), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L97-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L113-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L140-L140)


```solidity

File: /contracts/tokenvault/BaseVault.sol

09: /// @title BaseVault
10: /// @notice This abstract contract provides a base implementation for vaults.
11: /// @custom:security-contact security@taiko.xyz
12: abstract contract BaseVault is

20:     error VAULT_PERMISSION_DENIED();

22:     modifier onlyFromBridge() {

29:     /// @notice Initializes the contract.
30:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
31:     /// @param _addressManager The address of the {AddressManager} contract.

36:     /// @notice Checks if the contract supports the given interface.
37:     /// @param _interfaceId The interface identifier.
38:     /// @return true if the contract supports the interface, false otherwise.

43:     /// @notice Returns the name of the vault.
44:     /// @return The name of the vault.

47:     function checkProcessMessageContext()

58:     function checkRecallMessageContext()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L9-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L29-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L36-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L43-L44), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L58-L58)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

11: /// @title IERC1155NameAndSymbol
12: /// @notice Interface for ERC1155 contracts that provide name() and symbol()
13: /// functions. These functions may not be part of the official interface but are
14: /// used by some contracts.
15: /// @custom:security-contact security@taiko.xyz
16: interface IERC1155NameAndSymbol {

17:     /// @notice Returns the name of the token.

20:     /// @notice Returns the symbol of the token.

34:     /// @notice Transfers ERC1155 tokens to this vault and sends a message to
35:     /// the destination chain so the user can receive the same (bridged) tokens
36:     /// by invoking the message call.
37:     /// @param _op Option for sending the ERC1155 token.
38:     /// @return message_ The constructed message.

92:     /// @inheritdoc IMessageInvocable

126:     /// @inheritdoc IRecallableSender

159:     /// @notice See {ERC1155ReceiverUpgradeable-onERC1155BatchReceived}.

174:     /// @notice See {ERC1155ReceiverUpgradeable-onERC1155Received}.

203:     /// @inheritdoc BaseVault


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L11-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L34-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L92-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L174-L174), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L203-L203)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

56:     /// @notice Emitted when a new bridged token is deployed.
57:     /// @param srcChainId The chain ID of the canonical token.
58:     /// @param ctoken The address of the canonical token.
59:     /// @param btoken The address of the bridged token.
60:     /// @param ctokenSymbol The symbol of the canonical token.
61:     /// @param ctokenName The name of the canonical token.
62:     /// @param ctokenDecimal The decimal of the canonical token.

72:     /// @notice Emitted when a bridged token is changed.
73:     /// @param srcChainId The chain ID of the canonical token.
74:     /// @param ctoken The address of the canonical token.
75:     /// @param btokenOld The address of the old bridged token.
76:     /// @param btokenNew The address of the new bridged token.
77:     /// @param ctokenSymbol The symbol of the canonical token.
78:     /// @param ctokenName The name of the canonical token.
79:     /// @param ctokenDecimal The decimal of the canonical token.

90:     /// @notice Emitted when a token is sent to another chain.
91:     /// @param msgHash The hash of the message.
92:     /// @param from The address of the sender.
93:     /// @param to The address of the recipient.
94:     /// @param destChainId The chain ID of the destination chain.
95:     /// @param ctoken The address of the canonical token.
96:     /// @param token The address of the bridged token.
97:     /// @param amount The amount of tokens sent.

108:     /// @notice Emitted when a token is released from a message.
109:     /// @param msgHash The hash of the message.
110:     /// @param from The address of the sender.
111:     /// @param ctoken The address of the canonical token.
112:     /// @param token The address of the bridged token.
113:     /// @param amount The amount of tokens released.

118:     /// @notice Emitted when a token is received from another chain.
119:     /// @param msgHash The hash of the message.
120:     /// @param from The address of the sender.
121:     /// @param to The address of the recipient.
122:     /// @param srcChainId The chain ID of the source chain.
123:     /// @param ctoken The address of the canonical token.
124:     /// @param token The address of the bridged token.
125:     /// @param amount The amount of tokens received.

136:     error VAULT_BTOKEN_BLACKLISTED();

137:     error VAULT_CTOKEN_MISMATCH();

138:     error VAULT_INVALID_TOKEN();

139:     error VAULT_INVALID_AMOUNT();

140:     error VAULT_INVALID_NEW_BTOKEN();

141:     error VAULT_INVALID_TO();

142:     error VAULT_NOT_SAME_OWNER();

144:     /// @notice Change bridged token.
145:     /// @param _ctoken The canonical token.
146:     /// @param _btokenNew The new bridged token address.
147:     /// @return btokenOld_ The old bridged token address.

202:     /// @notice Transfers ERC20 tokens to this vault and sends a message to the
203:     /// destination chain so the user can receive the same amount of tokens by
204:     /// invoking the message call.
205:     /// @param _op Option for sending ERC20 tokens.
206:     /// @return message_ The constructed message.

252:     /// @inheritdoc IMessageInvocable

284:     /// @inheritdoc IRecallableSender

315:     /// @inheritdoc BaseVault

320:     function _transferTokens(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L56-L62) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L72-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L90-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L108-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L118-L125), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L144-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L202-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L315-L315), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L320-L320)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

21:     /// @notice Transfers ERC721 tokens to this vault and sends a message to the
22:     /// destination chain so the user can receive the same (bridged) tokens
23:     /// by invoking the message call.
24:     /// @param _op Option for sending the ERC721 token.
25:     /// @return message_ The constructed message.

76:     /// @inheritdoc IMessageInvocable

109:     /// @inheritdoc IRecallableSender

141:     /// @inheritdoc IERC721Receiver

155:     /// @inheritdoc BaseVault

160:     function _transferTokens(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L21-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L160-L160)


```solidity

File: /contracts/tokenvault/IBridgedERC20.sol

11:     /// @notice Mints `amount` tokens and assigns them to the `account` address.
12:     /// @param _account The account to receive the minted tokens.
13:     /// @param _amount The amount of tokens to mint.

16:     /// @notice Burns `amount` tokens from the `from` address.
17:     /// @param _from The account from which the tokens will be burned.
18:     /// @param _amount The amount of tokens to burn.

21:     /// @notice Start or stop migration to/from a specified contract.
22:     /// @param _addr The address migrating 'to' or 'from'.
23:     /// @param _inbound If false then signals migrating 'from', true if migrating 'into'.

26:     /// @notice Returns the owner.
27:     /// @return The address of the owner.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L11-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L16-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L21-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L26-L27)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

6: /// @title LibBridgedToken
7: /// @custom:security-contact security@taiko.xyz
8: library LibBridgedToken {

9:     error BTOKEN_INVALID_PARAMS();

11:     function validateInputs(

28:     function buildName(

39:     function buildSymbol(string memory _symbol) internal pure returns (string memory) {

43:     function buildURI(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L43)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5-L5) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

4: /// @title Bytes
5: /// @notice Bytes is a library for manipulating byte arrays.
6: library Bytes {

07:     /// @custom:attribution https://github.com/GNSPS/solidity-bytes-utils
08:     /// @notice Slices a byte array with a given starting index and length. Returns a new byte array
09:     ///         as opposed to a pointer to the original array. Will throw if trying to slice more
10:     ///         bytes than exist in the array.
11:     /// @param _bytes Byte array to slice.
12:     /// @param _start Starting index of the slice.
13:     /// @param _length Length of the slice.
14:     /// @return Slice of the input byte array.

86:     /// @notice Slices a byte array with a given starting index up to the end of the original byte
87:     ///         array. Returns a new array rathern than a pointer to the original.
88:     /// @param _bytes Byte array to slice.
89:     /// @param _start Starting index of the slice.
90:     /// @return Slice of the input byte array.

098:     /// @notice Converts a byte array into a nibble array by splitting each byte into two nibbles.
099:     ///         Resulting nibble array will be exactly twice as long as the input byte array.
100:     /// @param _bytes Input byte array to convert.
101:     /// @return Resulting nibble array.

145:     /// @notice Compares two byte arrays by comparing their keccak256 hashes.
146:     /// @param _bytes First byte array to compare.
147:     /// @param _other Second byte array to compare.
148:     /// @return true if the two byte arrays are equal, false otherwise.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L7-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L86-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L98-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L145-L148)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

4: /// @custom:attribution https://github.com/hamdiallam/Solidity-RLP
5: /// @title RLPReader
6: /// @notice RLPReader is a library for parsing RLP-encoded byte arrays into Solidity types. Adapted
7: ///         from Solidity-RLP (https://github.com/hamdiallam/Solidity-RLP) by Hamdi Allam with
8: ///         various tweaks to improve readability.
9: library RLPReader {

21:     /// @notice Struct representing an RLP item.
22:     /// @custom:field length Length of the RLP item.
23:     /// @custom:field ptr    Pointer to the RLP item in memory.

32:     /// @notice Converts bytes to a reference to memory position and length.
33:     /// @param _in Input bytes to convert.
34:     /// @return out_ Output memory reference.

50:     /// @notice Reads an RLP list value into a list of RLP items.
51:     /// @param _in RLP list value.
52:     /// @return out_ Decoded RLP list items.

099:     /// @notice Reads an RLP list value into a list of RLP items.
100:     /// @param _in RLP list value.
101:     /// @return out_ Decoded RLP list items.

106:     /// @notice Reads an RLP bytes value into bytes.
107:     /// @param _in RLP bytes value.
108:     /// @return out_ Decoded bytes.

125:     /// @notice Reads an RLP bytes value into bytes.
126:     /// @param _in RLP bytes value.
127:     /// @return out_ Decoded bytes.

132:     /// @notice Reads the raw bytes of an RLP item.
133:     /// @param _in RLP item to read.
134:     /// @return out_ Raw RLP bytes.

139:     /// @notice Decodes the length of an RLP item.
140:     /// @param _in RLP item to decode.
141:     /// @return offset_ Offset of the encoded data.
142:     /// @return length_ Length of the encoded data.
143:     /// @return type_ RLP item type (LIST_ITEM or DATA_ITEM).

272:     /// @notice Copies the bytes from a memory location.
273:     /// @param _src    Pointer to the location to read from.
274:     /// @param _offset Offset to start reading from.
275:     /// @param _length Number of bytes to read.
276:     /// @return out_ Copied bytes.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L4-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L21-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L32-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L50-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L99-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L106-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L125-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L132-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L139-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L272-L276)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

4: /// @custom:attribution https://github.com/bakaoh/solidity-rlp-encode
5: /// @title RLPWriter
6: /// @author RLPWriter is a library for encoding Solidity types to RLP bytes. Adapted from Bakaoh's
7: ///         RLPEncode library (https://github.com/bakaoh/solidity-rlp-encode) with minor
8: ///         modifications to improve legibility.
9: library RLPWriter {

10:     /// @notice RLP encodes a byte string.
11:     /// @param _in The byte string to encode.
12:     /// @return out_ The RLP encoded string in bytes.

21:     /// @notice RLP encodes a uint.
22:     /// @param _in The uint256 to encode.
23:     /// @return out_ The RLP encoded uint256 in bytes.

28:     /// @notice Encode the first byte and then the `len` in binary form if `length` is more than 55.
29:     /// @param _len    The length of the string or the payload.
30:     /// @param _offset 128 if item is string, 192 if item is list.
31:     /// @return out_ RLP encoded bytes.

52:     /// @notice Encode integer in big endian binary form with no leading zeroes.
53:     /// @param _x The integer to encode.
54:     /// @return out_ RLP encoded bytes.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L4-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L10-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L21-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L28-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L52-L54)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

07: /// @title MerkleTrie
08: /// @notice MerkleTrie is a small library for verifying standard Ethereum Merkle-Patricia trie
09: ///         inclusion proofs. By default, this library assumes a hexary trie. One can change the
10: ///         trie radix constant to support other trie radixes.
11: library MerkleTrie {

12:     /// @notice Struct representing a node in the trie.
13:     /// @custom:field encoded The RLP-encoded node.
14:     /// @custom:field decoded The RLP-decoded node.

41:     /// @notice Verifies a proof that a given key/value pair is present in the trie.
42:     /// @param _key   Key of the node to search for, as a hex string.
43:     /// @param _value Value of the node to search for, as a hex string.
44:     /// @param _proof Merkle trie inclusion proof for the desired node. Unlike traditional Merkle
45:     ///               trees, this proof is executed top-down and consists of a list of RLP-encoded
46:     ///               nodes that make a path down to the target node.
47:     /// @param _root  Known root of the Merkle trie. Used to verify that the included proof is
48:     ///               correctly constructed.
49:     /// @return valid_ Whether or not the proof is valid.

63:     /// @notice Retrieves the value associated with a given key.
64:     /// @param _key   Key to search for, as hex bytes.
65:     /// @param _proof Merkle trie inclusion proof for the key.
66:     /// @param _root  Known root of the Merkle trie.
67:     /// @return value_ Value of the key if it exists.

201:     /// @notice Parses an array of proof elements into a new array that contains both the original
202:     ///         encoded element and the RLP-decoded element.
203:     /// @param _proof Array of proof elements to parse.
204:     /// @return proof_ Proof parsed into easily accessible structs.

216:     /// @notice Picks out the ID for a node. Node ID is referred to as the "hash" within the
217:     ///         specification, but nodes < 32 bytes are not actually hashed.
218:     /// @param _node Node to pull an ID for.
219:     /// @return id_ ID for the node, depending on the size of its contents.

224:     /// @notice Gets the path for a leaf or extension node.
225:     /// @param _node Node to get a path for.
226:     /// @return nibbles_ Node path, converted to an array of nibbles.

231:     /// @notice Utility; determines the number of nibbles shared between two nibble arrays.
232:     /// @param _a First nibble array.
233:     /// @param _b Second nibble array.
234:     /// @return shared_ Number of shared nibbles.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L7-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L12-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L41-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L63-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L201-L204), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L216-L219), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L224-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L231-L234)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

6: /// @title SecureMerkleTrie
7: /// @notice SecureMerkleTrie is a thin wrapper around the MerkleTrie library that hashes the input
8: ///         keys. Ethereum's state trie hashes input keys before storing them.
9: library SecureMerkleTrie {

10:     /// @notice Verifies a proof that a given key/value pair is present in the Merkle trie.
11:     /// @param _key   Key of the node to search for, as a hex string.
12:     /// @param _value Value of the node to search for, as a hex string.
13:     /// @param _proof Merkle trie inclusion proof for the desired node. Unlike traditional Merkle
14:     ///               trees, this proof is executed top-down and consists of a list of RLP-encoded
15:     ///               nodes that make a path down to the target node.
16:     /// @param _root  Known root of the Merkle trie. Used to verify that the included proof is
17:     ///               correctly constructed.
18:     /// @return valid_ Whether or not the proof is valid.

33:     /// @notice Retrieves the value associated with a given key.
34:     /// @param _key   Key to search for, as hex bytes.
35:     /// @param _proof Merkle trie inclusion proof for the key.
36:     /// @param _root  Known root of the Merkle trie.
37:     /// @return value_ Value of the key if it exists.

51:     /// @notice Computes the hashed version of the input key.
52:     /// @param _key Key to hash.
53:     /// @return hash_ Hashed version of the key.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L6-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L10-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L33-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L51-L53)


```solidity

File: /contracts/verifiers/IVerifier.sol

6: /// @title IVerifier
7: /// @notice Defines the function that handles proof verification.
8: /// @custom:security-contact security@taiko.xyz
9: interface IVerifier {

10:     struct Context {

20:     /// @notice Verifies a proof.
21:     /// @param _ctx The context of the proof verification.
22:     /// @param _tran The transition to verify.
23:     /// @param _proof The proof to verify.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L6-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L20-L23)


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

08: /// @title GuardianVerifier
09: /// @custom:security-contact security@taiko.xyz
10: contract GuardianVerifier is EssentialContract, IVerifier {

13:     error PERMISSION_DENIED();

15:     /// @notice Initializes the contract.
16:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
17:     /// @param _addressManager The address of the {AddressManager} contract.

22:     /// @inheritdoc IVerifier


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L15-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L22-L22)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

59:     /// @notice Emitted when a new SGX instance is added to the registry, or replaced.
60:     /// @param id The ID of the SGX instance.
61:     /// @param instance The address of the SGX instance.
62:     /// @param replaced The address of the SGX instance that was replaced. If it is the first
63:     /// instance, this value is zero address.
64:     /// @param validSince The time since the instance is valid.

69:     /// @notice Emitted when an SGX instance is deleted from the registry.
70:     /// @param id The ID of the SGX instance.
71:     /// @param instance The address of the SGX instance.

74:     error SGX_ALREADY_ATTESTED();

75:     error SGX_INVALID_ATTESTATION();

76:     error SGX_INVALID_INSTANCE();

77:     error SGX_INVALID_PROOF();

78:     error SGX_RA_NOT_SUPPORTED();

80:     /// @notice Initializes the contract.
81:     /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
82:     /// @param _addressManager The address of the {AddressManager} contract.

87:     /// @notice Adds trusted SGX instances to the registry.
88:     /// @param _instances The address array of trusted SGX instances.
89:     /// @return The respective instanceId array per addresses.

98:     /// @notice Deletes SGX instances from the registry.
99:     /// @param _ids The ids array of SGX instances.

115:     /// @notice Adds an SGX instance after the attestation is verified
116:     /// @param _attestation The parsed attestation quote.
117:     /// @return The respective instanceId

138:     /// @inheritdoc IVerifier

165:     /// @notice Gets the signed hash for the proof verification.
166:     /// @param _tran The transition to verify.
167:     /// @param _newInstance The new instance address.
168:     /// @param _prover The prover address.
169:     /// @param _metaHash The meta hash.
170:     /// @return The signed hash.

195:     function _addInstances(

226:     function _replaceInstance(uint256 id, address oldInstance, address newInstance) private {

233:     function _isInstanceValid(uint256 id, address instance) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L59-L64) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L69-L71), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L80-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L87-L89), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L98-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L115-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L165-L170), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L233-L233)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

08: /// @title ERC20Airdrop
09: /// @notice Contract for managing Taiko token airdrop for eligible users.
10: /// @custom:security-contact security@taiko.xyz
11: contract ERC20Airdrop is MerkleClaimable {

20:     /// @notice Initializes the contract.
21:     /// @param _owner The owner of this contract.
22:     /// @param _claimStart The start time of the claim period.
23:     /// @param _claimEnd The end time of the claim period.
24:     /// @param _merkleRoot The merkle root.
25:     /// @param _token The address of the token contract.
26:     /// @param _vault The address of the vault contract.

45:     /// @notice Claims the airdrop for the user and delegates the voting power to the delegatee.
46:     /// @param user The address of the user.
47:     /// @param amount The amount of tokens to claim.
48:     /// @param proof The merkle proof.
49:     /// @param delegationData The data for delegating the voting power.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L8-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L20-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L45-L49)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

08: /// @title ERC20Airdrop2
09: /// @notice Contract for managing Taiko token airdrop for eligible users, but the
10: /// withdrawal is not immediate and is subject to a withdrawal window.
11: /// @custom:security-contact security@taiko.xyz
12: contract ERC20Airdrop2 is MerkleClaimable {

32:     /// @notice Event emitted when a user withdraws their tokens.
33:     /// @param user The address of the user.
34:     /// @param amount The amount of tokens withdrawn.

37:     error WITHDRAWALS_NOT_ONGOING();

39:     modifier ongoingWithdrawals() {

46:     /// @notice Initializes the contract.
47:     /// @param _owner The owner of this contract.
48:     /// @param _claimStart The start time of the claim period.
49:     /// @param _claimEnd The end time of the claim period.
50:     /// @param _merkleRoot The merkle root.
51:     /// @param _token The address of the token contract.
52:     /// @param _vault The address of the vault contract.
53:     /// @param _withdrawalWindow The length of the withdrawal window.

74:     /// @notice Claims the airdrop for the user.
75:     /// @param user The address of the user.
76:     /// @param amount The amount of tokens to claim.
77:     /// @param proof The merkle proof.

86:     /// @notice External withdraw function
87:     /// @param user User address

096:     /// @notice Getter for the balance and withdrawal amount per given user
097:     /// The 2nd airdrop is subject to an unlock period. User has to claim his
098:     /// tokens (within claimStart and claimEnd), but not immediately
099:     /// withdrawable. With a time of X (withdrawalWindow) it becomes fully
100:     /// withdrawable - and unlocks linearly.
101:     /// @param user User address
102:     /// @return balance The balance the user successfully claimed
103:     /// @return withdrawableAmount The amount available to withdraw


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L8-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L32-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L46-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L74-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L86-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L96-L103)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

7: /// @title ERC721Airdrop
8: /// @custom:security-contact security@taiko.xyz
9: contract ERC721Airdrop is MerkleClaimable {

18:     /// @notice Initializes the contract.
19:     /// @param _owner The owner of this contract.
20:     /// @param _claimStart The start time of the claim period.
21:     /// @param _claimEnd The end time of the claim period.
22:     /// @param _merkleRoot The merkle root.
23:     /// @param _token The address of the token contract.
24:     /// @param _vault The address of the vault contract.

43:     /// @notice Claims the airdrop for the user.
44:     /// @param user The address of the user.
45:     /// @param tokenIds The token IDs to claim.
46:     /// @param proof The merkle proof.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L7-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L18-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L43-L46)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

07: /// @title MerkleClaimable
08: /// @notice Contract for managing Taiko token airdrop for eligible users
09: /// @custom:security-contact security@taiko.xyz
10: abstract contract MerkleClaimable is EssentialContract {

25:     /// @notice Event emitted when a claim is made
26:     /// @param hash Hash of the claim

29:     error CLAIM_NOT_ONGOING();

30:     error CLAIMED_ALREADY();

31:     error INVALID_PROOF();

33:     modifier ongoingClaim() {

41:     /// @notice Set config parameters
42:     /// @param _claimStart Unix timestamp for claim start
43:     /// @param _claimEnd Unix timestamp for claim end
44:     /// @param _merkleRoot Merkle root of the tree

56:     function __MerkleClaimable_init(

67:     function _verifyClaim(bytes memory data, bytes32[] calldata proof) internal ongoingClaim {

77:     function _verifyMerkleProof(

90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L25-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L41-L44), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L90)


```solidity

File: /contracts/team/TimelockTokenPool.sol

09: /// @title TimelockTokenPool
10: /// @notice Contract for managing Taiko tokens allocated to different roles and
11: /// individuals.
12: ///
13: /// Manages Taiko tokens through a three-state lifecycle: "allocated" to
14: /// "granted, owned, and locked," and finally to "granted, owned, and unlocked."
15: /// Allocation doesn't transfer ownership unless specified by grant settings.
16: /// Conditional allocated tokens can be canceled by invoking `void()`, making
17: /// them available for other uses. Once granted and owned, tokens are
18: /// irreversible and their unlock schedules are immutable.
19: ///
20: /// We should deploy multiple instances of this contract for different roles:
21: /// - investors
22: /// - team members, advisors, etc.
23: /// - grant program grantees
24: /// @custom:security-contact security@taiko.xyz
25: contract TimelockTokenPool is EssentialContract {

28:     struct Grant {

52:     struct Recipient {

84:     /// @notice Emitted when a grant is made.
85:     /// @param recipient The grant recipient address.
86:     /// @param grant The grant.

89:     /// @notice Emitted when a grant is voided.
90:     /// @param recipient The grant recipient address.
91:     /// @param amount The amount of tokens voided.

94:     /// @notice Emitted when tokens are withdrawn.
95:     /// @param recipient The grant recipient address.
96:     /// @param to The address where the granted and unlocked tokens shall be sent to.
97:     /// @param amount The amount of tokens withdrawn.
98:     /// @param cost The cost.

101:     error ALREADY_GRANTED();

102:     error INVALID_GRANT();

103:     error INVALID_PARAM();

104:     error NOTHING_TO_VOID();

106:     /// @notice Initializes the contract.
107:     /// @param _owner The owner address.
108:     /// @param _taikoToken The Taiko token address.
109:     /// @param _costToken The cost token address.
110:     /// @param _sharedVault The shared vault address.

131:     /// @notice Gives a grant to a address with its own unlock schedule.
132:     /// This transaction should happen on a regular basis, e.g., quarterly.
133:     /// @param _recipient The grant recipient address.
134:     /// @param _grant The grant struct.

146:     /// @notice Puts a stop to all grants for a given recipient. Tokens already
147:     /// granted to the recipient will NOT be voided but are subject to the
148:     /// original unlock schedule.
149:     /// @param _recipient The grant recipient address.

160:     /// @notice Withdraws all withdrawable tokens.

165:     /// @notice Withdraws all withdrawable tokens.
166:     /// @param _to The address where the granted and unlocked tokens shall be sent to.
167:     /// @param _sig Signature provided by the grant recipient.

175:     /// @notice Returns the summary of the grant for a given recipient.

201:     /// @notice Returns the grant for a given recipient.
202:     /// @param _recipient The grant recipient address.
203:     /// @return The grant.

208:     function _withdraw(address _recipient, address _to) private {

225:     function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {

235:     function _getAmountOwned(Grant memory _grant) private view returns (uint128) {

239:     function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {

245:     function _calcAmount(

267:     function _validateGrant(Grant memory _grant) private pure {

273:     function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L9-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L84-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L89-L91), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L94-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L106-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L131-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L146-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L165-L167), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L201-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L267-L267), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L273-L273)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

20: /// @title AutomataDcapV3Attestation
21: /// @custom:security-contact security@taiko.xyz
22: contract AutomataDcapV3Attestation is IAttestation {

54:     constructor(address sigVerifyLibAddr, address pemCertLibAddr) {

60:     modifier onlyOwner() {

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {

73:     function addRevokedCertSerialNum(

88:     function removeRevokedCertSerialNum(

103:     function configureTcbInfoJson(

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)

122:     function toggleLocalReportCheck() external onlyOwner {

126:     function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)

138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {

175:     function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)

206:     function _checkTcbLevels(

229:     function _isCpuSvnHigherOrGreater(

248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)

303:     function _enclaveReportSigVerification(

364:     function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L20-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364-L364)


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

6: /// @title IAttestation
7: /// @custom:security-contact security@taiko.xyz
8: interface IAttestation {

9:     function verifyAttestation(bytes calldata data) external returns (bool);

10:     function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L10-L10)


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

4: /// @title ISigVerifyLib
5: /// @custom:security-contact security@taiko.xyz
6: interface ISigVerifyLib {

12:     struct PublicKey {

24:     struct Certificate {

38:     function verifyAttStmtSignature(

48:     function verifyCertificateSignature(

58:     function verifyRS256Signature(

67:     function verifyRS1Signature(

76:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L76-L76)


```solidity

File: /contracts/automata-attestation/lib/EnclaveIdStruct.sol

4: /// @title EnclaveIdStruct
5: /// @custom:security-contact security@taiko.xyz
6: library EnclaveIdStruct {

7:     struct EnclaveId {

17:     struct TcbLevel {

22:     struct TcbObj {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L22-L22)


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

4: /// @title IPEMCertChainLib
5: /// @custom:security-contact security@taiko.xyz
6: interface IPEMCertChainLib {

7:     struct ECSha256Certificate {

18:     struct PCKCertificateField {

24:     struct PCKTCBInfo {

36:     function splitCertificateChain(

44:     function decodeCert(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L44-L44)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

10: /// @title PEMCertChainLib
11: /// @custom:security-contact security@taiko.xyz
12: contract PEMCertChainLib is IPEMCertChainLib {

34:     struct PCKTCBFlags {

40:     function splitCertificateChain(

74:     function decodeCert(

216:     function _removeHeadersAndFooters(string memory pemData)

252:     function _trimBytes(

269:     function _findPckTcbInfo(

341:     function _findTcb(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L10-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L341-L341)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

09: /// @title V3Parser
10: /// @custom:security-contact security@taiko.xyz
11: library V3Parser {

21:     function parseInput(

62:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)

133:     function parseEnclaveReport(bytes memory rawEnclaveReport)

152:     function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {

165:     function parseAndVerifyHeader(bytes memory rawHeader)

203:     function parseAuthDataAndVerifyCertType(

238:     /// enclaveReport to bytes for hash calculation.
239:     /// the only difference between enclaveReport and packedQEReport is the
240:     /// order of isvProdId and isvSvn. enclaveReport is in little endian, while
241:     /// in bytes should be in big endian according to Intel spec.
242:     /// @param enclaveReport enclave report
243:     /// @return packedQEReport enclave report in bytes

267:     function parseCerificationChainBytes(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L9-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L238-L243), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L267)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

4: /// @title V3Struct
5: /// @custom:security-contact security@taiko.xyz
6: library V3Struct {

7:     struct Header {

17:     struct EnclaveReport {

33:     struct QEAuthData {

38:     struct CertificationData {

47:     struct ECDSAQuoteV3AuthData {

56:     struct ParsedV3QuoteStruct {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L56-L56)


```solidity

File: /contracts/automata-attestation/lib/TCBInfoStruct.sol

4: /// @title TCBInfoStruct
5: /// @custom:security-contact security@taiko.xyz
6: library TCBInfoStruct {

7:     struct TCBInfo {

13:     struct TCBLevelObj {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L13-L13)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

10: /// @title NodePtr
11: /// @custom:security-contact security@taiko.xyz
12: library NodePtr {

36: /// @title Asn1Decode
37: /// @custom:security-contact security@taiko.xyz
38: library Asn1Decode {

14:     function ixs(uint256 self) internal pure returns (uint256) {

19:     function ixf(uint256 self) internal pure returns (uint256) {

24:     function ixl(uint256 self) internal pure returns (uint256) {

29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {

47:     function root(bytes memory der) internal pure returns (uint256) {

56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

66:     function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

87:     function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

187:     function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L10-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L36-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L187-L187)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

6: /// @title BytesUtils
7: /// @custom:security-contact security@taiko.xyz
8: library BytesUtils {

16:     function keccak(

39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

56:     function compare(

116:     function equals(

138:     function equals(

160:     function equals(

178:     function equals(bytes memory self, bytes memory other) internal pure returns (bool) {

188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {

198:     function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {

211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

224:     function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {

237:     function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {

255:     function readBytesN(

272:     function memcpy(uint256 dest, uint256 src, uint256 len) private pure {

284:     function substring(

371:     function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L211-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L371-L371)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

32: /// @title RsaVerify
33: /// @custom:security-contact security@taiko.xyz
34: library RsaVerify {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L32-L34) 


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

08: /// @title SHA1
09: /// @custom:security-contact security@taiko.xyz
10: library SHA1 {

11:     function sha1(bytes memory data) internal pure returns (bytes20 ret) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L11-L11)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

08: /// @title SigVerifyLib
09: /// @custom:security-contact security@taiko.xyz
10: // Library for verifying signatures

20:     constructor(address es256Verifier) {

24:     function verifyAttStmtSignature(

54:     function verifyCertificateSignature(

79:     function verifyRS256Signature(

96:     function verifyRS1Signature(

113:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L113)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

5: /// @title X509DateUtils
6: /// @custom:security-contact security@taiko.xyz
7: library X509DateUtils {

8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {

34:     function toUnixTimestamp(

71:     function isLeapYear(uint16 year) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L5-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L71-L71)


</details>


### [NC&#x2011;84] Add inline comments for unnamed variables 
`function foo(address x, address)` -> `function foo(address x, address /* y */)`


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit parameters 1, need comment
54:     function getMinTier(uint256) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L54-L54) 


</details>


### [NC&#x2011;85] Contract should expose an `interface` 
The `contract`s should expose an `interface` so that other projects can more easily integrate with it, without having to develop their own non-standard variants.


*There are 87 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

30:     function init(address _owner) external initializer {

38:     function setAddress(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L38-L38)


```solidity

File: /contracts/common/EssentialContract.sol

69:     function pause() public virtual whenNotPaused {

78:     function unpause() public virtual whenPaused {

88:     function paused() public view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L88-L88)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

31:     function init(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L31-L31) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

15:     function init(address _owner, uint256 _minDelay) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L15-L15) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

57:     function init(address _owner, address _addressManager) external initializer {

137:     function hashAssignment(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L137-L137)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

25:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L25-L25) 


```solidity

File: /contracts/L1/provers/Guardians.sol

53:     function setGuardians(

101:     function isApproved(bytes32 _hash) public view returns (bool) {

107:     function numGuardians() public view returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L53-L53) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L107-L107)


```solidity

File: /contracts/L1/TaikoL1.sol

42:     function init(

111:     function pauseProving(bool _pause) external {

119:     function depositEtherToL2(address _recipient) external payable nonReentrant whenNotPaused {

132:     function canDepositEthToL2(uint256 _amount) public view returns (bool) {

137:     function isBlobReusable(bytes32 _blobHash) public view returns (bool) {

145:     function getBlock(uint64 _blockId)

162:     function getTransition(

176:     function getStateVariables()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L42-L42) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L119-L119), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L132-L132), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L176-L176)


```solidity

File: /contracts/L1/TaikoToken.sol

25:     function init(

52:     function snapshot() public onlyFromOwnerOrNamed("snapshooter") {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L52-L52)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L2/TaikoL2.sol

71:     function init(

107:     function anchor(

163:     function withdraw(

185:     function getBasefee(

200:     function getBlockHash(uint64 _blockId) public view returns (bytes32) {

219:     function skipFeeCheck() public pure virtual returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L71-L71) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L200-L200), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L219-L219)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

25:     function setConfigAndExcess(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L25-L25) 


```solidity

File: /contracts/signal/SignalService.sol

48:     function init(address _owner, address _addressManager) external initializer {

56:     function authorize(address _addr, bool _authorize) external onlyOwner {

194:     function getSignalSlot(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L194-L194)


```solidity

File: /contracts/bridge/Bridge.sol

75:     function init(address _owner, address _addressManager) external initializer {

82:     function suspendMessages(

101:     function banAddress(

352:     function proveMessageFailed(

374:     function proveMessageReceived(

392:     function isDestChainEnabled(uint64 _chainId)

417:     function getInvocationDelays()

456:     function signalForFailedMessage(bytes32 _msgHash) public pure returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L75-L75) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L82-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L352-L352), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L374-L374), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L392-L392), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L417-L417), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L456-L456)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

38:     function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L38-L38) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

52:     function init(

80:     function setSnapshoter(address _snapshooter) external onlyOwner {

85:     function snapshot() external onlyOwnerOrSnapshooter {

125:     function canonical() public view returns (address, uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L80), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L85-L85), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L125-L125)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

31:     function init(

100:     function source() public view returns (address, uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L31-L31) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L100-L100)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

38:     function init(

83:     function mintBatch(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L83-L83)


```solidity

File: /contracts/tokenvault/BaseVault.sol

32:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

39:     function sendToken(BridgeTransferOp memory _op)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L39-L39) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

148:     function changeBridgedToken(

207:     function sendToken(BridgeTransferOp calldata _op)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L148-L148) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L207-L207)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

26:     function sendToken(BridgeTransferOp memory _op)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L26-L26) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

18:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L18-L18) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

83:     function init(address _owner, address _addressManager) external initializer {

90:     function addInstances(address[] calldata _instances)

100:     function deleteInstances(uint256[] calldata _ids)

118:     function registerInstance(V3Struct.ParsedV3QuoteStruct calldata _attestation)

171:     function getSignedHash(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L83-L83) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L171-L171)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

27:     function init(

50:     function claimAndDelegate(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L50-L50)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

54:     function init(

78:     function claim(address user, uint256 amount, bytes32[] calldata proof) external nonReentrant {

88:     function withdraw(address user) external ongoingWithdrawals {

104:     function getBalance(address user)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L104-L104)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

25:     function init(

47:     function claim(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L47-L47)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

45:     function setConfig(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L45-L45) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

111:     function init(

135:     function grant(address _recipient, Grant memory _grant) external onlyOwner {

150:     function void(address _recipient) external onlyOwner {

161:     function withdraw() external {

168:     function withdraw(address _to, bytes memory _sig) external {

176:     function getMyGrantSummary(address _recipient)

204:     function getMyGrant(address _recipient) public view returns (Grant memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L161-L161), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L204-L204)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {

73:     function addRevokedCertSerialNum(

88:     function removeRevokedCertSerialNum(

103:     function configureTcbInfoJson(

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)

122:     function toggleLocalReportCheck() external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122-L122)


</details>


### [NC&#x2011;86] Named imports of parent contracts are missing 



*There are 69 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

//@audit `EssentialContract`
10: contract AddressManager is EssentialContract, IAddressManager {

//@audit `IAddressManager`
10: contract AddressManager is EssentialContract, IAddressManager {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L10-L10)


```solidity

File: /contracts/common/EssentialContract.sol

//@audit `UUPSUpgradeable`
10: abstract contract EssentialContract is UUPSUpgradeable, Ownable2StepUpgradeable, AddressResolver {

//@audit `Ownable2StepUpgradeable`
10: abstract contract EssentialContract is UUPSUpgradeable, Ownable2StepUpgradeable, AddressResolver {

//@audit `AddressResolver`
10: abstract contract EssentialContract is UUPSUpgradeable, Ownable2StepUpgradeable, AddressResolver {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L10-L10), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L10-L10)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

//@audit `EssentialContract`
17:     EssentialContract,

//@audit `GovernorCompatibilityBravoUpgradeable`
18:     GovernorCompatibilityBravoUpgradeable,

//@audit `GovernorVotesUpgradeable`
19:     GovernorVotesUpgradeable,

//@audit `GovernorVotesQuorumFractionUpgradeable`
20:     GovernorVotesQuorumFractionUpgradeable,

//@audit `GovernorTimelockControlUpgradeable`
21:     GovernorTimelockControlUpgradeable


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L21-L21)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

//@audit `EssentialContract`
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {

//@audit `TimelockControllerUpgradeable`
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L9-L9)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

//@audit `EssentialContract`
14: contract AssignmentHook is EssentialContract, IHook {

//@audit `IHook`
14: contract AssignmentHook is EssentialContract, IHook {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L14-L14)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

//@audit `Guardians`
10: contract GuardianProver is Guardians {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L10-L10) 


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit `EssentialContract`
9: abstract contract Guardians is EssentialContract {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L9-L9) 


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit `EssentialContract`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {

//@audit `ITaikoL1`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {

//@audit `TaikoEvents`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {

//@audit `TaikoErrors`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L22-L22)


```solidity

File: /contracts/L1/TaikoToken.sol

//@audit `EssentialContract`
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {

//@audit `ERC20SnapshotUpgradeable`
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {

//@audit `ERC20VotesUpgradeable`
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L15-L15)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit `EssentialContract`
10: contract DevnetTierProvider is EssentialContract, ITierProvider {

//@audit `ITierProvider`
10: contract DevnetTierProvider is EssentialContract, ITierProvider {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L10-L10)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit `EssentialContract`
10: contract MainnetTierProvider is EssentialContract, ITierProvider {

//@audit `ITierProvider`
10: contract MainnetTierProvider is EssentialContract, ITierProvider {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L10-L10)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit `EssentialContract`
10: contract TestnetTierProvider is EssentialContract, ITierProvider {

//@audit `ITierProvider`
10: contract TestnetTierProvider is EssentialContract, ITierProvider {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L10-L10)


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit `EssentialContract`
14: abstract contract CrossChainOwned is EssentialContract, IMessageInvocable {

//@audit `IMessageInvocable`
14: abstract contract CrossChainOwned is EssentialContract, IMessageInvocable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L14-L14)


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit `CrossChainOwned`
21: contract TaikoL2 is CrossChainOwned {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L21-L21) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

//@audit `TaikoL2`
9: contract TaikoL2EIP1559Configurable is TaikoL2 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L9-L9) 


```solidity

File: /contracts/signal/SignalService.sol

//@audit `EssentialContract`
14: contract SignalService is EssentialContract, ISignalService {

//@audit `ISignalService`
14: contract SignalService is EssentialContract, ISignalService {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L14-L14)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit `EssentialContract`
16: contract Bridge is EssentialContract, IBridge {

//@audit `IBridge`
16: contract Bridge is EssentialContract, IBridge {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L16-L16)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

//@audit `BridgedERC20Base`
28: contract USDCAdapter is BridgedERC20Base {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L28-L28) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit `BridgedERC20Base`
16:     BridgedERC20Base,

//@audit `IERC20MetadataUpgradeable`
17:     IERC20MetadataUpgradeable,

//@audit `ERC20SnapshotUpgradeable`
18:     ERC20SnapshotUpgradeable,

//@audit `ERC20VotesUpgradeable`
19:     ERC20VotesUpgradeable


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L19-L19)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

//@audit `EssentialContract`
9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {

//@audit `IBridgedERC20`
9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L9-L9)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

//@audit `EssentialContract`
12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {

//@audit `ERC721Upgradeable`
12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L12-L12)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit `EssentialContract`
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {

//@audit `IERC1155MetadataURIUpgradeable`
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {

//@audit `ERC1155Upgradeable`
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L14-L14)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

//@audit `BaseVault`
9: abstract contract BaseNFTVault is BaseVault {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L9-L9) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit `EssentialContract`
13:     EssentialContract,

//@audit `IRecallableSender`
14:     IRecallableSender,

//@audit `IMessageInvocable`
15:     IMessageInvocable,

//@audit `IERC165Upgradeable`
16:     IERC165Upgradeable


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L16-L16)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit `BaseNFTVault`
29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {

//@audit `ERC1155ReceiverUpgradeable`
29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L29-L29)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit `BaseVault`
18: contract ERC20Vault is BaseVault {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L18-L18) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit `BaseNFTVault`
16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {

//@audit `IERC721Receiver`
16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L16-L16)


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

//@audit `EssentialContract`
10: contract GuardianVerifier is EssentialContract, IVerifier {

//@audit `IVerifier`
10: contract GuardianVerifier is EssentialContract, IVerifier {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L10-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L10-L10)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit `EssentialContract`
19: contract SgxVerifier is EssentialContract, IVerifier {

//@audit `IVerifier`
19: contract SgxVerifier is EssentialContract, IVerifier {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L19-L19)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

//@audit `MerkleClaimable`
11: contract ERC20Airdrop is MerkleClaimable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L11-L11) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit `MerkleClaimable`
12: contract ERC20Airdrop2 is MerkleClaimable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L12-L12) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

//@audit `MerkleClaimable`
9: contract ERC721Airdrop is MerkleClaimable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L9-L9) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

//@audit `EssentialContract`
10: abstract contract MerkleClaimable is EssentialContract {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L10-L10) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit `EssentialContract`
25: contract TimelockTokenPool is EssentialContract {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L25-L25) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

//@audit `ISigVerifyLib`
15: contract SigVerifyLib is ISigVerifyLib {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L15-L15) 


</details>


### [NC&#x2011;87] [NatSpec] Natspec `@notice` is missing from `contract` 



*There are 509 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

25:     error AM_INVALID_PARAMS();

26:     error AM_UNSUPPORTED();

53:     /// @inheritdoc IAddressManager

58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58)


```solidity

File: /contracts/common/EssentialContract.sol

08: /// @title EssentialContract
09: /// @custom:security-contact security@taiko.xyz
10: abstract contract EssentialContract is UUPSUpgradeable, Ownable2StepUpgradeable, AddressResolver {

35:     error REENTRANT_CALL();

36:     error INVALID_PAUSE_STATUS();

37:     error ZERO_ADDR_MANAGER();

39:     /// @dev Modifier that ensures the caller is the owner or resolved address of a given name.
40:     /// @param _name The name to check against.

46:     modifier nonReentrant() {

53:     modifier whenPaused() {

58:     modifier whenNotPaused() {

63:     /// @custom:oz-upgrades-unsafe-allow constructor

109:     function __Essential_init(address _owner) internal virtual {

114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }

116:     function _authorizePause(address) internal virtual onlyOwner { }

119:     function _storeReentryLock(uint8 _reentry) internal virtual {

130:     function _loadReentryLock() internal view virtual returns (uint8 reentry_) {

140:     function _inNonReentrant() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L39-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L119-L119), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L140-L140)


```solidity

File: /contracts/libs/Lib4844.sol

19:     error EVAL_FAILED_1();

20:     error EVAL_FAILED_2();

21:     error POINT_X_TOO_LARGE();

22:     error POINT_Y_TOO_LARGE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L22-L22)


```solidity

File: /contracts/libs/LibAddress.sol

10: /// @title LibAddress
11: /// @dev Provides utilities for address-related operations.
12: /// @custom:security-contact security@taiko.xyz
13: library LibAddress {

16:     error ETH_TRANSFER_FAILED();

18:     /// @dev Sends Ether to the specified address.
19:     /// @param _to The recipient address.
20:     /// @param _amount The amount of Ether to send in wei.
21:     /// @param _gasLimit The max amount gas to pay for this transaction.

39:     /// @dev Sends Ether to the specified address.
40:     /// @param _to The recipient address.
41:     /// @param _amount The amount of Ether to send in wei.

46:     function supportsInterface(

61:     function isValidSignature(

77:     function isSenderEOA() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L10-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L18-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L39-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L77-L77)


```solidity

File: /contracts/libs/LibMath.sol

4: /// @title LibMath
5: /// @dev This library offers additional math functions for uint256.
6: /// @custom:security-contact security@taiko.xyz
7: library LibMath {

08:     /// @dev Returns the smaller of the two given values.
09:     /// @param _a The first number to compare.
10:     /// @param _b The second number to compare.
11:     /// @return The smaller of the two numbers.

16:     /// @dev Returns the larger of the two given values.
17:     /// @param _a The first number to compare.
18:     /// @param _b The second number to compare.
19:     /// @return The larger of the two numbers.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L4-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L8-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L16-L19)


```solidity

File: /contracts/libs/LibTrieProof.sol

13: /// @title LibTrieProof
14: /// @custom:security-contact security@taiko.xyz
15: library LibTrieProof {

20:     error LTP_INVALID_ACCOUNT_PROOF();

21:     error LTP_INVALID_INCLUSION_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L13-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L21-L21)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

14: /// @title TaikoGovernor
15: /// @custom:security-contact security@taiko.xyz
16: contract TaikoGovernor is

25:     error TG_INVALID_SIGNATURES_LENGTH();

47:     /// @dev See {IGovernor-propose}

88:     /// @dev See {GovernorUpgradeable-supportsInterface}

98:     /// @dev See {GovernorUpgradeable-state}

127:     function _execute(

140:     function _cancel(

153:     function _executor()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L14-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L153-L153)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

7: /// @title TaikoTimelockController
8: /// @custom:security-contact security@taiko.xyz
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {

21:     /// @dev Gets the minimum delay for an operation to become valid, allows the admin to get around
22:     /// of the min delay.
23:     /// @return The minimum delay.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L7-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L21-L23)


```solidity

File: /contracts/L1/hooks/IHook.sol

6: /// @title IHook
7: /// @custom:security-contact security@taiko.xyz
8: interface IHook {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L6-L8) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

18:     struct ProverAssignment {

29:     struct Input {

50:     error HOOK_ASSIGNMENT_EXPIRED();

51:     error HOOK_ASSIGNMENT_INVALID_SIG();

52:     error HOOK_TIER_NOT_FOUND();

61:     /// @inheritdoc IHook

164:     function _getProverFee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L164-L164)


```solidity

File: /contracts/L1/ITaikoL1.sol

6: /// @title ITaikoL1
7: /// @custom:security-contact security@taiko.xyz
8: interface ITaikoL1 {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L6-L8) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

21:     /// @dev Any errors defined here must also be defined in TaikoErrors.sol.

24:     /// @dev Deposits Ether to Layer 2.
25:     /// @param _state Current TaikoData.State.
26:     /// @param _config Actual TaikoData.Config.
27:     /// @param _resolver Address resolver interface.
28:     /// @param _recipient The recipient address.

66:     /// @dev Processes the ETH deposits in a batched manner.

121:     /// @dev Checks if Ether deposit is allowed for Layer 2.

145:     /// @dev Encodes the given deposit into a uint256.
146:     /// @param _addr The address of the deposit recipient.
147:     /// @param _amount The amount of the deposit.
148:     /// @return The encoded deposit.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L24-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L145-L148)


```solidity

File: /contracts/L1/libs/LibProposing.sol

44:     error L1_BLOB_FOR_DA_DISABLED();

45:     error L1_BLOB_NOT_FOUND();

46:     error L1_BLOB_NOT_REUSABLE();

47:     error L1_BLOB_REUSE_DISABLED();

48:     error L1_INVALID_HOOK();

49:     error L1_INVALID_PARAM();

50:     error L1_INVALID_PROVER();

51:     error L1_LIVENESS_BOND_NOT_RECEIVED();

52:     error L1_PROPOSER_NOT_EOA();

53:     error L1_TOO_MANY_BLOCKS();

54:     error L1_TXLIST_OFFSET();

55:     error L1_TXLIST_SIZE();

56:     error L1_UNAUTHORIZED();

57:     error L1_UNEXPECTED_PARENT();

59:     /// @dev Proposes a Taiko L2 block.
60:     /// @param _state Current TaikoData.State.
61:     /// @param _config Actual TaikoData.Config.
62:     /// @param _resolver Address resolver interface.
63:     /// @param _data Encoded data bytes containing the block params.
64:     /// @param _txList Transaction list bytes (if not blob).
65:     /// @return meta_ The constructed block's metadata.
66:     /// @return deposits_ The EthDeposit array about processed deposits in this proposed
67:     /// block.

299:     function _isProposerPermitted(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L59-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L299-L299)


```solidity

File: /contracts/L1/libs/LibProving.sol

59:     error L1_ALREADY_CONTESTED();

60:     error L1_ALREADY_PROVED();

61:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

62:     error L1_BLOCK_MISMATCH();

63:     error L1_INVALID_BLOCK_ID();

64:     error L1_INVALID_PAUSE_STATUS();

65:     error L1_INVALID_TIER();

66:     error L1_INVALID_TRANSITION();

67:     error L1_MISSING_VERIFIER();

68:     error L1_NOT_ASSIGNED_PROVER();

83:     /// @dev Proves or contests a block transition.
84:     /// @param _state Current TaikoData.State.
85:     /// @param _config Actual TaikoData.Config.
86:     /// @param _resolver Address resolver interface.
87:     /// @param _meta The block's metadata.
88:     /// @param _tran The transition data.
89:     /// @param _proof The proof.
90:     /// @param maxBlocksToVerify_ The number of blocks to be verified with this transaction.

268:     /// @dev Handle the transition initialization logic

349:     /// @dev Handles what happens when there is a higher proof incoming

400:     /// @dev Check the msg.sender (the new prover) against the block's assigned prover.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L83-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L268-L268), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L349-L349), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L400-L400)


```solidity

File: /contracts/L1/libs/LibUtils.sol

11:     error L1_BLOCK_MISMATCH();

12:     error L1_INVALID_BLOCK_ID();

13:     error L1_TRANSITION_NOT_FOUND();

14:     error L1_UNEXPECTED_TRANSITION_ID();

48:     /// @dev Retrieves a block based on its ID.
49:     /// @param _state Current TaikoData.State.
50:     /// @param _config Actual TaikoData.Config.
51:     /// @param _blockId Id of the block.

68:     /// @dev Retrieves the ID of the transition with a given parentHash.
69:     /// This function will return 0 if the transition is not found.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L48-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L68-L69)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

39:     error L1_BLOCK_MISMATCH();

40:     error L1_INVALID_CONFIG();

41:     error L1_TRANSITION_ID_ZERO();

84:     /// @dev Verifies up to N blocks.

224:     function _syncChainData(

245:     function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L84-L84), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L245-L245)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

08: /// @title GuardianProver
09: /// @custom:security-contact security@taiko.xyz
10: contract GuardianProver is Guardians {

29:     /// @dev Called by guardians to approve a guardian proof
30:     /// @param _meta The block's metadata.
31:     /// @param _tran The valid transition.
32:     /// @param _proof The tier proof.
33:     /// @return approved_ If the minimum number of participants sent the same proof, and proving
34:     /// transaction is fired away returns true, false otherwise.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L29-L34)


```solidity

File: /contracts/L1/provers/Guardians.sol

45:     error INVALID_GUARDIAN();

46:     error INVALID_GUARDIAN_SET();

47:     error INVALID_MIN_GUARDIANS();

48:     error INVALID_PROOF();

111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {

124:     function deleteApproval(bytes32 _hash) internal {

128:     function isApproved(uint256 _approvalBits) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L128-L128)


```solidity

File: /contracts/L1/TaikoData.sol

9:     /// @dev Struct holding Taiko configuration parameters. See {TaikoConfig}.

62:     /// @dev Struct representing prover assignment

68:     struct TierProof {

73:     struct HookCall {

78:     struct BlockParams {

90:     /// @dev Struct containing data only required for proving a block
91:     /// Note: On L2, `block.difficulty` is the pseudo name of
92:     /// `block.prevrandao`, which returns a random number provided by the layer
93:     /// 1 chain.

112:     /// @dev Struct representing transition to be proven.

120:     /// @dev Struct representing state transition data.
121:     /// 10 slots reserved for upgradability, 6 slots used.

135:     /// @dev Struct containing data required for verifying a block.
136:     /// 10 slots reserved for upgradability, 3 slots used.

148:     /// @dev Struct representing an Ethereum deposit.
149:     /// 1 slot used.

156:     /// @dev Forge is only able to run coverage in case the contracts by default
157:     /// capable of compiling without any optimization (neither optimizer runs,
158:     /// no compiling --via-ir flag).
159:     /// In order to resolve stack too deep without optimizations, we needed to
160:     /// introduce outsourcing vars into structs below.

168:     struct SlotB {

178:     /// @dev Struct holding the state variables for the {TaikoL1} contract.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L90-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L120-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L135-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L148-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L156-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L178-L178)


```solidity

File: /contracts/L1/TaikoErrors.sol

12:     error L1_ALREADY_CONTESTED();

13:     error L1_ALREADY_PROVED();

14:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

15:     error L1_BLOB_FOR_DA_DISABLED();

16:     error L1_BLOB_NOT_FOUND();

17:     error L1_BLOB_NOT_REUSABLE();

18:     error L1_BLOB_REUSE_DISABLED();

19:     error L1_BLOCK_MISMATCH();

20:     error L1_INVALID_BLOCK_ID();

21:     error L1_INVALID_CONFIG();

22:     error L1_INVALID_ETH_DEPOSIT();

23:     error L1_INVALID_HOOK();

24:     error L1_INVALID_PARAM();

25:     error L1_INVALID_PAUSE_STATUS();

26:     error L1_INVALID_PROVER();

27:     error L1_INVALID_TIER();

28:     error L1_INVALID_TRANSITION();

29:     error L1_LIVENESS_BOND_NOT_RECEIVED();

30:     error L1_NOT_ASSIGNED_PROVER();

31:     error L1_PROPOSER_NOT_EOA();

32:     error L1_PROVING_PAUSED();

33:     error L1_RECEIVE_DISABLED();

34:     error L1_MISSING_VERIFIER();

35:     error L1_TOO_MANY_BLOCKS();

36:     error L1_TOO_MANY_TIERS();

37:     error L1_TRANSITION_ID_ZERO();

38:     error L1_TRANSITION_NOT_FOUND();

39:     error L1_TXLIST_SIZE();

40:     error L1_UNAUTHORIZED();

41:     error L1_UNEXPECTED_PARENT();

42:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L42-L42)


```solidity

File: /contracts/L1/TaikoEvents.sol

14:     /// @dev Emitted when a block is proposed.
15:     /// @param blockId The ID of the proposed block.
16:     /// @param assignedProver The block's assigned prover.
17:     /// @param livenessBond The bond in Taiko token from the assigned prover.
18:     /// @param meta The block metadata containing information about the proposed
19:     /// block.
20:     /// @param depositsProcessed Ether deposits processed.

28:     /// @dev Emitted when a block is verified.
29:     /// @param blockId The ID of the verified block.
30:     /// @param assignedProver The block's assigned prover.
31:     /// @param prover The prover whose transition is used for verifying the
32:     /// block.
33:     /// @param blockHash The hash of the verified block.
34:     /// @param stateRoot The block's state root.
35:     /// @param tier The tier ID of the proof.
36:     /// @param contestations Number of total contestations.

47:     /// @dev Emitted when a block transition is proved or re-proved.
48:     /// @param blockId The ID of the proven block.
49:     /// @param tran The verified transition.
50:     /// @param prover The prover address.
51:     /// @param validityBond The validity bond amount.
52:     /// @param tier The tier ID of the proof.

61:     /// @dev Emitted when a block transition is contested.
62:     /// @param blockId The ID of the proven block.
63:     /// @param tran The verified transition.
64:     /// @param contester The contester address.
65:     /// @param contestBond The contesting bond amount.
66:     /// @param tier The tier ID of the proof.

75:     /// @dev Emitted when a blob is cached for reuse.
76:     /// @param blobHash The blobHash cached.

79:     /// @dev Emitted when proving has been paused
80:     /// @param paused True if paused, false if unpaused.

83:     /// @dev Emitted when an Ethereum deposit is made.
84:     /// @param deposit The Ethereum deposit information including recipient,
85:     /// amount, and ID.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L14-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L28-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L47-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L61-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L75-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L79-L80), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoEvents.sol#L83-L85)


```solidity

File: /contracts/L1/TaikoL1.sol

28:     modifier whenProvingNotPaused() {

33:     /// @dev Fallback function to receive Ether from Hooks

54:     /// @inheritdoc ITaikoL1

74:     /// @inheritdoc ITaikoL1

99:     /// @inheritdoc ITaikoL1

123:     /// @inheritdoc EssentialContract

185:     /// @inheritdoc ITaikoL1

220:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L185-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L220)


```solidity

File: /contracts/L1/TaikoToken.sol

18:     error TKO_INVALID_ADDR();

83:     function _beforeTokenTransfer(

94:     function _afterTokenTransfer(

105:     function _mint(

115:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L115-L115)


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

36: /// @dev Tier ID cannot be zero!
37: library LibTiers {

8:     struct Tier {

17:     error TIER_NOT_FOUND();

19:     /// @dev Retrieves the configuration for a specified tier.
20:     /// @param tierId ID of the tier.
21:     /// @return Tier struct containing the tier's parameters.

24:     /// @dev Retrieves the IDs of all supported tiers.
25:     /// Note that the core protocol requires the number of tiers to be smaller
26:     /// than 256. In reality, this number should be much smaller.
27:     /// @return The ids of the tiers.

30:     /// @dev Determines the minimal tier for a block based on a random input.
31:     /// @param rand (Semi) random number.
32:     /// @return The tier id.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L36-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L19-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L24-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L30-L32)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

07: /// @title DevnetTierProvider
08: /// @dev Labeled in AddressResolver as "tier_provider"
09: /// @custom:security-contact security@taiko.xyz
10: contract DevnetTierProvider is EssentialContract, ITierProvider {

19:     /// @inheritdoc ITierProvider

46:     /// @inheritdoc ITierProvider

53:     /// @inheritdoc ITierProvider


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L53-L53)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

07: /// @title MainnetTierProvider
08: /// @dev Labeled in AddressResolver as "tier_provider"
09: /// @custom:security-contact security@taiko.xyz
10: contract MainnetTierProvider is EssentialContract, ITierProvider {

19:     /// @inheritdoc ITierProvider

57:     /// @inheritdoc ITierProvider

65:     /// @inheritdoc ITierProvider


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L65-L65)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

07: /// @title TestnetTierProvider
08: /// @dev Labeled in AddressResolver as "tier_provider"
09: /// @custom:security-contact security@taiko.xyz
10: contract TestnetTierProvider is EssentialContract, ITierProvider {

19:     /// @inheritdoc ITierProvider

57:     /// @inheritdoc ITierProvider

65:     /// @inheritdoc ITierProvider


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L7-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L65-L65)


```solidity

File: /contracts/L2/CrossChainOwned.sol

28:     error XCO_INVALID_OWNER_CHAINID();

29:     error XCO_INVALID_TX_ID();

30:     error XCO_PERMISSION_DENIED();

31:     error XCO_TX_REVERTED();

33:     /// @inheritdoc IMessageInvocable
34:     /// @dev Do not guard with nonReentrant as this function will re-enter the contract as _data
35:     /// represents calls to address(this).


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L33-L35)


```solidity

File: /contracts/L2/Lib1559Math.sol

11:     error EIP1559_INVALID_PARAMS();

13:     /// @dev eth_qty(excess_gas_issued) / (TARGET * ADJUSTMENT_QUOTIENT)
14:     /// @param _gasExcess TBD
15:     /// @param _adjustmentFactor The product of gasTarget and adjustmentQuotient

32:     /// @dev exp(gas_qty / TARGET / ADJUSTMENT_QUOTIENT)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L13-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L32-L32)


```solidity

File: /contracts/L2/TaikoL2.sol

26:     struct Config {

59:     error L2_BASEFEE_MISMATCH();

60:     error L2_INVALID_CHAIN_ID();

61:     error L2_INVALID_PARAM();

62:     error L2_INVALID_SENDER();

63:     error L2_PUBLIC_INPUT_HASH_MISMATCH();

64:     error L2_TOO_LATE();

223:     function _calcPublicInputHash(uint256 _blockId)

252:     function _calc1559BaseFee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L252-L252)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

20:     error L2_INVALID_CONFIG();

42:     /// @inheritdoc TaikoL2


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L42-L42)


```solidity

File: /contracts/signal/ISignalService.sol

20:     struct HopProof {

20:     struct HopProof {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L20)


```solidity

File: /contracts/signal/LibSignals.sol

4: /// @title LibSignals
5: /// @custom:security-contact security@taiko.xyz
6: library LibSignals {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/LibSignals.sol#L4-L6) 


```solidity

File: /contracts/signal/SignalService.sol

25:     error SS_EMPTY_PROOF();

26:     error SS_INVALID_SENDER();

27:     error SS_INVALID_LAST_HOP_CHAINID();

28:     error SS_INVALID_MID_HOP_CHAINID();

29:     error SS_INVALID_STATE();

30:     error SS_INVALID_VALUE();

31:     error SS_SIGNAL_NOT_FOUND();

32:     error SS_UNAUTHORIZED();

33:     error SS_UNSUPPORTED();

35:     modifier validSender(address _app) {

40:     modifier nonZeroValue(bytes32 _input) {

52:     /// @dev Authorize or deauthorize an address for calling syncChainData.
53:     /// @dev Note that addr is supposed to be TaikoL1 and TaikoL1 contracts deployed locally.
54:     /// @param _addr The address to be authorized or deauthorized.
55:     /// @param _authorize True if authorize, false otherwise.

62:     /// @inheritdoc ISignalService

67:     /// @inheritdoc ISignalService

81:     /// @inheritdoc ISignalService
82:     /// @dev This function may revert.

136:     /// @inheritdoc ISignalService

152:     /// @inheritdoc ISignalService

157:     /// @inheritdoc ISignalService

176:     /// @inheritdoc ISignalService

206:     function _verifyHopProof(

231:     function _authorizePause(address) internal pure override {

235:     function _syncChainData(

253:     function _sendSignal(

271:     function _cacheChainData(

298:     function _loadSignalValue(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L52-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L81-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L157-L157), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L298-L298)


```solidity

File: /contracts/bridge/IBridge.sol

17:     struct Message {

49:     struct ProofReceipt {

60:     struct Context {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L60-L60)


```solidity

File: /contracts/bridge/Bridge.sol

50:     error B_INVALID_CHAINID();

51:     error B_INVALID_CONTEXT();

52:     error B_INVALID_GAS_LIMIT();

53:     error B_INVALID_STATUS();

54:     error B_INVALID_USER();

55:     error B_INVALID_VALUE();

56:     error B_MESSAGE_NOT_SENT();

57:     error B_NON_RETRIABLE();

58:     error B_NOT_FAILED();

59:     error B_NOT_RECEIVED();

60:     error B_PERMISSION_DENIED();

61:     error B_STATUS_MISMATCH();

62:     error B_INVOCATION_TOO_EARLY();

64:     modifier sameChain(uint64 _chainId) {

114:     /// @inheritdoc IBridge

154:     /// @inheritdoc IBridge

216:     /// @inheritdoc IBridge

309:     /// @inheritdoc IBridge

339:     /// @inheritdoc IBridge

448:     /// @inheritdoc IBridge


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L309-L309), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L339-L339), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L448-L448)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

6: /// @title IUSDC
7: /// @custom:security-contact security@taiko.xyz
8: interface IUSDC {

26: /// @title USDCAdapter
27: /// @custom:security-contact security@taiko.xyz
28: contract USDCAdapter is BridgedERC20Base {

43:     function _mintToken(address _account, uint256 _amount) internal override {

47:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L26-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

34:     error BTOKEN_CANNOT_RECEIVE();

35:     error BTOKEN_UNAUTHORIZED();

37:     modifier onlyOwnerOrSnapshooter() {

129:     function _mintToken(address _account, uint256 _amount) internal override {

133:     function _burnToken(address _from, uint256 _amount) internal override {

137:     /// @dev For ERC20SnapshotUpgradeable and ERC20VotesUpgradeable, need to implement the following
138:     /// functions

152:     function _afterTokenTransfer(

163:     function _mint(

173:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L137-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L173)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

7: /// @title BridgedERC20Base
8: /// @custom:security-contact security@taiko.xyz
9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {

29:     error BB_PERMISSION_DENIED();

30:     error BB_INVALID_PARAMS();

31:     error BB_MINT_DISALLOWED();

97:     function _mintToken(address _account, uint256 _amount) internal virtual;

99:     function _burnToken(address _from, uint256 _amount) internal virtual;

101:     function _isMigratingOut() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L7-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L99-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L101-L101)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

21:     error BTOKEN_CANNOT_RECEIVE();

22:     error BTOKEN_INVALID_BURN();

51:     /// @dev Mints tokens.
52:     /// @param _account Address to receive the minted token.
53:     /// @param _tokenId ID of the token to mint.

66:     /// @dev Burns tokens.
67:     /// @param _account Address from which the token is burned.
68:     /// @param _tokenId ID of the token to burn.

115:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L51-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L66-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L115)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

29:     error BTOKEN_CANNOT_RECEIVE();

62:     /// @dev Mints tokens.
63:     /// @param _to Address to receive the minted tokens.
64:     /// @param _tokenId ID of the token to mint.
65:     /// @param _amount Amount of tokens to mint.

79:     /// @dev Mints tokens.
80:     /// @param _to Address to receive the minted tokens.
81:     /// @param _tokenIds ID of the token to mint.
82:     /// @param _amounts Amount of tokens to mint.

96:     /// @dev Burns tokens.
97:     /// @param _account Address from which tokens are burned.
98:     /// @param _tokenId ID of the token to burn.
99:     /// @param _amount Amount of tokens to burn.

125:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L62-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L79-L82), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L96-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L125)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

11:     struct CanonicalNFT {

23:     struct BridgeTransferOp {

133:     error VAULT_INVALID_TOKEN();

134:     error VAULT_INVALID_AMOUNT();

135:     error VAULT_INVALID_TO();

136:     error VAULT_INTERFACE_NOT_SUPPORTED();

137:     error VAULT_TOKEN_ARRAY_MISMATCH();

138:     error VAULT_MAX_TOKEN_PER_TXN_EXCEEDED();

140:     modifier withValidOperation(BridgeTransferOp memory _op) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L140-L140)


```solidity

File: /contracts/tokenvault/BaseVault.sol

20:     error VAULT_PERMISSION_DENIED();

22:     modifier onlyFromBridge() {

47:     function checkProcessMessageContext()

58:     function checkRecallMessageContext()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L58-L58)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

92:     /// @inheritdoc IMessageInvocable

126:     /// @inheritdoc IRecallableSender

189:     /// @dev See {BaseVault-supportsInterface}.
190:     /// @param interfaceId The interface identifier.
191:     /// @return true if supports, else otherwise.

203:     /// @inheritdoc BaseVault

208:     /// @dev Transfers ERC1155 tokens to the `to` address.
209:     /// @param ctoken CanonicalNFT data.
210:     /// @param to The address to transfer the tokens to.
211:     /// @param tokenIds The token IDs to transfer.
212:     /// @param amounts The amounts to transfer.
213:     /// @return token The address of the token.

234:     /// @dev Handles the message on the source chain and returns the encoded
235:     /// call on the destination call.
236:     /// @param _user The user's address.
237:     /// @param _op BridgeTransferOp data.
238:     /// @return msgData_ Encoded message data.
239:     /// @return ctoken_ The canonical token.

285:     /// @dev Retrieve or deploy a bridged ERC1155 token contract.
286:     /// @param _ctoken CanonicalNFT data.
287:     /// @return btoken_ Address of the bridged token contract.

298:     /// @dev Deploy a new BridgedNFT contract and initialize it.
299:     /// This must be called before the first time a bridged token is sent to
300:     /// this chain.
301:     /// @param _ctoken CanonicalNFT data.
302:     /// @return btoken_ Address of the deployed bridged token contract.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L92-L92) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L189-L191), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L208-L213), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L234-L239), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L285-L287), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L298-L302)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

22:     /// @dev Represents a canonical ERC20 token.

31:     /// @dev Represents an operation to send tokens to another chain.

136:     error VAULT_BTOKEN_BLACKLISTED();

137:     error VAULT_CTOKEN_MISMATCH();

138:     error VAULT_INVALID_TOKEN();

139:     error VAULT_INVALID_AMOUNT();

140:     error VAULT_INVALID_NEW_BTOKEN();

141:     error VAULT_INVALID_TO();

142:     error VAULT_NOT_SAME_OWNER();

252:     /// @inheritdoc IMessageInvocable

284:     /// @inheritdoc IRecallableSender

315:     /// @inheritdoc BaseVault

320:     function _transferTokens(

337:     /// @dev Handles the message on the source chain and returns the encoded
338:     /// call on the destination call.
339:     /// @param _user The user's address.
340:     /// @param _token The token address.
341:     /// @param _to To address.
342:     /// @param _amount Amount to be sent.
343:     /// @return msgData_ Encoded message data.
344:     /// @return ctoken_ The canonical token.
345:     /// @return balanceChange_ User token balance actual change after the token
346:     /// transfer. This value is calculated so we do not assume token balance
347:     /// change is the amount of token transferred away.

388:     /// @dev Retrieve or deploy a bridged ERC20 token contract.
389:     /// @param ctoken CanonicalERC20 data.
390:     /// @return btoken Address of the bridged token contract.

402:     /// @dev Deploy a new BridgedERC20 contract and initialize it.
403:     /// This must be called before the first time a bridged token is sent to
404:     /// this chain.
405:     /// @param ctoken CanonicalERC20 data.
406:     /// @return btoken Address of the deployed bridged token contract.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L315-L315), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L320-L320), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L337-L347), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L388-L390), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L402-L406)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

76:     /// @inheritdoc IMessageInvocable

109:     /// @inheritdoc IRecallableSender

141:     /// @inheritdoc IERC721Receiver

155:     /// @inheritdoc BaseVault

160:     function _transferTokens(

181:     /// @dev Handles the message on the source chain and returns the encoded
182:     /// call on the destination call.
183:     /// @param _user The user's address.
184:     /// @param _op BridgeTransferOp data.
185:     /// @return msgData_ Encoded message data.
186:     /// @return ctoken_ The canonical token.

221:     /// @dev Retrieve or deploy a bridged ERC721 token contract.
222:     /// @param _ctoken CanonicalNFT data.
223:     /// @return btoken_ Address of the bridged token contract.

235:     /// @dev Deploy a new BridgedNFT contract and initialize it.
236:     /// This must be called before the first time a bridged token is sent to
237:     /// this chain.
238:     /// @param _ctoken CanonicalNFT data.
239:     /// @return btoken_ Address of the deployed bridged token contract.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L181-L186), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L221-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L235-L239)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

6: /// @title LibBridgedToken
7: /// @custom:security-contact security@taiko.xyz
8: library LibBridgedToken {

9:     error BTOKEN_INVALID_PARAMS();

11:     function validateInputs(

28:     function buildName(

39:     function buildSymbol(string memory _symbol) internal pure returns (string memory) {

43:     function buildURI(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L43)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5-L5) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

4: /// @custom:attribution https://github.com/bakaoh/solidity-rlp-encode
5: /// @title RLPWriter
6: /// @author RLPWriter is a library for encoding Solidity types to RLP bytes. Adapted from Bakaoh's
7: ///         RLPEncode library (https://github.com/bakaoh/solidity-rlp-encode) with minor
8: ///         modifications to improve legibility.
9: library RLPWriter {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L4-L9) 


```solidity

File: /contracts/verifiers/IVerifier.sol

10:     struct Context {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L10-L10) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

08: /// @title GuardianVerifier
09: /// @custom:security-contact security@taiko.xyz
10: contract GuardianVerifier is EssentialContract, IVerifier {

13:     error PERMISSION_DENIED();

22:     /// @inheritdoc IVerifier


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L22-L22)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

20:     /// @dev Each public-private key pair (Ethereum address) is generated within
21:     /// the SGX program when it boots up. The off-chain remote attestation
22:     /// ensures the validity of the program hash and has the capability of
23:     /// bootstrapping the network with trustworthy instances.

74:     error SGX_ALREADY_ATTESTED();

75:     error SGX_INVALID_ATTESTATION();

76:     error SGX_INVALID_INSTANCE();

77:     error SGX_INVALID_PROOF();

78:     error SGX_RA_NOT_SUPPORTED();

138:     /// @inheritdoc IVerifier

195:     function _addInstances(

226:     function _replaceInstance(uint256 id, address oldInstance, address newInstance) private {

233:     function _isInstanceValid(uint256 id, address instance) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L20-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L195-L195), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L233-L233)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

37:     error WITHDRAWALS_NOT_ONGOING();

39:     modifier ongoingWithdrawals() {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L39-L39)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

7: /// @title ERC721Airdrop
8: /// @custom:security-contact security@taiko.xyz
9: contract ERC721Airdrop is MerkleClaimable {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L7-L9) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

29:     error CLAIM_NOT_ONGOING();

30:     error CLAIMED_ALREADY();

31:     error INVALID_PROOF();

33:     modifier ongoingClaim() {

56:     function __MerkleClaimable_init(

67:     function _verifyClaim(bytes memory data, bytes32[] calldata proof) internal ongoingClaim {

77:     function _verifyMerkleProof(

90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L90)


```solidity

File: /contracts/team/TimelockTokenPool.sol

28:     struct Grant {

52:     struct Recipient {

101:     error ALREADY_GRANTED();

102:     error INVALID_GRANT();

103:     error INVALID_PARAM();

104:     error NOTHING_TO_VOID();

208:     function _withdraw(address _recipient, address _to) private {

225:     function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {

235:     function _getAmountOwned(Grant memory _grant) private view returns (uint128) {

239:     function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {

245:     function _calcAmount(

267:     function _validateGrant(Grant memory _grant) private pure {

273:     function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L104-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L267-L267), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L273-L273)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

20: /// @title AutomataDcapV3Attestation
21: /// @custom:security-contact security@taiko.xyz
22: contract AutomataDcapV3Attestation is IAttestation {

54:     constructor(address sigVerifyLibAddr, address pemCertLibAddr) {

60:     modifier onlyOwner() {

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {

73:     function addRevokedCertSerialNum(

88:     function removeRevokedCertSerialNum(

103:     function configureTcbInfoJson(

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)

122:     function toggleLocalReportCheck() external onlyOwner {

126:     function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)

138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {

143:     /// @dev Provide the raw quote binary as input
144:     /// @dev The attestation data (or the returned data of this method)
145:     /// is constructed depending on the validity of the quote verification.
146:     /// @dev After confirming that a quote has been verified, the attestation's validity then
147:     /// depends on the
148:     /// status of the associated TCB.
149:     /// @dev Example scenarios as below:
150:     /// --------------------------------
151:     /// @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
152:     ///
153:     /// @dev For all valid quote verification, the validity of the attestation depends on the status
154:     /// of a
155:     /// matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
156:     /// overwritten
157:     /// in derived contracts. (Except for "Revoked" status, which also returns (false,
158:     /// INVALID_EXIT_CODE) value)
159:     /// @dev For all valid quote verification, returns the following data:
160:     /// (_attestationTcbIsValid(), abi.encodePacked(sha256(quote), uint8 exitCode))
161:     /// @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum

175:     function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)

206:     function _checkTcbLevels(

229:     function _isCpuSvnHigherOrGreater(

248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)

303:     function _enclaveReportSigVerification(

336:     /// @dev Provide the parsed quote binary as input
337:     /// @dev The attestation data (or the returned data of this method)
338:     /// is constructed depending on the validity of the quote verification.
339:     /// @dev After confirming that a quote has been verified, the attestation's validity then
340:     /// depends on the
341:     /// status of the associated TCB.
342:     /// @dev Example scenarios as below:
343:     /// --------------------------------
344:     /// @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
345:     ///
346:     /// @dev For all valid quote verification, the validity of the attestation depends on the status
347:     /// of a
348:     /// matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
349:     /// overwritten
350:     /// in derived contracts. (Except for "Revoked" status, which also returns (false,
351:     /// INVALID_EXIT_CODE) value)
352:     /// @dev For all valid quote verification, returns the following data:
353:     /// (_attestationTcbIsValid())
354:     /// @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum

364:     function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L20-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L143-L161), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L336-L354), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364-L364)


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

6: /// @title IAttestation
7: /// @custom:security-contact security@taiko.xyz
8: interface IAttestation {

9:     function verifyAttestation(bytes calldata data) external returns (bool);

10:     function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L9-L9), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L10-L10)


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

4: /// @title ISigVerifyLib
5: /// @custom:security-contact security@taiko.xyz
6: interface ISigVerifyLib {

12:     struct PublicKey {

24:     struct Certificate {

38:     function verifyAttStmtSignature(

48:     function verifyCertificateSignature(

58:     function verifyRS256Signature(

67:     function verifyRS1Signature(

76:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L76-L76)


```solidity

File: /contracts/automata-attestation/lib/EnclaveIdStruct.sol

4: /// @title EnclaveIdStruct
5: /// @custom:security-contact security@taiko.xyz
6: library EnclaveIdStruct {

7:     struct EnclaveId {

17:     struct TcbLevel {

22:     struct TcbObj {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L22-L22)


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

4: /// @title IPEMCertChainLib
5: /// @custom:security-contact security@taiko.xyz
6: interface IPEMCertChainLib {

7:     struct ECSha256Certificate {

18:     struct PCKCertificateField {

24:     struct PCKTCBInfo {

36:     function splitCertificateChain(

44:     function decodeCert(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L44-L44)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

10: /// @title PEMCertChainLib
11: /// @custom:security-contact security@taiko.xyz
12: contract PEMCertChainLib is IPEMCertChainLib {

34:     struct PCKTCBFlags {

40:     function splitCertificateChain(

74:     function decodeCert(

216:     function _removeHeadersAndFooters(string memory pemData)

252:     function _trimBytes(

269:     function _findPckTcbInfo(

341:     function _findTcb(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L10-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L341-L341)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

09: /// @title V3Parser
10: /// @custom:security-contact security@taiko.xyz
11: library V3Parser {

21:     function parseInput(

62:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)

133:     function parseEnclaveReport(bytes memory rawEnclaveReport)

152:     function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {

165:     function parseAndVerifyHeader(bytes memory rawHeader)

203:     function parseAuthDataAndVerifyCertType(

238:     /// enclaveReport to bytes for hash calculation.
239:     /// the only difference between enclaveReport and packedQEReport is the
240:     /// order of isvProdId and isvSvn. enclaveReport is in little endian, while
241:     /// in bytes should be in big endian according to Intel spec.
242:     /// @param enclaveReport enclave report
243:     /// @return packedQEReport enclave report in bytes

267:     function parseCerificationChainBytes(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L9-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L238-L243), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L267)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

4: /// @title V3Struct
5: /// @custom:security-contact security@taiko.xyz
6: library V3Struct {

7:     struct Header {

17:     struct EnclaveReport {

33:     struct QEAuthData {

38:     struct CertificationData {

47:     struct ECDSAQuoteV3AuthData {

56:     struct ParsedV3QuoteStruct {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L56-L56)


```solidity

File: /contracts/automata-attestation/lib/TCBInfoStruct.sol

4: /// @title TCBInfoStruct
5: /// @custom:security-contact security@taiko.xyz
6: library TCBInfoStruct {

7:     struct TCBInfo {

13:     struct TCBLevelObj {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L4-L6) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L13-L13)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

10: /// @title NodePtr
11: /// @custom:security-contact security@taiko.xyz
12: library NodePtr {

36: /// @title Asn1Decode
37: /// @custom:security-contact security@taiko.xyz
38: library Asn1Decode {

14:     function ixs(uint256 self) internal pure returns (uint256) {

19:     function ixf(uint256 self) internal pure returns (uint256) {

24:     function ixl(uint256 self) internal pure returns (uint256) {

29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {

47:     function root(bytes memory der) internal pure returns (uint256) {

56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

66:     function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

87:     function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

187:     function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L10-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L36-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L187-L187)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

6: /// @title BytesUtils
7: /// @custom:security-contact security@taiko.xyz
8: library BytesUtils {

16:     function keccak(

39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

56:     function compare(

116:     function equals(

138:     function equals(

160:     function equals(

178:     function equals(bytes memory self, bytes memory other) internal pure returns (bool) {

188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {

198:     function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {

211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

224:     function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {

237:     function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {

255:     function readBytesN(

272:     function memcpy(uint256 dest, uint256 src, uint256 len) private pure {

284:     function substring(

313:     /**
314:      * @dev Decodes unpadded base32 data of up to one word in length.
315:      * @param self The data to decode.
316:      * @param off Offset into the string to start at.
317:      * @param len Number of characters to decode.
318:      * @return The decoded data, left aligned.
319:      */

371:     function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L6-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L211-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L313-L319), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L371-L371)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

32: /// @title RsaVerify
33: /// @custom:security-contact security@taiko.xyz
34: library RsaVerify {

35:     /**
36:      * @dev Verifies a PKCSv1.5 SHA256 signature
37:      * @param _sha256 is the sha256 of the data
38:      * @param _s is the signature
39:      * @param _e is the exponent
40:      * @param _m is the modulus
41:      * @return true if success, false otherwise
42:      */

183:     /**
184:      * @dev Verifies a PKCSv1.5 SHA256 signature
185:      * @param _data to verify
186:      * @param _s is the signature
187:      * @param _e is the exponent
188:      * @param _m is the modulus
189:      * @return 0 if success, >0 otherwise
190:      */

204:     /**
205:      * @dev Verifies a PKCSv1.5 SHA1 signature
206:      * @param _sha1 is the sha1 of the data
207:      * @param _s is the signature
208:      * @param _e is the exponent
209:      * @param _m is the modulus
210:      * @return true if success, false otherwise
211:      */

299:     /**
300:      * @dev Verifies a PKCSv1.5 SHA1 signature
301:      * @param _data to verify
302:      * @param _s is the signature
303:      * @param _e is the exponent
304:      * @param _m is the modulus
305:      * @return 0 if success, >0 otherwise
306:      */


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L32-L34) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L35-L42), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L183-L190), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L204-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L299-L306)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

08: /// @title SHA1
09: /// @custom:security-contact security@taiko.xyz
10: library SHA1 {

11:     function sha1(bytes memory data) internal pure returns (bytes20 ret) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L11-L11)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

08: /// @title SigVerifyLib
09: /// @custom:security-contact security@taiko.xyz
10: // Library for verifying signatures

20:     constructor(address es256Verifier) {

24:     function verifyAttStmtSignature(

54:     function verifyCertificateSignature(

79:     function verifyRS256Signature(

96:     function verifyRS1Signature(

113:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L8-L10) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L113)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

5: /// @title X509DateUtils
6: /// @custom:security-contact security@taiko.xyz
7: library X509DateUtils {

8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {

34:     function toUnixTimestamp(

71:     function isLeapYear(uint16 year) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L5-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L71-L71)


</details>


### [NC&#x2011;88] Do not use UNDERSCORE in `struct` elements names 



*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/TaikoData.sol

//@audit remove underscore from `__reserved1`, `__reserved2`, `__reserved3`, 
168:     struct SlotB {
169:         uint64 numBlocks;
170:         uint64 lastVerifiedBlockId;
171:         bool provingPaused;
172:         uint8 __reserved1;
173:         uint16 __reserved2;
174:         uint32 __reserved3;
175:         uint64 lastUnpausedAt;
176:     }

//@audit remove underscore from `__gap`, 
179:     struct State {
180:         // Ring buffer for proposed blocks and a some recent verified blocks.
181:         mapping(uint64 blockId_mod_blockRingBufferSize => Block blk) blocks;
182:         // Indexing to transition ids (ring buffer not possible)
183:         mapping(uint64 blockId => mapping(bytes32 parentHash => uint32 transitionId)) transitionIds;
184:         // Ring buffer for transitions
185:         mapping(
186:             uint64 blockId_mod_blockRingBufferSize
187:                 => mapping(uint32 transitionId => TransitionState ts)
188:             ) transitions;
189:         // Ring buffer for Ether deposits
190:         mapping(uint256 depositId_mod_ethDepositRingBufferSize => uint256 depositAmount) ethDeposits;
191:         // Reusable blobs
192:         mapping(bytes32 blobHash => uint256 since) reusableBlobs;
193:         SlotA slotA; // slot 6
194:         SlotB slotB; // slot 7
195:         uint256[43] __gap;
196:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L168-L176) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L179-L196)


</details>


### [NC&#x2011;89] Expressions for constant values should use `immutable` rather than `constant` 
While it does not save gas for some simple binary expressions because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and `immutable` variables, and they should each be used in their appropriate contexts. `constants` should be used for literal values written into the code, and `immutable` variables should be used for expressions, or values calculated in, or passed into the constructor.


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

10:     address public constant POINT_EVALUATION_PRECOMPILE_ADDRESS = address(0x0A);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L10-L10) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

21:     uint256 public constant MAX_BYTES_PER_BLOB = 4096 * 32;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L21-L21) 


```solidity

File: /contracts/L1/libs/LibProving.sol

20:     bytes32 public constant RETURN_LIVENESS_BOND = keccak256("RETURN_LIVENESS_BOND");

23:     bytes32 public constant TIER_OP = bytes32("tier_optimistic");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L23-L23)


```solidity

File: /contracts/signal/LibSignals.sol

8:     bytes32 public constant STATE_ROOT = keccak256("STATE_ROOT");

11:     bytes32 public constant SIGNAL_ROOT = keccak256("SIGNAL_ROOT");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/LibSignals.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/LibSignals.sol#L11-L11)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

24:     uint256 internal constant BRANCH_NODE_LENGTH = TREE_RADIX + 1;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L24-L24) 


</details>


### [NC&#x2011;90] Consider splitting long calculations 
The longer a string of operations is, the harder it is to understand it. Consider splitting the full calculation into more steps, with more descriptive temporary variable names, and add extensive comments.


*There are 9 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

159:             acc += upperDigit * (16 ** ((2 * i) + 1));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L159-L159) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

24:         yrs += (uint8(x509Time[offset + 0]) - 48) * 10 + uint8(x509Time[offset + 1]) - 48;

25:         mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;

26:         dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;

27:         hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;

28:         mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;

29:         secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;

21:             yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L21-L21)


</details>


### [NC&#x2011;91] `immutable` variable names don\'t follow the Solidity style guide 
For `immutable` variable names, each word should use all capital letters, with underscores separating each word (CONSTANT_CASE)


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

25:     ISigVerifyLib public immutable sigVerifyLib;

26:     IPEMCertChainLib public immutable pemCertLib;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L26-L26)


</details>


### [NC&#x2011;92] `private`/`public` function name should start with underscore 
According to solidity style guide, Private or Public function name should start with underscore.


*There are 95 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

//@audit `evaluatePoint` is not in CamelCase
30:     function evaluatePoint(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L30-L30) 


```solidity

File: /contracts/libs/LibAddress.sol

//@audit `sendEther` is not in CamelCase
22:     function sendEther(address _to, uint256 _amount, uint256 _gasLimit) internal {

//@audit `sendEther` is not in CamelCase
42:     function sendEther(address _to, uint256 _amount) internal {

//@audit `supportsInterface` is not in CamelCase
46:     function supportsInterface(

//@audit `isValidSignature` is not in CamelCase
61:     function isValidSignature(

//@audit `isSenderEOA` is not in CamelCase
77:     function isSenderEOA() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L42-L42), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L77-L77)


```solidity

File: /contracts/libs/LibMath.sol

//@audit `min` is not in CamelCase
12:     function min(uint256 _a, uint256 _b) internal pure returns (uint256) {

//@audit `max` is not in CamelCase
20:     function max(uint256 _a, uint256 _b) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L20-L20)


```solidity

File: /contracts/libs/LibTrieProof.sol

//@audit `verifyMerkleProof` is not in CamelCase
34:     function verifyMerkleProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L34-L34) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

//@audit `depositEtherToL2` is not in CamelCase
29:     function depositEtherToL2(

//@audit `processDeposits` is not in CamelCase
67:     function processDeposits(

//@audit `canDepositEthToL2` is not in CamelCase
122:     function canDepositEthToL2(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L122-L122)


```solidity

File: /contracts/L1/libs/LibProposing.sol

//@audit `proposeBlock` is not in CamelCase
68:     function proposeBlock(

//@audit `isBlobReusable` is not in CamelCase
287:     function isBlobReusable(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L287-L287)


```solidity

File: /contracts/L1/libs/LibProving.sol

//@audit `proveBlock` is not in CamelCase
91:     function proveBlock(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L91) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

//@audit `getTransitionId` is not in CamelCase
70:     function getTransitionId(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L70-L70) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit `verifyBlocks` is not in CamelCase
85:     function verifyBlocks(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L85-L85) 


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit `approve` is not in CamelCase
111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {

//@audit `deleteApproval` is not in CamelCase
124:     function deleteApproval(bytes32 _hash) internal {

//@audit `isApproved` is not in CamelCase
128:     function isApproved(uint256 _approvalBits) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L128-L128)


```solidity

File: /contracts/L2/Lib1559Math.sol

//@audit `basefee` is not in CamelCase
16:     function basefee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L16-L16) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit `checkProcessMessageContext` is not in CamelCase
47:     function checkProcessMessageContext()

//@audit `checkRecallMessageContext` is not in CamelCase
58:     function checkRecallMessageContext()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L58-L58)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

//@audit `validateInputs` is not in CamelCase
11:     function validateInputs(

//@audit `buildName` is not in CamelCase
28:     function buildName(

//@audit `buildSymbol` is not in CamelCase
39:     function buildSymbol(string memory _symbol) internal pure returns (string memory) {

//@audit `buildURI` is not in CamelCase
43:     function buildURI(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L43)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

//@audit `excessivelySafeCall` is not in CamelCase
25:     function excessivelySafeCall(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L25) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

//@audit `slice` is not in CamelCase
15:     function slice(

//@audit `slice` is not in CamelCase
91:     function slice(bytes memory _bytes, uint256 _start) internal pure returns (bytes memory) {

//@audit `toNibbles` is not in CamelCase
102:     function toNibbles(bytes memory _bytes) internal pure returns (bytes memory) {

//@audit `equal` is not in CamelCase
149:     function equal(bytes memory _bytes, bytes memory _other) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L15-L15) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L149-L149)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

//@audit `toRLPItem` is not in CamelCase
35:     function toRLPItem(bytes memory _in) internal pure returns (RLPItem memory out_) {

//@audit `readList` is not in CamelCase
53:     function readList(RLPItem memory _in) internal pure returns (RLPItem[] memory out_) {

//@audit `readList` is not in CamelCase
102:     function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {

//@audit `readBytes` is not in CamelCase
109:     function readBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {

//@audit `readBytes` is not in CamelCase
128:     function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {

//@audit `readRawBytes` is not in CamelCase
135:     function readRawBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L135-L135)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit `writeBytes` is not in CamelCase
13:     function writeBytes(bytes memory _in) internal pure returns (bytes memory out_) {

//@audit `writeUint` is not in CamelCase
24:     function writeUint(uint256 _in) internal pure returns (bytes memory out_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L24-L24)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

//@audit `verifyInclusionProof` is not in CamelCase
50:     function verifyInclusionProof(

//@audit `get` is not in CamelCase
68:     function get(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68-L68)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

//@audit `verifyInclusionProof` is not in CamelCase
19:     function verifyInclusionProof(

//@audit `get` is not in CamelCase
38:     function get(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L38-L38)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit `parseInput` is not in CamelCase
21:     function parseInput(

//@audit `validateParsedInput` is not in CamelCase
62:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)

//@audit `parseEnclaveReport` is not in CamelCase
133:     function parseEnclaveReport(bytes memory rawEnclaveReport)

//@audit `littleEndianDecode` is not in CamelCase
152:     function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {

//@audit `parseAndVerifyHeader` is not in CamelCase
165:     function parseAndVerifyHeader(bytes memory rawHeader)

//@audit `parseAuthDataAndVerifyCertType` is not in CamelCase
203:     function parseAuthDataAndVerifyCertType(

//@audit `packQEReport` is not in CamelCase
244:     function packQEReport(V3Struct.EnclaveReport memory enclaveReport)

//@audit `parseCerificationChainBytes` is not in CamelCase
267:     function parseCerificationChainBytes(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L244-L244), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L267)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit `ixs` is not in CamelCase
14:     function ixs(uint256 self) internal pure returns (uint256) {

//@audit `ixf` is not in CamelCase
19:     function ixf(uint256 self) internal pure returns (uint256) {

//@audit `ixl` is not in CamelCase
24:     function ixl(uint256 self) internal pure returns (uint256) {

//@audit `getPtr` is not in CamelCase
29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {

//@audit `root` is not in CamelCase
47:     function root(bytes memory der) internal pure returns (uint256) {

//@audit `rootOfBitStringAt` is not in CamelCase
56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

//@audit `rootOfOctetStringAt` is not in CamelCase
66:     function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

//@audit `nextSiblingOf` is not in CamelCase
77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

//@audit `firstChildOf` is not in CamelCase
87:     function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

//@audit `isChildOf` is not in CamelCase
98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

//@audit `bytesAt` is not in CamelCase
111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

//@audit `allBytesAt` is not in CamelCase
121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

//@audit `bytes32At` is not in CamelCase
131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

//@audit `uintAt` is not in CamelCase
141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

//@audit `uintBytesAt` is not in CamelCase
154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

//@audit `keccakOfBytesAt` is not in CamelCase
165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

//@audit `keccakOfAllBytesAt` is not in CamelCase
169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

//@audit `bitstringAt` is not in CamelCase
179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit `keccak` is not in CamelCase
16:     function keccak(

//@audit `compare` is not in CamelCase
39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

//@audit `compare` is not in CamelCase
56:     function compare(

//@audit `equals` is not in CamelCase
116:     function equals(

//@audit `equals` is not in CamelCase
138:     function equals(

//@audit `equals` is not in CamelCase
160:     function equals(

//@audit `equals` is not in CamelCase
178:     function equals(bytes memory self, bytes memory other) internal pure returns (bool) {

//@audit `readUint8` is not in CamelCase
188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {

//@audit `readUint16` is not in CamelCase
198:     function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {

//@audit `readUint32` is not in CamelCase
211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

//@audit `readBytes32` is not in CamelCase
224:     function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {

//@audit `readBytes20` is not in CamelCase
237:     function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {

//@audit `readBytesN` is not in CamelCase
255:     function readBytesN(

//@audit `memcpy` is not in CamelCase
272:     function memcpy(uint256 dest, uint256 src, uint256 len) private pure {

//@audit `substring` is not in CamelCase
284:     function substring(

//@audit `base32HexDecodeWord` is not in CamelCase
320:     function base32HexDecodeWord(

//@audit `compareBytes` is not in CamelCase
371:     function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L211-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L320), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L371-L371)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

//@audit `pkcs1Sha256` is not in CamelCase
43:     function pkcs1Sha256(

//@audit `pkcs1Sha256Raw` is not in CamelCase
191:     function pkcs1Sha256Raw(

//@audit `pkcs1Sha1` is not in CamelCase
212:     function pkcs1Sha1(

//@audit `pkcs1Sha1Raw` is not in CamelCase
307:     function pkcs1Sha1Raw(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L191-L191), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L307-L307)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

//@audit `sha1` is not in CamelCase
11:     function sha1(bytes memory data) internal pure returns (bytes20 ret) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L11-L11) 


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

//@audit `toTimestamp` is not in CamelCase
8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {

//@audit `toUnixTimestamp` is not in CamelCase
34:     function toUnixTimestamp(

//@audit `isLeapYear` is not in CamelCase
71:     function isLeapYear(uint16 year) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L71-L71)


</details>


### [NC&#x2011;93] Assembly block creates dirty bits 
Writing data to the free memory pointer without later updating the free memory pointer will cause there to be dirty bits at that memory location. Not updating the free memory pointer will make it [harder](https://docs.soliditylang.org/en/latest/ir-breaking-changes.html#cleanup) for the optimizer to reason about whether the memory needs to be cleaned, which may lead to worse optimizations. Annotate the block with `assembly ("memory-safe") { ... }` if the memory's value can be discarded. If the memory needs to be saved, update the free memory pointer in addtion to using the annotation. See [this](https://docs.soliditylang.org/en/latest/assembly.html#memory-safety) link for other cases where the annotation can be used


*There are 23 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

53:         assembly {
54:             first := mload(add(ret, 32))
55:             second := mload(add(ret, 64))
56:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L53-L56) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

43:         assembly {
44:             _success :=
45:                 call(
46:                     _gas, // gas
47:                     _target, // recipient
48:                     _value, // ether value
49:                     add(_calldata, 0x20), // inloc
50:                     mload(_calldata), // inlen
51:                     0, // outloc
52:                     0 // outlen
53:                 )
54:             // limit our copy to 256 bytes
55:             _toCopy := returndatasize()
56:             if gt(_toCopy, _maxCopy) { _toCopy := _maxCopy }
57:             // Store the length of the copied bytes
58:             mstore(_returnData, _toCopy)
59:             // copy the bytes from returndata[0:_toCopy]
60:             returndatacopy(add(_returnData, 0x20), 0, _toCopy)
61:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L43-L61) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

32:         assembly {
33:             switch iszero(_length)
34:             case 0 {
35:                 // Get a location of some free memory and store it in tempBytes as
36:                 // Solidity does for memory variables.
37:                 tempBytes := mload(0x40)
38: 
39:                 // The first word of the slice result is potentially a partial
40:                 // word read from the original array. To read it, we calculate
41:                 // the length of that partial word and start copying that many
42:                 // bytes into the array. The first word we copy will start with
43:                 // data we don't care about, but the last `lengthmod` bytes will
44:                 // land at the beginning of the contents of the new array. When
45:                 // we're done copying, we overwrite the full first word with
46:                 // the actual length of the slice.
47:                 let lengthmod := and(_length, 31)
48: 
49:                 // The multiplication in the next line is necessary
50:                 // because when slicing multiples of 32 bytes (lengthmod == 0)
51:                 // the following copy loop was copying the origin's length
52:                 // and then ending prematurely not copying everything it should.
53:                 let mc := add(add(tempBytes, lengthmod), mul(0x20, iszero(lengthmod)))
54:                 let end := add(mc, _length)
55: 
56:                 for {
57:                     // The multiplication in the next line has the same exact purpose
58:                     // as the one above.
59:                     let cc := add(add(add(_bytes, lengthmod), mul(0x20, iszero(lengthmod))), _start)
60:                 } lt(mc, end) {
61:                     mc := add(mc, 0x20)
62:                     cc := add(cc, 0x20)
63:                 } { mstore(mc, mload(cc)) }
64: 
65:                 mstore(tempBytes, _length)
66: 
67:                 //update free-memory pointer
68:                 //allocating the array padded to 32 bytes like the compiler does now
69:                 mstore(0x40, and(add(mc, 31), not(31)))
70:             }
71:             //if we want a zero-length slice let's just return a zero-length array
72:             default {
73:                 tempBytes := mload(0x40)
74: 
75:                 //zero out the 32 bytes slice we are about to return
76:                 //we need to do it because Solidity does not garbage collect
77:                 mstore(tempBytes, 0)
78: 
79:                 mstore(0x40, add(tempBytes, 0x20))
80:             }
81:         }

104:         assembly {
105:             // Grab a free memory offset for the new array
106:             _nibbles := mload(0x40)
107: 
108:             // Load the length of the passed bytes array from memory
109:             let bytesLength := mload(_bytes)
110: 
111:             // Calculate the length of the new nibble array
112:             // This is the length of the input array times 2
113:             let nibblesLength := shl(0x01, bytesLength)
114: 
115:             // Update the free memory pointer to allocate memory for the new array.
116:             // To do this, we add the length of the new array + 32 bytes for the array length
117:             // rounded up to the nearest 32 byte boundary to the current free memory pointer.
118:             mstore(0x40, add(_nibbles, and(not(0x1F), add(nibblesLength, 0x3F))))
119: 
120:             // Store the length of the new array in memory
121:             mstore(_nibbles, nibblesLength)
122: 
123:             // Store the memory offset of the _bytes array's contents on the stack
124:             let bytesStart := add(_bytes, 0x20)
125: 
126:             // Store the memory offset of the nibbles array's contents on the stack
127:             let nibblesStart := add(_nibbles, 0x20)
128: 
129:             // Loop through each byte in the input array
130:             for { let i := 0x00 } lt(i, bytesLength) { i := add(i, 0x01) } {
131:                 // Get the starting offset of the next 2 bytes in the nibbles array
132:                 let offset := add(nibblesStart, shl(0x01, i))
133:                 // Load the byte at the current index within the `_bytes` array
134:                 let b := byte(0x00, mload(add(bytesStart, i)))
135: 
136:                 // Pull out the first nibble and store it in the new array
137:                 mstore8(offset, shr(0x04, b))
138:                 // Pull out the second nibble and store it in the new array
139:                 mstore8(add(offset, 0x01), and(b, 0x0F))
140:             }
141:         }

34:             case 0 {
35:                 // Get a location of some free memory and store it in tempBytes as
36:                 // Solidity does for memory variables.
37:                 tempBytes := mload(0x40)
38: 
39:                 // The first word of the slice result is potentially a partial
40:                 // word read from the original array. To read it, we calculate
41:                 // the length of that partial word and start copying that many
42:                 // bytes into the array. The first word we copy will start with
43:                 // data we don't care about, but the last `lengthmod` bytes will
44:                 // land at the beginning of the contents of the new array. When
45:                 // we're done copying, we overwrite the full first word with
46:                 // the actual length of the slice.
47:                 let lengthmod := and(_length, 31)
48: 
49:                 // The multiplication in the next line is necessary
50:                 // because when slicing multiples of 32 bytes (lengthmod == 0)
51:                 // the following copy loop was copying the origin's length
52:                 // and then ending prematurely not copying everything it should.
53:                 let mc := add(add(tempBytes, lengthmod), mul(0x20, iszero(lengthmod)))
54:                 let end := add(mc, _length)
55: 
56:                 for {
57:                     // The multiplication in the next line has the same exact purpose
58:                     // as the one above.
59:                     let cc := add(add(add(_bytes, lengthmod), mul(0x20, iszero(lengthmod))), _start)
60:                 } lt(mc, end) {
61:                     mc := add(mc, 0x20)
62:                     cc := add(cc, 0x20)
63:                 } { mstore(mc, mload(cc)) }
64: 
65:                 mstore(tempBytes, _length)
66: 
67:                 //update free-memory pointer
68:                 //allocating the array padded to 32 bytes like the compiler does now
69:                 mstore(0x40, and(add(mc, 31), not(31)))
70:             }

72:             default {
73:                 tempBytes := mload(0x40)
74: 
75:                 //zero out the 32 bytes slice we are about to return
76:                 //we need to do it because Solidity does not garbage collect
77:                 mstore(tempBytes, 0)
78: 
79:                 mstore(0x40, add(tempBytes, 0x20))
80:             }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L32-L81) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L104-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L34-L70), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L72-L80)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

159:         assembly {
160:             prefix := byte(0, mload(ptr))
161:         }

178:             assembly {
179:                 firstByteOfContent := and(mload(add(ptr, 1)), shl(248, 0xff))
180:             }

198:             assembly {
199:                 firstByteOfContent := and(mload(add(ptr, 1)), shl(248, 0xff))
200:             }

208:             assembly {
209:                 strLen := shr(sub(256, mul(8, lenOfStrLen)), mload(add(ptr, 1)))
210:             }

244:             assembly {
245:                 firstByteOfContent := and(mload(add(ptr, 1)), shl(248, 0xff))
246:             }

254:             assembly {
255:                 listLen := shr(sub(256, mul(8, lenOfListLen)), mload(add(ptr, 1)))
256:             }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L159-L161) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L178-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L198-L200), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L208-L210), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L244-L246), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L254-L256)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

200:         assembly {
201:             ret := and(mload(add(add(self, 2), idx)), 0xFFFF)
202:         }

213:         assembly {
214:             ret := and(mload(add(add(self, 4), idx)), 0xFFFFFFFF)
215:         }

226:         assembly {
227:             ret := mload(add(add(self, 32), idx))
228:         }

239:         assembly {
240:             ret :=
241:                 and(
242:                     mload(add(add(self, 32), idx)),
243:                     0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000000
244:                 )
245:         }

266:         assembly {
267:             let mask := not(sub(exp(256, sub(32, len)), 1))
268:             ret := and(mload(add(add(self, 32), idx)), mask)
269:         }

83:             assembly {
84:                 a := mload(selfptr)
85:                 b := mload(otherptr)
86:             }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L200-L202) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L213-L215), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L226-L228), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L239-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L266-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L83-L86)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

012:         assembly {
013:             // Get a safe scratch location
014:             let scratch := mload(0x40)
015: 
016:             // Get the data length, and point data at the first byte
017:             let len := mload(data)
018:             data := add(data, 32)
019: 
020:             // Find the length after padding
021:             let totallen := add(and(add(len, 1), 0xFFFFFFFFFFFFFFC0), 64)
022:             switch lt(sub(totallen, len), 9)
023:             case 1 { totallen := add(totallen, 64) }
024: 
025:             let h := 0x6745230100EFCDAB890098BADCFE001032547600C3D2E1F0
026: 
027:             function readword(ptr, off, count) -> result {
028:                 result := 0
029:                 if lt(off, count) {
030:                     result := mload(add(ptr, off))
031:                     count := sub(count, off)
032:                     if lt(count, 32) {
033:                         let mask := not(sub(exp(256, sub(32, count)), 1))
034:                         result := and(result, mask)
035:                     }
036:                 }
037:             }
038: 
039:             for { let i := 0 } lt(i, totallen) { i := add(i, 64) } {
040:                 mstore(scratch, readword(data, i, len))
041:                 mstore(add(scratch, 32), readword(data, add(i, 32), len))
042: 
043:                 // If we loaded the last byte, store the terminator byte
044:                 switch lt(sub(len, i), 64)
045:                 case 1 { mstore8(add(scratch, sub(len, i)), 0x80) }
046: 
047:                 // If this is the last block, store the length
048:                 switch eq(i, sub(totallen, 64))
049:                 case 1 { mstore(add(scratch, 32), or(mload(add(scratch, 32)), mul(len, 8))) }
050: 
051:                 // Expand the 16 32-bit words into 80
052:                 for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
053:                     let temp :=
054:                         xor(
055:                             xor(mload(add(scratch, sub(j, 12))), mload(add(scratch, sub(j, 32)))),
056:                             xor(mload(add(scratch, sub(j, 56))), mload(add(scratch, sub(j, 64))))
057:                         )
058:                     temp :=
059:                         or(
060:                             and(
061:                                 mul(temp, 2),
062:                                 0xFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE
063:                             ),
064:                             and(
065:                                 div(temp, 0x80000000),
066:                                 0x0000000100000001000000010000000100000001000000010000000100000001
067:                             )
068:                         )
069:                     mstore(add(scratch, j), temp)
070:                 }
071:                 for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
072:                     let temp :=
073:                         xor(
074:                             xor(mload(add(scratch, sub(j, 24))), mload(add(scratch, sub(j, 64)))),
075:                             xor(mload(add(scratch, sub(j, 112))), mload(add(scratch, sub(j, 128))))
076:                         )
077:                     temp :=
078:                         or(
079:                             and(
080:                                 mul(temp, 4),
081:                                 0xFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFC
082:                             ),
083:                             and(
084:                                 div(temp, 0x40000000),
085:                                 0x0000000300000003000000030000000300000003000000030000000300000003
086:                             )
087:                         )
088:                     mstore(add(scratch, j), temp)
089:                 }
090: 
091:                 let x := h
092:                 let f := 0
093:                 let k := 0
094:                 for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
095:                     switch div(j, 20)
096:                     case 0 {
097:                         // f = d xor (b and (c xor d))
098:                         f := xor(div(x, 0x100000000000000000000), div(x, 0x10000000000))
099:                         f := and(div(x, 0x1000000000000000000000000000000), f)
100:                         f := xor(div(x, 0x10000000000), f)
101:                         k := 0x5A827999
102:                     }
103:                     case 1 {
104:                         // f = b xor c xor d
105:                         f :=
106:                             xor(
107:                                 div(x, 0x1000000000000000000000000000000),
108:                                 div(x, 0x100000000000000000000)
109:                             )
110:                         f := xor(div(x, 0x10000000000), f)
111:                         k := 0x6ED9EBA1
112:                     }
113:                     case 2 {
114:                         // f = (b and c) or (d and (b or c))
115:                         f :=
116:                             or(
117:                                 div(x, 0x1000000000000000000000000000000),
118:                                 div(x, 0x100000000000000000000)
119:                             )
120:                         f := and(div(x, 0x10000000000), f)
121:                         f :=
122:                             or(
123:                                 and(
124:                                     div(x, 0x1000000000000000000000000000000),
125:                                     div(x, 0x100000000000000000000)
126:                                 ),
127:                                 f
128:                             )
129:                         k := 0x8F1BBCDC
130:                     }
131:                     case 3 {
132:                         // f = b xor c xor d
133:                         f :=
134:                             xor(
135:                                 div(x, 0x1000000000000000000000000000000),
136:                                 div(x, 0x100000000000000000000)
137:                             )
138:                         f := xor(div(x, 0x10000000000), f)
139:                         k := 0xCA62C1D6
140:                     }
141:                     // temp = (a leftrotate 5) + f + e + k + w[i]
142:                     let temp := and(div(x, 0x80000000000000000000000000000000000000000000000), 0x1F)
143:                     temp :=
144:                         or(and(div(x, 0x800000000000000000000000000000000000000), 0xFFFFFFE0), temp)
145:                     temp := add(f, temp)
146:                     temp := add(and(x, 0xFFFFFFFF), temp)
147:                     temp := add(k, temp)
148:                     temp :=
149:                         add(
150:                             div(
151:                                 mload(add(scratch, mul(j, 4))),
152:                                 0x100000000000000000000000000000000000000000000000000000000
153:                             ),
154:                             temp
155:                         )
156:                     x :=
157:                         or(
158:                             div(x, 0x10000000000),
159:                             mul(temp, 0x10000000000000000000000000000000000000000)
160:                         )
161:                     x :=
162:                         or(
163:                             and(x, 0xFFFFFFFF00FFFFFFFF000000000000FFFFFFFF00FFFFFFFF),
164:                             mul(
165:                                 or(
166:                                     and(div(x, 0x4000000000000), 0xC0000000),
167:                                     and(div(x, 0x400000000000000000000), 0x3FFFFFFF)
168:                                 ),
169:                                 0x100000000000000000000
170:                             )
171:                         )
172:                 }
173: 
174:                 h := and(add(h, x), 0xFFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF)
175:             }
176:             ret :=
177:                 mul(
178:                     or(
179:                         or(
180:                             or(
181:                                 or(
182:                                     and(div(h, 0x100000000), 0xFFFFFFFF00000000000000000000000000000000),
183:                                     and(div(h, 0x1000000), 0xFFFFFFFF000000000000000000000000)
184:                                 ),
185:                                 and(div(h, 0x10000), 0xFFFFFFFF0000000000000000)
186:                             ),
187:                             and(div(h, 0x100), 0xFFFFFFFF00000000)
188:                         ),
189:                         and(h, 0xFFFFFFFF)
190:                     ),
191:                     0x1000000000000000000000000
192:                 )
193:         }

27:             function readword(ptr, off, count) -> result {
28:                 result := 0
29:                 if lt(off, count) {
30:                     result := mload(add(ptr, off))
31:                     count := sub(count, off)
32:                     if lt(count, 32) {
33:                         let mask := not(sub(exp(256, sub(32, count)), 1))
34:                         result := and(result, mask)
35:                     }
36:                 }
37:             }

039:             for { let i := 0 } lt(i, totallen) { i := add(i, 64) } {
040:                 mstore(scratch, readword(data, i, len))
041:                 mstore(add(scratch, 32), readword(data, add(i, 32), len))
042: 
043:                 // If we loaded the last byte, store the terminator byte
044:                 switch lt(sub(len, i), 64)
045:                 case 1 { mstore8(add(scratch, sub(len, i)), 0x80) }
046: 
047:                 // If this is the last block, store the length
048:                 switch eq(i, sub(totallen, 64))
049:                 case 1 { mstore(add(scratch, 32), or(mload(add(scratch, 32)), mul(len, 8))) }
050: 
051:                 // Expand the 16 32-bit words into 80
052:                 for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
053:                     let temp :=
054:                         xor(
055:                             xor(mload(add(scratch, sub(j, 12))), mload(add(scratch, sub(j, 32)))),
056:                             xor(mload(add(scratch, sub(j, 56))), mload(add(scratch, sub(j, 64))))
057:                         )
058:                     temp :=
059:                         or(
060:                             and(
061:                                 mul(temp, 2),
062:                                 0xFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE
063:                             ),
064:                             and(
065:                                 div(temp, 0x80000000),
066:                                 0x0000000100000001000000010000000100000001000000010000000100000001
067:                             )
068:                         )
069:                     mstore(add(scratch, j), temp)
070:                 }
071:                 for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
072:                     let temp :=
073:                         xor(
074:                             xor(mload(add(scratch, sub(j, 24))), mload(add(scratch, sub(j, 64)))),
075:                             xor(mload(add(scratch, sub(j, 112))), mload(add(scratch, sub(j, 128))))
076:                         )
077:                     temp :=
078:                         or(
079:                             and(
080:                                 mul(temp, 4),
081:                                 0xFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFC
082:                             ),
083:                             and(
084:                                 div(temp, 0x40000000),
085:                                 0x0000000300000003000000030000000300000003000000030000000300000003
086:                             )
087:                         )
088:                     mstore(add(scratch, j), temp)
089:                 }
090: 
091:                 let x := h
092:                 let f := 0
093:                 let k := 0
094:                 for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
095:                     switch div(j, 20)
096:                     case 0 {
097:                         // f = d xor (b and (c xor d))
098:                         f := xor(div(x, 0x100000000000000000000), div(x, 0x10000000000))
099:                         f := and(div(x, 0x1000000000000000000000000000000), f)
100:                         f := xor(div(x, 0x10000000000), f)
101:                         k := 0x5A827999
102:                     }
103:                     case 1 {
104:                         // f = b xor c xor d
105:                         f :=
106:                             xor(
107:                                 div(x, 0x1000000000000000000000000000000),
108:                                 div(x, 0x100000000000000000000)
109:                             )
110:                         f := xor(div(x, 0x10000000000), f)
111:                         k := 0x6ED9EBA1
112:                     }
113:                     case 2 {
114:                         // f = (b and c) or (d and (b or c))
115:                         f :=
116:                             or(
117:                                 div(x, 0x1000000000000000000000000000000),
118:                                 div(x, 0x100000000000000000000)
119:                             )
120:                         f := and(div(x, 0x10000000000), f)
121:                         f :=
122:                             or(
123:                                 and(
124:                                     div(x, 0x1000000000000000000000000000000),
125:                                     div(x, 0x100000000000000000000)
126:                                 ),
127:                                 f
128:                             )
129:                         k := 0x8F1BBCDC
130:                     }
131:                     case 3 {
132:                         // f = b xor c xor d
133:                         f :=
134:                             xor(
135:                                 div(x, 0x1000000000000000000000000000000),
136:                                 div(x, 0x100000000000000000000)
137:                             )
138:                         f := xor(div(x, 0x10000000000), f)
139:                         k := 0xCA62C1D6
140:                     }
141:                     // temp = (a leftrotate 5) + f + e + k + w[i]
142:                     let temp := and(div(x, 0x80000000000000000000000000000000000000000000000), 0x1F)
143:                     temp :=
144:                         or(and(div(x, 0x800000000000000000000000000000000000000), 0xFFFFFFE0), temp)
145:                     temp := add(f, temp)
146:                     temp := add(and(x, 0xFFFFFFFF), temp)
147:                     temp := add(k, temp)
148:                     temp :=
149:                         add(
150:                             div(
151:                                 mload(add(scratch, mul(j, 4))),
152:                                 0x100000000000000000000000000000000000000000000000000000000
153:                             ),
154:                             temp
155:                         )
156:                     x :=
157:                         or(
158:                             div(x, 0x10000000000),
159:                             mul(temp, 0x10000000000000000000000000000000000000000)
160:                         )
161:                     x :=
162:                         or(
163:                             and(x, 0xFFFFFFFF00FFFFFFFF000000000000FFFFFFFF00FFFFFFFF),
164:                             mul(
165:                                 or(
166:                                     and(div(x, 0x4000000000000), 0xC0000000),
167:                                     and(div(x, 0x400000000000000000000), 0x3FFFFFFF)
168:                                 ),
169:                                 0x100000000000000000000
170:                             )
171:                         )
172:                 }
173: 
174:                 h := and(add(h, x), 0xFFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF)
175:             }

29:                 if lt(off, count) {
30:                     result := mload(add(ptr, off))
31:                     count := sub(count, off)
32:                     if lt(count, 32) {
33:                         let mask := not(sub(exp(256, sub(32, count)), 1))
34:                         result := and(result, mask)
35:                     }
36:                 }

094:                 for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
095:                     switch div(j, 20)
096:                     case 0 {
097:                         // f = d xor (b and (c xor d))
098:                         f := xor(div(x, 0x100000000000000000000), div(x, 0x10000000000))
099:                         f := and(div(x, 0x1000000000000000000000000000000), f)
100:                         f := xor(div(x, 0x10000000000), f)
101:                         k := 0x5A827999
102:                     }
103:                     case 1 {
104:                         // f = b xor c xor d
105:                         f :=
106:                             xor(
107:                                 div(x, 0x1000000000000000000000000000000),
108:                                 div(x, 0x100000000000000000000)
109:                             )
110:                         f := xor(div(x, 0x10000000000), f)
111:                         k := 0x6ED9EBA1
112:                     }
113:                     case 2 {
114:                         // f = (b and c) or (d and (b or c))
115:                         f :=
116:                             or(
117:                                 div(x, 0x1000000000000000000000000000000),
118:                                 div(x, 0x100000000000000000000)
119:                             )
120:                         f := and(div(x, 0x10000000000), f)
121:                         f :=
122:                             or(
123:                                 and(
124:                                     div(x, 0x1000000000000000000000000000000),
125:                                     div(x, 0x100000000000000000000)
126:                                 ),
127:                                 f
128:                             )
129:                         k := 0x8F1BBCDC
130:                     }
131:                     case 3 {
132:                         // f = b xor c xor d
133:                         f :=
134:                             xor(
135:                                 div(x, 0x1000000000000000000000000000000),
136:                                 div(x, 0x100000000000000000000)
137:                             )
138:                         f := xor(div(x, 0x10000000000), f)
139:                         k := 0xCA62C1D6
140:                     }
141:                     // temp = (a leftrotate 5) + f + e + k + w[i]
142:                     let temp := and(div(x, 0x80000000000000000000000000000000000000000000000), 0x1F)
143:                     temp :=
144:                         or(and(div(x, 0x800000000000000000000000000000000000000), 0xFFFFFFE0), temp)
145:                     temp := add(f, temp)
146:                     temp := add(and(x, 0xFFFFFFFF), temp)
147:                     temp := add(k, temp)
148:                     temp :=
149:                         add(
150:                             div(
151:                                 mload(add(scratch, mul(j, 4))),
152:                                 0x100000000000000000000000000000000000000000000000000000000
153:                             ),
154:                             temp
155:                         )
156:                     x :=
157:                         or(
158:                             div(x, 0x10000000000),
159:                             mul(temp, 0x10000000000000000000000000000000000000000)
160:                         )
161:                     x :=
162:                         or(
163:                             and(x, 0xFFFFFFFF00FFFFFFFF000000000000FFFFFFFF00FFFFFFFF),
164:                             mul(
165:                                 or(
166:                                     and(div(x, 0x4000000000000), 0xC0000000),
167:                                     and(div(x, 0x400000000000000000000), 0x3FFFFFFF)
168:                                 ),
169:                                 0x100000000000000000000
170:                             )
171:                         )
172:                 }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L12-L193) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L27-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L39-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L29-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L94-L172)


</details>


### [NC&#x2011;94] Add inline comments for unnamed parameters 
`function func(address a, address)` -> `function func(address a, address /* b */)`


*There are 11 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

//@audit parameter number 0 starting from left need inline comment
58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58) 


```solidity

File: /contracts/common/EssentialContract.sol

//@audit parameter number 0 starting from left need inline comment
114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }

//@audit parameter number 0 starting from left need inline comment
116:     function _authorizePause(address) internal virtual onlyOwner { }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L116-L116)


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit parameter number 0 starting from left need inline comment
220:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L220) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit parameter number 0 starting from left need inline comment
54:     function getMinTier(uint256) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L54-L54) 


```solidity

File: /contracts/signal/SignalService.sol

//@audit parameter number 0 starting from left need inline comment
231:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231) 


```solidity

File: /contracts/bridge/Bridge.sol

//@audit parameter number 0 starting from left need inline comment
461:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L461-L461) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
//@audit parameter number 3 starting from left need inline comment
//@audit parameter number 4 starting from left need inline comment
160:     function onERC1155BatchReceived(

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
//@audit parameter number 3 starting from left need inline comment
//@audit parameter number 4 starting from left need inline comment
175:     function onERC1155Received(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L160-L160) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L175-L175)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit parameter number 0 starting from left need inline comment
//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
//@audit parameter number 3 starting from left need inline comment
142:     function onERC721Received(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L142-L142) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

//@audit parameter number 1 starting from left need inline comment
//@audit parameter number 2 starting from left need inline comment
23:     function verifyProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L23-L23) 


</details>


### [NC&#x2011;95] Consider adding formal verification proofs 
Consider using formal verification to mathematically prove that your code does what is intended, and does not have any edge cases with unexpected behavior. The solidity compiler itself has this functionality [built in](https://docs.soliditylang.org/en/latest/smtchecker.html#smtchecker-and-formal-verification)


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

@audit Should implement invariant tests
1: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L1-L1) 


</details>


### [NC&#x2011;96] Missing zero address check in functions with address parameters 
Adding a zero address check for each address type parameter can prevent errors.


*There are 5 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/BridgedERC20.sol

//@audit _snapshooter,  are not checked
80:     function setSnapshoter(address _snapshooter) external onlyOwner {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L80) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

//@audit _target,  are not checked
25:     function excessivelySafeCall(
26:         address _target,
27:         uint256 _gas,
28:         uint256 _value,
29:         uint16 _maxCopy,
30:         bytes memory _calldata
31:     )


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L31) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit _recipient,  are not checked
176:     function getMyGrantSummary(address _recipient)

//@audit _recipient,  are not checked
204:     function getMyGrant(address _recipient) public view returns (Grant memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L176-L176) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L204-L204)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

//@audit es256Verifier,  are not checked
20:     constructor(address es256Verifier) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L20-L20) 


</details>


### [NC&#x2011;97] Use a struct to encapsulate multiple function parameters 
If a function has too many parameters, replacing them with a struct can improve code readability and maintainability, increase reusability, and reduce the likelihood of errors when passing the parameters.


*There are 23 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

30:     function evaluatePoint(
31:         bytes32 _blobHash,
32:         uint256 _x,
33:         uint256 _y,
34:         bytes1[48] memory _commitment,
35:         bytes1[48] memory _pointProof
36:     )
37:         internal
38:         view
39:     {
40:         if (_x >= BLS_MODULUS) revert POINT_X_TOO_LARGE();
41:         if (_y >= BLS_MODULUS) revert POINT_Y_TOO_LARGE();
42: 
43:         (bool ok, bytes memory ret) = POINT_EVALUATION_PRECOMPILE_ADDRESS.staticcall(
44:             abi.encodePacked(_blobHash, _x, _y, _commitment, _pointProof)
45:         );
46: 
47:         if (!ok) revert EVAL_FAILED_1();
48: 
49:         if (ret.length != 64) revert EVAL_FAILED_2();
50: 
51:         bytes32 first;
52:         bytes32 second;
53:         assembly {
54:             first := mload(add(ret, 32))
55:             second := mload(add(ret, 64))
56:         }
57:         if (uint256(first) != FIELD_ELEMENTS_PER_BLOB || uint256(second) != BLS_MODULUS) {
58:             revert EVAL_FAILED_2();
59:         }
60:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L30-L60) 


```solidity

File: /contracts/libs/LibTrieProof.sol

34:     function verifyMerkleProof(
35:         bytes32 _rootHash,
36:         address _addr,
37:         bytes32 _slot,
38:         bytes32 _value,
39:         bytes[] memory _accountProof,
40:         bytes[] memory _storageProof
41:     )
42:         internal
43:         pure
44:         returns (bytes32 storageRoot_)
45:     {
46:         if (_accountProof.length != 0) {
47:             bytes memory rlpAccount =
48:                 SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash);
49: 
50:             if (rlpAccount.length == 0) revert LTP_INVALID_ACCOUNT_PROOF();
51: 
52:             RLPReader.RLPItem[] memory accountState = RLPReader.readList(rlpAccount);
53: 
54:             storageRoot_ =
55:                 bytes32(RLPReader.readBytes(accountState[_ACCOUNT_FIELD_INDEX_STORAGE_HASH]));
56:         } else {
57:             storageRoot_ = _rootHash;
58:         }
59: 
60:         bool verified = SecureMerkleTrie.verifyInclusionProof(
61:             bytes.concat(_slot), RLPWriter.writeUint(uint256(_value)), _storageProof, storageRoot_
62:         );
63: 
64:         if (!verified) revert LTP_INVALID_INCLUSION_PROOF();
65:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L34-L65) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

69:     function propose(
70:         address[] memory _targets,
71:         uint256[] memory _values,
72:         string[] memory _signatures,
73:         bytes[] memory _calldatas,
74:         string memory _description
75:     )
76:         public
77:         virtual
78:         override(GovernorCompatibilityBravoUpgradeable)
79:         returns (uint256)
80:     {
81:         if (_signatures.length != _calldatas.length) revert TG_INVALID_SIGNATURES_LENGTH();
82: 
83:         return GovernorCompatibilityBravoUpgradeable.propose(
84:             _targets, _values, _signatures, _calldatas, _description
85:         );
86:     }

127:     function _execute(
128:         uint256 _proposalId,
129:         address[] memory _targets,
130:         uint256[] memory _values,
131:         bytes[] memory _calldatas,
132:         bytes32 _descriptionHash
133:     )
134:         internal
135:         override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
136:     {
137:         super._execute(_proposalId, _targets, _values, _calldatas, _descriptionHash);
138:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L69-L86) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L138)


```solidity

File: /contracts/L1/libs/LibProposing.sol

068:     function proposeBlock(
069:         TaikoData.State storage _state,
070:         TaikoData.Config memory _config,
071:         IAddressResolver _resolver,
072:         bytes calldata _data,
073:         bytes calldata _txList
074:     )
075:         internal
076:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
077:     {
078:         TaikoData.BlockParams memory params = abi.decode(_data, (TaikoData.BlockParams));
079: 
080:         // We need a prover that will submit proofs after the block has been submitted
081:         if (params.assignedProver == address(0)) {
082:             revert L1_INVALID_PROVER();
083:         }
084: 
085:         if (params.coinbase == address(0)) {
086:             params.coinbase = msg.sender;
087:         }
088: 
089:         // Taiko, as a Based Rollup, enables permissionless block proposals.
090:         // However, if the "proposer" address is set to a non-zero value, we
091:         // ensure that only that specific address has the authority to propose
092:         // blocks.
093:         TaikoData.SlotB memory b = _state.slotB;
094:         if (!_isProposerPermitted(b, _resolver)) revert L1_UNAUTHORIZED();
095: 
096:         // It's essential to ensure that the ring buffer for proposed blocks
097:         // still has space for at least one more block.
098:         if (b.numBlocks >= b.lastVerifiedBlockId + _config.blockMaxProposals + 1) {
099:             revert L1_TOO_MANY_BLOCKS();
100:         }
101: 
102:         bytes32 parentMetaHash =
103:             _state.blocks[(b.numBlocks - 1) % _config.blockRingBufferSize].metaHash;
104: 
105:         // Check if parent block has the right meta hash
106:         // This is to allow the proposer to make sure the block builds on the expected latest chain
107:         // state
108:         if (params.parentMetaHash != 0 && parentMetaHash != params.parentMetaHash) {
109:             revert L1_UNEXPECTED_PARENT();
110:         }
111: 
112:         // Each transaction must handle a specific quantity of L1-to-L2
113:         // Ether deposits.
114:         deposits_ = LibDepositing.processDeposits(_state, _config, params.coinbase);
115: 
116:         // Initialize metadata to compute a metaHash, which forms a part of
117:         // the block data to be stored on-chain for future integrity checks.
118:         // If we choose to persist all data fields in the metadata, it will
119:         // require additional storage slots.
120:         unchecked {
121:             meta_ = TaikoData.BlockMetadata({
122:                 l1Hash: blockhash(block.number - 1),
123:                 difficulty: 0, // to be initialized below
124:                 blobHash: 0, // to be initialized below
125:                 extraData: params.extraData,
126:                 depositsHash: keccak256(abi.encode(deposits_)),
127:                 coinbase: params.coinbase,
128:                 id: b.numBlocks,
129:                 gasLimit: _config.blockMaxGasLimit,
130:                 timestamp: uint64(block.timestamp),
131:                 l1Height: uint64(block.number - 1),
132:                 txListByteOffset: 0, // to be initialized below
133:                 txListByteSize: 0, // to be initialized below
134:                 minTier: 0, // to be initialized below
135:                 blobUsed: _txList.length == 0,
136:                 parentMetaHash: parentMetaHash
137:             });
138:         }
139: 
140:         // Update certain meta fields
141:         if (meta_.blobUsed) {
142:             if (!_config.blobAllowedForDA) revert L1_BLOB_FOR_DA_DISABLED();
143: 
144:             if (params.blobHash != 0) {
145:                 if (!_config.blobReuseEnabled) revert L1_BLOB_REUSE_DISABLED();
146: 
147:                 // We try to reuse an old blob
148:                 if (!isBlobReusable(_state, _config, params.blobHash)) {
149:                     revert L1_BLOB_NOT_REUSABLE();
150:                 }
151:                 meta_.blobHash = params.blobHash;
152:             } else {
153:                 // Always use the first blob in this transaction. If the
154:                 // proposeBlock functions are called more than once in the same
155:                 // L1 transaction, these multiple L2 blocks will share the same
156:                 // blob.
157:                 meta_.blobHash = blobhash(0);
158: 
159:                 if (meta_.blobHash == 0) revert L1_BLOB_NOT_FOUND();
160: 
161:                 // Depends on the blob data price, it may not make sense to
162:                 // cache the blob which costs 20,000 (sstore) + 631 (event)
163:                 // extra gas.
164:                 if (_config.blobReuseEnabled && params.cacheBlobForReuse) {
165:                     _state.reusableBlobs[meta_.blobHash] = block.timestamp;
166:                     emit BlobCached(meta_.blobHash);
167:                 }
168:             }
169: 
170:             // Check that the txList data range is within the max size of a blob
171:             if (uint256(params.txListByteOffset) + params.txListByteSize > MAX_BYTES_PER_BLOB) {
172:                 revert L1_TXLIST_OFFSET();
173:             }
174: 
175:             meta_.txListByteOffset = params.txListByteOffset;
176:             meta_.txListByteSize = params.txListByteSize;
177:         } else {
178:             // The proposer must be an Externally Owned Account (EOA) for
179:             // calldata usage. This ensures that the transaction is not an
180:             // internal one, making calldata retrieval more straightforward for
181:             // Taiko node software.
182:             if (!LibAddress.isSenderEOA()) revert L1_PROPOSER_NOT_EOA();
183: 
184:             // The txList is the full byte array without any offset
185:             if (params.txListByteOffset != 0) {
186:                 revert L1_INVALID_PARAM();
187:             }
188: 
189:             meta_.blobHash = keccak256(_txList);
190:             meta_.txListByteOffset = 0;
191:             meta_.txListByteSize = uint24(_txList.length);
192:         }
193: 
194:         // Check that the tx length is non-zero and within the supported range
195:         if (meta_.txListByteSize == 0 || meta_.txListByteSize > _config.blockMaxTxListBytes) {
196:             revert L1_TXLIST_SIZE();
197:         }
198: 
199:         // Following the Merge, the L1 mixHash incorporates the
200:         // prevrandao value from the beacon chain. Given the possibility
201:         // of multiple Taiko blocks being proposed within a single
202:         // Ethereum block, we choose to introduce a salt to this random
203:         // number as the L2 mixHash.
204:         meta_.difficulty = keccak256(abi.encodePacked(block.prevrandao, b.numBlocks, block.number));
205: 
206:         // Use the difficulty as a random number
207:         meta_.minTier = ITierProvider(_resolver.resolve("tier_provider", false)).getMinTier(
208:             uint256(meta_.difficulty)
209:         );
210: 
211:         // Create the block that will be stored onchain
212:         TaikoData.Block memory blk = TaikoData.Block({
213:             metaHash: keccak256(abi.encode(meta_)),
214:             // Safeguard the liveness bond to ensure its preservation,
215:             // particularly in scenarios where it might be altered after the
216:             // block's proposal but before it has been proven or verified.
217:             livenessBond: _config.livenessBond,
218:             blockId: b.numBlocks,
219:             proposedAt: meta_.timestamp,
220:             proposedIn: uint64(block.number),
221:             // For a new block, the next transition ID is always 1, not 0.
222:             nextTransitionId: 1,
223:             // For unverified block, its verifiedTransitionId is always 0.
224:             verifiedTransitionId: 0,
225:             assignedProver: params.assignedProver
226:         });
227: 
228:         // Store the block in the ring buffer
229:         _state.blocks[b.numBlocks % _config.blockRingBufferSize] = blk;
230: 
231:         // Increment the counter (cursor) by 1.
232:         unchecked {
233:             ++_state.slotB.numBlocks;
234:         }
235: 
236:         {
237:             IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));
238:             uint256 tkoBalance = tko.balanceOf(address(this));
239: 
240:             // Run all hooks.
241:             // Note that address(this).balance has been updated with msg.value,
242:             // prior to any code in this function has been executed.
243:             address prevHook;
244:             for (uint256 i; i < params.hookCalls.length; ++i) {
245:                 if (uint160(prevHook) >= uint160(params.hookCalls[i].hook)) {
246:                     revert L1_INVALID_HOOK();
247:                 }
248: 
249:                 // When a hook is called, all ether in this contract will be send to the hook.
250:                 // If the ether sent to the hook is not used entirely, the hook shall send the Ether
251:                 // back to this contract for the next hook to use.
252:                 // Proposers shall choose use extra hooks wisely.
253:                 IHook(params.hookCalls[i].hook).onBlockProposed{ value: address(this).balance }(
254:                     blk, meta_, params.hookCalls[i].data
255:                 );
256: 
257:                 prevHook = params.hookCalls[i].hook;
258:             }
259:             // Refund Ether
260:             if (address(this).balance != 0) {
261:                 msg.sender.sendEther(address(this).balance);
262:             }
263: 
264:             // Check that after hooks, the Taiko Token balance of this contract
265:             // have increased by the same amount as _config.livenessBond (to prevent)
266:             // multiple draining payments by a malicious proposer nesting the same
267:             // hook.
268:             if (tko.balanceOf(address(this)) != tkoBalance + _config.livenessBond) {
269:                 revert L1_LIVENESS_BOND_NOT_RECEIVED();
270:             }
271:         }
272: 
273:         emit BlockProposed({
274:             blockId: blk.blockId,
275:             assignedProver: blk.assignedProver,
276:             livenessBond: _config.livenessBond,
277:             meta: meta_,
278:             depositsProcessed: deposits_
279:         });
280:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L280) 


```solidity

File: /contracts/L1/libs/LibProving.sol

091:     function proveBlock(
092:         TaikoData.State storage _state,
093:         TaikoData.Config memory _config,
094:         IAddressResolver _resolver,
095:         TaikoData.BlockMetadata memory _meta,
096:         TaikoData.Transition memory _tran,
097:         TaikoData.TierProof memory _proof
098:     )
099:         internal
100:         returns (uint8 maxBlocksToVerify_)
101:     {
102:         // Make sure parentHash is not zero
103:         // To contest an existing transition, simply use any non-zero value as
104:         // the blockHash and stateRoot.
105:         if (_tran.parentHash == 0 || _tran.blockHash == 0 || _tran.stateRoot == 0) {
106:             revert L1_INVALID_TRANSITION();
107:         }
108: 
109:         // Check that the block has been proposed but has not yet been verified.
110:         TaikoData.SlotB memory b = _state.slotB;
111:         if (_meta.id <= b.lastVerifiedBlockId || _meta.id >= b.numBlocks) {
112:             revert L1_INVALID_BLOCK_ID();
113:         }
114: 
115:         uint64 slot = _meta.id % _config.blockRingBufferSize;
116:         TaikoData.Block storage blk = _state.blocks[slot];
117: 
118:         // Check the integrity of the block data. It's worth noting that in
119:         // theory, this check may be skipped, but it's included for added
120:         // caution.
121:         if (blk.blockId != _meta.id || blk.metaHash != keccak256(abi.encode(_meta))) {
122:             revert L1_BLOCK_MISMATCH();
123:         }
124: 
125:         // Each transition is uniquely identified by the parentHash, with the
126:         // blockHash and stateRoot open for later updates as higher-tier proofs
127:         // become available. In cases where a transition with the specified
128:         // parentHash does not exist, the transition ID (tid) will be set to 0.
129:         (uint32 tid, TaikoData.TransitionState storage ts) =
130:             _createTransition(_state, blk, _tran, slot);
131: 
132:         // The new proof must meet or exceed the minimum tier required by the
133:         // block or the previous proof; it cannot be on a lower tier.
134:         if (_proof.tier == 0 || _proof.tier < _meta.minTier || _proof.tier < ts.tier) {
135:             revert L1_INVALID_TIER();
136:         }
137: 
138:         // Retrieve the tier configurations. If the tier is not supported, the
139:         // subsequent action will result in a revert.
140:         ITierProvider.Tier memory tier =
141:             ITierProvider(_resolver.resolve("tier_provider", false)).getTier(_proof.tier);
142: 
143:         // Check if this prover is allowed to submit a proof for this block
144:         _checkProverPermission(_state, blk, ts, tid, tier);
145: 
146:         // We must verify the proof, and any failure in proof verification will
147:         // result in a revert.
148:         //
149:         // It's crucial to emphasize that the proof can be assessed in two
150:         // potential modes: "proving mode" and "contesting mode." However, the
151:         // precise verification logic is defined within each tier's IVerifier
152:         // contract implementation. We simply specify to the verifier contract
153:         // which mode it should utilize - if the new tier is higher than the
154:         // previous tier, we employ the proving mode; otherwise, we employ the
155:         // contesting mode (the new tier cannot be lower than the previous tier,
156:         // this has been checked above).
157:         //
158:         // It's obvious that proof verification is entirely decoupled from
159:         // Taiko's core protocol.
160:         {
161:             address verifier = _resolver.resolve(tier.verifierName, true);
162: 
163:             if (verifier != address(0)) {
164:                 bool isContesting = _proof.tier == ts.tier && tier.contestBond != 0;
165: 
166:                 IVerifier.Context memory ctx = IVerifier.Context({
167:                     metaHash: blk.metaHash,
168:                     blobHash: _meta.blobHash,
169:                     // Separate msgSender to allow the prover to be any address in the future.
170:                     prover: msg.sender,
171:                     msgSender: msg.sender,
172:                     blockId: blk.blockId,
173:                     isContesting: isContesting,
174:                     blobUsed: _meta.blobUsed
175:                 });
176: 
177:                 IVerifier(verifier).verifyProof(ctx, _tran, _proof);
178:             } else if (tier.verifierName != TIER_OP) {
179:                 // The verifier can be address-zero, signifying that there are no
180:                 // proof checks for the tier. In practice, this only applies to
181:                 // optimistic proofs.
182:                 revert L1_MISSING_VERIFIER();
183:             }
184:         }
185: 
186:         bool isTopTier = tier.contestBond == 0;
187:         IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));
188: 
189:         if (isTopTier) {
190:             // A special return value from the top tier prover can signal this
191:             // contract to return all liveness bond.
192:             bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32
193:                 && bytes32(_proof.data) == RETURN_LIVENESS_BOND;
194: 
195:             if (returnLivenessBond) {
196:                 tko.transfer(blk.assignedProver, blk.livenessBond);
197:                 blk.livenessBond = 0;
198:             }
199:         }
200: 
201:         bool sameTransition = _tran.blockHash == ts.blockHash && _tran.stateRoot == ts.stateRoot;
202: 
203:         if (_proof.tier > ts.tier) {
204:             // Handles the case when an incoming tier is higher than the current transition's tier.
205:             // Reverts when the incoming proof tries to prove the same transition
206:             // (L1_ALREADY_PROVED).
207:             _overrideWithHigherProof(ts, _tran, _proof, tier, tko, sameTransition);
208: 
209:             emit TransitionProved({
210:                 blockId: blk.blockId,
211:                 tran: _tran,
212:                 prover: msg.sender,
213:                 validityBond: tier.validityBond,
214:                 tier: _proof.tier
215:             });
216:         } else {
217:             // New transition and old transition on the same tier - and if this transaction tries to
218:             // prove the same, it reverts
219:             if (sameTransition) revert L1_ALREADY_PROVED();
220: 
221:             if (isTopTier) {
222:                 // The top tier prover re-proves.
223:                 assert(tier.validityBond == 0);
224:                 assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0));
225: 
226:                 ts.prover = msg.sender;
227:                 ts.blockHash = _tran.blockHash;
228:                 ts.stateRoot = _tran.stateRoot;
229: 
230:                 emit TransitionProved({
231:                     blockId: blk.blockId,
232:                     tran: _tran,
233:                     prover: msg.sender,
234:                     validityBond: 0,
235:                     tier: _proof.tier
236:                 });
237:             } else {
238:                 // Contesting but not on the highest tier
239:                 if (ts.contester != address(0)) revert L1_ALREADY_CONTESTED();
240: 
241:                 // Burn the contest bond from the prover.
242:                 tko.transferFrom(msg.sender, address(this), tier.contestBond);
243: 
244:                 // We retain the contest bond within the transition, just in
245:                 // case this configuration is altered to a different value
246:                 // before the contest is resolved.
247:                 //
248:                 // It's worth noting that the previous value of ts.contestBond
249:                 // doesn't have any significance.
250:                 ts.contestBond = tier.contestBond;
251:                 ts.contester = msg.sender;
252:                 ts.contestations += 1;
253: 
254:                 emit TransitionContested({
255:                     blockId: blk.blockId,
256:                     tran: _tran,
257:                     contester: msg.sender,
258:                     contestBond: tier.contestBond,
259:                     tier: _proof.tier
260:                 });
261:             }
262:         }
263: 
264:         ts.timestamp = uint64(block.timestamp);
265:         return tier.maxBlocksToVerifyPerProof;
266:     }

350:     function _overrideWithHigherProof(
351:         TaikoData.TransitionState storage _ts,
352:         TaikoData.Transition memory _tran,
353:         TaikoData.TierProof memory _proof,
354:         ITierProvider.Tier memory _tier,
355:         IERC20 _tko,
356:         bool _sameTransition
357:     )
358:         private
359:     {
360:         // Higher tier proof overwriting lower tier proof
361:         uint256 reward;
362: 
363:         if (_ts.contester != address(0)) {
364:             if (_sameTransition) {
365:                 // The contested transition is proven to be valid, contestor loses the game
366:                 reward = _ts.contestBond >> 2;
367:                 _tko.transfer(_ts.prover, _ts.validityBond + reward);
368:             } else {
369:                 // The contested transition is proven to be invalid, contestor wins the game
370:                 reward = _ts.validityBond >> 2;
371:                 _tko.transfer(_ts.contester, _ts.contestBond + reward);
372:             }
373:         } else {
374:             if (_sameTransition) revert L1_ALREADY_PROVED();
375:             // Contest the existing transition and prove it to be invalid
376:             reward = _ts.validityBond >> 1;
377:             _ts.contestations += 1;
378:         }
379: 
380:         unchecked {
381:             if (reward > _tier.validityBond) {
382:                 _tko.transfer(msg.sender, reward - _tier.validityBond);
383:             } else {
384:                 _tko.transferFrom(msg.sender, address(this), _tier.validityBond - reward);
385:             }
386:         }
387: 
388:         _ts.validityBond = _tier.validityBond;
389:         _ts.contestBond = 1; // to save gas
390:         _ts.contester = address(0);
391:         _ts.prover = msg.sender;
392:         _ts.tier = _proof.tier;
393: 
394:         if (!_sameTransition) {
395:             _ts.blockHash = _tran.blockHash;
396:             _ts.stateRoot = _tran.stateRoot;
397:         }
398:     }

401:     function _checkProverPermission(
402:         TaikoData.State storage _state,
403:         TaikoData.Block storage _blk,
404:         TaikoData.TransitionState storage _ts,
405:         uint32 _tid,
406:         ITierProvider.Tier memory _tier
407:     )
408:         private
409:         view
410:     {
411:         // The highest tier proof can always submit new proofs
412:         if (_tier.contestBond == 0) return;
413: 
414:         bool inProvingWindow = uint256(_ts.timestamp).max(_state.slotB.lastUnpausedAt)
415:             + _tier.provingWindow * 60 >= block.timestamp;
416:         bool isAssignedPover = msg.sender == _blk.assignedProver;
417: 
418:         // The assigned prover can only submit the very first transition.
419:         if (_tid == 1 && _ts.tier == 0 && inProvingWindow) {
420:             if (!isAssignedPover) revert L1_NOT_ASSIGNED_PROVER();
421:         } else {
422:             // Disallow the same address to prove the block so that we can detect that the
423:             // assigned prover should not receive his liveness bond back
424:             if (isAssignedPover) revert L1_ASSIGNED_PROVER_NOT_ALLOWED();
425:         }
426:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L266) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L350-L398), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L401-L426)


```solidity

File: /contracts/signal/SignalService.sol

206:     function _verifyHopProof(
207:         uint64 _chainId,
208:         address _app,
209:         bytes32 _signal,
210:         bytes32 _value,
211:         HopProof memory _hop,
212:         address _signalService
213:     )
214:         internal
215:         virtual
216:         validSender(_app)
217:         nonZeroValue(_signal)
218:         nonZeroValue(_value)
219:         returns (bytes32)
220:     {
221:         return LibTrieProof.verifyMerkleProof(
222:             _hop.rootHash,
223:             _signalService,
224:             getSignalSlot(_chainId, _app, _signal),
225:             _value,
226:             _hop.accountProof,
227:             _hop.storageProof
228:         );
229:     }

271:     function _cacheChainData(
272:         HopProof memory _hop,
273:         uint64 _chainId,
274:         uint64 _blockId,
275:         bytes32 _signalRoot,
276:         bool _isFullProof,
277:         bool _isLastHop
278:     )
279:         private
280:     {
281:         // cache state root
282:         bool cacheStateRoot = _hop.cacheOption == CacheOption.CACHE_BOTH
283:             || _hop.cacheOption == CacheOption.CACHE_STATE_ROOT;
284: 
285:         if (cacheStateRoot && _isFullProof && !_isLastHop) {
286:             _syncChainData(_chainId, LibSignals.STATE_ROOT, _blockId, _hop.rootHash);
287:         }
288: 
289:         // cache signal root
290:         bool cacheSignalRoot = _hop.cacheOption == CacheOption.CACHE_BOTH
291:             || _hop.cacheOption == CacheOption.CACHE_SIGNAL_ROOT;
292: 
293:         if (cacheSignalRoot && (_isFullProof || !_isLastHop)) {
294:             _syncChainData(_chainId, LibSignals.SIGNAL_ROOT, _blockId, _signalRoot);
295:         }
296:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L229) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L271-L296)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

52:     function init(
53:         address _owner,
54:         address _addressManager,
55:         address _srcToken,
56:         uint256 _srcChainId,
57:         uint8 _decimals,
58:         string memory _symbol,
59:         string memory _name
60:     )
61:         external
62:         initializer
63:     {
64:         // Check if provided parameters are valid
65:         LibBridgedToken.validateInputs(_srcToken, _srcChainId, _symbol, _name);
66:         __Essential_init(_owner, _addressManager);
67:         __ERC20_init(_name, _symbol);
68:         __ERC20Snapshot_init();
69:         __ERC20Votes_init();
70:         __ERC20Permit_init(_name);
71: 
72:         // Set contract properties
73:         srcToken = _srcToken;
74:         srcChainId = _srcChainId;
75:         __srcDecimals = _decimals;
76:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L52-L76) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

31:     function init(
32:         address _owner,
33:         address _addressManager,
34:         address _srcToken,
35:         uint256 _srcChainId,
36:         string memory _symbol,
37:         string memory _name
38:     )
39:         external
40:         initializer
41:     {
42:         // Check if provided parameters are valid
43:         LibBridgedToken.validateInputs(_srcToken, _srcChainId, _symbol, _name);
44:         __Essential_init(_owner, _addressManager);
45:         __ERC721_init(_name, _symbol);
46: 
47:         srcToken = _srcToken;
48:         srcChainId = _srcChainId;
49:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L31-L49) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

38:     function init(
39:         address _owner,
40:         address _addressManager,
41:         address _srcToken,
42:         uint256 _srcChainId,
43:         string memory _symbol,
44:         string memory _name
45:     )
46:         external
47:         initializer
48:     {
49:         // Check if provided parameters are valid.
50:         // The symbol and the name can be empty for ERC1155 tokens so we use some placeholder data
51:         // for them instead.
52:         LibBridgedToken.validateInputs(_srcToken, _srcChainId, "foo", "foo");
53:         __Essential_init(_owner, _addressManager);
54:         __ERC1155_init(LibBridgedToken.buildURI(_srcToken, _srcChainId));
55: 
56:         srcToken = _srcToken;
57:         srcChainId = _srcChainId;
58:         __symbol = _symbol;
59:         __name = _name;
60:     }

125:     function _beforeTokenTransfer(
126:         address, /*_operator*/
127:         address, /*_from*/
128:         address _to,
129:         uint256[] memory, /*_ids*/
130:         uint256[] memory, /*_amounts*/
131:         bytes memory /*_data*/
132:     )
133:         internal
134:         virtual
135:         override
136:     {
137:         if (_to == address(this)) revert BTOKEN_CANNOT_RECEIVE();
138:         if (paused()) revert INVALID_PAUSE_STATUS();
139:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L38-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L139)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

160:     function onERC1155BatchReceived(
161:         address,
162:         address,
163:         uint256[] calldata,
164:         uint256[] calldata,
165:         bytes calldata
166:     )
167:         external
168:         pure
169:         returns (bytes4)
170:     {
171:         return IERC1155ReceiverUpgradeable.onERC1155BatchReceived.selector;
172:     }

175:     function onERC1155Received(
176:         address,
177:         address,
178:         uint256,
179:         uint256,
180:         bytes calldata
181:     )
182:         external
183:         pure
184:         returns (bytes4)
185:     {
186:         return IERC1155ReceiverUpgradeable.onERC1155Received.selector;
187:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L160-L172) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L175-L187)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25:     function excessivelySafeCall(
26:         address _target,
27:         uint256 _gas,
28:         uint256 _value,
29:         uint16 _maxCopy,
30:         bytes memory _calldata
31:     )
32:         internal
33:         returns (bool, bytes memory)
34:     {
35:         // set up for assembly call
36:         uint256 _toCopy;
37:         bool _success;
38:         bytes memory _returnData = new bytes(_maxCopy);
39:         // dispatch message to recipient
40:         // by assembly calling "handle" function
41:         // we call via assembly to avoid memcopying a very large returndata
42:         // returned by a malicious contract
43:         assembly {
44:             _success :=
45:                 call(
46:                     _gas, // gas
47:                     _target, // recipient
48:                     _value, // ether value
49:                     add(_calldata, 0x20), // inloc
50:                     mload(_calldata), // inlen
51:                     0, // outloc
52:                     0 // outlen
53:                 )
54:             // limit our copy to 256 bytes
55:             _toCopy := returndatasize()
56:             if gt(_toCopy, _maxCopy) { _toCopy := _maxCopy }
57:             // Store the length of the copied bytes
58:             mstore(_returnData, _toCopy)
59:             // copy the bytes from returndata[0:_toCopy]
60:             returndatacopy(add(_returnData, 0x20), 0, _toCopy)
61:         }
62:         return (_success, _returnData);
63:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L63) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

27:     function init(
28:         address _owner,
29:         uint64 _claimStart,
30:         uint64 _claimEnd,
31:         bytes32 _merkleRoot,
32:         address _token,
33:         address _vault
34:     )
35:         external
36:         initializer
37:     {
38:         __Essential_init(_owner);
39:         __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);
40: 
41:         token = _token;
42:         vault = _vault;
43:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L27-L43) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

54:     function init(
55:         address _owner,
56:         uint64 _claimStart,
57:         uint64 _claimEnd,
58:         bytes32 _merkleRoot,
59:         address _token,
60:         address _vault,
61:         uint64 _withdrawalWindow
62:     )
63:         external
64:         initializer
65:     {
66:         __Essential_init(_owner);
67:         __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);
68: 
69:         token = _token;
70:         vault = _vault;
71:         withdrawalWindow = _withdrawalWindow;
72:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L72) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

25:     function init(
26:         address _owner,
27:         uint64 _claimStart,
28:         uint64 _claimEnd,
29:         bytes32 _merkleRoot,
30:         address _token,
31:         address _vault
32:     )
33:         external
34:         initializer
35:     {
36:         __Essential_init(_owner);
37:         __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);
38: 
39:         token = _token;
40:         vault = _vault;
41:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L25-L41) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

056:     function compare(
057:         bytes memory self,
058:         uint256 offset,
059:         uint256 len,
060:         bytes memory other,
061:         uint256 otheroffset,
062:         uint256 otherlen
063:     )
064:         internal
065:         pure
066:         returns (int256)
067:     {
068:         uint256 shortest = len;
069:         if (otherlen < len) {
070:             shortest = otherlen;
071:         }
072: 
073:         uint256 selfptr;
074:         uint256 otherptr;
075: 
076:         assembly {
077:             selfptr := add(self, add(offset, 32))
078:             otherptr := add(other, add(otheroffset, 32))
079:         }
080:         for (uint256 idx = 0; idx < shortest; idx += 32) {
081:             uint256 a;
082:             uint256 b;
083:             assembly {
084:                 a := mload(selfptr)
085:                 b := mload(otherptr)
086:             }
087:             if (a != b) {
088:                 // Mask out irrelevant bytes and check again
089:                 uint256 mask;
090:                 if (shortest > 32) {
091:                     mask = type(uint256).max; // aka 0xffffff....
092:                 } else {
093:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);
094:                 }
095:                 uint256 diff = (a & mask) - (b & mask);
096:                 if (diff != 0) {
097:                     return int256(diff);
098:                 }
099:             }
100:             selfptr += 32;
101:             otherptr += 32;
102:         }
103: 
104:         return int256(len) - int256(otherlen);
105:     }

116:     function equals(
117:         bytes memory self,
118:         uint256 offset,
119:         bytes memory other,
120:         uint256 otherOffset,
121:         uint256 len
122:     )
123:         internal
124:         pure
125:         returns (bool)
126:     {
127:         return keccak(self, offset, len) == keccak(other, otherOffset, len);
128:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L105) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L128)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

34:     function toUnixTimestamp(
35:         uint16 year,
36:         uint8 month,
37:         uint8 day,
38:         uint8 hour,
39:         uint8 minute,
40:         uint8 second
41:     )
42:         internal
43:         pure
44:         returns (uint256)
45:     {
46:         uint256 timestamp = 0;
47: 
48:         for (uint16 i = 1970; i < year; ++i) {
49:             if (isLeapYear(i)) {
50:                 timestamp += 31_622_400; // Leap year in seconds
51:             } else {
52:                 timestamp += 31_536_000; // Normal year in seconds
53:             }
54:         }
55: 
56:         uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
57:         if (isLeapYear(year)) monthDays[1] = 29;
58: 
59:         for (uint8 i = 1; i < month; ++i) {
60:             timestamp += uint256(monthDays[i - 1]) * 86_400; // Days in seconds
61:         }
62: 
63:         timestamp += uint256(day - 1) * 86_400; // Days in seconds
64:         timestamp += uint256(hour) * 3600; // Hours in seconds
65:         timestamp += uint256(minute) * 60; // Minutes in seconds
66:         timestamp += second;
67: 
68:         return timestamp;
69:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L69) 


</details>


### [NC&#x2011;98] Use custom errors rather than `revert()`/`require()` strings for better readability 
Custom errors are available from solidity version 0.8.4. Custom errors are more easily processed in try-catch blocks, and are easier to re-use and maintain.


*There are 60 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/thirdparty/optimism/Bytes.sol

25:             require(_length + 31 >= _length, "slice_overflow");

26:             require(_start + _length >= _start, "slice_overflow");

27:             require(_bytes.length >= _start + _length, "slice_outOfBounds");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L27-L27)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

37:         require(
38:             _in.length > 0,
39:             "RLPReader: length of an RLP item must be greater than zero to be decodable"
40:         );

56:         require(
57:             itemType == RLPItemType.LIST_ITEM,
58:             "RLPReader: decoded item type for list is not a list item"
59:         );

61:         require(
62:             listOffset + listLength == _in.length,
63:             "RLPReader: list item has an invalid data remainder"
64:         );

112:         require(
113:             itemType == RLPItemType.DATA_ITEM,
114:             "RLPReader: decoded item type for bytes is not a data item"
115:         );

117:         require(
118:             _in.length == itemOffset + itemLength,
119:             "RLPReader: bytes value contains an invalid remainder"
120:         );

152:         require(
153:             _in.length > 0,
154:             "RLPReader: length of an RLP item must be greater than zero to be decodable"
155:         );

172:             require(
173:                 _in.length > strLen,
174:                 "RLPReader: length of content must be greater than string length (short string)"
175:             );

182:             require(
183:                 strLen != 1 || firstByteOfContent >= 0x80,
184:                 "RLPReader: invalid prefix, single byte < 0x80 are not prefixed (short string)"
185:             );

192:             require(
193:                 _in.length > lenOfStrLen,
194:                 "RLPReader: length of content must be > than length of string length (long string)"
195:             );

202:             require(
203:                 firstByteOfContent != 0x00,
204:                 "RLPReader: length of content must not have any leading zeros (long string)"
205:             );

212:             require(
213:                 strLen > 55,
214:                 "RLPReader: length of content must be greater than 55 bytes (long string)"
215:             );

217:             require(
218:                 _in.length > lenOfStrLen + strLen,
219:                 "RLPReader: length of content must be greater than total length (long string)"
220:             );

238:             require(
239:                 _in.length > lenOfListLen,
240:                 "RLPReader: length of content must be > than length of list length (long list)"
241:             );

248:             require(
249:                 firstByteOfContent != 0x00,
250:                 "RLPReader: length of content must not have any leading zeros (long list)"
251:             );

258:             require(
259:                 listLen > 55,
260:                 "RLPReader: length of content must be greater than 55 bytes (long list)"
261:             );

263:             require(
264:                 _in.length > lenOfListLen + listLen,
265:                 "RLPReader: length of content must be greater than total length (long list)"
266:             );

228:             require(
229:                 _in.length > listLen,
230:                 "RLPReader: length of content must be greater than list length (short list)"
231:             );


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L37-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L56-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L61-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L112-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L117-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L152-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L172-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L182-L185), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L192-L195), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L202-L205), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L212-L215), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L217-L220), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L238-L241), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L248-L251), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L258-L261), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L263-L266), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L228-L231)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

77:         require(_key.length > 0, "MerkleTrie: empty key");

89:             require(currentKeyIndex <= key.length, "MerkleTrie: key index exceeds total key length");

93:                 require(
94:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
95:                     "MerkleTrie: invalid root hash"
96:                 );

105:                 require(
106:                     Bytes.equal(currentNode.encoded, currentNodeID),
107:                     "MerkleTrie: invalid internal node hash"
108:                 );

099:                 require(
100:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
101:                     "MerkleTrie: invalid large internal hash"
102:                 );

150:                 require(
151:                     pathRemainder.length == sharedNibbleLength,
152:                     "MerkleTrie: path remainder must share all nibbles with key"
153:                 );

119:                     require(
120:                         value_.length > 0,
121:                         "MerkleTrie: value length must be greater than zero (branch)"
122:                     );

125:                     require(
126:                         i == proof.length - 1,
127:                         "MerkleTrie: value node must be last node in proof (branch)"
128:                     );

162:                     require(
163:                         keyRemainder.length == sharedNibbleLength,
164:                         "MerkleTrie: key remainder must be identical to path remainder"
165:                     );

172:                     require(
173:                         value_.length > 0,
174:                         "MerkleTrie: value length must be greater than zero (leaf)"
175:                     );

178:                     require(
179:                         i == proof.length - 1,
180:                         "MerkleTrie: value node must be last node in proof (leaf)"
181:                     );


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L77-L77) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L89-L89), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L93-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L105-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L99-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L150-L153), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L119-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L125-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L162-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L172-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L178-L181)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

61:         require(msg.sender == owner, "onlyOwner");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L61-L61) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

77:         require(
78:             localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
79:                 && localEnclaveReport.reportData.length == 64,
80:             "local QE report has wrong length"
81:         );

82:         require(
83:             pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
84:                 && pckSignedQeReport.reportData.length == 64,
85:             "QE report has wrong length"
86:         );

87:         require(
88:             v3Quote.v3AuthData.certification.certType == 5,
89:             "certType must be 5: Concatenated PCK Cert Chain (PEM formatted)"
90:         );

91:         require(
92:             v3Quote.v3AuthData.certification.decodedCertDataArray.length == 3, "3 certs in chain"
93:         );

94:         require(
95:             v3Quote.v3AuthData.ecdsa256BitSignature.length == 64
96:                 && v3Quote.v3AuthData.ecdsaAttestationKey.length == 64
97:                 && v3Quote.v3AuthData.qeReportSignature.length == 64,
98:             "Invalid ECDSA signature format"
99:         );

100:         require(
101:             v3Quote.v3AuthData.qeAuthData.parsedDataSize
102:                 == v3Quote.v3AuthData.qeAuthData.data.length,
103:             "Invalid QEAuthData size"
104:         );

116:         require(totalQuoteSize >= MINIMUM_QUOTE_LENGTH, "Invalid quote size");

279:         require(certParsedSuccessfully, "splitCertificateChain failed");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L77-L81) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L82-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L87-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L91-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L94-L99), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L100-L104), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L279-L279)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

57:         require(der[ptr.ixs()] == 0x03, "Not type BIT STRING");

67:         require(der[ptr.ixs()] == 0x04, "Not type OCTET STRING");

88:         require(der[ptr.ixs()] & 0x20 == 0x20, "Not a constructed type");

142:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

155:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

156:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");

180:         require(der[ptr.ixs()] == 0x03, "ixs Not type BIT STRING 0x03");

182:         require(der[ptr.ixf()] == 0x00, "ixf Not 0");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L142-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L155-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L156-L156), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L182-L182)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

25:         require(offset + len <= self.length, "invalid offset");

199:         require(idx + 2 <= self.length, "invalid idx");

212:         require(idx + 4 <= self.length, "unexpected idx");

225:         require(idx + 32 <= self.length, "unexpected idx");

238:         require(idx + 20 <= self.length, "unexpected idx");

264:         require(len <= 32, "unexpected len");

265:         require(idx + len <= self.length, "unexpected idx");

293:         require(offset + len <= self.length, "unexpected offset");

329:         require(len <= 52, "unexpected len");

335:             require(char >= 0x30 && char <= 0x7A, "invalid char");

337:             require(decoded <= 0x20, "invalid decoded");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L199-L199), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L238-L238), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L265-L265), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L293-L293), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L329-L329), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L335-L335), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L337-L337)


</details>


### [NC&#x2011;99] Use `@inheritdoc` for overridden functions 



*There are 43 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58) 


```solidity

File: /contracts/common/EssentialContract.sol

114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

47:     /// @dev See {IGovernor-propose}

61:     /// @notice An overwrite of GovernorCompatibilityBravoUpgradeable's propose() as that one does
62:     /// not check that the length of signatures equal the calldata.
63:     /// @dev See vulnerability description here:
64:     /// https://github.com/taikoxyz/taiko-mono/security/dependabot/114
65:     /// See fix in OZ 4.8.3 here (URL broken down for readability):
66:     /// https://github.com/OpenZeppelin/openzeppelin-contracts/blob/
67:     /// 0a25c1940ca220686588c4af3ec526f725fe2582/contracts/governance/compatibility/GovernorCompatibilityBravo.sol#L72
68:     /// See {GovernorCompatibilityBravoUpgradeable-propose}

88:     /// @dev See {GovernorUpgradeable-supportsInterface}

98:     /// @dev See {GovernorUpgradeable-state}

108:     /// @notice How long after a proposal is created should voting power be fixed. A
109:     /// large voting delay gives users time to unstake tokens if necessary.
110:     /// @return The duration of the voting delay.

115:     /// @notice How long does a proposal remain open to votes.
116:     /// @return The duration of the voting period.

121:     /// @notice The number of votes required in order for a voter to become a proposer.
122:     /// @return The number of votes required.

127:     function _execute(

140:     function _cancel(

153:     function _executor()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L61-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L108-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L115-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L121-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L153-L153)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

21:     /// @dev Gets the minimum delay for an operation to become valid, allows the admin to get around
22:     /// of the min delay.
23:     /// @return The minimum delay.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L21-L23) 


```solidity

File: /contracts/L1/TaikoL1.sol

220:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L220) 


```solidity

File: /contracts/L1/TaikoToken.sol

56:     /// @notice Transfers tokens to a specified address.
57:     /// @param _to The address to transfer tokens to.
58:     /// @param _amount The amount of tokens to transfer.
59:     /// @return A boolean indicating whether the transfer was successful or not.

65:     /// @notice Transfers tokens from one address to another.
66:     /// @param _from The address to transfer tokens from.
67:     /// @param _to The address to transfer tokens to.
68:     /// @param _amount The amount of tokens to transfer.
69:     /// @return A boolean indicating whether the transfer was successful or not.

83:     function _beforeTokenTransfer(

94:     function _afterTokenTransfer(

105:     function _mint(

115:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L56-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L65-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L83-L83), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L115-L115)


```solidity

File: /contracts/signal/SignalService.sol

231:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231) 


```solidity

File: /contracts/bridge/Bridge.sol

460:     /// @notice Checks if the given address can pause and unpause the bridge.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L460-L460) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

43:     function _mintToken(address _account, uint256 _amount) internal override {

47:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

89:     /// @notice Gets the name of the token.
90:     /// @return The name.

100:     /// @notice Gets the symbol of the bridged token.
101:     /// @return The symbol.

111:     /// @notice Gets the number of decimal places of the token.
112:     /// @return The number of decimal places of the token.

129:     function _mintToken(address _account, uint256 _amount) internal override {

133:     function _burnToken(address _from, uint256 _amount) internal override {

137:     /// @dev For ERC20SnapshotUpgradeable and ERC20VotesUpgradeable, need to implement the following
138:     /// functions

152:     function _afterTokenTransfer(

163:     function _mint(

173:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L89-L90) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L100-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L111-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L137-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L173)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

91:     /// @notice Returns the owner.
92:     /// @return The address of the owner.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L91-L92) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

85:     /// @notice Gets the name of the token.
86:     /// @return The name.

91:     /// @notice Gets the symbol of the bridged token.
92:     /// @return The symbol.

104:     /// @notice Returns the token URI.
105:     /// @param _tokenId The token id.
106:     /// @return The token URI following EIP-681.

115:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L85-L86) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L91-L92), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L104-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L115)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

125:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L125) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

36:     /// @notice Checks if the contract supports the given interface.
37:     /// @param _interfaceId The interface identifier.
38:     /// @return true if the contract supports the interface, false otherwise.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L36-L38) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

189:     /// @dev See {BaseVault-supportsInterface}.
190:     /// @param interfaceId The interface identifier.
191:     /// @return true if supports, else otherwise.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L189-L191) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {

336:     /// @dev Provide the parsed quote binary as input
337:     /// @dev The attestation data (or the returned data of this method)
338:     /// is constructed depending on the validity of the quote verification.
339:     /// @dev After confirming that a quote has been verified, the attestation's validity then
340:     /// depends on the
341:     /// status of the associated TCB.
342:     /// @dev Example scenarios as below:
343:     /// --------------------------------
344:     /// @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
345:     ///
346:     /// @dev For all valid quote verification, the validity of the attestation depends on the status
347:     /// of a
348:     /// matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
349:     /// overwritten
350:     /// in derived contracts. (Except for "Revoked" status, which also returns (false,
351:     /// INVALID_EXIT_CODE) value)
352:     /// @dev For all valid quote verification, returns the following data:
353:     /// (_attestationTcbIsValid())
354:     /// @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L138) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L336-L354)


</details>


### [NC&#x2011;100] Multiple mappings with same keys can be combined into a single struct mapping for readability 
Well-organized data structures make code reviews easier, which may lead to fewer bugs. Consider combining related mappings into mappings to structs, so it's clear what data is related.


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/BaseNFTVault.sol

56:     mapping(address btoken => CanonicalNFT canonical) public bridgedToCanonical;

59:     mapping(uint256 chainId => mapping(address ctoken => address btoken)) public canonicalToBridged;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L59-L59)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

45:     mapping(address btoken => CanonicalERC20 canonical) public bridgedToCanonical;

49:     mapping(uint256 chainId => mapping(address ctoken => address btoken)) public canonicalToBridged;

52:     mapping(address btoken => bool blacklisted) public btokenBlacklist;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L52-L52)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

22:     mapping(address addr => uint256 amountClaimed) public claimedAmount;

25:     mapping(address addr => uint256 amountWithdrawn) public withdrawnAmount;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L25-L25)


</details>


### [NC&#x2011;101] constructor should emit an event 
Use events to signal significant changes to off-chain monitoring tools.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

64:     constructor() {
65:         _disableInitializers();
66:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L64-L66) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

54:     constructor(address sigVerifyLibAddr, address pemCertLibAddr) {
55:         sigVerifyLib = ISigVerifyLib(sigVerifyLibAddr);
56:         pemCertLib = PEMCertChainLib(pemCertLibAddr);
57:         owner = msg.sender;
58:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54-L58) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

20:     constructor(address es256Verifier) {
21:         ES256VERIFIER = es256Verifier;
22:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L20-L22) 


</details>


### [NC&#x2011;102] `error` should be named using CapWords style 
See the [Solidity Style](https://docs.soliditylang.org/en/latest/style-guide.html#struct-names) Guide for more info.


*There are 156 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

25:     error AM_INVALID_PARAMS();

26:     error AM_UNSUPPORTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L26-L26)


```solidity

File: /contracts/common/EssentialContract.sol

35:     error REENTRANT_CALL();

36:     error INVALID_PAUSE_STATUS();

37:     error ZERO_ADDR_MANAGER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L37-L37)


```solidity

File: /contracts/libs/Lib4844.sol

19:     error EVAL_FAILED_1();

20:     error EVAL_FAILED_2();

21:     error POINT_X_TOO_LARGE();

22:     error POINT_Y_TOO_LARGE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L22-L22)


```solidity

File: /contracts/libs/LibAddress.sol

16:     error ETH_TRANSFER_FAILED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L16-L16) 


```solidity

File: /contracts/libs/LibTrieProof.sol

20:     error LTP_INVALID_ACCOUNT_PROOF();

21:     error LTP_INVALID_INCLUSION_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L21-L21)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

25:     error TG_INVALID_SIGNATURES_LENGTH();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L25-L25) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

50:     error HOOK_ASSIGNMENT_EXPIRED();

51:     error HOOK_ASSIGNMENT_INVALID_SIG();

52:     error HOOK_TIER_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L52-L52)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

22:     error L1_INVALID_ETH_DEPOSIT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L22-L22) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

44:     error L1_BLOB_FOR_DA_DISABLED();

45:     error L1_BLOB_NOT_FOUND();

46:     error L1_BLOB_NOT_REUSABLE();

47:     error L1_BLOB_REUSE_DISABLED();

48:     error L1_INVALID_HOOK();

49:     error L1_INVALID_PARAM();

50:     error L1_INVALID_PROVER();

51:     error L1_LIVENESS_BOND_NOT_RECEIVED();

52:     error L1_PROPOSER_NOT_EOA();

53:     error L1_TOO_MANY_BLOCKS();

54:     error L1_TXLIST_OFFSET();

55:     error L1_TXLIST_SIZE();

56:     error L1_UNAUTHORIZED();

57:     error L1_UNEXPECTED_PARENT();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L50-L50), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L57-L57)


```solidity

File: /contracts/L1/libs/LibProving.sol

59:     error L1_ALREADY_CONTESTED();

60:     error L1_ALREADY_PROVED();

61:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

62:     error L1_BLOCK_MISMATCH();

63:     error L1_INVALID_BLOCK_ID();

64:     error L1_INVALID_PAUSE_STATUS();

65:     error L1_INVALID_TIER();

66:     error L1_INVALID_TRANSITION();

67:     error L1_MISSING_VERIFIER();

68:     error L1_NOT_ASSIGNED_PROVER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L68-L68)


```solidity

File: /contracts/L1/libs/LibUtils.sol

11:     error L1_BLOCK_MISMATCH();

12:     error L1_INVALID_BLOCK_ID();

13:     error L1_TRANSITION_NOT_FOUND();

14:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L14-L14)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

39:     error L1_BLOCK_MISMATCH();

40:     error L1_INVALID_CONFIG();

41:     error L1_TRANSITION_ID_ZERO();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L41-L41)


```solidity

File: /contracts/L1/provers/Guardians.sol

45:     error INVALID_GUARDIAN();

46:     error INVALID_GUARDIAN_SET();

47:     error INVALID_MIN_GUARDIANS();

48:     error INVALID_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L46-L46), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L48-L48)


```solidity

File: /contracts/L1/TaikoErrors.sol

12:     error L1_ALREADY_CONTESTED();

13:     error L1_ALREADY_PROVED();

14:     error L1_ASSIGNED_PROVER_NOT_ALLOWED();

15:     error L1_BLOB_FOR_DA_DISABLED();

16:     error L1_BLOB_NOT_FOUND();

17:     error L1_BLOB_NOT_REUSABLE();

18:     error L1_BLOB_REUSE_DISABLED();

19:     error L1_BLOCK_MISMATCH();

20:     error L1_INVALID_BLOCK_ID();

21:     error L1_INVALID_CONFIG();

22:     error L1_INVALID_ETH_DEPOSIT();

23:     error L1_INVALID_HOOK();

24:     error L1_INVALID_PARAM();

25:     error L1_INVALID_PAUSE_STATUS();

26:     error L1_INVALID_PROVER();

27:     error L1_INVALID_TIER();

28:     error L1_INVALID_TRANSITION();

29:     error L1_LIVENESS_BOND_NOT_RECEIVED();

30:     error L1_NOT_ASSIGNED_PROVER();

31:     error L1_PROPOSER_NOT_EOA();

32:     error L1_PROVING_PAUSED();

33:     error L1_RECEIVE_DISABLED();

34:     error L1_MISSING_VERIFIER();

35:     error L1_TOO_MANY_BLOCKS();

36:     error L1_TOO_MANY_TIERS();

37:     error L1_TRANSITION_ID_ZERO();

38:     error L1_TRANSITION_NOT_FOUND();

39:     error L1_TXLIST_SIZE();

40:     error L1_UNAUTHORIZED();

41:     error L1_UNEXPECTED_PARENT();

42:     error L1_UNEXPECTED_TRANSITION_ID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L14-L14), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L15-L15), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L16-L16), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L20-L20), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L35-L35), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L36-L36), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L37-L37), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoErrors.sol#L42-L42)


```solidity

File: /contracts/L1/TaikoToken.sol

18:     error TKO_INVALID_ADDR();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L18-L18) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

17:     error TIER_NOT_FOUND();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L17-L17) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

28:     error XCO_INVALID_OWNER_CHAINID();

29:     error XCO_INVALID_TX_ID();

30:     error XCO_PERMISSION_DENIED();

31:     error XCO_TX_REVERTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L28-L28) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L31-L31)


```solidity

File: /contracts/L2/Lib1559Math.sol

11:     error EIP1559_INVALID_PARAMS();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L11-L11) 


```solidity

File: /contracts/L2/TaikoL2.sol

59:     error L2_BASEFEE_MISMATCH();

60:     error L2_INVALID_CHAIN_ID();

61:     error L2_INVALID_PARAM();

62:     error L2_INVALID_SENDER();

63:     error L2_PUBLIC_INPUT_HASH_MISMATCH();

64:     error L2_TOO_LATE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L64-L64)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

20:     error L2_INVALID_CONFIG();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L20-L20) 


```solidity

File: /contracts/signal/SignalService.sol

25:     error SS_EMPTY_PROOF();

26:     error SS_INVALID_SENDER();

27:     error SS_INVALID_LAST_HOP_CHAINID();

28:     error SS_INVALID_MID_HOP_CHAINID();

29:     error SS_INVALID_STATE();

30:     error SS_INVALID_VALUE();

31:     error SS_SIGNAL_NOT_FOUND();

32:     error SS_UNAUTHORIZED();

33:     error SS_UNSUPPORTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L25-L25) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L26-L26), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L27-L27), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L31-L31), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L33-L33)


```solidity

File: /contracts/bridge/Bridge.sol

50:     error B_INVALID_CHAINID();

51:     error B_INVALID_CONTEXT();

52:     error B_INVALID_GAS_LIMIT();

53:     error B_INVALID_STATUS();

54:     error B_INVALID_USER();

55:     error B_INVALID_VALUE();

56:     error B_MESSAGE_NOT_SENT();

57:     error B_NON_RETRIABLE();

58:     error B_NOT_FAILED();

59:     error B_NOT_RECEIVED();

60:     error B_PERMISSION_DENIED();

61:     error B_STATUS_MISMATCH();

62:     error B_INVOCATION_TOO_EARLY();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L50-L50) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L55-L55), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L62-L62)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

34:     error BTOKEN_CANNOT_RECEIVE();

35:     error BTOKEN_UNAUTHORIZED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L34-L34) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L35-L35)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

29:     error BB_PERMISSION_DENIED();

30:     error BB_INVALID_PARAMS();

31:     error BB_MINT_DISALLOWED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L31-L31)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

21:     error BTOKEN_CANNOT_RECEIVE();

22:     error BTOKEN_INVALID_BURN();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L22-L22)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

29:     error BTOKEN_CANNOT_RECEIVE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L29-L29) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

133:     error VAULT_INVALID_TOKEN();

134:     error VAULT_INVALID_AMOUNT();

135:     error VAULT_INVALID_TO();

136:     error VAULT_INTERFACE_NOT_SUPPORTED();

137:     error VAULT_TOKEN_ARRAY_MISMATCH();

138:     error VAULT_MAX_TOKEN_PER_TXN_EXCEEDED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L133-L133) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L134-L134), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L136-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L138-L138)


```solidity

File: /contracts/tokenvault/BaseVault.sol

20:     error VAULT_PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L20-L20) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

136:     error VAULT_BTOKEN_BLACKLISTED();

137:     error VAULT_CTOKEN_MISMATCH();

138:     error VAULT_INVALID_TOKEN();

139:     error VAULT_INVALID_AMOUNT();

140:     error VAULT_INVALID_NEW_BTOKEN();

141:     error VAULT_INVALID_TO();

142:     error VAULT_NOT_SAME_OWNER();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L136-L136) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L139-L139), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L142-L142)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

9:     error BTOKEN_INVALID_PARAMS();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L9-L9) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

13:     error PERMISSION_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L13-L13) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

74:     error SGX_ALREADY_ATTESTED();

75:     error SGX_INVALID_ATTESTATION();

76:     error SGX_INVALID_INSTANCE();

77:     error SGX_INVALID_PROOF();

78:     error SGX_RA_NOT_SUPPORTED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L78-L78)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

37:     error WITHDRAWALS_NOT_ONGOING();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L37-L37) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

29:     error CLAIM_NOT_ONGOING();

30:     error CLAIMED_ALREADY();

31:     error INVALID_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L29-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L30-L30), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L31-L31)


```solidity

File: /contracts/team/TimelockTokenPool.sol

101:     error ALREADY_GRANTED();

102:     error INVALID_GRANT();

103:     error INVALID_PARAM();

104:     error NOTHING_TO_VOID();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L101-L101) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L104-L104)


</details>


### [NC&#x2011;103] Complex functions should include comments 
Large and/or complex functions should include comments to make them easier to understand and reduce margin for error.


*There are 26 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/Lib4844.sol

30:     function evaluatePoint(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/Lib4844.sol#L30-L30) 


```solidity

File: /contracts/libs/LibTrieProof.sol

34:     function verifyMerkleProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L34-L34) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

137:     function hashAssignment(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L137-L137) 


```solidity

File: /contracts/L1/libs/LibUtils.sol

23:     function getTransition(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L23-L23) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

35:     function approve(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L35-L35) 


```solidity

File: /contracts/L1/TaikoL1.sol

75:     function proveBlock(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L75-L75) 


```solidity

File: /contracts/signal/SignalService.sol

83:     function proveSignalReceived(

206:     function _verifyHopProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L83) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L206)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

407:     function _deployBridgedToken(CanonicalERC20 memory ctoken) private returns (address btoken) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L407-L407) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

187:     function _handleMessage(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L187-L187) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

171:     function getSignedHash(

195:     function _addInstances(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L171-L171) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L195-L195)


```solidity

File: /contracts/team/TimelockTokenPool.sol

245:     function _calcAmount(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L245) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

175:     function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)

206:     function _checkTcbLevels(

303:     function _enclaveReportSigVerification(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175-L175) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L303)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

40:     function splitCertificateChain(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L40) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

21:     function parseInput(

165:     function parseAndVerifyHeader(bytes memory rawHeader)

203:     function parseAuthDataAndVerifyCertType(

244:     function packQEReport(V3Struct.EnclaveReport memory enclaveReport)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L244-L244)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

187:     function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L187-L187) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

284:     function substring(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

24:     function verifyAttStmtSignature(

54:     function verifyCertificateSignature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L54)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8) 


</details>


### [NC&#x2011;104] Make use of Solidiy's `using` keyword 
The directive `using A for B` can be used to attach functions (`A`) as operators to user-defined value types or as member functions to any type (`B`). The member functions receive the object they are called on as their first parameter (like the `self` variable in Python). The operator functions receive operands as parameters.  Doing so improves readability, makes debugging easier, and promotes modularity and reusability in the code.


*There are 107 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/libs/LibAddress.sol

27:         (bool success,) = ExcessivelySafeCall.excessivelySafeCall(

70:         if (Address.isContract(_addr)) {

54:         if (!Address.isContract(_addr)) return false;

73:             return ECDSA.recover(_hash, _sig) == _addr;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L70-L70), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L73-L73)


```solidity

File: /contracts/libs/LibTrieProof.sol

60:         bool verified = SecureMerkleTrie.verifyInclusionProof(

61:             bytes.concat(_slot), RLPWriter.writeUint(uint256(_value)), _storageProof, storageRoot_

48:                 SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash);

52:             RLPReader.RLPItem[] memory accountState = RLPReader.readList(rlpAccount);

55:                 bytes32(RLPReader.readBytes(accountState[_ACCOUNT_FIELD_INDEX_STORAGE_HASH]));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L60-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L61-L61), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L52-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L55-L55)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

83:         return GovernorCompatibilityBravoUpgradeable.propose(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L83-L83) 


```solidity

File: /contracts/L1/libs/LibDepositing.sol

51:             TaikoData.EthDeposit({

88:                 deposits_[i] = TaikoData.EthDeposit({


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L88-L88)


```solidity

File: /contracts/L1/libs/LibProposing.sol

212:         TaikoData.Block memory blk = TaikoData.Block({

114:         deposits_ = LibDepositing.processDeposits(_state, _config, params.coinbase);

121:             meta_ = TaikoData.BlockMetadata({

182:             if (!LibAddress.isSenderEOA()) revert L1_PROPOSER_NOT_EOA();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L212-L212) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L182-L182)


```solidity

File: /contracts/L1/libs/LibProving.sol

278:         tid_ = LibUtils.getTransitionId(_state, _blk, slot, _tran.parentHash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L278-L278) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

133:                 tid = LibUtils.getTransitionId(_state, blk, slot, blockHash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L133-L133) 


```solidity

File: /contracts/L1/TaikoL1.sol

51:         LibVerifying.init(state, getConfig(), _genesisBlockHash);

94:         uint8 maxBlocksToVerify = LibProving.proveBlock(state, config, this, meta, tran, proof);

96:         LibVerifying.verifyBlocks(state, config, this, maxBlocksToVerify);

106:         LibVerifying.verifyBlocks(state, getConfig(), this, _maxBlocksToVerify);

113:         LibProving.pauseProving(state, _pause);

120:         LibDepositing.depositEtherToL2(state, getConfig(), this, _recipient);

133:         return LibDepositing.canDepositEthToL2(state, getConfig(), _amount);

138:         return LibProposing.isBlobReusable(state, getConfig(), _blobHash);

67:         (meta_, deposits_) = LibProposing.proposeBlock(state, config, this, _params, _txList);

70:             LibVerifying.verifyBlocks(state, config, this, config.maxBlocksToVerifyPerProposal);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L113-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L70-L70)


```solidity

File: /contracts/L2/Lib1559Math.sol

45:         return uint256(LibFixedPointMath.exp(int256(input)));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L45-L45) 


```solidity

File: /contracts/L2/TaikoL2.sol

290:             basefee_ = Lib1559Math.basefee(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L290-L290) 


```solidity

File: /contracts/signal/SignalService.sol

221:         return LibTrieProof.verifyMerkleProof(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L221-L221) 


```solidity

File: /contracts/bridge/Bridge.sol

497:             (success_,) = ExcessivelySafeCall.excessivelySafeCall(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L497-L497) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

65:         LibBridgedToken.validateInputs(_srcToken, _srcChainId, _symbol, _name);

97:         return LibBridgedToken.buildName(super.name(), srcChainId);

108:         return LibBridgedToken.buildSymbol(super.symbol());


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L65-L65) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L108-L108)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

43:         LibBridgedToken.validateInputs(_srcToken, _srcChainId, _symbol, _name);

88:         return LibBridgedToken.buildName(super.name(), srcChainId);

94:         return LibBridgedToken.buildSymbol(super.symbol());

110:                 LibBridgedToken.buildURI(srcToken, srcChainId), Strings.toString(_tokenId)

110:                 LibBridgedToken.buildURI(srcToken, srcChainId), Strings.toString(_tokenId)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L110-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L110-L110)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

52:         LibBridgedToken.validateInputs(_srcToken, _srcChainId, "foo", "foo");

116:         return LibBridgedToken.buildName(__name, srcChainId);

122:         return LibBridgedToken.buildSymbol(__symbol);

54:         __ERC1155_init(LibBridgedToken.buildURI(_srcToken, _srcChainId));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L52-L52) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L54-L54)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

263:                 try t.name() returns (string memory _name) {

266:                 try t.symbol() returns (string memory _symbol) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L263-L263) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L266-L266)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

378:             uint256 _balance = t.balanceOf(address(this));

379:             t.safeTransferFrom({ from: msg.sender, to: address(this), value: _amount });

380:             balanceChange_ = t.balanceOf(address(this)) - _balance;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L378-L378) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L379-L379), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L380-L380)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

206:                     symbol: t.symbol(),

207:                     name: t.name()

211:                     t.safeTransferFrom(_user, address(this), _op.tokenIds[i]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L206-L206) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L207-L207), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L211-L211)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

36:         return string.concat("Bridged ", _name, unicode" (b-ï¿½", Strings.toString(_srcChainId), ")");

56:                 Strings.toHexString(uint160(_srcToken), 20),

58:                 Strings.toString(_srcChainId),


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L58-L58)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

80:         bytes memory key = Bytes.toNibbles(_key);

60:         valid_ = Bytes.equal(_value, get(_key, _proof, _root));

228:         nibbles_ = Bytes.toNibbles(RLPReader.readBytes(_node.decoded[0]));

221:         id_ = _node.length < 32 ? RLPReader.readRawBytes(_node) : RLPReader.readBytes(_node);

221:         id_ = _node.length < 32 ? RLPReader.readRawBytes(_node) : RLPReader.readBytes(_node);

228:         nibbles_ = Bytes.toNibbles(RLPReader.readBytes(_node.decoded[0]));

209:             proof_[i] = TrieNode({ encoded: _proof[i], decoded: RLPReader.readList(_proof[i]) });

94:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),

143:                 bytes memory pathRemainder = Bytes.slice(path, offset);

144:                 bytes memory keyRemainder = Bytes.slice(key, currentKeyIndex);

106:                     Bytes.equal(currentNode.encoded, currentNodeID),

100:                     Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),

118:                     value_ = RLPReader.readBytes(currentNode.decoded[TREE_RADIX]);

171:                     value_ = RLPReader.readBytes(currentNode.decoded[1]);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L80-L80) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L60-L60), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L221-L221), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L221-L221), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L209-L209), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L143-L143), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L106-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L118-L118), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L171-L171)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

30:         valid_ = MerkleTrie.verifyInclusionProof(key, _value, _proof, _root);

48:         value_ = MerkleTrie.get(key, _proof, _root);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L48-L48)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

156:         bytes memory signature = Bytes.slice(_proof.data, 24);

159:             ECDSA.recover(getSignedHash(_tran, newInstance, _ctx.prover, _ctx.metaHash), signature);

154:         uint32 id = uint32(bytes4(Bytes.slice(_proof.data, 0, 4)));

155:         address newInstance = address(bytes20(Bytes.slice(_proof.data, 4, 20)));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L156-L156) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L155-L155)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

87:         return MerkleProof.verify(_proof, _merkleRoot, _value);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L87-L87) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

171:         address recipient = ECDSA.recover(hash, _sig);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L171-L171) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

167:             V3Parser.parseInput(quote, address(pemCertLib));

378:         ) = V3Parser.validateParsedInput(v3quote);

437:             bool tcbConfigured = LibString.eq(parsedFmspc, fetchedTcbInfo.fmspc);

443:             bool pceidMatched = LibString.eq(pckCert.pck.sgxExtension.pceid, fetchedTcbInfo.pceid);

321:                 V3Parser.packQEReport(authDataV3.pckSignedQeReport);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L167-L167) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L378-L378), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L437-L437), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L443-L443), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L321-L321)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

222:         uint256 beginPos = LibString.indexOf(pemData, HEADER);

223:         uint256 endPos = LibString.indexOf(pemData, FOOTER);

240:         string memory contentSlice = LibString.slice(pemData, contentStart, endPos);

241:         string[] memory split = LibString.split(contentSlice, string(delimiter));

140:             cert.notBefore = X509DateUtils.toTimestamp(der.bytesAt(notBeforePtr));

141:             cert.notAfter = X509DateUtils.toTimestamp(der.bytesAt(notAfterPtr));

171:             sigPtr = NodePtr.getPtr(sigPtr.ixs() + 3, sigPtr.ixf() + 3, sigPtr.ixl());

292:             if (BytesUtils.compareBytes(der.bytesAt(internalPtr), SGX_EXTENSION_OID)) {

361:             if (BytesUtils.compareBytes(der.bytesAt(svnPtr), PCESVN_OID)) {

120:             bool issuerNameIsValid = LibString.eq(cert.pck.issuerName, PLATFORM_ISSUER_NAME)

121:                 || LibString.eq(cert.pck.issuerName, PROCESSOR_ISSUER_NAME);

152:             if (!LibString.eq(cert.pck.commonName, PCK_COMMON_NAME)) {

208:             cert.pck.sgxExtension.pceid = LibString.toHexStringNoPrefix(pceidBytes);

209:             cert.pck.sgxExtension.fmspc = LibString.toHexStringNoPrefix(fmspcBytes);

245:             contentStr = LibString.concat(contentStr, split[i]);

57:                 input = LibString.slice(pemChainStr, index, index + len);

306:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), TCB_OID)) {

310:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), PCEID_OID)) {

316:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), FMSPC_OID)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L222-L222) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L223-L223), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L240-L240), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L241-L241), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L292-L292), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L361-L361), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L120-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L209-L209), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L57-L57), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L306-L306), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L310-L310), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L316-L316)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

54:         v3ParsedQuote = V3Struct.ParsedV3QuoteStruct({

190:         header = V3Struct.Header({

282:             quoteCerts[i] = Base64.decode(string(quoteCerts[i]));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L190-L190), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L282-L282)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

317:         return pkcs1Sha1(SHA1.sha1(_data), _s, _e, _m);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L317-L317) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

93:         sigValid = RsaVerify.pkcs1Sha256Raw(tbs, signature, exponent, modulus);

110:         sigValid = RsaVerify.pkcs1Sha1Raw(tbs, signature, exponent, modulus);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L93-L93) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L110-L110)


</details>


### [NC&#x2011;105] Avoid using underscore at the end of a variable name 
The use of the underscore at the end of the variable name is unusual, consider refactoring it.


*There are 99 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

//@audit variable : `reentry_`
130:     function _loadReentryLock() internal view virtual returns (uint8 reentry_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L130-L130) 


```solidity

File: /contracts/libs/LibAddress.sol

//@audit variable : `result_`
52:         returns (bool result_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L52-L52) 


```solidity

File: /contracts/libs/LibTrieProof.sol

//@audit variable : `storageRoot_`
44:         returns (bytes32 storageRoot_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L44-L44) 


```solidity

File: /contracts/L1/ITaikoL1.sol

//@audit variable : `meta_`
20:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_);

//@audit variable : `deposits_`
20:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L20-L20)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

//@audit variable : `deposits_`
73:         returns (TaikoData.EthDeposit[] memory deposits_)

//@audit variable : `recipient_`
44:         address recipient_ = _recipient == address(0) ? msg.sender : _recipient;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L73-L73) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L44-L44)


```solidity

File: /contracts/L1/libs/LibProposing.sol

//@audit variable : `meta_`
76:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)

//@audit variable : `deposits_`
76:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L76-L76)


```solidity

File: /contracts/L1/libs/LibProving.sol

//@audit variable : `maxBlocksToVerify_`
100:         returns (uint8 maxBlocksToVerify_)

//@audit variable : `tid_`
276:         returns (uint32 tid_, TaikoData.TransitionState storage ts_)

//@audit variable : `ts_`
276:         returns (uint32 tid_, TaikoData.TransitionState storage ts_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L100-L100) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L276-L276), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L276-L276)


```solidity

File: /contracts/L1/libs/LibUtils.sol

//@audit variable : `blk_`
59:         returns (TaikoData.Block storage blk_, uint64 slot_)

//@audit variable : `slot_`
59:         returns (TaikoData.Block storage blk_, uint64 slot_)

//@audit variable : `tid_`
78:         returns (uint32 tid_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L78-L78)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

//@audit variable : `approved_`
43:         returns (bool approved_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L43-L43) 


```solidity

File: /contracts/L1/provers/Guardians.sol

//@audit variable : `approved_`
111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111) 


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit variable : `meta_`
63:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)

//@audit variable : `deposits_`
63:         returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)

//@audit variable : `blk_`
148:         returns (TaikoData.Block memory blk_, TaikoData.TransitionState memory ts_)

//@audit variable : `ts_`
148:         returns (TaikoData.Block memory blk_, TaikoData.TransitionState memory ts_)

//@audit variable : `a_`
179:         returns (TaikoData.SlotA memory a_, TaikoData.SlotB memory b_)

//@audit variable : `b_`
179:         returns (TaikoData.SlotA memory a_, TaikoData.SlotB memory b_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L63-L63) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L63-L63), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L179-L179)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit variable : `tiers_`
47:     function getTierIds() public pure override returns (uint16[] memory tiers_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L47-L47) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit variable : `tiers_`
58:     function getTierIds() public pure override returns (uint16[] memory tiers_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L58-L58) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit variable : `tiers_`
58:     function getTierIds() public pure override returns (uint16[] memory tiers_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L58-L58) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit variable : `basefee_`
191:         returns (uint256 basefee_)

//@audit variable : `config_`
208:     function getConfig() public view virtual returns (Config memory config_) {

//@audit variable : `basefee_`
259:         returns (uint256 basefee_, uint64 gasExcess_)

//@audit variable : `gasExcess_`
259:         returns (uint256 basefee_, uint64 gasExcess_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L191-L191) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L259-L259), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L259-L259)


```solidity

File: /contracts/signal/ISignalService.sol

//@audit variable : `slot_`
59:     function sendSignal(bytes32 _signal) external returns (bytes32 slot_);

//@audit variable : `signal_`
75:         returns (bytes32 signal_);

//@audit variable : `blockId_`
129:         returns (uint64 blockId_, bytes32 chainData_);

//@audit variable : `chainData_`
129:         returns (uint64 blockId_, bytes32 chainData_);

//@audit variable : `signal_`
144:         returns (bytes32 signal_);

//@audit variable : `slot_`
59:     function sendSignal(bytes32 _signal) external returns (bytes32 slot_);

//@audit variable : `signal_`
75:         returns (bytes32 signal_);

//@audit variable : `blockId_`
129:         returns (uint64 blockId_, bytes32 chainData_);

//@audit variable : `chainData_`
129:         returns (uint64 blockId_, bytes32 chainData_);

//@audit variable : `signal_`
144:         returns (bytes32 signal_);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L59-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L144-L144)


```solidity

File: /contracts/signal/SignalService.sol

//@audit variable : `blockId_`
165:         returns (uint64 blockId_, bytes32 chainData_)

//@audit variable : `chainData_`
165:         returns (uint64 blockId_, bytes32 chainData_)

//@audit variable : `signal_`
242:         returns (bytes32 signal_)

//@audit variable : `slot_`
262:         returns (bytes32 slot_)

//@audit variable : `value_`
306:         returns (bytes32 value_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L165-L165) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L242-L242), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L262-L262), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L306-L306)


```solidity

File: /contracts/bridge/IBridge.sol

//@audit variable : `msgHash_`
112:         returns (bytes32 msgHash_, Message memory message_);

//@audit variable : `message_`
112:         returns (bytes32 msgHash_, Message memory message_);

//@audit variable : `ctx_`
145:     function context() external view returns (Context memory ctx_);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L112-L112) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L145-L145)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit variable : `msgHash_`
121:         returns (bytes32 msgHash_, Message memory message_)

//@audit variable : `message_`
121:         returns (bytes32 msgHash_, Message memory message_)

//@audit variable : `enabled_`
395:         returns (bool enabled_, address destBridge_)

//@audit variable : `destBridge_`
395:         returns (bool enabled_, address destBridge_)

//@audit variable : `ctx_`
403:     function context() public view returns (Context memory ctx_) {

//@audit variable : `invocationDelay_`
421:         returns (uint256 invocationDelay_, uint256 invocationExtraDelay_)

//@audit variable : `invocationExtraDelay_`
421:         returns (uint256 invocationDelay_, uint256 invocationExtraDelay_)

//@audit variable : `success_`
483:         returns (bool success_)

//@audit variable : `success_`
585:         returns (bool success_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L121-L121) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L395-L395), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L395-L395), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L403-L403), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L483-L483), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L585-L585)


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit variable : `ctx_`
51:         returns (IBridge.Context memory ctx_)

//@audit variable : `ctx_`
62:         returns (IBridge.Context memory ctx_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L51-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L62-L62)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit variable : `message_`
45:         returns (IBridge.Message memory message_)

//@audit variable : `msgData_`
245:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

//@audit variable : `ctoken_`
245:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

//@audit variable : `btoken_`
290:         returns (address btoken_)

//@audit variable : `btoken_`
303:     function _deployBridgedToken(CanonicalNFT memory _ctoken) private returns (address btoken_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L290-L290), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L303-L303)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit variable : `btokenOld_`
156:         returns (address btokenOld_)

//@audit variable : `message_`
212:         returns (IBridge.Message memory message_)

//@audit variable : `token_`
326:         returns (address token_)

//@audit variable : `msgData_`
355:         returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)

//@audit variable : `ctoken_`
355:         returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)

//@audit variable : `balanceChange_`
355:         returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L156-L156) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L212-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L326-L326), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L355-L355), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L355-L355), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L355-L355)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit variable : `message_`
32:         returns (IBridge.Message memory message_)

//@audit variable : `token_`
166:         returns (address token_)

//@audit variable : `msgData_`
192:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

//@audit variable : `ctoken_`
192:         returns (bytes memory msgData_, CanonicalNFT memory ctoken_)

//@audit variable : `btoken_`
226:         returns (address btoken_)

//@audit variable : `btoken_`
240:     function _deployBridgedToken(CanonicalNFT memory _ctoken) private returns (address btoken_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L32-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L166-L166), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L192-L192), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L240-L240)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

//@audit variable : `out_`
35:     function toRLPItem(bytes memory _in) internal pure returns (RLPItem memory out_) {

//@audit variable : `out_`
53:     function readList(RLPItem memory _in) internal pure returns (RLPItem[] memory out_) {

//@audit variable : `out_`
102:     function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {

//@audit variable : `out_`
109:     function readBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {

//@audit variable : `out_`
128:     function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {

//@audit variable : `out_`
135:     function readRawBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {

//@audit variable : `offset_`
147:         returns (uint256 offset_, uint256 length_, RLPItemType type_)

//@audit variable : `length_`
147:         returns (uint256 offset_, uint256 length_, RLPItemType type_)

//@audit variable : `type_`
147:         returns (uint256 offset_, uint256 length_, RLPItemType type_)

//@audit variable : `out_`
284:         returns (bytes memory out_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L53-L53), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L109-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L147-L147), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L284-L284)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit variable : `out_`
13:     function writeBytes(bytes memory _in) internal pure returns (bytes memory out_) {

//@audit variable : `out_`
24:     function writeUint(uint256 _in) internal pure returns (bytes memory out_) {

//@audit variable : `out_`
32:     function _writeLength(uint256 _len, uint256 _offset) private pure returns (bytes memory out_) {

//@audit variable : `out_`
55:     function _toBinary(uint256 _x) private pure returns (bytes memory out_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L13-L13) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L32-L32), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L55-L55)


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

//@audit variable : `valid_`
58:         returns (bool valid_)

//@audit variable : `value_`
75:         returns (bytes memory value_)

//@audit variable : `proof_`
205:     function _parseProof(bytes[] memory _proof) private pure returns (TrieNode[] memory proof_) {

//@audit variable : `id_`
220:     function _getNodeID(RLPReader.RLPItem memory _node) private pure returns (bytes memory id_) {

//@audit variable : `nibbles_`
227:     function _getNodePath(TrieNode memory _node) private pure returns (bytes memory nibbles_) {

//@audit variable : `shared_`
241:         returns (uint256 shared_)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L75-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L205-L205), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L220-L220), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L227-L227), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L241-L241)


```solidity

File: /contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

//@audit variable : `valid_`
27:         returns (bool valid_)

//@audit variable : `value_`
45:         returns (bytes memory value_)

//@audit variable : `hash_`
54:     function _getSecureKey(bytes memory _key) private pure returns (bytes memory hash_) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L27-L27) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L54-L54)


</details>


### [NC&#x2011;106] [NatSpec] Natspec `@param` is missing from `error` 



*There are 216 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58) 


```solidity

File: /contracts/common/EssentialContract.sol

109:     function __Essential_init(address _owner) internal virtual {

114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }

116:     function _authorizePause(address) internal virtual onlyOwner { }

119:     function _storeReentryLock(uint8 _reentry) internal virtual {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L109-L109) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L119-L119)


```solidity

File: /contracts/libs/LibAddress.sol

46:     function supportsInterface(

61:     function isValidSignature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L61)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

47:     /// @dev See {IGovernor-propose}

61:     /// @notice An overwrite of GovernorCompatibilityBravoUpgradeable's propose() as that one does
62:     /// not check that the length of signatures equal the calldata.
63:     /// @dev See vulnerability description here:
64:     /// https://github.com/taikoxyz/taiko-mono/security/dependabot/114
65:     /// See fix in OZ 4.8.3 here (URL broken down for readability):
66:     /// https://github.com/OpenZeppelin/openzeppelin-contracts/blob/
67:     /// 0a25c1940ca220686588c4af3ec526f725fe2582/contracts/governance/compatibility/GovernorCompatibilityBravo.sol#L72
68:     /// See {GovernorCompatibilityBravoUpgradeable-propose}

88:     /// @dev See {GovernorUpgradeable-supportsInterface}

98:     /// @dev See {GovernorUpgradeable-state}

127:     function _execute(

140:     function _cancel(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L61-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L140)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

164:     function _getProverFee(

18:     struct ProverAssignment {

29:     struct Input {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L164-L164) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L29-L29)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

17:     /// @notice Emitted when Ether is deposited.
18:     /// @dev Any events defined here must also be defined in TaikoEvents.sol.

66:     /// @dev Processes the ETH deposits in a batched manner.

121:     /// @dev Checks if Ether deposit is allowed for Layer 2.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L17-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L121-L121)


```solidity

File: /contracts/L1/libs/LibProposing.sol

299:     function _isProposerPermitted(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L299-L299) 


```solidity

File: /contracts/L1/libs/LibProving.sol

268:     /// @dev Handle the transition initialization logic

349:     /// @dev Handles what happens when there is a higher proof incoming

400:     /// @dev Check the msg.sender (the new prover) against the block's assigned prover.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L268-L268) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L349-L349), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L400-L400)


```solidity

File: /contracts/L1/libs/LibUtils.sol

68:     /// @dev Retrieves the ID of the transition with a given parentHash.
69:     /// This function will return 0 if the transition is not found.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L68-L69) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

84:     /// @dev Verifies up to N blocks.

224:     function _syncChainData(

245:     function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L245-L245)


```solidity

File: /contracts/L1/provers/Guardians.sol

111:     function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {

124:     function deleteApproval(bytes32 _hash) internal {

128:     function isApproved(uint256 _approvalBits) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L111-L111) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L124-L124), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L128-L128)


```solidity

File: /contracts/L1/TaikoData.sol

9:     /// @dev Struct holding Taiko configuration parameters. See {TaikoConfig}.

62:     /// @dev Struct representing prover assignment

68:     struct TierProof {

73:     struct HookCall {

78:     struct BlockParams {

90:     /// @dev Struct containing data only required for proving a block
91:     /// Note: On L2, `block.difficulty` is the pseudo name of
92:     /// `block.prevrandao`, which returns a random number provided by the layer
93:     /// 1 chain.

112:     /// @dev Struct representing transition to be proven.

120:     /// @dev Struct representing state transition data.
121:     /// 10 slots reserved for upgradability, 6 slots used.

135:     /// @dev Struct containing data required for verifying a block.
136:     /// 10 slots reserved for upgradability, 3 slots used.

148:     /// @dev Struct representing an Ethereum deposit.
149:     /// 1 slot used.

156:     /// @dev Forge is only able to run coverage in case the contracts by default
157:     /// capable of compiling without any optimization (neither optimizer runs,
158:     /// no compiling --via-ir flag).
159:     /// In order to resolve stack too deep without optimizations, we needed to
160:     /// introduce outsourcing vars into structs below.

168:     struct SlotB {

178:     /// @dev Struct holding the state variables for the {TaikoL1} contract.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L90-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L112-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L120-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L135-L136), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L148-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L156-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L168-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoData.sol#L178-L178)


```solidity

File: /contracts/L1/TaikoL1.sol

136:     /// @notice See {LibProposing-isBlobReusable}.

220:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L136-L136) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L220)


```solidity

File: /contracts/L1/TaikoToken.sol

83:     function _beforeTokenTransfer(

94:     function _afterTokenTransfer(

105:     function _mint(

115:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L83-L83) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L115-L115)


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

8:     struct Tier {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L8-L8) 


```solidity

File: /contracts/L2/Lib1559Math.sol

32:     /// @dev exp(gas_qty / TARGET / ADJUSTMENT_QUOTIENT)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L32-L32) 


```solidity

File: /contracts/L2/TaikoL2.sol

223:     function _calcPublicInputHash(uint256 _blockId)

252:     function _calc1559BaseFee(

26:     struct Config {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L223-L223) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L26-L26)


```solidity

File: /contracts/signal/ISignalService.sol

20:     struct HopProof {

20:     struct HopProof {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L20-L20)


```solidity

File: /contracts/signal/SignalService.sol

35:     modifier validSender(address _app) {

40:     modifier nonZeroValue(bytes32 _input) {

206:     function _verifyHopProof(

231:     function _authorizePause(address) internal pure override {

235:     function _syncChainData(

253:     function _sendSignal(

271:     function _cacheChainData(

298:     function _loadSignalValue(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L253-L253), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L271-L271), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L298-L298)


```solidity

File: /contracts/bridge/IBridge.sol

17:     struct Message {

49:     struct ProofReceipt {

60:     struct Context {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L17-L17) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L49-L49), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L60-L60)


```solidity

File: /contracts/bridge/Bridge.sol

64:     modifier sameChain(uint64 _chainId) {

460:     /// @notice Checks if the given address can pause and unpause the bridge.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L64-L64) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L460-L460)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

43:     function _mintToken(address _account, uint256 _amount) internal override {

47:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L43-L43) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

129:     function _mintToken(address _account, uint256 _amount) internal override {

133:     function _burnToken(address _from, uint256 _amount) internal override {

137:     /// @dev For ERC20SnapshotUpgradeable and ERC20VotesUpgradeable, need to implement the following
138:     /// functions

152:     function _afterTokenTransfer(

163:     function _mint(

173:     function _burn(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L129-L129) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L137-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L173)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

97:     function _mintToken(address _account, uint256 _amount) internal virtual;

99:     function _burnToken(address _from, uint256 _amount) internal virtual;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L97-L97) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L99-L99)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

115:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L115) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

125:     function _beforeTokenTransfer(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L125) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

140:     modifier withValidOperation(BridgeTransferOp memory _op) {

11:     struct CanonicalNFT {

23:     struct BridgeTransferOp {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L140-L140) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L11-L11), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L23-L23)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

159:     /// @notice See {ERC1155ReceiverUpgradeable-onERC1155BatchReceived}.

174:     /// @notice See {ERC1155ReceiverUpgradeable-onERC1155Received}.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L159-L159) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L174-L174)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

320:     function _transferTokens(

22:     /// @dev Represents a canonical ERC20 token.

31:     /// @dev Represents an operation to send tokens to another chain.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L320-L320) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L22-L22), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L31-L31)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

160:     function _transferTokens(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L160-L160) 


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

11:     function validateInputs(

28:     function buildName(

39:     function buildSymbol(string memory _symbol) internal pure returns (string memory) {

43:     function buildURI(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L43)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

21:     /// @notice Struct representing an RLP item.
22:     /// @custom:field length Length of the RLP item.
23:     /// @custom:field ptr    Pointer to the RLP item in memory.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L21-L23) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

12:     /// @notice Struct representing a node in the trie.
13:     /// @custom:field encoded The RLP-encoded node.
14:     /// @custom:field decoded The RLP-decoded node.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L12-L14) 


```solidity

File: /contracts/verifiers/IVerifier.sol

10:     struct Context {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L10-L10) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

195:     function _addInstances(

226:     function _replaceInstance(uint256 id, address oldInstance, address newInstance) private {

233:     function _isInstanceValid(uint256 id, address instance) private view returns (bool) {

20:     /// @dev Each public-private key pair (Ethereum address) is generated within
21:     /// the SGX program when it boots up. The off-chain remote attestation
22:     /// ensures the validity of the program hash and has the capability of
23:     /// bootstrapping the network with trustworthy instances.


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L195-L195) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L226-L226), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L233-L233), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L20-L23)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

56:     function __MerkleClaimable_init(

67:     function _verifyClaim(bytes memory data, bytes32[] calldata proof) internal ongoingClaim {

77:     function _verifyMerkleProof(

90:     function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L90-L90)


```solidity

File: /contracts/team/TimelockTokenPool.sol

175:     /// @notice Returns the summary of the grant for a given recipient.

208:     function _withdraw(address _recipient, address _to) private {

225:     function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {

235:     function _getAmountOwned(Grant memory _grant) private view returns (uint128) {

239:     function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {

245:     function _calcAmount(

267:     function _validateGrant(Grant memory _grant) private pure {

273:     function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {

28:     struct Grant {

52:     struct Recipient {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L175-L175) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L208-L208), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L225-L225), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L267-L267), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L273-L273), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L28-L28), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L52-L52)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

54:     constructor(address sigVerifyLibAddr, address pemCertLibAddr) {

65:     function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {

69:     function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {

73:     function addRevokedCertSerialNum(

88:     function removeRevokedCertSerialNum(

103:     function configureTcbInfoJson(

114:     function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)

126:     function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)

138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {

143:     /// @dev Provide the raw quote binary as input
144:     /// @dev The attestation data (or the returned data of this method)
145:     /// is constructed depending on the validity of the quote verification.
146:     /// @dev After confirming that a quote has been verified, the attestation's validity then
147:     /// depends on the
148:     /// status of the associated TCB.
149:     /// @dev Example scenarios as below:
150:     /// --------------------------------
151:     /// @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
152:     ///
153:     /// @dev For all valid quote verification, the validity of the attestation depends on the status
154:     /// of a
155:     /// matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
156:     /// overwritten
157:     /// in derived contracts. (Except for "Revoked" status, which also returns (false,
158:     /// INVALID_EXIT_CODE) value)
159:     /// @dev For all valid quote verification, returns the following data:
160:     /// (_attestationTcbIsValid(), abi.encodePacked(sha256(quote), uint8 exitCode))
161:     /// @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum

175:     function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)

206:     function _checkTcbLevels(

229:     function _isCpuSvnHigherOrGreater(

248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)

303:     function _enclaveReportSigVerification(

336:     /// @dev Provide the parsed quote binary as input
337:     /// @dev The attestation data (or the returned data of this method)
338:     /// is constructed depending on the validity of the quote verification.
339:     /// @dev After confirming that a quote has been verified, the attestation's validity then
340:     /// depends on the
341:     /// status of the associated TCB.
342:     /// @dev Example scenarios as below:
343:     /// --------------------------------
344:     /// @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
345:     ///
346:     /// @dev For all valid quote verification, the validity of the attestation depends on the status
347:     /// of a
348:     /// matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
349:     /// overwritten
350:     /// in derived contracts. (Except for "Revoked" status, which also returns (false,
351:     /// INVALID_EXIT_CODE) value)
352:     /// @dev For all valid quote verification, returns the following data:
353:     /// (_attestationTcbIsValid())
354:     /// @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum

364:     function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54-L54) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126-L126), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L143-L161), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L206), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L248), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L336-L354), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364-L364)


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

9:     function verifyAttestation(bytes calldata data) external returns (bool);

10:     function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L9-L9) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L10-L10)


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

38:     function verifyAttStmtSignature(

48:     function verifyCertificateSignature(

58:     function verifyRS256Signature(

67:     function verifyRS1Signature(

76:     function verifyES256Signature(

12:     struct PublicKey {

24:     struct Certificate {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L12-L12), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L24-L24)


```solidity

File: /contracts/automata-attestation/lib/EnclaveIdStruct.sol

7:     struct EnclaveId {

17:     struct TcbLevel {

22:     struct TcbObj {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/EnclaveIdStruct.sol#L22-L22)


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

36:     function splitCertificateChain(

44:     function decodeCert(

7:     struct ECSha256Certificate {

18:     struct PCKCertificateField {

24:     struct PCKTCBInfo {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L36-L36) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L44-L44), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L18-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L24-L24)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

40:     function splitCertificateChain(

74:     function decodeCert(

216:     function _removeHeadersAndFooters(string memory pemData)

252:     function _trimBytes(

269:     function _findPckTcbInfo(

341:     function _findTcb(

34:     struct PCKTCBFlags {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L74-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L216-L216), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L252-L252), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L341-L341), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L34-L34)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

21:     function parseInput(

62:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)

133:     function parseEnclaveReport(bytes memory rawEnclaveReport)

152:     function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {

165:     function parseAndVerifyHeader(bytes memory rawHeader)

203:     function parseAuthDataAndVerifyCertType(

267:     function parseCerificationChainBytes(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L21) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L62), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152-L152), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L203), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L267)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

7:     struct Header {

17:     struct EnclaveReport {

33:     struct QEAuthData {

38:     struct CertificationData {

47:     struct ECDSAQuoteV3AuthData {

56:     struct ParsedV3QuoteStruct {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L17-L17), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L33-L33), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L56-L56)


```solidity

File: /contracts/automata-attestation/lib/TCBInfoStruct.sol

7:     struct TCBInfo {

13:     struct TCBLevelObj {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L7-L7) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/TCBInfoStruct.sol#L13-L13)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

14:     function ixs(uint256 self) internal pure returns (uint256) {

19:     function ixf(uint256 self) internal pure returns (uint256) {

24:     function ixl(uint256 self) internal pure returns (uint256) {

29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {

47:     function root(bytes memory der) internal pure returns (uint256) {

56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

66:     function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

87:     function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

187:     function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L187-L187)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

16:     function keccak(

39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

56:     function compare(

116:     function equals(

138:     function equals(

160:     function equals(

178:     function equals(bytes memory self, bytes memory other) internal pure returns (bool) {

188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {

198:     function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {

211:     function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {

224:     function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {

237:     function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {

255:     function readBytesN(

272:     function memcpy(uint256 dest, uint256 src, uint256 len) private pure {

284:     function substring(

371:     function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L116), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L138), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L160), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L188), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L198-L198), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L211-L211), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L237-L237), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L255-L255), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L272-L272), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L284), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L371-L371)


```solidity

File: /contracts/automata-attestation/utils/SHA1.sol

11:     function sha1(bytes memory data) internal pure returns (bytes20 ret) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SHA1.sol#L11-L11) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

20:     constructor(address es256Verifier) {

24:     function verifyAttStmtSignature(

54:     function verifyCertificateSignature(

79:     function verifyRS256Signature(

96:     function verifyRS1Signature(

113:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L113)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {

34:     function toUnixTimestamp(

71:     function isLeapYear(uint16 year) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L34), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L71-L71)


</details>


### [NC&#x2011;107] [NatSpec] Natspec comment is missing from scope `block` 



*There are 12 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProposing.sol

236:         {
237:             IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));
238:             uint256 tkoBalance = tko.balanceOf(address(this));
239: 
240:             // Run all hooks.
241:             // Note that address(this).balance has been updated with msg.value,
242:             // prior to any code in this function has been executed.
243:             address prevHook;
244:             for (uint256 i; i < params.hookCalls.length; ++i) {
245:                 if (uint160(prevHook) >= uint160(params.hookCalls[i].hook)) {
246:                     revert L1_INVALID_HOOK();
247:                 }
248: 
249:                 // When a hook is called, all ether in this contract will be send to the hook.
250:                 // If the ether sent to the hook is not used entirely, the hook shall send the Ether
251:                 // back to this contract for the next hook to use.
252:                 // Proposers shall choose use extra hooks wisely.
253:                 IHook(params.hookCalls[i].hook).onBlockProposed{ value: address(this).balance }(
254:                     blk, meta_, params.hookCalls[i].data
255:                 );
256: 
257:                 prevHook = params.hookCalls[i].hook;
258:             }
259:             // Refund Ether
260:             if (address(this).balance != 0) {
261:                 msg.sender.sendEther(address(this).balance);
262:             }
263: 
264:             // Check that after hooks, the Taiko Token balance of this contract
265:             // have increased by the same amount as _config.livenessBond (to prevent)
266:             // multiple draining payments by a malicious proposer nesting the same
267:             // hook.
268:             if (tko.balanceOf(address(this)) != tkoBalance + _config.livenessBond) {
269:                 revert L1_LIVENESS_BOND_NOT_RECEIVED();
270:             }
271:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L236-L271) 


```solidity

File: /contracts/L1/libs/LibProving.sol

160:         {
161:             address verifier = _resolver.resolve(tier.verifierName, true);
162: 
163:             if (verifier != address(0)) {
164:                 bool isContesting = _proof.tier == ts.tier && tier.contestBond != 0;
165: 
166:                 IVerifier.Context memory ctx = IVerifier.Context({
167:                     metaHash: blk.metaHash,
168:                     blobHash: _meta.blobHash,
169:                     // Separate msgSender to allow the prover to be any address in the future.
170:                     prover: msg.sender,
171:                     msgSender: msg.sender,
172:                     blockId: blk.blockId,
173:                     isContesting: isContesting,
174:                     blobUsed: _meta.blobUsed
175:                 });
176: 
177:                 IVerifier(verifier).verifyProof(ctx, _tran, _proof);
178:             } else if (tier.verifierName != TIER_OP) {
179:                 // The verifier can be address-zero, signifying that there are no
180:                 // proof checks for the tier. In practice, this only applies to
181:                 // optimistic proofs.
182:                 revert L1_MISSING_VERIFIER();
183:             }
184:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L160-L184) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

384:         {
385:             if (_checkLocalEnclaveReport) {
386:                 // 4k gas
387:                 bool mrEnclaveIsTrusted =
388:                     _trustedUserMrEnclave[v3quote.localEnclaveReport.mrEnclave];
389:                 bool mrSignerIsTrusted = _trustedUserMrSigner[v3quote.localEnclaveReport.mrSigner];
390: 
391:                 if (!mrEnclaveIsTrusted || !mrSignerIsTrusted) {
392:                     return (false, retData);
393:                 }
394:             }
395:         }

399:         {
400:             bool verifiedEnclaveIdSuccessfully;
401:             (verifiedEnclaveIdSuccessfully, qeTcbStatus) =
402:                 _verifyQEReportWithIdentity(v3quote.v3AuthData.pckSignedQeReport);
403:             if (!verifiedEnclaveIdSuccessfully) {
404:                 return (false, retData);
405:             }
406:             if (
407:                 !verifiedEnclaveIdSuccessfully
408:                     || qeTcbStatus == EnclaveIdStruct.EnclaveIdStatus.SGX_ENCLAVE_REPORT_ISVSVN_REVOKED
409:             ) {
410:                 return (false, retData);
411:             }
412:         }

417:         {
418:             // 536k gas
419:             parsedQuoteCerts = new IPEMCertChainLib.ECSha256Certificate[](3);
420:             for (uint256 i; i < 3; ++i) {
421:                 bool isPckCert = i == 0; // additional parsing for PCKCert
422:                 bool certDecodedSuccessfully;
423:                 // todo! move decodeCert offchain
424:                 (certDecodedSuccessfully, parsedQuoteCerts[i]) = pemCertLib.decodeCert(
425:                     authDataV3.certification.decodedCertDataArray[i], isPckCert
426:                 );
427:                 if (!certDecodedSuccessfully) {
428:                     return (false, retData);
429:                 }
430:             }
431:         }

434:         {
435:             string memory parsedFmspc = parsedQuoteCerts[0].pck.sgxExtension.fmspc;
436:             fetchedTcbInfo = tcbInfo[parsedFmspc];
437:             bool tcbConfigured = LibString.eq(parsedFmspc, fetchedTcbInfo.fmspc);
438:             if (!tcbConfigured) {
439:                 return (false, retData);
440:             }
441: 
442:             IPEMCertChainLib.ECSha256Certificate memory pckCert = parsedQuoteCerts[0];
443:             bool pceidMatched = LibString.eq(pckCert.pck.sgxExtension.pceid, fetchedTcbInfo.pceid);
444:             if (!pceidMatched) {
445:                 return (false, retData);
446:             }
447:         }

451:         {
452:             // 4k gas
453:             bool tcbVerified;
454:             (tcbVerified, tcbStatus) = _checkTcbLevels(parsedQuoteCerts[0].pck, fetchedTcbInfo);
455:             if (!tcbVerified) {
456:                 return (false, retData);
457:             }
458:         }

461:         {
462:             // 660k gas (rootCA pubkey is trusted)
463:             bool pckCertChainVerified = _verifyCertChain(parsedQuoteCerts);
464:             if (!pckCertChainVerified) {
465:                 return (false, retData);
466:             }
467:         }

470:         {
471:             bool enclaveReportSigsVerified = _enclaveReportSigVerification(
472:                 parsedQuoteCerts[0].pubKey,
473:                 signedQuoteData,
474:                 authDataV3,
475:                 v3quote.v3AuthData.pckSignedQeReport
476:             );
477:             if (!enclaveReportSigsVerified) {
478:                 return (false, retData);
479:             }
480:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L384-L395) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L399-L412), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L417-L431), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L434-L447), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L451-L458), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L461-L467), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L470-L480)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

106:         {
107:             bytes memory serialNumBytes = der.bytesAt(tbsPtr);
108:             cert.serialNumber = serialNumBytes;
109:         }

129:         {
130:             uint256 notBeforePtr = der.firstChildOf(tbsPtr);
131:             uint256 notAfterPtr = der.nextSiblingOf(notBeforePtr);
132:             bytes1 notBeforeTag = der[notBeforePtr.ixs()];
133:             bytes1 notAfterTag = der[notAfterPtr.ixs()];
134:             if (
135:                 (notBeforeTag != 0x17 && notBeforeTag == 0x18)
136:                     || (notAfterTag != 0x17 && notAfterTag != 0x18)
137:             ) {
138:                 return (false, cert);
139:             }
140:             cert.notBefore = X509DateUtils.toTimestamp(der.bytesAt(notBeforePtr));
141:             cert.notAfter = X509DateUtils.toTimestamp(der.bytesAt(notAfterPtr));
142:         }

159:         {
160:             // Entering subjectPublicKeyInfo sequence
161:             uint256 subjectPublicKeyInfoPtr = der.firstChildOf(tbsPtr);
162:             subjectPublicKeyInfoPtr = der.nextSiblingOf(subjectPublicKeyInfoPtr);
163: 
164:             // The Signature sequence is located two sibling elements below the tbsCertificate
165:             // element
166:             uint256 sigPtr = der.nextSiblingOf(tbsParentPtr);
167:             sigPtr = der.nextSiblingOf(sigPtr);
168: 
169:             // Skip three bytes to the right
170:             // the three bytes in question: 0x034700 or 0x034800 or 0x034900
171:             sigPtr = NodePtr.getPtr(sigPtr.ixs() + 3, sigPtr.ixf() + 3, sigPtr.ixl());
172: 
173:             sigPtr = der.firstChildOf(sigPtr);
174:             bytes memory sigX = _trimBytes(der.bytesAt(sigPtr), 32);
175: 
176:             sigPtr = der.nextSiblingOf(sigPtr);
177:             bytes memory sigY = _trimBytes(der.bytesAt(sigPtr), 32);
178: 
179:             cert.tbsCertificate = der.allBytesAt(tbsParentPtr);
180:             cert.pubKey = _trimBytes(der.bytesAt(subjectPublicKeyInfoPtr), 64);
181:             cert.signature = abi.encodePacked(sigX, sigY);
182:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L106-L109) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L129-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L159-L182)


</details>


### [NC&#x2011;108] OpenZeppelin libraries should be upgraded to a newer version 
These contracts import some OpenZeppelin libraries, but they are using an old version.


*There are 71 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

4: import "@openzeppelin/contracts/proxy/utils/UUPSUpgradeable.sol";

5: import "@openzeppelin/contracts-upgradeable/access/Ownable2StepUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L5-L5)


```solidity

File: /contracts/libs/LibAddress.sol

4: import "@openzeppelin/contracts/utils/Address.sol";

5: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";

6: import "@openzeppelin/contracts/utils/introspection/IERC165.sol";

7: import "@openzeppelin/contracts/interfaces/IERC1271.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L7-L7)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";

5: import

7: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesUpgradeable.sol";

8: import

10: import


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L10-L10)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

4: import "@openzeppelin/contracts-upgradeable/governance/TimelockControllerUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L4-L4) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L5-L5)


```solidity

File: /contracts/L1/libs/LibProposing.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L4-L4) 


```solidity

File: /contracts/L1/libs/LibProving.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L4-L4) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L4-L4) 


```solidity

File: /contracts/L1/TaikoToken.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/ERC20Upgradeable.sol";

5: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";

6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L6-L6)


```solidity

File: /contracts/L2/CrossChainOwned.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L4-L4) 


```solidity

File: /contracts/L2/TaikoL2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L5-L5)


```solidity

File: /contracts/signal/SignalService.sol

4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L4-L4) 


```solidity

File: /contracts/bridge/Bridge.sol

4: import "@openzeppelin/contracts/utils/Address.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";

5: import "@openzeppelin/contracts/utils/Strings.sol";

6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";

7: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L7-L7)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol";

5: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L5-L5)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";

5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/ERC1155Upgradeable.sol";

6: import


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L6-L6)


```solidity

File: /contracts/tokenvault/BaseVault.sol

4: import "@openzeppelin/contracts-upgradeable/utils/introspection/IERC165Upgradeable.sol";

5: import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L5-L5)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

4: import "@openzeppelin/contracts/token/ERC1155/IERC1155.sol";

5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/utils/ERC1155ReceiverUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L5-L5)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";

6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L6-L6)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";

5: import "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L5-L5)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L4-L4) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L4-L4) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

5: import "@openzeppelin/contracts/governance/utils/IVotes.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L5-L5)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L4-L4) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L4-L4) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

4: import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L4-L4) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";

5: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";

6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L6-L6)


```solidity

File: /contracts/common/EssentialContract.sol

5: import "@openzeppelin/contracts-upgradeable/access/Ownable2StepUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L5-L5) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";

5: import

7: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesUpgradeable.sol";

8: import

10: import


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L7-L7), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L8-L8), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L10-L10)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

4: import "@openzeppelin/contracts-upgradeable/governance/TimelockControllerUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L4-L4) 


```solidity

File: /contracts/L1/TaikoToken.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/ERC20Upgradeable.sol";

5: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";

6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L5-L5), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L6-L6)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";

6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";

7: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L4-L4) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L6-L6), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L7-L7)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/ERC1155Upgradeable.sol";

6: import


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L5-L5) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L6-L6)


```solidity

File: /contracts/tokenvault/BaseVault.sol

4: import "@openzeppelin/contracts-upgradeable/utils/introspection/IERC165Upgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L4-L4) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/utils/ERC1155ReceiverUpgradeable.sol";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L5-L5) 


</details>


### [NC&#x2011;109] Not using the latest version of `prb-math` from dependencies 
`prb-math` is an important mathematical library The package.json configuration file says that the project is using an old version of `prb-math`.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: package.json

//@audit `prb-math` version is 
1: 


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol//package.json#L1-L1) 


</details>


### [NC&#x2011;110] Enforcing Lowercase and Underscores Only in the `name` Field of package.json 
package.json name variable should only consist of lowercase letters and underscores


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: package.json

//@audit package.json name is @taiko/protocol
1: {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol//package.json#L1-L1) 


</details>


### [NC&#x2011;111] Non constant/immutable state variables are missing a setter post deployment 
Non-constant or non-immutable state variables lacking a setter function can create inflexibility in contract operations. If there's no way to update these variables post-deployment, the contract might not adapt to changing conditions or requirements, which can be a significant drawback, especially in upgradable or long-lived contracts. To resolve this, implement setter functions guarded by appropriate access controls, like `onlyOwner` or similar modifiers, so that these variables can be updated as required while maintaining security. This enables smoother contract maintenance and feature upgrades.


*There are 39 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

14:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L14-L14) 


```solidity

File: /contracts/common/EssentialContract.sol

25:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L25-L25) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

23:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L23-L23) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

10:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L10-L10) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

40:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L40-L40) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L11-L11) 


```solidity

File: /contracts/L1/provers/Guardians.sol

32:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L32-L32) 


```solidity

File: /contracts/L1/TaikoL1.sol

24:     TaikoData.State public state;

26:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L26-L26)


```solidity

File: /contracts/L1/TaikoToken.sol

16:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L16-L16) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

21:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L21-L21) 


```solidity

File: /contracts/L2/TaikoL2.sol

52:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L52-L52) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

13:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L13-L13) 


```solidity

File: /contracts/signal/SignalService.sol

23:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L23-L23) 


```solidity

File: /contracts/bridge/Bridge.sol

48:     uint256[43] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L48-L48) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

32:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

32:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

16:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L16-L16) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

19:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L19-L19) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

27:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L27-L27) 


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

56:     mapping(address btoken => CanonicalNFT canonical) public bridgedToCanonical;

59:     mapping(uint256 chainId => mapping(address ctoken => address btoken)) public canonicalToBridged;

61:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L56-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L59-L59), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L61-L61)


```solidity

File: /contracts/tokenvault/BaseVault.sol

18:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L18-L18) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

32:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

54:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L54-L54) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

19:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L19-L19) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L11-L11) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

57:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L57-L57) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

18:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L18-L18) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

30:     uint256[45] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L30-L30) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

16:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L16-L16) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

23:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L23-L23) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

82:     uint128[44] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L82-L82) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

52:     address public owner;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L52-L52) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

18:     address private ES256VERIFIER;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L18-L18) 


</details>


### [NC&#x2011;112] Consider making private state variables internal to increase flexibility 
In Solidity, `private` state variables are strictly confined to the contract they are defined in and can't be accessed or modified by its derived contracts. While this offers strong encapsulation, it can limit contract extensibility and modification in inheritance chains. On the other hand, `internal` variables can be accessed and potentially overridden by child contracts, granting more flexibility in contract development and upgrades. Therefore, it's recommended to use `private` only when you explicitly want to prevent child contract access. Otherwise, prefer `internal` to maintain a balance between encapsulation and the flexibility offered by inheritance patterns in Solidity.


*There are 52 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

12:     mapping(uint256 chainId => mapping(bytes32 name => address addr)) private __addresses;

14:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L14-L14)


```solidity

File: /contracts/common/EssentialContract.sol

11:     uint8 private constant _FALSE = 1;

13:     uint8 private constant _TRUE = 2;

17:     bytes32 private constant _REENTRY_SLOT =
18:         0xa5054f728453d3dbe953bdc43e4d0cb97e662ea32d7958190f3dc2da31d9721a;

21:     uint8 private __reentry;

23:     uint8 private __paused;

25:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L11-L11) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L13-L13), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L17-L18), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L21-L21), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L25-L25)


```solidity

File: /contracts/libs/LibAddress.sol

14:     bytes4 private constant _EIP1271_MAGICVALUE = 0x1626ba7e;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L14-L14) 


```solidity

File: /contracts/libs/LibTrieProof.sol

18:     uint256 private constant _ACCOUNT_FIELD_INDEX_STORAGE_HASH = 2;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L18-L18) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

23:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L23-L23) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

10:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L10-L10) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

40:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L40-L40) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L11-L11) 


```solidity

File: /contracts/L1/provers/Guardians.sol

32:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L32-L32) 


```solidity

File: /contracts/L1/TaikoL1.sol

26:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L26-L26) 


```solidity

File: /contracts/L1/TaikoToken.sol

16:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L16-L16) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L11-L11) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

21:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L21-L21) 


```solidity

File: /contracts/L2/TaikoL2.sol

52:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L52-L52) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

13:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L13-L13) 


```solidity

File: /contracts/signal/SignalService.sol

23:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L23-L23) 


```solidity

File: /contracts/bridge/Bridge.sol

23:     bytes32 private constant _CTX_SLOT =
24:         0xe4ece82196de19aabe639620d7f716c433d1348f96ce727c9989a982dbadc2b9;

38:     Context private __ctx;

48:     uint256[43] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L23-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L48-L48)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

32:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

24:     uint8 private __srcDecimals;

32:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L24-L24) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L32-L32)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

16:     uint256[49] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L16-L16) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

19:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L19-L19) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

22:     string private __symbol;

25:     string private __name;

27:     uint256[46] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L22-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L25-L25), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L27-L27)


```solidity

File: /contracts/tokenvault/BaseNFTVault.sol

61:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseNFTVault.sol#L61-L61) 


```solidity

File: /contracts/tokenvault/BaseVault.sol

18:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L18-L18) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

32:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

54:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L54-L54) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

19:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L19-L19) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

11:     uint256[50] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L11-L11) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

57:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L57-L57) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

18:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L18-L18) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

30:     uint256[45] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L30-L30) 


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

16:     uint256[48] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L16-L16) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

23:     uint256[47] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L23-L23) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

82:     uint128[44] private __gap;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L82-L82) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

38:     bool private _checkLocalEnclaveReport;

39:     mapping(bytes32 enclave => bool trusted) private _trustedUserMrEnclave;

40:     mapping(bytes32 signer => bool trusted) private _trustedUserMrSigner;

47:     mapping(uint256 idx => mapping(bytes serialNum => bool revoked)) private _serialNumIsRevoked;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L40-L40), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L47-L47)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

18:     address private ES256VERIFIER;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L18-L18) 


</details>


### [NC&#x2011;113] Off-by-one timestamp error 
In Solidity, using `>=` or `<=` to compare against `block.timestamp` (alias `now`) may introduce off-by-one errors due to the fact that `block.timestamp` is only updated once per block and its value remains constant throughout the block's execution. If an operation happens at the exact second when `block.timestamp` changes, it could result in unexpected behavior. To avoid this, it's safer to use strict inequality operators (`>` or `<`). For instance, if a condition should only be met after a certain time, use `block.timestamp > time` rather than `block.timestamp >= time`. This way, potential off-by-one errors due to the exact timing of block mining are mitigated, leading to safer, more predictable contract behavior.


*There are 8 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProving.sol

414:         bool inProvingWindow = uint256(_ts.timestamp).max(_state.slotB.lastUnpausedAt)
415:             + _tier.provingWindow * 60 >= block.timestamp;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L414-L415) 


```solidity

File: /contracts/bridge/Bridge.sol

189:         if (block.timestamp >= invocationDelay + receivedAt) {

258:         if (block.timestamp >= invocationDelay + receivedAt) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L189-L189) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L258-L258)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

236:         return instances[id].validSince <= block.timestamp

237:             && block.timestamp <= instances[id].validSince + INSTANCE_EXPIRY;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L236-L236) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L237-L237)


```solidity

File: /contracts/team/TimelockTokenPool.sol

257:         if (block.timestamp <= _start) return 0;

260:         if (block.timestamp >= _start + _period) return _amount;

262:         if (block.timestamp <= _cliff) return 0;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L257-L257) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L260-L260), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L262-L262)


</details>


### [NC&#x2011;114] Lack of space near the operator 
Lack of space near operators in code can lead to reduced readability, making it more challenging to distinguish between different elements and understand the logic quickly. As a resolution, always include spaces around operators to ensure a clear visual separation, which promotes better maintainability and comprehension of the code.


*There are 79 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/gov/TaikoGovernor.sol

//@audit operator : /
124:         return 1_000_000_000 ether / 10_000; // 0.01% of Taiko Token


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L124-L124) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit operator : *
251:                 || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L251-L251) 


```solidity

File: /contracts/L1/provers/Guardians.sol

68:         if (_minGuardians < (_newGuardians.length + 1) >> 1 || _minGuardians > _newGuardians.length)

68:         if (_minGuardians < (_newGuardians.length + 1) >> 1 || _minGuardians > _newGuardians.length)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L68-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L68-L68)


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit operator : +
234:             for (uint256 i; i < 255 && _blockId >= i + 1; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L234-L234) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

//@audit operator : %
47:                 out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));

//@audit operator : /
47:                 out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));

//@audit operator : -
47:                 out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47-L47) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47-L47)


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit operator : /
197:         uint128 _amountUnlocked = amountUnlocked / 1e18; // divide first


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L197-L197) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit operator : +
354:         for (uint256 i; i < SGX_TCB_CPUSVN_SIZE + 1; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L354-L354) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : *
158:             uint256 acc = lowerDigit * (16 ** (2 * i));

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report

//@audit operator : *
158:             uint256 acc = lowerDigit * (16 ** (2 * i));

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report

//@audit operator : +
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L115), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L113), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L112), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L110), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L158-L158), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L109), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L108), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106-L107)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit operator : -
93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);

//@audit operator : *
93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);

//@audit operator : +
93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);

//@audit operator : -
93:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L93-L93)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

//@audit operator : +
140:         for (uint256 i = 2; i < 2 + paddingLen; ++i) {

//@audit operator : +
273:         for (uint256 i = 2; i < 2 + paddingLen; ++i) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L140-L140) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L273-L273)


</details>


### [NC&#x2011;115] Incorrect withdraw declaration 
In Solidity, it's essential for clarity and interoperability to correctly specify return types in function declarations. If the `withdraw` function is expected to return a `bool` to indicate success or failure, its omission could lead to ambiguity or unexpected behavior when interacting with or calling this function from other contracts or off-chain systems. Missing return values can mislead developers and potentially lead to contract integrations built on incorrect assumptions. To resolve this, the function declaration for `withdraw` should be modified to explicitly include the `bool` return type, ensuring clarity and correctness in contract interactions.


*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/TaikoL2.sol

163:     function withdraw(
164:         address _token,
165:         address _to
166:     )
167:         external
168:         onlyFromOwnerOrNamed("withdrawer")
169:         nonReentrant
170:         whenNotPaused
171:     {
172:         if (_to == address(0)) revert L2_INVALID_PARAM();
173:         if (_token == address(0)) {
174:             _to.sendEther(address(this).balance);
175:         } else {
176:             IERC20(_token).safeTransfer(_to, IERC20(_token).balanceOf(address(this)));
177:         }
178:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L178) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

88:     function withdraw(address user) external ongoingWithdrawals {
89:         (, uint256 amount) = getBalance(user);
90:         withdrawnAmount[user] += amount;
91:         IERC20(token).transferFrom(vault, user, amount);
92: 
93:         emit Withdrawn(user, amount);
94:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L88-L94) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

161:     function withdraw() external {
162:         _withdraw(msg.sender, msg.sender);
163:     }

168:     function withdraw(address _to, bytes memory _sig) external {
169:         if (_to == address(0)) revert INVALID_PARAM();
170:         bytes32 hash = keccak256(abi.encodePacked("Withdraw unlocked Taiko token to: ", _to));
171:         address recipient = ECDSA.recover(hash, _sig);
172:         _withdraw(recipient, _to);
173:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L161-L163) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L168-L173)


</details>


### [NC&#x2011;116] Avoid mutating function parameters 
Function parameters in Solidity are passed by value, meaning they are essentially local copies. Mutating them can lead to confusion and errors because the changes don't persist outside the function. By keeping function parameters immutable, you ensure clarity in code behavior, preventing unintended side-effects. If you need to modify a value based on a parameter, use a local variable inside the function, leaving the original parameter unaltered. By adhering to this practice, you maintain a clear distinction between input data and the internal processing logic, improving code readability and reducing the potential for bugs.


*There are 2 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

//@audit the following parameters are mutated tbsPtr,
269:     function _findPckTcbInfo(
270:         bytes memory der,
271:         uint256 tbsPtr,
272:         uint256 tbsParentPtr
273:     )
274:         private
275:         pure
276:         returns (
277:             bool success,
278:             uint256 pcesvn,
279:             uint256[] memory cpusvns,
280:             bytes memory fmspcBytes,
281:             bytes memory pceidBytes
282:         )
283:     {
284:         // iterate through the elements in the Extension sequence
285:         // until we locate the SGX Extension OID
286:         while (tbsPtr != 0) {
287:             uint256 internalPtr = der.firstChildOf(tbsPtr);
288:             if (der[internalPtr.ixs()] != 0x06) {
289:                 return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);
290:             }
291: 
292:             if (BytesUtils.compareBytes(der.bytesAt(internalPtr), SGX_EXTENSION_OID)) {
293:                 // 1.2.840.113741.1.13.1
294:                 internalPtr = der.nextSiblingOf(internalPtr);
295:                 uint256 extnValueParentPtr = der.rootOfOctetStringAt(internalPtr);
296:                 uint256 extnValuePtr = der.firstChildOf(extnValueParentPtr);
297: 
298:                 // Copy flags to memory to avoid stack too deep
299:                 PCKTCBFlags memory flags;
300: 
301:                 while (!(flags.fmspcFound && flags.pceidFound && flags.tcbFound)) {
302:                     uint256 extnValueOidPtr = der.firstChildOf(extnValuePtr);
303:                     if (der[extnValueOidPtr.ixs()] != 0x06) {
304:                         return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);
305:                     }
306:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), TCB_OID)) {
307:                         // 1.2.840.113741.1.13.1.2
308:                         (flags.tcbFound, pcesvn, cpusvns) = _findTcb(der, extnValueOidPtr);
309:                     }
310:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), PCEID_OID)) {
311:                         // 1.2.840.113741.1.13.1.3
312:                         uint256 pceidPtr = der.nextSiblingOf(extnValueOidPtr);
313:                         pceidBytes = der.bytesAt(pceidPtr);
314:                         flags.pceidFound = true;
315:                     }
316:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), FMSPC_OID)) {
317:                         // 1.2.840.113741.1.13.1.4
318:                         uint256 fmspcPtr = der.nextSiblingOf(extnValueOidPtr);
319:                         fmspcBytes = der.bytesAt(fmspcPtr);
320:                         flags.fmspcFound = true;
321:                     }
322: 
323:                     if (extnValuePtr.ixl() < extnValueParentPtr.ixl()) {
324:                         extnValuePtr = der.nextSiblingOf(extnValuePtr);
325:                     } else {
326:                         break;
327:                     }
328:                 }
329:                 success = flags.fmspcFound && flags.pceidFound && flags.tcbFound;
330:                 break;
331:             }
332: 
333:             if (tbsPtr.ixl() < tbsParentPtr.ixl()) {
334:                 tbsPtr = der.nextSiblingOf(tbsPtr);
335:             } else {
336:                 tbsPtr = 0; // exit
337:             }
338:         }
339:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L339) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

//@audit the following parameters are mutated _ixs,
29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {
30:         _ixs |= _ixf << 80;
31:         _ixs |= _ixl << 160;
32:         return _ixs;
33:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L33) 


</details>


### [NC&#x2011;117] A event should be emitted if a non immutable state variable is set in a constructor 



*There are 4 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

55:         sigVerifyLib = ISigVerifyLib(sigVerifyLibAddr);

56:         pemCertLib = PEMCertChainLib(pemCertLibAddr);

57:         owner = msg.sender;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L55-L55) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L57-L57)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

21:         ES256VERIFIER = es256Verifier;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L21-L21) 


</details>


### [NC&#x2011;118] Contracts use both += 1 and ++ (-- and -= 1) 
For consistency consider only using one of these incrementing methods. The instances bellow represents the less used technique.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProving.sol

293:                 tid_ = _blk.nextTransitionId++;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L293-L293) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

137:                     currentKeyIndex += 1;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L137-L137) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

359:             bitlen -= 1;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L359-L359) 


</details>


### [NC&#x2011;119] Returning a struct instead of returning many variables is better 
Returning a struct from a Solidity function instead of multiple variables offers several benefits, enhancing code clarity and efficiency. Structs allow for the grouping of related data into a single entity, making the function's return values more organized and easier to manage. This approach significantly improves readability, as it encapsulates the data logically, helping developers quickly understand the returned information's structure. Additionally, it simplifies function interfaces, reducing the potential for errors when handling multiple return values. By using structs, you can also easily extend or modify the returned data without altering the function signature, facilitating smoother updates and maintenance of your smart contract code.


*There are 3 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/team/TimelockTokenPool.sol

176:     function getMyGrantSummary(address _recipient)
177:         public
178:         view
179:         returns (
180:             uint128 amountOwned,
181:             uint128 amountUnlocked,
182:             uint128 amountWithdrawn,
183:             uint128 amountToWithdraw,
184:             uint128 costToWithdraw
185:         )
186:     {
187:         Recipient storage r = recipients[_recipient];
188: 
189:         amountOwned = _getAmountOwned(r.grant);
190:         amountUnlocked = _getAmountUnlocked(r.grant);
191: 
192:         amountWithdrawn = r.amountWithdrawn;
193:         amountToWithdraw = amountUnlocked - amountWithdrawn;
194: 
195:         // Note: precision is maintained at the token level rather than the wei level, otherwise,
196:         // `costPaid` must be a uint256.
197:         uint128 _amountUnlocked = amountUnlocked / 1e18; // divide first
198:         costToWithdraw = _amountUnlocked * r.grant.costPerToken - r.costPaid;
199:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L176-L199) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

269:     function _findPckTcbInfo(
270:         bytes memory der,
271:         uint256 tbsPtr,
272:         uint256 tbsParentPtr
273:     )
274:         private
275:         pure
276:         returns (
277:             bool success,
278:             uint256 pcesvn,
279:             uint256[] memory cpusvns,
280:             bytes memory fmspcBytes,
281:             bytes memory pceidBytes
282:         )
283:     {
284:         // iterate through the elements in the Extension sequence
285:         // until we locate the SGX Extension OID
286:         while (tbsPtr != 0) {
287:             uint256 internalPtr = der.firstChildOf(tbsPtr);
288:             if (der[internalPtr.ixs()] != 0x06) {
289:                 return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);
290:             }
291: 
292:             if (BytesUtils.compareBytes(der.bytesAt(internalPtr), SGX_EXTENSION_OID)) {
293:                 // 1.2.840.113741.1.13.1
294:                 internalPtr = der.nextSiblingOf(internalPtr);
295:                 uint256 extnValueParentPtr = der.rootOfOctetStringAt(internalPtr);
296:                 uint256 extnValuePtr = der.firstChildOf(extnValueParentPtr);
297: 
298:                 // Copy flags to memory to avoid stack too deep
299:                 PCKTCBFlags memory flags;
300: 
301:                 while (!(flags.fmspcFound && flags.pceidFound && flags.tcbFound)) {
302:                     uint256 extnValueOidPtr = der.firstChildOf(extnValuePtr);
303:                     if (der[extnValueOidPtr.ixs()] != 0x06) {
304:                         return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);
305:                     }
306:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), TCB_OID)) {
307:                         // 1.2.840.113741.1.13.1.2
308:                         (flags.tcbFound, pcesvn, cpusvns) = _findTcb(der, extnValueOidPtr);
309:                     }
310:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), PCEID_OID)) {
311:                         // 1.2.840.113741.1.13.1.3
312:                         uint256 pceidPtr = der.nextSiblingOf(extnValueOidPtr);
313:                         pceidBytes = der.bytesAt(pceidPtr);
314:                         flags.pceidFound = true;
315:                     }
316:                     if (BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), FMSPC_OID)) {
317:                         // 1.2.840.113741.1.13.1.4
318:                         uint256 fmspcPtr = der.nextSiblingOf(extnValueOidPtr);
319:                         fmspcBytes = der.bytesAt(fmspcPtr);
320:                         flags.fmspcFound = true;
321:                     }
322: 
323:                     if (extnValuePtr.ixl() < extnValueParentPtr.ixl()) {
324:                         extnValuePtr = der.nextSiblingOf(extnValuePtr);
325:                     } else {
326:                         break;
327:                     }
328:                 }
329:                 success = flags.fmspcFound && flags.pceidFound && flags.tcbFound;
330:                 break;
331:             }
332: 
333:             if (tbsPtr.ixl() < tbsParentPtr.ixl()) {
334:                 tbsPtr = der.nextSiblingOf(tbsPtr);
335:             } else {
336:                 tbsPtr = 0; // exit
337:             }
338:         }
339:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L269-L339) 


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

062:     function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
063:         internal
064:         pure
065:         returns (
066:             bool success,
067:             V3Struct.Header memory header,
068:             V3Struct.EnclaveReport memory localEnclaveReport,
069:             bytes memory signedQuoteData, // concatenation of header and local enclave report bytes
070:             V3Struct.ECDSAQuoteV3AuthData memory authDataV3
071:         )
072:     {
073:         success = true;
074:         localEnclaveReport = v3Quote.localEnclaveReport;
075:         V3Struct.EnclaveReport memory pckSignedQeReport = v3Quote.v3AuthData.pckSignedQeReport;
076: 
077:         require(
078:             localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
079:                 && localEnclaveReport.reportData.length == 64,
080:             "local QE report has wrong length"
081:         );
082:         require(
083:             pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
084:                 && pckSignedQeReport.reportData.length == 64,
085:             "QE report has wrong length"
086:         );
087:         require(
088:             v3Quote.v3AuthData.certification.certType == 5,
089:             "certType must be 5: Concatenated PCK Cert Chain (PEM formatted)"
090:         );
091:         require(
092:             v3Quote.v3AuthData.certification.decodedCertDataArray.length == 3, "3 certs in chain"
093:         );
094:         require(
095:             v3Quote.v3AuthData.ecdsa256BitSignature.length == 64
096:                 && v3Quote.v3AuthData.ecdsaAttestationKey.length == 64
097:                 && v3Quote.v3AuthData.qeReportSignature.length == 64,
098:             "Invalid ECDSA signature format"
099:         );
100:         require(
101:             v3Quote.v3AuthData.qeAuthData.parsedDataSize
102:                 == v3Quote.v3AuthData.qeAuthData.data.length,
103:             "Invalid QEAuthData size"
104:         );
105: 
106:         uint32 totalQuoteSize = 48 // header
107:             + 384 // local QE report
108:             + 64 // ecdsa256BitSignature
109:             + 64 // ecdsaAttestationKey
110:             + 384 // QE report
111:             + 64 // qeReportSignature
112:             + 2 // sizeof(v3Quote.v3AuthData.qeAuthData.parsedDataSize)
113:             + v3Quote.v3AuthData.qeAuthData.parsedDataSize + 2 // sizeof(v3Quote.v3AuthData.certification.certType)
114:             + 4 // sizeof(v3Quote.v3AuthData.certification.certDataSize)
115:             + v3Quote.v3AuthData.certification.certDataSize;
116:         require(totalQuoteSize >= MINIMUM_QUOTE_LENGTH, "Invalid quote size");
117: 
118:         header = v3Quote.header;
119:         bytes memory headerBytes = abi.encodePacked(
120:             header.version,
121:             header.attestationKeyType,
122:             header.teeType,
123:             header.qeSvn,
124:             header.pceSvn,
125:             header.qeVendorId,
126:             header.userData
127:         );
128: 
129:         signedQuoteData = abi.encodePacked(headerBytes, V3Parser.packQEReport(localEnclaveReport));
130:         authDataV3 = v3Quote.v3AuthData;
131:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62-L131) 


</details>


### [NC&#x2011;120] Not using the named return variables anywhere in the function is confusing 
Consider changing the variable to be an unnamed one, since the variable is never assigned, nor is it returned by name. If the optimizer is not turned on, leaving the code as it is will also waste gas for the stack variable.


*There are 7 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/libs/LibProving.sol

// @audit maxBlocksToVerify_
91:     function proveBlock(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L91) 


```solidity

File: /contracts/bridge/Bridge.sol

// @audit invocationDelay_
// @audit invocationExtraDelay_
417:     function getInvocationDelays()


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L417-L417) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

// @audit offset_
// @audit length_
// @audit type_
144:     function _decodeLength(RLPItem memory _in)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L144-L144) 


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

// @audit valid
126:     function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126-L126) 


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

// @audit success
216:     function _removeHeadersAndFooters(string memory pemData)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L216-L216) 


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

// @audit ret
188:     function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L188-L188) 


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

// @audit sigValid
113:     function verifyES256Signature(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L113-L113) 


</details>


### [NC&#x2011;121] Use named return values 
Using named returns makes the code more self-documenting, makes it easier to fill out NatSpec, and in some cases can save gas. The cases below are where there currently is at most one return statement, which is ideal for named returns.


*There are 141 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

54:     function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L54-L54) 


```solidity

File: /contracts/common/EssentialContract.sol

88:     function paused() public view returns (bool) {

140:     function _inNonReentrant() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L88-L88) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L140-L140)


```solidity

File: /contracts/libs/LibAddress.sol

61:     function isValidSignature(
62:         address _addr,
63:         bytes32 _hash,
64:         bytes memory _sig
65:     )
66:         internal
67:         view
68:         returns (bool)

77:     function isSenderEOA() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L61-L68) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L77-L77)


```solidity

File: /contracts/libs/LibMath.sol

12:     function min(uint256 _a, uint256 _b) internal pure returns (uint256) {

20:     function max(uint256 _a, uint256 _b) internal pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L12-L12) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibMath.sol#L20-L20)


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

48:     function propose(
49:         address[] memory _targets,
50:         uint256[] memory _values,
51:         bytes[] memory _calldatas,
52:         string memory _description
53:     )
54:         public
55:         override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
56:         returns (uint256)

69:     function propose(
70:         address[] memory _targets,
71:         uint256[] memory _values,
72:         string[] memory _signatures,
73:         bytes[] memory _calldatas,
74:         string memory _description
75:     )
76:         public
77:         virtual
78:         override(GovernorCompatibilityBravoUpgradeable)
79:         returns (uint256)

89:     function supportsInterface(bytes4 _interfaceId)
90:         public
91:         view
92:         override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
93:         returns (bool)

099:     function state(uint256 _proposalId)
100:         public
101:         view
102:         override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
103:         returns (ProposalState)

111:     function votingDelay() public pure override returns (uint256) {

117:     function votingPeriod() public pure override returns (uint256) {

123:     function proposalThreshold() public pure override returns (uint256) {

140:     function _cancel(
141:         address[] memory _targets,
142:         uint256[] memory _values,
143:         bytes[] memory _calldatas,
144:         bytes32 _descriptionHash
145:     )
146:         internal
147:         override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
148:         returns (uint256)

153:     function _executor()
154:         internal
155:         view
156:         override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
157:         returns (address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L48-L56) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L69-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L89-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L99-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L117-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L123-L123), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L153-L157)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

24:     function getMinDelay() public view override returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L24-L24) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

137:     function hashAssignment(
138:         ProverAssignment memory _assignment,
139:         address _taikoL1Address,
140:         bytes32 _blobHash
141:     )
142:         public
143:         view
144:         returns (bytes32)

164:     function _getProverFee(
165:         TaikoData.TierFee[] memory _tierFees,
166:         uint16 _tierId
167:     )
168:         private
169:         pure
170:         returns (uint256)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L137-L144) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L164-L170)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

122:     function canDepositEthToL2(
123:         TaikoData.State storage _state,
124:         TaikoData.Config memory _config,
125:         uint256 _amount
126:     )
127:         internal
128:         view
129:         returns (bool)

149:     function _encodeEthDeposit(address _addr, uint256 _amount) private pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L122-L129) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L149-L149)


```solidity

File: /contracts/L1/libs/LibProposing.sol

287:     function isBlobReusable(
288:         TaikoData.State storage _state,
289:         TaikoData.Config memory _config,
290:         bytes32 _blobHash
291:     )
292:         internal
293:         view
294:         returns (bool)

299:     function _isProposerPermitted(
300:         TaikoData.SlotB memory _slotB,
301:         IAddressResolver _resolver
302:     )
303:         private
304:         view
305:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L287-L294) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L299-L305)


```solidity

File: /contracts/L1/libs/LibUtils.sol

23:     function getTransition(
24:         TaikoData.State storage _state,
25:         TaikoData.Config memory _config,
26:         uint64 _blockId,
27:         bytes32 _parentHash
28:     )
29:         external
30:         view
31:         returns (TaikoData.TransitionState storage)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L23-L31) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

245:     function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L245-L245) 


```solidity

File: /contracts/L1/provers/Guardians.sol

101:     function isApproved(bytes32 _hash) public view returns (bool) {

107:     function numGuardians() public view returns (uint256) {

128:     function isApproved(uint256 _approvalBits) internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L101-L101) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L128-L128)


```solidity

File: /contracts/L1/TaikoL1.sol

132:     function canDepositEthToL2(uint256 _amount) public view returns (bool) {

137:     function isBlobReusable(bytes32 _blobHash) public view returns (bool) {

162:     function getTransition(
163:         uint64 _blockId,
164:         bytes32 _parentHash
165:     )
166:         public
167:         view
168:         returns (TaikoData.TransitionState memory)

186:     function getConfig() public view virtual override returns (TaikoData.Config memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L132-L132) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L137-L137), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L162-L168), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L186-L186)


```solidity

File: /contracts/L1/TaikoToken.sol

60:     function transfer(address _to, uint256 _amount) public override returns (bool) {

70:     function transferFrom(
71:         address _from,
72:         address _to,
73:         uint256 _amount
74:     )
75:         public
76:         override
77:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L60-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L70-L77)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

54:     function getMinTier(uint256) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L54-L54)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

66:     function getMinTier(uint256 _rand) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L66-L66)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

20:     function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {

66:     function getMinTier(uint256 _rand) public pure override returns (uint16) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L20-L20) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L66-L66)


```solidity

File: /contracts/L2/Lib1559Math.sol

16:     function basefee(
17:         uint256 _gasExcess,
18:         uint256 _adjustmentFactor
19:     )
20:         internal
21:         pure
22:         returns (uint256)

33:     function _ethQty(
34:         uint256 _gasExcess,
35:         uint256 _adjustmentFactor
36:     )
37:         private
38:         pure
39:         returns (uint256)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L16-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L33-L39)


```solidity

File: /contracts/L2/TaikoL2.sol

200:     function getBlockHash(uint64 _blockId) public view returns (bytes32) {

219:     function skipFeeCheck() public pure virtual returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L200-L200) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L219-L219)


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

43:     function getConfig() public view override returns (Config memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L43-L43) 


```solidity

File: /contracts/signal/SignalService.sol

63:     function sendSignal(bytes32 _signal) external returns (bytes32) {

68:     function syncChainData(
69:         uint64 _chainId,
70:         bytes32 _kind,
71:         uint64 _blockId,
72:         bytes32 _chainData
73:     )
74:         external
75:         returns (bytes32)

137:     function isChainDataSynced(
138:         uint64 _chainId,
139:         bytes32 _kind,
140:         uint64 _blockId,
141:         bytes32 _chainData
142:     )
143:         public
144:         view
145:         nonZeroValue(_chainData)
146:         returns (bool)

153:     function isSignalSent(address _app, bytes32 _signal) public view returns (bool) {

177:     function signalForChainData(
178:         uint64 _chainId,
179:         bytes32 _kind,
180:         uint64 _blockId
181:     )
182:         public
183:         pure
184:         returns (bytes32)

194:     function getSignalSlot(
195:         uint64 _chainId,
196:         address _app,
197:         bytes32 _signal
198:     )
199:         public
200:         pure
201:         returns (bytes32)

206:     function _verifyHopProof(
207:         uint64 _chainId,
208:         address _app,
209:         bytes32 _signal,
210:         bytes32 _value,
211:         HopProof memory _hop,
212:         address _signalService
213:     )
214:         internal
215:         virtual
216:         validSender(_app)
217:         nonZeroValue(_signal)
218:         nonZeroValue(_value)
219:         returns (bytes32)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L63-L63) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L68-L75), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L137-L146), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L153-L153), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L177-L184), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L194-L201), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L219)


```solidity

File: /contracts/bridge/Bridge.sol

340:     function isMessageSent(Message calldata _message) public view returns (bool) {

352:     function proveMessageFailed(
353:         Message calldata _message,
354:         bytes calldata _proof
355:     )
356:         public
357:         view
358:         returns (bool)

374:     function proveMessageReceived(
375:         Message calldata _message,
376:         bytes calldata _proof
377:     )
378:         public
379:         view
380:         returns (bool)

449:     function hashMessage(Message memory _message) public pure returns (bytes32) {

456:     function signalForFailedMessage(bytes32 _msgHash) public pure returns (bytes32) {

555:     function _loadContext() private view returns (Context memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L340-L340) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L352-L358), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L374-L380), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L449-L449), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L456-L456), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L555-L555)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

91:     function name()
92:         public
93:         view
94:         override(ERC20Upgradeable, IERC20MetadataUpgradeable)
95:         returns (string memory)

102:     function symbol()
103:         public
104:         view
105:         override(ERC20Upgradeable, IERC20MetadataUpgradeable)
106:         returns (string memory)

113:     function decimals()
114:         public
115:         view
116:         override(ERC20Upgradeable, IERC20MetadataUpgradeable)
117:         returns (uint8)

125:     function canonical() public view returns (address, uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L91-L95) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L102-L106), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L113-L117), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L125-L125)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

93:     function owner() public view override(IBridgedERC20, OwnableUpgradeable) returns (address) {

101:     function _isMigratingOut() internal view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L93-L93) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L101-L101)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

87:     function name() public view override(ERC721Upgradeable) returns (string memory) {

93:     function symbol() public view override(ERC721Upgradeable) returns (string memory) {

100:     function source() public view returns (address, uint256) {

107:     function tokenURI(uint256 _tokenId) public view virtual override returns (string memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L87-L87) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L100-L100), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L107-L107)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

115:     function name() public view returns (string memory) {

121:     function symbol() public view returns (string memory) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L115-L115) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L121-L121)


```solidity

File: /contracts/tokenvault/BaseVault.sol

39:     function supportsInterface(bytes4 _interfaceId) public view virtual override returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L39-L39) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

160:     function onERC1155BatchReceived(
161:         address,
162:         address,
163:         uint256[] calldata,
164:         uint256[] calldata,
165:         bytes calldata
166:     )
167:         external
168:         pure
169:         returns (bytes4)

175:     function onERC1155Received(
176:         address,
177:         address,
178:         uint256,
179:         uint256,
180:         bytes calldata
181:     )
182:         external
183:         pure
184:         returns (bytes4)

192:     function supportsInterface(bytes4 interfaceId)
193:         public
194:         view
195:         virtual
196:         override(BaseVault, ERC1155ReceiverUpgradeable)
197:         returns (bool)

204:     function name() public pure override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L160-L169) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L175-L184), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L192-L197), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L204-L204)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

316:     function name() public pure override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L316-L316) 


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

142:     function onERC721Received(
143:         address,
144:         address,
145:         uint256,
146:         bytes calldata
147:     )
148:         external
149:         pure
150:         returns (bytes4)

156:     function name() public pure override returns (bytes32) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L142-L150) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L156-L156)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

28:     function buildName(
29:         string memory _name,
30:         uint256 _srcChainId
31:     )
32:         internal
33:         pure
34:         returns (string memory)

39:     function buildSymbol(string memory _symbol) internal pure returns (string memory) {

43:     function buildURI(
44:         address _srcToken,
45:         uint256 _srcChainId
46:     )
47:         internal
48:         pure
49:         returns (string memory)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L28-L34) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L39-L39), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L49)


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25:     function excessivelySafeCall(
26:         address _target,
27:         uint256 _gas,
28:         uint256 _value,
29:         uint16 _maxCopy,
30:         bytes memory _calldata
31:     )
32:         internal
33:         returns (bool, bytes memory)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L33) 


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

15:     function slice(
16:         bytes memory _bytes,
17:         uint256 _start,
18:         uint256 _length
19:     )
20:         internal
21:         pure
22:         returns (bytes memory)

91:     function slice(bytes memory _bytes, uint256 _start) internal pure returns (bytes memory) {

102:     function toNibbles(bytes memory _bytes) internal pure returns (bytes memory) {

149:     function equal(bytes memory _bytes, bytes memory _other) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L15-L22) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L91-L91), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L102-L102), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L149-L149)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

90:     function addInstances(address[] calldata _instances)
91:         external
92:         onlyOwner
93:         returns (uint256[] memory)

118:     function registerInstance(V3Struct.ParsedV3QuoteStruct calldata _attestation)
119:         external
120:         returns (uint256)

171:     function getSignedHash(
172:         TaikoData.Transition memory _tran,
173:         address _newInstance,
174:         address _prover,
175:         bytes32 _metaHash
176:     )
177:         public
178:         view
179:         returns (bytes32)

233:     function _isInstanceValid(uint256 id, address instance) private view returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L90-L93) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L118-L120), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L171-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L233-L233)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

77:     function _verifyMerkleProof(
78:         bytes32[] calldata _proof,
79:         bytes32 _merkleRoot,
80:         bytes32 _value
81:     )
82:         internal
83:         pure
84:         virtual
85:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L77-L85) 


```solidity

File: /contracts/team/TimelockTokenPool.sol

204:     function getMyGrant(address _recipient) public view returns (Grant memory) {

235:     function _getAmountOwned(Grant memory _grant) private view returns (uint128) {

239:     function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {

245:     function _calcAmount(
246:         uint128 _amount,
247:         uint64 _start,
248:         uint64 _cliff,
249:         uint64 _period
250:     )
251:         private
252:         view
253:         returns (uint128)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L204-L204) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L235-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L239-L239), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L245-L253)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

138:     function verifyAttestation(bytes calldata data) external view override returns (bool) {

162:     function _verify(bytes calldata quote) private view returns (bool, bytes memory) {

175:     function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)
176:         private
177:         view
178:         returns (bool, EnclaveIdStruct.EnclaveIdStatus status)

206:     function _checkTcbLevels(
207:         IPEMCertChainLib.PCKCertificateField memory pck,
208:         TCBInfoStruct.TCBInfo memory tcb
209:     )
210:         private
211:         pure
212:         returns (bool, TCBInfoStruct.TCBStatus status)

229:     function _isCpuSvnHigherOrGreater(
230:         uint256[] memory pckCpuSvns,
231:         uint8[] memory tcbCpuSvns
232:     )
233:         private
234:         pure
235:         returns (bool)

248:     function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
249:         private
250:         view
251:         returns (bool)

303:     function _enclaveReportSigVerification(
304:         bytes memory pckCertPubKey,
305:         bytes memory signedQuoteData,
306:         V3Struct.ECDSAQuoteV3AuthData memory authDataV3,
307:         V3Struct.EnclaveReport memory qeEnclaveReport
308:     )
309:         private
310:         view
311:         returns (bool)

355:     function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
356:         external
357:         view
358:         override
359:         returns (bool, bytes memory)

364:     function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
365:         internal
366:         view
367:         returns (bool, bytes memory)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138-L138) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229-L235), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248-L251), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303-L311), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355-L359), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364-L367)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

14:     function ixs(uint256 self) internal pure returns (uint256) {

19:     function ixf(uint256 self) internal pure returns (uint256) {

24:     function ixl(uint256 self) internal pure returns (uint256) {

29:     function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {

47:     function root(bytes memory der) internal pure returns (uint256) {

56:     function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

66:     function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

77:     function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

87:     function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {

98:     function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {

111:     function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

121:     function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

131:     function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

141:     function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {

154:     function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

165:     function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

169:     function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {

179:     function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {

187:     function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L24-L24), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L29-L29), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L56-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L66-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L77-L77), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L87-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L98-L98), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L121-L121), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L165-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L187-L187)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

39:     function compare(bytes memory self, bytes memory other) internal pure returns (int256) {

56:     function compare(
57:         bytes memory self,
58:         uint256 offset,
59:         uint256 len,
60:         bytes memory other,
61:         uint256 otheroffset,
62:         uint256 otherlen
63:     )
64:         internal
65:         pure
66:         returns (int256)

116:     function equals(
117:         bytes memory self,
118:         uint256 offset,
119:         bytes memory other,
120:         uint256 otherOffset,
121:         uint256 len
122:     )
123:         internal
124:         pure
125:         returns (bool)

138:     function equals(
139:         bytes memory self,
140:         uint256 offset,
141:         bytes memory other,
142:         uint256 otherOffset
143:     )
144:         internal
145:         pure
146:         returns (bool)

160:     function equals(
161:         bytes memory self,
162:         uint256 offset,
163:         bytes memory other
164:     )
165:         internal
166:         pure
167:         returns (bool)

178:     function equals(bytes memory self, bytes memory other) internal pure returns (bool) {

284:     function substring(
285:         bytes memory self,
286:         uint256 offset,
287:         uint256 len
288:     )
289:         internal
290:         pure
291:         returns (bytes memory)

320:     function base32HexDecodeWord(
321:         bytes memory self,
322:         uint256 off,
323:         uint256 len
324:     )
325:         internal
326:         pure
327:         returns (bytes32)

371:     function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L56-L66), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L116-L125), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L138-L146), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L160-L167), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L178-L178), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L284-L291), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L320-L327), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L371-L371)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

43:     function pkcs1Sha256(
44:         bytes32 _sha256,
45:         bytes memory _s,
46:         bytes memory _e,
47:         bytes memory _m
48:     )
49:         internal
50:         view
51:         returns (bool)

191:     function pkcs1Sha256Raw(
192:         bytes memory _data,
193:         bytes memory _s,
194:         bytes memory _e,
195:         bytes memory _m
196:     )
197:         internal
198:         view
199:         returns (bool)

212:     function pkcs1Sha1(
213:         bytes20 _sha1,
214:         bytes memory _s,
215:         bytes memory _e,
216:         bytes memory _m
217:     )
218:         internal
219:         view
220:         returns (bool)

307:     function pkcs1Sha1Raw(
308:         bytes memory _data,
309:         bytes memory _s,
310:         bytes memory _e,
311:         bytes memory _m
312:     )
313:         internal
314:         view
315:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L43-L51) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L191-L199), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L212-L220), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L307-L315)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

24:     function verifyAttStmtSignature(
25:         bytes memory tbs,
26:         bytes memory signature,
27:         PublicKey memory publicKey,
28:         Algorithm alg
29:     )
30:         public
31:         view
32:         returns (bool)

54:     function verifyCertificateSignature(
55:         bytes memory tbs,
56:         bytes memory signature,
57:         PublicKey memory publicKey,
58:         CertSigAlgorithm alg
59:     )
60:         public
61:         view
62:         returns (bool)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L24-L32) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L54-L62)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

8:     function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {

34:     function toUnixTimestamp(
35:         uint16 year,
36:         uint8 month,
37:         uint8 day,
38:         uint8 hour,
39:         uint8 minute,
40:         uint8 second
41:     )
42:         internal
43:         pure
44:         returns (uint256)

71:     function isLeapYear(uint16 year) internal pure returns (bool) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L8-L8) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L34-L44), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L71-L71)


</details>


### [NC&#x2011;122] Consider moving duplicated strings to constants 



*There are 44 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L1/hooks/AssignmentHook.sol

70:         onlyFromNamed("taiko")

101:         IERC20 tko = IERC20(resolve("taiko_token", false));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L70-L70) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L101-L101)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

41:         _resolver.resolve("bridge", false).sendEther(msg.value);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L41-L41) 


```solidity

File: /contracts/L1/libs/LibProposing.sol

237:             IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));

207:         meta_.minTier = ITierProvider(_resolver.resolve("tier_provider", false)).getMinTier(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L237-L237) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L207-L207)


```solidity

File: /contracts/L1/libs/LibProving.sol

187:         IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));

141:             ITierProvider(_resolver.resolve("tier_provider", false)).getTier(_proof.tier);

23:     bytes32 public constant TIER_OP = bytes32("tier_optimistic");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L187-L187) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L141-L141), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L23-L23)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

188:                 IERC20 tko = IERC20(_resolver.resolve("taiko_token", false));

149:                         tierProvider = _resolver.resolve("tier_provider", false);

232:         ISignalService signalService = ISignalService(_resolver.resolve("signal_service", false));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L188-L188) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L232-L232)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

51:             ITaikoL1(resolve("taiko", false)).proveBlock(_meta.id, abi.encode(_meta, _tran, _proof));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L51-L51) 


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

23:                 verifierName: "tier_optimistic",

34:                 verifierName: "tier_guardian",


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L34-L34)


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

45:                 verifierName: "tier_guardian",

23:                 verifierName: "tier_sgx",


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L45-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L23-L23)


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

23:                 verifierName: "tier_optimistic",

45:                 verifierName: "tier_guardian",

34:                 verifierName: "tier_sgx",


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L23-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L34-L34)


```solidity

File: /contracts/L2/CrossChainOwned.sol

40:         onlyFromNamed("bridge")


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L40-L40) 


```solidity

File: /contracts/L2/TaikoL2.sol

148:             ISignalService(resolve("signal_service", false)).syncChainData(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L148-L148) 


```solidity

File: /contracts/signal/SignalService.sol

101:         address signalService = resolve(chainId, "signal_service", false);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L101-L101) 


```solidity

File: /contracts/bridge/Bridge.sol

397:         destBridge_ = resolve(_chainId, "bridge", true);

229:         address signalService = resolve("signal_service", false);

87:         onlyFromOwnerOrNamed("bridge_watchdog")


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L397-L397) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L87-L87)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

43:         onlyFromOwnerOrNamed("erc20_vault")


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L43-L43) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

61:         onlyFromNamed("erc721_vault")


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L61-L61) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

74:         onlyFromNamed("erc1155_vault")

52:         LibBridgedToken.validateInputs(_srcToken, _srcChainId, "foo", "foo");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L52-L52)


```solidity

File: /contracts/tokenvault/BaseVault.sol

23:         if (msg.sender != resolve("bridge", false)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L23-L23) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

77:             IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);

205:         return "erc1155_vault";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L77-L77) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L205-L205)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

239:             IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);

317:         return "erc20_vault";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L239-L239) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L317-L317)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

62:             IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);

157:         return "erc721_vault";


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L62-L62) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L157-L157)


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

25:             require(_length + 31 >= _length, "slice_overflow");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L25-L25) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

39:             "RLPReader: length of an RLP item must be greater than zero to be decodable"


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L39-L39) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

145:         onlyFromNamed("taiko")


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L145-L145) 


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

142:         require(der[ptr.ixs()] == 0x02, "Not type INTEGER");

143:         require(der[ptr.ixf()] & 0x80 == 0, "Not positive");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L142-L142) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L143-L143)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

212:         require(idx + 4 <= self.length, "unexpected idx");

264:         require(len <= 32, "unexpected len");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L212-L212) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L264-L264)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

75:             revert("Unsupported algorithm");


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L75-L75) 


</details>


### [NC&#x2011;123] Missing checks for uint state variable assignments 
Consider whether reasonable bounds checks for variables would be useful


*There are 14 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

70:         __paused = _TRUE;

79:         __paused = _FALSE;

111:         __paused = _FALSE;

125:             __reentry = _reentry;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L70-L70) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L79-L79), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L125-L125)


```solidity

File: /contracts/L1/provers/Guardians.sol

94:         minGuardians = _minGuardians;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/Guardians.sol#L94-L94) 


```solidity

File: /contracts/L2/TaikoL2.sol

96:         gasExcess = _gasExcess;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L96-L96) 


```solidity

File: /contracts/L2/TaikoL2EIP1559Configurable.sol

37:         gasExcess = _newGasExcess;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2EIP1559Configurable.sol#L37-L37) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

74:         srcChainId = _srcChainId;

75:         __srcDecimals = _decimals;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L74-L74) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L75-L75)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

48:         srcChainId = _srcChainId;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L48-L48) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

57:         srcChainId = _srcChainId;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L57-L57) 


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

71:         withdrawalWindow = _withdrawalWindow;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L71-L71) 


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

91:         claimStart = _claimStart;

92:         claimEnd = _claimEnd;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L91-L91) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L92-L92)


</details>


### [NC&#x2011;124] Consider adding validation of user inputs 



*There are 114 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/AddressManager.sol

//@audit these parameters `_owner`, are not checked
30:     function init(address _owner) external initializer {

//@audit these parameters ``, are not checked
58:     function _authorizePause(address) internal pure override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L30-L30) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/AddressManager.sol#L58-L58)


```solidity

File: /contracts/common/EssentialContract.sol

//@audit these parameters `_owner`, are not checked
95:     function __Essential_init(
96:         address _owner,
97:         address _addressManager

//@audit these parameters ``, are not checked
114:     function _authorizeUpgrade(address) internal virtual override onlyOwner { }

//@audit these parameters ``, are not checked
116:     function _authorizePause(address) internal virtual onlyOwner { }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L95-L97) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L114-L114), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L116-L116)


```solidity

File: /contracts/libs/LibAddress.sol

//@audit these parameters `_to`, are not checked
42:     function sendEther(address _to, uint256 _amount) internal {

//@audit these parameters `_addr`, are not checked
46:     function supportsInterface(
47:         address _addr,
48:         bytes4 _interfaceId


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L42-L42) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L46-L48)


```solidity

File: /contracts/libs/LibTrieProof.sol

//@audit these parameters `_addr`, are not checked
34:     function verifyMerkleProof(
35:         bytes32 _rootHash,
36:         address _addr,
37:         bytes32 _slot,
38:         bytes32 _value,
39:         bytes[] memory _accountProof,
40:         bytes[] memory _storageProof


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibTrieProof.sol#L34-L40) 


```solidity

File: /contracts/L1/gov/TaikoGovernor.sol

//@audit these parameters `_owner`,`_token`,`_timelock`, are not checked
31:     function init(
32:         address _owner,
33:         IVotesUpgradeable _token,
34:         TimelockControllerUpgradeable _timelock

//@audit these parameters `_targets`, are not checked
48:     function propose(
49:         address[] memory _targets,
50:         uint256[] memory _values,
51:         bytes[] memory _calldatas,
52:         string memory _description

//@audit these parameters `_targets`, are not checked
69:     function propose(
70:         address[] memory _targets,
71:         uint256[] memory _values,
72:         string[] memory _signatures,
73:         bytes[] memory _calldatas,
74:         string memory _description

//@audit these parameters `_targets`, are not checked
127:     function _execute(
128:         uint256 _proposalId,
129:         address[] memory _targets,
130:         uint256[] memory _values,
131:         bytes[] memory _calldatas,
132:         bytes32 _descriptionHash

//@audit these parameters `_targets`, are not checked
140:     function _cancel(
141:         address[] memory _targets,
142:         uint256[] memory _values,
143:         bytes[] memory _calldatas,
144:         bytes32 _descriptionHash


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L31-L34) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L48-L52), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L69-L74), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L127-L132), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoGovernor.sol#L140-L144)


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

//@audit these parameters `_owner`, are not checked
15:     function init(address _owner, uint256 _minDelay) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L15-L15) 


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
57:     function init(address _owner, address _addressManager) external initializer {

//@audit these parameters `_taikoL1Address`, are not checked
137:     function hashAssignment(
138:         ProverAssignment memory _assignment,
139:         address _taikoL1Address,
140:         bytes32 _blobHash


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L137-L140)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

//@audit these parameters `_resolver`, are not checked
29:     function depositEtherToL2(
30:         TaikoData.State storage _state,
31:         TaikoData.Config memory _config,
32:         IAddressResolver _resolver,
33:         address _recipient

//@audit these parameters `_feeRecipient`, are not checked
67:     function processDeposits(
68:         TaikoData.State storage _state,
69:         TaikoData.Config memory _config,
70:         address _feeRecipient


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L29-L33) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L67-L70)


```solidity

File: /contracts/L1/libs/LibProposing.sol

//@audit these parameters `_resolver`, are not checked
68:     function proposeBlock(
69:         TaikoData.State storage _state,
70:         TaikoData.Config memory _config,
71:         IAddressResolver _resolver,
72:         bytes calldata _data,
73:         bytes calldata _txList

//@audit these parameters `_resolver`, are not checked
299:     function _isProposerPermitted(
300:         TaikoData.SlotB memory _slotB,
301:         IAddressResolver _resolver


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L68-L73) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L299-L301)


```solidity

File: /contracts/L1/libs/LibProving.sol

//@audit these parameters `_resolver`, are not checked
91:     function proveBlock(
92:         TaikoData.State storage _state,
93:         TaikoData.Config memory _config,
94:         IAddressResolver _resolver,
95:         TaikoData.BlockMetadata memory _meta,
96:         TaikoData.Transition memory _tran,
97:         TaikoData.TierProof memory _proof

//@audit these parameters `_tko`, are not checked
350:     function _overrideWithHigherProof(
351:         TaikoData.TransitionState storage _ts,
352:         TaikoData.Transition memory _tran,
353:         TaikoData.TierProof memory _proof,
354:         ITierProvider.Tier memory _tier,
355:         IERC20 _tko,
356:         bool _sameTransition


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L91-L97) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L350-L356)


```solidity

File: /contracts/L1/libs/LibVerifying.sol

//@audit these parameters `_resolver`, are not checked
85:     function verifyBlocks(
86:         TaikoData.State storage _state,
87:         TaikoData.Config memory _config,
88:         IAddressResolver _resolver,
89:         uint64 _maxBlocksToVerify

//@audit these parameters `_resolver`, are not checked
224:     function _syncChainData(
225:         TaikoData.Config memory _config,
226:         IAddressResolver _resolver,
227:         uint64 _lastVerifiedBlockId,
228:         bytes32 _stateRoot


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L85-L89) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L224-L228)


```solidity

File: /contracts/L1/provers/GuardianProver.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
25:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L25-L25) 


```solidity

File: /contracts/L1/TaikoL1.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
42:     function init(
43:         address _owner,
44:         address _addressManager,
45:         bytes32 _genesisBlockHash

//@audit these parameters `_recipient`, are not checked
119:     function depositEtherToL2(address _recipient) external payable nonReentrant whenNotPaused {

//@audit these parameters ``, are not checked
220:     function _authorizePause(address)


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L42-L45) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L119-L119), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L220-L220)


```solidity

File: /contracts/L1/TaikoToken.sol

//@audit these parameters `_owner`,`_recipient`, are not checked
25:     function init(
26:         address _owner,
27:         string calldata _name,
28:         string calldata _symbol,
29:         address _recipient

//@audit these parameters `_from`, are not checked
47:     function burn(address _from, uint256 _amount) public onlyOwner {

//@audit these parameters `_from`, are not checked
70:     function transferFrom(
71:         address _from,
72:         address _to,
73:         uint256 _amount

//@audit these parameters `_from`,`_to`, are not checked
83:     function _beforeTokenTransfer(
84:         address _from,
85:         address _to,
86:         uint256 _amount

//@audit these parameters `_from`,`_to`, are not checked
94:     function _afterTokenTransfer(
95:         address _from,
96:         address _to,
97:         uint256 _amount

//@audit these parameters `_to`, are not checked
105:     function _mint(
106:         address _to,
107:         uint256 _amount

//@audit these parameters `_from`, are not checked
115:     function _burn(
116:         address _from,
117:         uint256 _amount


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L25-L29) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L70-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L83-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L94-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L105-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L115-L117)


```solidity

File: /contracts/L1/tiers/DevnetTierProvider.sol

//@audit these parameters `_owner`, are not checked
15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/DevnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L1/tiers/MainnetTierProvider.sol

//@audit these parameters `_owner`, are not checked
15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/MainnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L1/tiers/TestnetTierProvider.sol

//@audit these parameters `_owner`, are not checked
15:     function init(address _owner) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/TestnetTierProvider.sol#L15-L15) 


```solidity

File: /contracts/L2/CrossChainOwned.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
60:     function __CrossChainOwned_init(
61:         address _owner,
62:         address _addressManager,
63:         uint64 _ownerChainId


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L60-L63) 


```solidity

File: /contracts/L2/TaikoL2.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
71:     function init(
72:         address _owner,
73:         address _addressManager,
74:         uint64 _l1ChainId,
75:         uint64 _gasExcess


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L71-L75) 


```solidity

File: /contracts/signal/ISignalService.sol

//@audit these parameters `_app`, are not checked
84:     function proveSignalReceived(
85:         uint64 _chainId,
86:         address _app,
87:         bytes32 _signal,
88:         bytes calldata _proof

//@audit these parameters `_app`, are not checked
96:     function isSignalSent(address _app, bytes32 _signal) external view returns (bool);

//@audit these parameters `_app`, are not checked
84:     function proveSignalReceived(
85:         uint64 _chainId,
86:         address _app,
87:         bytes32 _signal,
88:         bytes calldata _proof

//@audit these parameters `_app`, are not checked
96:     function isSignalSent(address _app, bytes32 _signal) external view returns (bool);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L84-L88) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L96-L96), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L84-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L96-L96)


```solidity

File: /contracts/signal/SignalService.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
48:     function init(address _owner, address _addressManager) external initializer {

//@audit these parameters `_app`, are not checked
83:     function proveSignalReceived(
84:         uint64 _chainId,
85:         address _app,
86:         bytes32 _signal,
87:         bytes calldata _proof

//@audit these parameters `_app`, are not checked
194:     function getSignalSlot(
195:         uint64 _chainId,
196:         address _app,
197:         bytes32 _signal

//@audit these parameters `_app`,`_signalService`, are not checked
206:     function _verifyHopProof(
207:         uint64 _chainId,
208:         address _app,
209:         bytes32 _signal,
210:         bytes32 _value,
211:         HopProof memory _hop,
212:         address _signalService

//@audit these parameters ``, are not checked
231:     function _authorizePause(address) internal pure override {

//@audit these parameters `_app`, are not checked
253:     function _sendSignal(
254:         address _app,
255:         bytes32 _signal,
256:         bytes32 _value

//@audit these parameters `_app`, are not checked
298:     function _loadSignalValue(
299:         address _app,
300:         bytes32 _signal


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L83-L87), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L194-L197), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L206-L212), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L231-L231), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L253-L256), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L298-L300)


```solidity

File: /contracts/bridge/Bridge.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
75:     function init(address _owner, address _addressManager) external initializer {

//@audit these parameters ``, are not checked
461:     function _authorizePause(address)

//@audit these parameters `_from`, are not checked
541:     function _storeContext(bytes32 _msgHash, address _from, uint64 _srcChainId) private {

//@audit these parameters `_signalService`, are not checked
577:     function _proveSignalReceived(
578:         address _signalService,
579:         bytes32 _signal,
580:         uint64 _chainId,
581:         bytes calldata _proof


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L75-L75) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L461-L461), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L541-L541), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L577-L581)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

//@audit these parameters `_to`, are not checked
16:     function mint(address _to, uint256 _amount) external;

//@audit these parameters `from`,`_to`, are not checked
23:     function transferFrom(address from, address _to, uint256 _amount) external returns (bool);

//@audit these parameters `_owner`,`_addressManager`,`_usdc`, are not checked
38:     function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {

//@audit these parameters `_account`, are not checked
43:     function _mintToken(address _account, uint256 _amount) internal override {

//@audit these parameters `_from`, are not checked
47:     function _burnToken(address _from, uint256 _amount) internal override {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L23-L23), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L38-L38), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L47-L47)


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

//@audit these parameters `_owner`,`_addressManager`,`_srcToken`, are not checked
52:     function init(
53:         address _owner,
54:         address _addressManager,
55:         address _srcToken,
56:         uint256 _srcChainId,
57:         uint8 _decimals,
58:         string memory _symbol,
59:         string memory _name

//@audit these parameters `_snapshooter`, are not checked
80:     function setSnapshoter(address _snapshooter) external onlyOwner {

//@audit these parameters `_account`, are not checked
129:     function _mintToken(address _account, uint256 _amount) internal override {

//@audit these parameters `_from`, are not checked
133:     function _burnToken(address _from, uint256 _amount) internal override {

//@audit these parameters `_from`, are not checked
139:     function _beforeTokenTransfer(
140:         address _from,
141:         address _to,
142:         uint256 _amount

//@audit these parameters `_from`,`_to`, are not checked
152:     function _afterTokenTransfer(
153:         address _from,
154:         address _to,
155:         uint256 _amount

//@audit these parameters `_to`, are not checked
163:     function _mint(
164:         address _to,
165:         uint256 _amount

//@audit these parameters `_from`, are not checked
173:     function _burn(
174:         address _from,
175:         uint256 _amount


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L52-L59) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L80-L80), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L129-L129), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L133-L133), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L139-L142), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L152-L155), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L163-L165), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L173-L175)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

//@audit these parameters `_account`, are not checked
57:     function mint(address _account, uint256 _amount) public nonReentrant whenNotPaused {

//@audit these parameters `_account`, are not checked
97:     function _mintToken(address _account, uint256 _amount) internal virtual;

//@audit these parameters `_from`, are not checked
99:     function _burnToken(address _from, uint256 _amount) internal virtual;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L57-L57) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L97-L97), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L99-L99)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

//@audit these parameters `_owner`,`_addressManager`,`_srcToken`, are not checked
31:     function init(
32:         address _owner,
33:         address _addressManager,
34:         address _srcToken,
35:         uint256 _srcChainId,
36:         string memory _symbol,
37:         string memory _name

//@audit these parameters `_account`, are not checked
54:     function mint(
55:         address _account,
56:         uint256 _tokenId

//@audit these parameters ``, are not checked
115:     function _beforeTokenTransfer(
116:         address, /*_from*/
117:         address _to,
118:         uint256, /*_firstTokenId*/
119:         uint256 /*_batchSize*/


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L31-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L54-L56), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L115-L119)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

//@audit these parameters `_owner`,`_addressManager`,`_srcToken`, are not checked
38:     function init(
39:         address _owner,
40:         address _addressManager,
41:         address _srcToken,
42:         uint256 _srcChainId,
43:         string memory _symbol,
44:         string memory _name

//@audit these parameters `_to`, are not checked
66:     function mint(
67:         address _to,
68:         uint256 _tokenId,
69:         uint256 _amount

//@audit these parameters `_to`, are not checked
83:     function mintBatch(
84:         address _to,
85:         uint256[] memory _tokenIds,
86:         uint256[] memory _amounts

//@audit these parameters `_account`, are not checked
100:     function burn(
101:         address _account,
102:         uint256 _tokenId,
103:         uint256 _amount

//@audit these parameters ``,``, are not checked
125:     function _beforeTokenTransfer(
126:         address, /*_operator*/
127:         address, /*_from*/
128:         address _to,
129:         uint256[] memory, /*_ids*/
130:         uint256[] memory, /*_amounts*/
131:         bytes memory /*_data*/


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L38-L44) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L66-L69), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L83-L86), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L100-L103), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L125-L131)


```solidity

File: /contracts/tokenvault/BaseVault.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
32:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L32-L32) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

//@audit these parameters ``,``, are not checked
160:     function onERC1155BatchReceived(
161:         address,
162:         address,
163:         uint256[] calldata,
164:         uint256[] calldata,
165:         bytes calldata

//@audit these parameters ``,``, are not checked
175:     function onERC1155Received(
176:         address,
177:         address,
178:         uint256,
179:         uint256,
180:         bytes calldata

//@audit these parameters `to`, are not checked
214:     function _transferTokens(
215:         CanonicalNFT memory ctoken,
216:         address to,
217:         uint256[] memory tokenIds,
218:         uint256[] memory amounts

//@audit these parameters `_user`, are not checked
240:     function _handleMessage(
241:         address _user,
242:         BridgeTransferOp memory _op


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L160-L165) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L175-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L214-L218), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L240-L242)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

//@audit these parameters `_to`, are not checked
320:     function _transferTokens(
321:         CanonicalERC20 memory _ctoken,
322:         address _to,
323:         uint256 _amount

//@audit these parameters `_user`,`_to`, are not checked
348:     function _handleMessage(
349:         address _user,
350:         address _token,
351:         address _to,
352:         uint256 _amount


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L320-L323) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L348-L352)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

//@audit these parameters ``,``, are not checked
142:     function onERC721Received(
143:         address,
144:         address,
145:         uint256,
146:         bytes calldata

//@audit these parameters `_to`, are not checked
160:     function _transferTokens(
161:         CanonicalNFT memory _ctoken,
162:         address _to,
163:         uint256[] memory _tokenIds

//@audit these parameters `_user`, are not checked
187:     function _handleMessage(
188:         address _user,
189:         BridgeTransferOp memory _op


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L142-L146) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L160-L163), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L187-L189)


```solidity

File: /contracts/tokenvault/IBridgedERC20.sol

//@audit these parameters `_account`, are not checked
14:     function mint(address _account, uint256 _amount) external;

//@audit these parameters `_from`, are not checked
19:     function burn(address _from, uint256 _amount) external;

//@audit these parameters `_addr`, are not checked
24:     function changeMigrationStatus(address _addr, bool _inbound) external;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L14-L14) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L19-L19), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L24-L24)


```solidity

File: /contracts/tokenvault/LibBridgedToken.sol

//@audit these parameters `_srcToken`, are not checked
43:     function buildURI(
44:         address _srcToken,
45:         uint256 _srcChainId


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/LibBridgedToken.sol#L43-L45) 


```solidity

File: /contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

//@audit these parameters `_target`, are not checked
25:     function excessivelySafeCall(
26:         address _target,
27:         uint256 _gas,
28:         uint256 _value,
29:         uint16 _maxCopy,
30:         bytes memory _calldata


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25-L30) 


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
18:     function init(address _owner, address _addressManager) external initializer {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L18-L18) 


```solidity

File: /contracts/verifiers/SgxVerifier.sol

//@audit these parameters `_owner`,`_addressManager`, are not checked
83:     function init(address _owner, address _addressManager) external initializer {

//@audit these parameters `_instances`, are not checked
90:     function addInstances(address[] calldata _instances)

//@audit these parameters `_newInstance`,`_prover`, are not checked
171:     function getSignedHash(
172:         TaikoData.Transition memory _tran,
173:         address _newInstance,
174:         address _prover,
175:         bytes32 _metaHash

//@audit these parameters `oldInstance`,`newInstance`, are not checked
226:     function _replaceInstance(uint256 id, address oldInstance, address newInstance) private {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L83-L83) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L90-L90), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L171-L175), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L226-L226)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

//@audit these parameters `_owner`,`_token`,`_vault`, are not checked
27:     function init(
28:         address _owner,
29:         uint64 _claimStart,
30:         uint64 _claimEnd,
31:         bytes32 _merkleRoot,
32:         address _token,
33:         address _vault

//@audit these parameters `user`, are not checked
50:     function claimAndDelegate(
51:         address user,
52:         uint256 amount,
53:         bytes32[] calldata proof,
54:         bytes calldata delegationData


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L27-L33) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L50-L54)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

//@audit these parameters `_owner`,`_token`,`_vault`, are not checked
54:     function init(
55:         address _owner,
56:         uint64 _claimStart,
57:         uint64 _claimEnd,
58:         bytes32 _merkleRoot,
59:         address _token,
60:         address _vault,
61:         uint64 _withdrawalWindow

//@audit these parameters `user`, are not checked
78:     function claim(address user, uint256 amount, bytes32[] calldata proof) external nonReentrant {

//@audit these parameters `user`, are not checked
88:     function withdraw(address user) external ongoingWithdrawals {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L54-L61) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L88-L88)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

//@audit these parameters `_owner`,`_token`,`_vault`, are not checked
25:     function init(
26:         address _owner,
27:         uint64 _claimStart,
28:         uint64 _claimEnd,
29:         bytes32 _merkleRoot,
30:         address _token,
31:         address _vault

//@audit these parameters `user`, are not checked
47:     function claim(
48:         address user,
49:         uint256[] calldata tokenIds,
50:         bytes32[] calldata proof


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L25-L31) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L47-L50)


```solidity

File: /contracts/team/TimelockTokenPool.sol

//@audit these parameters `_owner`, are not checked
111:     function init(
112:         address _owner,
113:         address _taikoToken,
114:         address _costToken,
115:         address _sharedVault

//@audit these parameters `_recipient`, are not checked
150:     function void(address _recipient) external onlyOwner {

//@audit these parameters `_recipient`, are not checked
176:     function getMyGrantSummary(address _recipient)

//@audit these parameters `_recipient`, are not checked
204:     function getMyGrant(address _recipient) public view returns (Grant memory) {

//@audit these parameters `_recipient`,`_to`, are not checked
208:     function _withdraw(address _recipient, address _to) private {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L111-L115) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L176-L176), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L204-L204), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L208-L208)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

//@audit these parameters `pemCertLibAddr`, are not checked
21:     function parseInput(
22:         bytes memory quote,
23:         address pemCertLibAddr

//@audit these parameters `pemCertLibAddr`, are not checked
203:     function parseAuthDataAndVerifyCertType(
204:         bytes memory rawAuthData,
205:         address pemCertLibAddr

//@audit these parameters `pemCertLibAddr`, are not checked
267:     function parseCerificationChainBytes(
268:         bytes memory certBytes,
269:         address pemCertLibAddr


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21-L23) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203-L205), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267-L269)


</details>


### [NC&#x2011;125] Consider allowing users access to their funds at all times 
Users should always have access to their funds. Consider whether withdrawal functionality really must be disabled when the contract is paused.


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/L2/TaikoL2.sol

163:     function withdraw(
164:         address _token,
165:         address _to
166:     )
167:         external
168:         onlyFromOwnerOrNamed("withdrawer")
169:         nonReentrant
170:         whenNotPaused
171:     {
172:         if (_to == address(0)) revert L2_INVALID_PARAM();
173:         if (_token == address(0)) {
174:             _to.sendEther(address(this).balance);
175:         } else {
176:             IERC20(_token).safeTransfer(_to, IERC20(_token).balanceOf(address(this)));
177:         }
178:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L163-L178) 


</details>


### [NC&#x2011;126] Interfaces should use floating version pragmas 
If the file contains non-interfaces as well, the interfaces should be moved to a separate file.


*There are 14 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/IAddressManager.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/IAddressManager.sol#L2-L2) 


```solidity

File: /contracts/L1/hooks/IHook.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/IHook.sol#L2-L2) 


```solidity

File: /contracts/L1/ITaikoL1.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/ITaikoL1.sol#L2-L2) 


```solidity

File: /contracts/L1/tiers/ITierProvider.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/tiers/ITierProvider.sol#L2-L2) 


```solidity

File: /contracts/signal/ISignalService.sol

2: pragma solidity 0.8.24;

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L2-L2) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/ISignalService.sol#L2-L2)


```solidity

File: /contracts/bridge/IBridge.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/IBridge.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L2-L2) 


```solidity

File: /contracts/tokenvault/IBridgedERC20.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L2-L2) 


```solidity

File: /contracts/verifiers/IVerifier.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/IVerifier.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/interfaces/IAttestation.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/IAttestation.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/interfaces/ISigVerifyLib.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L2-L2) 


```solidity

File: /contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

2: pragma solidity 0.8.24;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L2-L2) 


</details>


### [NC&#x2011;127] Consider disallowing transfers to `address(this)` 
Consider preventing a contract's tokens from being transferred/minted to the contract itself


*There are 6 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/tokenvault/adapters/USDCAdapter.sol

16:     function mint(address _to, uint256 _amount) external;

23:     function transferFrom(address from, address _to, uint256 _amount) external returns (bool);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L16-L16) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L23-L23)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

57:     function mint(address _account, uint256 _amount) public nonReentrant whenNotPaused {
58:         // mint is disabled while migrating outbound.
59:         if (_isMigratingOut()) revert BB_MINT_DISALLOWED();
60: 
61:         if (msg.sender == migratingAddress) {
62:             // Inbound migration
63:             emit MigratedTo(migratingAddress, _account, _amount);
64:         } else if (msg.sender != resolve("erc20_vault", true)) {
65:             // Bridging from vault
66:             revert BB_PERMISSION_DENIED();
67:         }
68: 
69:         _mintToken(_account, _amount);
70:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L57-L70) 


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

54:     function mint(
55:         address _account,
56:         uint256 _tokenId
57:     )
58:         public
59:         nonReentrant
60:         whenNotPaused
61:         onlyFromNamed("erc721_vault")
62:     {
63:         _safeMint(_account, _tokenId);
64:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L54-L64) 


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

66:     function mint(
67:         address _to,
68:         uint256 _tokenId,
69:         uint256 _amount
70:     )
71:         public
72:         nonReentrant
73:         whenNotPaused
74:         onlyFromNamed("erc1155_vault")
75:     {
76:         _mint(_to, _tokenId, _amount, "");
77:     }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L66-L77) 


```solidity

File: /contracts/tokenvault/IBridgedERC20.sol

14:     function mint(address _account, uint256 _amount) external;


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/IBridgedERC20.sol#L14-L14) 


</details>


### [NC&#x2011;128] Unusual loop variable 
For better readability, try to use common loop counter names


*There are 1 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/automata-attestation/utils/BytesUtils.sol

//@audit `idx` 
080:         for (uint256 idx = 0; idx < shortest; idx += 32) {
081:             uint256 a;
082:             uint256 b;
083:             assembly {
084:                 a := mload(selfptr)
085:                 b := mload(otherptr)
086:             }
087:             if (a != b) {
088:                 // Mask out irrelevant bytes and check again
089:                 uint256 mask;
090:                 if (shortest > 32) {
091:                     mask = type(uint256).max; // aka 0xffffff....
092:                 } else {
093:                     mask = ~(2 ** (8 * (32 - shortest + idx)) - 1);
094:                 }
095:                 uint256 diff = (a & mask) - (b & mask);
096:                 if (diff != 0) {
097:                     return int256(diff);
098:                 }
099:             }
100:             selfptr += 32;
101:             otherptr += 32;
102:         }


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L80-L102) 


</details>


### [NC&#x2011;129] Consider using named function calls 
Named function calls in Solidity greatly improve code readability by explicitly mapping arguments to their respective parameter names. This clarity becomes critical when dealing with functions that have numerous or complex parameters, reducing potential errors due to misordered arguments. Therefore, adopting named function calls contributes to more maintainable and less error-prone code.


*There are 176 instances of this issue:*



<details>
<summary>see instances</summary>


```solidity
File: /contracts/common/EssentialContract.sol

42:         if (msg.sender != owner() && msg.sender != resolve(_name, true)) revert RESOLVER_DENIED();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/common/EssentialContract.sol#L42-L42) 


```solidity

File: /contracts/libs/LibAddress.sol

43:         sendEther(_to, _amount, gasleft());


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/libs/LibAddress.sol#L43-L43) 


```solidity

File: /contracts/L1/gov/TaikoTimelockController.sol

18:         __TimelockController_init(_minDelay, nil, nil, owner());

25:         return hasRole(TIMELOCK_ADMIN_ROLE, msg.sender) ? 0 : super.getMinDelay();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L18-L18) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/gov/TaikoTimelockController.sol#L25-L25)


```solidity

File: /contracts/L1/hooks/AssignmentHook.sol

58:         __Essential_init(_owner, _addressManager);

94:         bytes32 hash = hashAssignment(assignment, taikoL1Address, _meta.blobHash);

105:         uint256 proverFee = _getProverFee(assignment.tierFees, _meta.minTier);

101:         IERC20 tko = IERC20(resolve("taiko_token", false));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L58-L58) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L105-L105), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/hooks/AssignmentHook.sol#L101-L101)


```solidity

File: /contracts/L1/libs/LibDepositing.sol

37:         if (!canDepositEthToL2(_state, _config, msg.value)) {

48:         _state.ethDeposits[slot] = _encodeEthDeposit(recipient_, msg.value);

110:                 _encodeEthDeposit(_feeRecipient, totalFee);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L48-L48), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibDepositing.sol#L110-L110)


```solidity

File: /contracts/L1/libs/LibProposing.sol

94:         if (!_isProposerPermitted(b, _resolver)) revert L1_UNAUTHORIZED();

148:                 if (!isBlobReusable(_state, _config, params.blobHash)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L94-L94) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProposing.sol#L148-L148)


```solidity

File: /contracts/L1/libs/LibProving.sol

130:             _createTransition(_state, blk, _tran, slot);

144:         _checkProverPermission(_state, blk, ts, tid, tier);

207:             _overrideWithHigherProof(ts, _tran, _proof, tier, tko, sameTransition);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L130-L130) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L144-L144), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibProving.sol#L207-L207)


```solidity

File: /contracts/L1/libs/LibUtils.sol

42:         uint32 tid = getTransitionId(_state, blk, slot, _parentHash);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibUtils.sol#L42-L42) 


```solidity

File: /contracts/L1/libs/LibVerifying.sol

219:                 _syncChainData(_config, _resolver, lastVerifiedBlockId, stateRoot);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/libs/LibVerifying.sol#L219-L219) 


```solidity

File: /contracts/L1/provers/GuardianProver.sol

26:         __Essential_init(_owner, _addressManager);

47:         approved_ = approve(_meta.id, hash);

51:             ITaikoL1(resolve("taiko", false)).proveBlock(_meta.id, abi.encode(_meta, _tran, _proof));


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L26-L26) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L47-L47), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/provers/GuardianProver.sol#L51-L51)


```solidity

File: /contracts/L1/TaikoL1.sol

50:         __Essential_init(_owner, _addressManager);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoL1.sol#L50-L50) 


```solidity

File: /contracts/L1/TaikoToken.sol

35:         __ERC20_init(_name, _symbol);

41:         _mint(_recipient, 1_000_000_000 ether);

48:         _burn(_from, _amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L35-L35) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L41-L41), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L1/TaikoToken.sol#L48-L48)


```solidity

File: /contracts/L2/CrossChainOwned.sol

69:         __Essential_init(_owner, _addressManager);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/CrossChainOwned.sol#L69-L69) 


```solidity

File: /contracts/L2/Lib1559Math.sol

28:         return _ethQty(_gasExcess, _adjustmentFactor) / LibFixedPointMath.SCALING_FACTOR


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/Lib1559Math.sol#L28-L28) 


```solidity

File: /contracts/L2/TaikoL2.sol

80:         __CrossChainOwned_init(_owner, _addressManager, _l1ChainId);

140:         (basefee, gasExcess) = _calc1559BaseFee(config, _l1BlockId, _parentGasUsed);

193:         (basefee_,) = _calc1559BaseFee(getConfig(), _l1BlockId, _parentGasUsed);

148:             ISignalService(resolve("signal_service", false)).syncChainData(


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L80-L80) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L140-L140), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L193-L193), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/L2/TaikoL2.sol#L148-L148)


```solidity

File: /contracts/signal/SignalService.sol

49:         __Essential_init(_owner, _addressManager);

64:         return _sendSignal(msg.sender, _signal, _signal);

78:         return _syncChainData(_chainId, _kind, _blockId, _chainData);

101:         address signalService = resolve(chainId, "signal_service", false);

148:         bytes32 signal = signalForChainData(_chainId, _kind, _blockId);

245:         _sendSignal(address(this), signal_, _chainData);

308:         bytes32 slot = getSignalSlot(uint64(block.chainid), _app, _signal);

149:         return _loadSignalValue(address(this), signal) == _chainData;

154:         return _loadSignalValue(_app, _signal) != 0;

224:             getSignalSlot(_chainId, _app, _signal),

244:         signal_ = signalForChainData(_chainId, _kind, _blockId);

264:         slot_ = getSignalSlot(uint64(block.chainid), _app, _signal);

107:             bytes32 signalRoot = _verifyHopProof(chainId, app, signal, value, hop, signalService);

122:             _cacheChainData(hop, chainId, hop.blockId, signalRoot, isFullProof, isLastHop);

131:         if (value == 0 || value != _loadSignalValue(address(this), signal)) {

170:             bytes32 signal = signalForChainData(_chainId, _kind, blockId_);

286:             _syncChainData(_chainId, LibSignals.STATE_ROOT, _blockId, _hop.rootHash);

294:             _syncChainData(_chainId, LibSignals.SIGNAL_ROOT, _blockId, _signalRoot);

125:             signal = signalForChainData(chainId, kind, hop.blockId);

171:             chainData_ = _loadSignalValue(address(this), signal);

117:                 signalService = resolve(hop.chainId, "signal_service", false);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L49-L49) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L101-L101), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L245-L245), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L308-L308), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L154-L154), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L224-L224), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L244-L244), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L264-L264), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L107-L107), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L131-L131), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L170-L170), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L286-L286), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L294-L294), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L125-L125), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L171-L171), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/signal/SignalService.sol#L117-L117)


```solidity

File: /contracts/bridge/Bridge.sol

76:         __Essential_init(_owner, _addressManager);

229:         address signalService = resolve("signal_service", false);

331:         if (_invokeMessageCall(_message, msgHash, gasleft())) {

362:         return _proveSignalReceived(
363:             resolve("signal_service", false),
364:             signalForFailedMessage(hashMessage(_message)),
365:             _message.destChainId,
366:             _proof
367:         );

383:         return _proveSignalReceived(
384:             resolve("signal_service", false), hashMessage(_message), _message.srcChainId, _proof
385:         );

488:         _storeContext(_msgHash, _message.from, _message.srcChainId);

363:             resolve("signal_service", false),

384:             resolve("signal_service", false), hashMessage(_message), _message.srcChainId, _proof

397:         destBridge_ = resolve(_chainId, "bridge", true);

172:             address signalService = resolve("signal_service", false);

332:             _updateMessageStatus(msgHash, Status.DONE);

533:             _storeContext(bytes32(PLACEHOLDER), address(uint160(PLACEHOLDER)), uint64(PLACEHOLDER));

531:             _storeContext(bytes32(0), address(0), uint64(0));

589:             (_chainId, resolve(_chainId, "bridge", false), _signal, _proof)

150:         ISignalService(resolve("signal_service", false)).sendSignal(msgHash_);

179:             if (!_proveSignalReceived(signalService, failureSignal, _message.destChainId, _proof)) {

236:             if (!_proveSignalReceived(signalService, msgHash, _message.srcChainId, _proof)) {

334:             _updateMessageStatus(msgHash, Status.FAILED);

342:         return ISignalService(resolve("signal_service", false)).isSignalSent({

196:                 _storeContext(msgHash, address(this), _message.srcChainId);

282:                 if (_invokeMessageCall(_message, msgHash, gasLimit)) {

276:                 _updateMessageStatus(msgHash, Status.DONE);

522:             ISignalService(resolve("signal_service", false)).sendSignal(

285:                     _updateMessageStatus(msgHash, Status.RETRIABLE);

283:                     _updateMessageStatus(msgHash, Status.DONE);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L76-L76) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L229-L229), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L331-L331), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L362-L367), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L383-L385), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L488-L488), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L363-L363), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L384-L384), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L397-L397), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L332-L332), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L533-L533), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L531-L531), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L589-L589), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L150-L150), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L179-L179), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L236-L236), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L334-L334), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L342-L342), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L196-L196), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L282-L282), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L276-L276), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L522-L522), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L285-L285), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/bridge/Bridge.sol#L283-L283)


```solidity

File: /contracts/tokenvault/adapters/USDCAdapter.sol

39:         __Essential_init(_owner, _addressManager);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/adapters/USDCAdapter.sol#L39-L39) 


```solidity

File: /contracts/tokenvault/BridgedERC20.sol

66:         __Essential_init(_owner, _addressManager);

67:         __ERC20_init(_name, _symbol);

130:         _mint(_account, _amount);

134:         _burn(_from, _amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L66-L66) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L67-L67), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L130-L130), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20.sol#L134-L134)


```solidity

File: /contracts/tokenvault/BridgedERC20Base.sol

69:         _mintToken(_account, _amount);

88:         _burnToken(_account, _amount);

64:         } else if (msg.sender != resolve("erc20_vault", true)) {

83:         } else if (msg.sender != resolve("erc20_vault", true)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L69-L69) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L88-L88), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC20Base.sol#L83-L83)


```solidity

File: /contracts/tokenvault/BridgedERC721.sol

44:         __Essential_init(_owner, _addressManager);

45:         __ERC721_init(_name, _symbol);

63:         _safeMint(_account, _tokenId);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L44-L44) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L45-L45), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC721.sol#L63-L63)


```solidity

File: /contracts/tokenvault/BridgedERC1155.sol

53:         __Essential_init(_owner, _addressManager);

76:         _mint(_to, _tokenId, _amount, "");

93:         _mintBatch(_to, _tokenIds, _amounts, "");

110:         _burn(_account, _tokenId, _amount);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L53-L53) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L76-L76), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L93-L93), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BridgedERC1155.sol#L110-L110)


```solidity

File: /contracts/tokenvault/BaseVault.sol

33:         __Essential_init(_owner, _addressManager);

54:         address selfOnSourceChain = resolve(ctx_.srcChainId, name(), false);

23:         if (msg.sender != resolve("bridge", false)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L33-L33) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L54-L54), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/BaseVault.sol#L23-L23)


```solidity

File: /contracts/tokenvault/ERC1155Vault.sol

55:         (bytes memory data, CanonicalNFT memory ctoken) = _handleMessage(msg.sender, _op);

111:         address token = _transferTokens(ctoken, to, tokenIds, amounts);

145:         address token = _transferTokens(ctoken, message.srcOwner, tokenIds, amounts);

65:             to: resolve(_op.destChainId, name(), false),

309:         btoken_ = address(new ERC1967Proxy(resolve("bridged_erc1155", false), data));

77:             IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L55-L55) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L111-L111), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L145-L145), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L65-L65), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L309-L309), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC1155Vault.sol#L77-L77)


```solidity

File: /contracts/tokenvault/ERC20Vault.sol

219:             _handleMessage(msg.sender, _op.token, _op.to, _op.amount);

270:         address token = _transferTokens(ctoken, to, amount);

303:         address token = _transferTokens(ctoken, _message.srcOwner, amount);

228:             to: resolve(_op.destChainId, name(), false),

421:         btoken = address(new ERC1967Proxy(resolve("bridged_erc20", false), data));

239:             IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L219-L219) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L270-L270), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L228-L228), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L421-L421), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC20Vault.sol#L239-L239)


```solidity

File: /contracts/tokenvault/ERC721Vault.sol

42:         (bytes memory data, CanonicalNFT memory ctoken) = _handleMessage(msg.sender, _op);

94:         address token = _transferTokens(ctoken, to, tokenIds);

128:         address token = _transferTokens(ctoken, _message.srcOwner, tokenIds);

51:             to: resolve(_op.destChainId, name(), false),

246:         btoken_ = address(new ERC1967Proxy(resolve("bridged_erc721", false), data));

62:             IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L42-L42) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L94-L94), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L128-L128), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L51-L51), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L246-L246), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/tokenvault/ERC721Vault.sol#L62-L62)


```solidity

File: /contracts/thirdparty/optimism/Bytes.sol

95:         return slice(_bytes, _start, _bytes.length - _start);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/Bytes.sol#L95-L95) 


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPReader.sol

122:         out_ = _copy(_in.ptr, itemOffset, itemLength);

136:         out_ = _copy(_in.ptr, 0, _in.length);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L122-L122) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPReader.sol#L136-L136)


```solidity

File: /contracts/thirdparty/optimism/rlp/RLPWriter.sol

17:             out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/rlp/RLPWriter.sol#L17-L17) 


```solidity

File: /contracts/thirdparty/optimism/trie/MerkleTrie.sol

60:         valid_ = Bytes.equal(_value, get(_key, _proof, _root));

145:                 uint256 sharedNibbleLength = _getSharedNibbleLength(pathRemainder, keyRemainder);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L60-L60) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/thirdparty/optimism/trie/MerkleTrie.sol#L145-L145)


```solidity

File: /contracts/verifiers/GuardianVerifier.sol

19:         __Essential_init(_owner, _addressManager);

31:         if (_ctx.msgSender != resolve("guardian_prover", false)) {


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L19-L19) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/GuardianVerifier.sol#L31-L31)


```solidity

File: /contracts/verifiers/SgxVerifier.sol

84:         __Essential_init(_owner, _addressManager);

95:         return _addInstances(_instances, true);

162:         _replaceInstance(id, oldInstance, newInstance);

181:         address taikoL1 = resolve("taiko", false);

122:         address automataDcapAttestation = (resolve("automata_dcap_attestation", true));

135:         return _addInstances(_address, false)[0];

159:             ECDSA.recover(getSignedHash(_tran, newInstance, _ctx.prover, _ctx.metaHash), signature);

161:         if (!_isInstanceValid(id, oldInstance)) revert SGX_INVALID_INSTANCE();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L84-L84) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L95-L95), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L162-L162), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L181-L181), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L122-L122), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L135-L135), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L159-L159), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/verifiers/SgxVerifier.sol#L161-L161)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop.sol

39:         __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);

60:         _verifyClaim(abi.encode(user, amount), proof);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L39-L39) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop.sol#L60-L60)


```solidity

File: /contracts/team/airdrop/ERC20Airdrop2.sol

67:         __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);

80:         _verifyClaim(abi.encode(user, amount), proof);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L67-L67) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC20Airdrop2.sol#L80-L80)


```solidity

File: /contracts/team/airdrop/ERC721Airdrop.sol

37:         __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);

56:         _verifyClaim(abi.encode(user, tokenIds), proof);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L37-L37) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/ERC721Airdrop.sol#L56-L56)


```solidity

File: /contracts/team/airdrop/MerkleClaimable.sol

53:         _setConfig(_claimStart, _claimEnd, _merkleRoot);

64:         _setConfig(_claimStart, _claimEnd, _merkleRoot);

71:         if (!_verifyMerkleProof(proof, merkleRoot, hash)) revert INVALID_PROOF();


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L53-L53) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L64-L64), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/airdrop/MerkleClaimable.sol#L71-L71)


```solidity

File: /contracts/team/TimelockTokenPool.sol

162:         _withdraw(msg.sender, msg.sender);

172:         _withdraw(recipient, _to);

236:         return _calcAmount(_grant.amount, _grant.grantStart, _grant.grantCliff, _grant.grantPeriod);

240:         return _calcAmount(
241:             _getAmountOwned(_grant), _grant.unlockStart, _grant.unlockCliff, _grant.unlockPeriod
242:         );

269:         _validateCliff(_grant.grantStart, _grant.grantCliff, _grant.grantPeriod);

270:         _validateCliff(_grant.unlockStart, _grant.unlockCliff, _grant.unlockPeriod);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L162-L162) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L172-L172), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L236-L236), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L240-L242), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L269-L269), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/team/TimelockTokenPool.sol#L270-L270)


```solidity

File: /contracts/automata-attestation/AutomataDcapV3Attestation.sol

471:             bool enclaveReportSigsVerified = _enclaveReportSigVerification(
472:                 parsedQuoteCerts[0].pubKey,
473:                 signedQuoteData,
474:                 authDataV3,
475:                 v3quote.v3AuthData.pckSignedQeReport
476:             );

217:             bool cpuSvnsAreHigherOrGreater = _isCpuSvnHigherOrGreater(
218:                 pck.sgxExtension.sgxTcbCompSvnArr, current.sgxTcbCompSvnArr
219:             );

454:             (tcbVerified, tcbStatus) = _checkTcbLevels(parsedQuoteCerts[0].pck, fetchedTcbInfo);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L471-L476) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L217-L219), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/AutomataDcapV3Attestation.sol#L454-L454)


```solidity

File: /contracts/automata-attestation/lib/PEMCertChainLib.sol

174:             bytes memory sigX = _trimBytes(der.bytesAt(sigPtr), 32);

177:             bytes memory sigY = _trimBytes(der.bytesAt(sigPtr), 32);

180:             cert.pubKey = _trimBytes(der.bytesAt(subjectPublicKeyInfoPtr), 64);

202:                 _findPckTcbInfo(der, tbsPtr, tbsParentPtr);

308:                         (flags.tcbFound, pcesvn, cpusvns) = _findTcb(der, extnValueOidPtr);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L174-L174) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L177-L177), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L180-L180), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L202-L202), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/PEMCertChainLib.sol#L308-L308)


```solidity

File: /contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

46:             parseAuthDataAndVerifyCertType(quote.substring(436, localAuthDataSize), pemCertLibAddr);

225:         cert.decodedCertDataArray = parseCerificationChainBytes(certData, pemCertLibAddr);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L46-L46) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L225-L225)


```solidity

File: /contracts/automata-attestation/utils/Asn1Decode.sol

48:         return _readNodeLength(der, 0);

58:         return _readNodeLength(der, ptr.ixf() + 1);

68:         return _readNodeLength(der, ptr.ixf());

78:         return _readNodeLength(der, ptr.ixl() + 1);

89:         return _readNodeLength(der, ptr.ixf());


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L48-L48) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L58-L58), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L78-L78), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/Asn1Decode.sol#L89-L89)


```solidity

File: /contracts/automata-attestation/utils/BytesUtils.sol

40:         return compare(self, 0, self.length, other, 0, other.length);

303:         memcpy(dest, src, len);

127:         return keccak(self, offset, len) == keccak(other, otherOffset, len);

127:         return keccak(self, offset, len) == keccak(other, otherOffset, len);

148:         return keccak(self, offset, self.length - offset)

149:             == keccak(other, otherOffset, other.length - otherOffset);

169:         return self.length >= offset + other.length && equals(self, offset, other, 0, other.length);

179:         return self.length == other.length && equals(self, 0, other, 0, self.length);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L40-L40) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L303-L303), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L127-L127), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L148-L148), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L149-L149), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L169-L169), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/BytesUtils.sol#L179-L179)


```solidity

File: /contracts/automata-attestation/utils/RsaVerify.sol

201:         return pkcs1Sha256(sha256(_data), _s, _e, _m);

317:         return pkcs1Sha1(SHA1.sha1(_data), _s, _e, _m);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L201-L201) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/RsaVerify.sol#L317-L317)


```solidity

File: /contracts/automata-attestation/utils/SigVerifyLib.sol

38:             return verifyRS256Signature(tbs, signature, publicKey.pubKey);

68:             return verifyRS256Signature(tbs, signature, publicKey.pubKey);

43:             return verifyES256Signature(tbs, signature, publicKey.pubKey);

73:             return verifyRS1Signature(tbs, signature, publicKey.pubKey);

48:             return verifyRS1Signature(tbs, signature, publicKey.pubKey);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L38-L38) , [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L68-L68), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L43-L43), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L73-L73), [link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/SigVerifyLib.sol#L48-L48)


```solidity

File: /contracts/automata-attestation/utils/X509DateUtils.sol

31:         return toUnixTimestamp(yrs, mnths, dys, hrs, mins, secs);


```

[link](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol///contracts/automata-attestation/utils/X509DateUtils.sol#L31-L31) 


</details>
