
## Low Findings

|    | Issue | Instances |
|----|-------|:---------:|
| [L-01] | Possible Vulnerability to Fee-On-Transfer Accounting Issues | 1 |
| [L-02] | Inconsistent Behavior of `block.number` Across Layer-2 Solutions | 14 |
| [L-03] | Potential DoS Risk with Loops Iterating Over Large State Arrays | 2 |
| [L-04] | Subtraction may underflow if multiplication is too large | 1 |
| [L-05] | `decimals()` is not part of the ERC20 standard | 6 |
| [L-06] | Large transfers may not work with some `ERC20` tokens | 2 |
| [L-07] | `assert()` should only be used for tests | 4 |
| [L-08] | Initializers can be front-run | 25 |
| [L-09] | `.call` bypasses function existence check, type checking and argument packing | 1 |
| [L-10] | Prefer skip over `revert` model in loops | 13 |
| [L-11] | Unbounded loop may run out of gas | 30 |
| [L-12] | Lack of index element validation in external/public function | 34 |
| [L-13] | Consider checking that transfer to `address(this)` is disabled | 9 |
| [L-14] | Using `_disableInitializers()` in Upgradeable Contracts to Ensure Initialization Only | 7 |
| [L-15] | Initializer missing `address(0)` Check before assignment | 29 |
| [L-16] | Missing checks for `address(0)` when updating state variables | 3 |
| [L-17] | Input Validation Missing in Setter Functions | 1 |
| [L-18] | Usage of `symbol()` Function in ERC-20 Context | 2 |
| [L-19] | Missing checks for state variable assignments | 6 |
| [L-20] | Missing checks in constructor/initialize | 10 |
| [L-21] | Non-compliance with EIP-721 in `tokenURI()` Implementation | 1 |
| [L-22] | Owner can renounce Ownership | 1 |
| [L-23] | State variables are not limited to a reasonable range | 3 |
| [L-24] | Ensure Initialization of Upgradable Contracts | 1 |
| [L-25] | External calls in an unbounded loop can result in a DoS | 24 |
| [L-26] | For loops in public or external functions should be avoided due to high gas costs and possible `revert` | 5 |
| [L-27] | Input Arrays Lengths Not Checked | 3 |
| [L-28] | Critical functions should be a two step procedure | 9 |
| [L-29] | `onlyOwner` functions not accessible if `owner` renounces ownership | 2 |
| [L-30] | NFT doesn't handle hard forks | 1 |
| [L-31] | Implement two-step ownership transfers | 1 |
| [L-32] | Loss of precision on division | 3 |
| [L-33] | Unsafe `uint` to `int` conversion | 4 |
| [L-34] | Array is `push()`ed but not `pop()`ed | 1 |
| [L-35] | Risk of Revert on Direct supportsInterface() Calls | 5 |
| [L-36] | Unsafe downcast from larger to smaller integer types | 1 |
| [L-37] | Lack of two-step update for updating protocol addresses | 7 |
| [L-38] | Some `ERC20` can revert on a zero value `transfer` | 2 |
| [L-39] | Potential Re-org Attack Vector | 3 |
| [L-40] | Consider Adding a Denylist modifier to Your NFT Contracts | 3 |
| [L-41] | Missing checks for `address(0)` in constructor | 2 |
| [L-42] | Using a vulnerable dependency from some libraries | 2 |

## NonCritical Findings

|    | Issue | Instances |
|----|-------|:---------:|
| [N-01] | `internal/private` Function calls within for loops | 24 |
| [N-02] | Events may be emitted out of order due to reentrancy | 8 |
| [N-03] | Function Parameters in Public Accessible Functions Need `address(0)` Check | 60 |
| [N-04] | Array indices should be referenced via `enum`s rather than via numeric literals | 42 |
| [N-05] | Consider splitting long calculations | 4 |
| [N-06] | Use custom errors instead of `require()/assert()` | 64 |
| [N-07] | Missing Event Emission After Critical Initialize() Function | 24 |
| [N-08] | Avoid Hard-Coded Addresses | 1 |
| [N-09] | Variables need not be initialized to zero | 13 |
| [N-10] | Multiple Interfaces in Single File | 3 |
| [N-11] | Multiple Libraries in One File | 2 |
| [N-12] | Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability | 8 |
| [N-13] | Consider returning a `struct` rather than having multiple `return` values | 7 |
| [N-14] | Consider using a `struct` rather than having many function input parameters | 23 |
| [N-15] | Prefer Custom Errors Over Unnamed `revert()` | 6 |
| [N-16] | Avoid using constant decimals in expressions | 1 |
| [N-17] | Simplify complex require statements | 3 |
| [N-18] | Consider using descriptive `constant`s when passing zero as a function argument | 19 |
| [N-19] | Avoid Empty Blocks in Code | 5 |
| [N-20] | Interfaces and Contracts in the Same File | 4 |
| [N-21] | Custom error has no error details | 160 |
| [N-22] | File with Library declaration Shoulde contain only Library | 2 |
| [N-23] | Consider using OpenZeppelin's SafeCast for any casting | 119 |
| [N-24] | Consider using `delete` rather than assigning `false` to clear values | 2 |
| [N-25] | Consider using `delete` rather than assigning `zero` to clear values | 10 |
| [N-26] | Consider emitting an event at the end of the constructor | 3 |
| [N-27] | Consider moving duplicated strings to constants | 38 |
| [N-28] | Consider providing a ranged getter for array state variables | 1 |
| [N-29] | Consider using named returns | 144 |
| [N-30] | Style guide: Initialisms should be capitalized | 29 |
| [N-31] | Expressions for constant values should use `immutable` rather than `constant` | 8 |
| [N-32] | Consider using named function arguments | 160 |
| [N-33] | Assembly block creates dirty bits | 6 |
| [N-34] | Contract/Library Names Not in `CapWords` Style (CamelCase) | 18 |
| [N-35] | Events are missing sender information | 34 |
| [N-36] | Non-constant/non-immutable variables using all capital letters | 2 |
| [N-37] | NatSpec: Function `@param` tag is missing | 144 |
| [N-38] | Consider Using OpenZeppelin's ReentrancyGuard Instead of Custom Implementation | 1 |
| [N-39] | High cyclomatic complexity | 22 |
| [N-40] | Contract should expose an `interface` | 59 |
| [N-41] | NatSpec: Function declarations should have descriptions | 50 |
| [N-42] | Contract uses both `require()`/`revert()` as well as custom errors | 23 |
| [N-43] | Modifiers Missing NatSpec `@param` Tag | 4 |
| [N-44] | Solidity Version Too Recent to be Trusted | 81 |
| [N-45] | Inconsistent spacing in comments | 1700 |
| [N-46] | Unused `error` definition | 1 |
| [N-47] | Critical system parameter changes should be behind a timelock | 9 |
| [N-48] | Library Should be in a Separate File | 1 |
| [N-49] | Ensure Non-Empty Check for Bytes in Function Parameters | 100 |
| [N-50] | Adding a `return` statement when the function defines a named return variable, is redundant | 10 |
| [N-51] | Assembly blocks should have extensive comments | 33 |
| [N-52] | Use `bytes.concat()` instead of `abi.encodePacked()` | 24 |
| [N-53] | Function/Constructor Argument Names Not in mixedCase | 235 |
| [N-54] | NatSpec: Function `@return` tag is missing | 97 |
| [N-55] | State-Altering Functions Should Emit Events | 18 |
| [N-56] | Contract Doesn't Handle All NFT Types | 2 |
| [N-57] | Upgrade `openzeppelin` to the Latest Version - 5.0.0 | 54 |
| [N-58] | Duplicated `require()`/`revert()` checks should be refactored to a modifier or function | 14 |
| [N-59] | Non-specific Imports | 179 |
| [N-60] | Event is not properly `indexed` | 39 |
| [N-61] | Consider Adding Emergency-Stop Functionality | 29 |
| [N-62] | Missing NatSpec Descriptions for Modifier Declarations | 13 |
| [N-63] | NatSpec: Public State variable declarations should have descriptions | 7 |
| [N-64] | Consider adding a block/deny-list | 10 |
| [N-65] | Non-uppercase/Constant-case Naming for `immutable` Variables | 2 |
| [N-66] | Not using the named return variables anywhere in the function is confusing | 11 |
| [N-67] | Function Names Not in mixedCase | 16 |
| [N-68] | Insufficient Comments in Complex Functions | 29 |
| [N-69] | Common functions should be refactored to a common base contract | 31 |
| [N-70] | NatSpec: Error declarations should have descriptions | 157 |
| [N-71] | NatSpec: Non-public state variable declarations should use `@dev` tags | 69 |
| [N-72] | `constant`s should be defined rather than using magic numbers | 383 |
| [N-73] | `require()`/`revert()` statements should have descriptive reason strings | 2 |
| [N-74] | Variable Names Not in mixedCase | 11 |
| [N-75] | Consider moving `msg.sender` checks to a common authorization `modifier` | 10 |
| [N-76] | NatSpec: Contract declarations should have descriptions | 4 |
| [N-77] | NatSpec: Contract declarations should have `@author` tag | 76 |
| [N-78] | Style guide: Non-`external`/`public` function names should begin with an underscore | 96 |
| [N-79] | Consider defining system-wide constants in a single file | 18 |
| [N-80] | Add inline comments for unnamed variables | 14 |
| [N-81] | Consider making contracts `Upgradeable` | 31 |
| [N-82] | Events that mark critical parameter changes should contain both the old and the new value | 5 |
| [N-83] | Non-Standard Annotations Detected Use `@inheritdoc` instead | 4 |
| [N-84] | Style guide: Non-`external`/`public` variable names should begin with an underscore | 34 |
| [N-85] | Style guide: Contract does not follow the Solidity style guide's suggested layout ordering | 2 |
| [N-86] | Style guide: Control structures do not follow the Solidity Style Guide | 135 |
| [N-87] | Consider bounding input array length | 11 |
| [N-88] | NatSpec: Function declarations should have `@notice` tag | 62 |
| [N-89] | Constants in comparisons should appear on the left side | 153 |
| [N-90] | NatSpec: Contract declarations should have `@notice` tag | 41 |
| [N-91] | Large numeric literals should use underscores for readability | 28 |
| [N-92] | Named Imports of Parent Contracts Are Missing | 55 |
| [N-93] | Long functions should be refactored into multiple, smaller, functions | 29 |
| [N-94] | NatSpec: Contract declarations should have `@dev` tags | 58 |
| [N-95] | The nonReentrant modifier should occur before all other modifiers | 4 |
| [N-96] | `public` functions not called by the contract should be declared `external` instead | 44 |
| [N-97] | Large multiples of ten should use scientific notation | 13 |
| [N-98] | Prefer Casting to `bytes` or `bytes32` Over `abi.encodePacked()` for Single Arguments | 5 |
| [N-99] | Complex casting | 18 |
| [N-100] | Non-assembly High-Level Solidity Functions Available | 2 |
| [N-101] | Equal `block.timestamp` Cases Not Handled | 10 |
| [N-102] | `else`-block not required | 7 |
| [N-103] | Polymorphic functions make security audits more time-consuming and error-prone | 24 |
| [N-104] | Style guide: Function ordering does not follow the Solidity style guide | 6 |
| [N-105] | Style guide: Lines are too long | 6 |
| [N-106] | Numeric Values Related to Time Lacking Units | 15 |
| [N-107] | Style guide: Extraneous whitespace | 188 |
| [N-108] | Contract/Libraries Names Do Not Match Their Filenames | 2 |
| [N-109] | Avoid the use of sensitive terms | 6 |
| [N-110] | Unused import | 8 |
| [N-111] | `if`-statement can be converted to a ternary | 5 |
| [N-112] | Use of `override` is unnecessary | 64 |
| [N-113] | Setters should prevent re-setting of the same value | 13 |
| [N-114] | NatSpec: Contract declarations should have `@title` tags | 7 |
| [N-115] | Explicit Visibility Recommended in Variable/Function Definitions | 5 |
| [N-116] | Open TODOs | 2 |
| [N-117] | Contracts should have full test coverage | 1 |
| [N-118] | Large or complicated code bases should implement invariant tests | 1 |
| [N-119] | Implement Formal Verification Proofs to Improve Security | 1 |

## Low Findings Details

### [L-01] Possible Vulnerability to Fee-On-Transfer Accounting Issues

Contracts transfer funds using the `transferFrom()` function but do not verify that the actual number of tokens received matches the input amount to the transfer.
This could lead to accounting issues if the token involves a fee on transfer.
An attacker might exploit latent funds to get a free credit.
To prevent this, consider checking the balance before and after the transfer and use the difference as the actual amount received.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

114: IERC20(assignment.feeToken).safeTransferFrom(
                _meta.coinbase, _blk.assignedProver, proverFee
            );
```
[114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L114)
</details>

### [L-02] Inconsistent Behavior of `block.number` Across Layer-2 Solutions

`block.number` can behave differently across various Layer-2 (L2) solutions. 
For instance, on Optimism, `block.number` corresponds to the L2 block number, but on Arbitrum, it matches the Layer-1 (L1) block number.
Moreover, L2 block numbers often increase more frequently than L1 block numbers.
This discrepancy can introduce inconsistencies when timing events or performing cross-chain operations.
Consider using a consistent clock mechanism, like the one provided by OpenZeppelin's Governor contract from version 4.9, to avoid potential issues.

<details>
<summary><i>14 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

86: || assignment.maxProposedIn != 0 && block.number > assignment.maxProposedIn
```
[86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L86)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

122: l1Hash: blockhash(block.number - 1),
131: l1Height: uint64(block.number - 1),
204: meta_.difficulty = keccak256(abi.encodePacked(block.prevrandao, b.numBlocks, block.number));
220: proposedIn: uint64(block.number),
```
[122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L122) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L131) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L204) | [220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L220)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

57: _state.slotA.genesisHeight = uint64(block.number);
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L57)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

86: if (block.number == 0) {
88: } else if (block.number == 1) {
90: uint256 parentHeight = block.number - 1;
97: (publicInputHash,) = _calcPublicInputHash(block.number);
118: || (block.number != 1 && _parentGasUsed == 0)
127: parentId = block.number - 1;
201: if (_blockId >= block.number) return 0;
202: if (_blockId + 256 >= block.number) return blockhash(_blockId);
```
[86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L86) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L88) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L90) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L97) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L118) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L127) | [201](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L201) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L202)
</details>

### [L-03] Potential DoS Risk with Loops Iterating Over Large State Arrays

Looping through state arrays can lead to denial of service (DoS) vulnerabilities if the array grows too large. 
If the computations within the loop are extensive enough to expend the entire transaction's gas, the function may fail.
Consider implementing mechanisms to check or limit the size of state arrays or to reduce the computational work within loops.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit state `guardians[]` is `push()`ed and may grow too large to iterate over. | 87: guardians.push(guardian);
74: for (uint256 i; i < guardians.length; ++i) {
/// @audit state `guardians[]` is `push()`ed and may grow too large to iterate over. | 87: guardians.push(guardian);
133: for (uint256 i; i < guardiansLength; ++i) {
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L74) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L133)
</details>

### [L-04] Subtraction may underflow if multiplication is too large

he following expressions may underflow, as the subtrahend could be greater than the minuend in case the former is multiplied by a large number.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

40: x = x - k * 54_916_777_467_707_473_351_141_471_128;
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L40)
</details>

### [L-05] `decimals()` is not part of the ERC20 standard

The `decimals` function is not part of the `ERC20` standard, and they may revert with some tokens if the don't also extend the `IERC20Metadata` interface.

<details>
<summary><i>6 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

175: ctoken.decimals != _ctoken.decimals
175: ctoken.decimals != _ctoken.decimals
198: ctokenDecimal: _ctoken.decimals
368: decimals: meta.decimals(),
415: ctoken.decimals,
431: ctokenDecimal: ctoken.decimals
```
[175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L175) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L175) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L198) | [368](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L368) | [415](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L415) | [431](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L431)
</details>

### [L-06] Large transfers may not work with some `ERC20` tokens

Some `IERC20` implementations (e.g `UNI`, `COMP`)
            
- [COMP (Compound Protocol)](https://github.com/compound-finance/compound-protocol/blob/a3214f67b73310d547e00fc578e8355911c9d376/contracts/Governance/Comp.sol#L115-L142)
- [UNI (Uniswap)](https://github.com/Uniswap/governance/blob/eabd8c71ad01f61fb54ed6945162021ee419998e/contracts/Uni.sol#L209-L236)
            
may fail if the valued `transferred` is larger than `uint96`.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

114: IERC20(assignment.feeToken).safeTransferFrom(
                _meta.coinbase, _blk.assignedProver, proverFee
            )
```
[114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L114)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

220: IERC20(costToken).safeTransferFrom(_recipient, sharedVault, costToWithdraw)
```
[220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L220)
</details>

### [L-07] `assert()` should only be used for tests

From (documentation)[https://docs.soliditylang.org/en/v0.8.20/control-structures.html#panic-via-assert-and-error-via-require]:
```text
The assert function creates an error of type Panic(uint256). The same error is created by the compiler in certain situations as listed below.
Assert should only be used to test for internal errors, and to check invariants. Properly functioning code should never create a Panic, not even on invalid external input. If this happens, then there is a bug in your contract which you should fix. Language analysis tools can evaluate your contract to identify the conditions and function calls which will cause a Panic.
```

<details>
<summary><i>4 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

223: assert(tier.validityBond == 0)
224: assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0))
```
[223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L223) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L224)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

486: assert(_message.from != address(this))
```
[486](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L486)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

138: assert(success)
```
[138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L138)
</details>

### [L-08] Initializers can be front-run

Initializers could be vulnerable to front-running attacks.
This might allow an attacker to set their own values, take ownership of the contract, or force a redeployment in the best-case scenario.
Be cautious of potential front-running risks in the following instances found in the code.

<details>
<summary><i>25 issue instances in 25 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

30: function init(address _owner) external initializer
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L30)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

31: function init(
        address _owner,
        IVotesUpgradeable _token,
        TimelockControllerUpgradeable _timelock
    )
        external
        initializer
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L31)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

15: function init(address _owner, uint256 _minDelay) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L15)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

57: function init(address _owner, address _addressManager) external initializer
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

47: function init(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        bytes32 _genesisBlockHash
    )
        external
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L47)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

25: function init(address _owner, address _addressManager) external initializer
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

15: function init(address _owner) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

15: function init(address _owner) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

15: function init(address _owner) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

48: function init(address _owner, address _addressManager) external initializer
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

75: function init(address _owner, address _addressManager) external initializer
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

32: function init(address _owner, address _addressManager) external initializer
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

18: function init(address _owner, address _addressManager) external initializer
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

83: function init(address _owner, address _addressManager) external initializer
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

111: function init(
        address _owner,
        address _taikoToken,
        address _costToken,
        address _sharedVault
    )
        external
        initializer
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L111)
</details>

### [L-09] `.call` bypasses function existence check, type checking and argument packing

Using the `.call` method in Solidity enables direct communication with an address, bypassing function existence checks, type checking, and argument packing.
While this can save gas and provide flexibility, it can also introduce security risks and potential errors. The absence of these checks can lead to unexpected behavior if the callee contract's interface changes or if the input parameters are not crafted with care.
The resolution to these issues is to use Solidity's high-level interface for calling functions when possible, as it automatically manages these aspects.
If using `.call` is necessary, ensure that the inputs are carefully validated and that awareness of the called contract's behavior is maintained.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

50: address(this).call(txdata)
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L50)
</details>

### [L-10] Prefer skip over `revert` model in loops

When dealing with array operations in Solidity, it's often wiser to opt for skipping over reverting.
Instead of halting the entire transaction when a condition isn't met, suggests simply moving on to the next array index.
The reason behind this choice is to reduce the risk of malicious actors intentionally introducing array objects that fail conditional checks within loops, causing group operations to fail.
Unless there's a compelling security or logical justification for reverting, it's recommended to embrace the skip-over approach for a more robust codebase.

<details>
<summary><i>13 issue instances in 8 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

246: revert L1_INVALID_HOOK()
```
[246](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L246)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

131: revert L1_BLOCK_MISMATCH()
```
[131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L131)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

82: revert INVALID_GUARDIAN()
84: revert INVALID_GUARDIAN_SET()
```
[82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L82) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L84)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

111: revert SS_INVALID_LAST_HOP_CHAINID()
115: revert SS_INVALID_MID_HOP_CHAINID()
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L111) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L115)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

48: revert VAULT_INVALID_AMOUNT()
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L48)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

35: revert VAULT_INVALID_AMOUNT()
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L35)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

191: revert("MerkleTrie: received a node with an unknown prefix")
194: revert("MerkleTrie: received an unparseable node")
```
[191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L191) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L194)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

107: revert SGX_INVALID_INSTANCE()
211: revert SGX_ALREADY_ATTESTED()
215: revert SGX_INVALID_INSTANCE()
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L107) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L211) | [215](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L215)
</details>

### [L-11] Unbounded loop may run out of gas

Unbounded loops in smart contracts pose a risk because they iterate over an unknown number of elements, potentially consuming all available gas for a transaction.
This can result in unintended transaction failures. Gas consumption increases linearly with the number of iterations, and if it surpasses the gas limit, the transaction reverts, wasting the gas spent.
To mitigate this, developers should either set a maximum limit on loop iterations.

<details>
<summary><i>30 issue instances in 17 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

172: for (uint256 i; i < _tierFees.length; ++i)
```
[172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L172)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

86: for (uint256 i; i < deposits_.length;)
```
[86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L86)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

244: for (uint256 i; i < params.hookCalls.length; ++i)
```
[244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L244)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

74: for (uint256 i; i < guardians.length; ++i)
80: for (uint256 i = 0; i < _newGuardians.length; ++i)
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L74) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L80)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

104: for (uint256 i; i < hopProofs.length; ++i)
```
[104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L104)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

90: for (uint256 i; i < _msgHashes.length; ++i)
```
[90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L90)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

47: for (uint256 i; i < _op.amounts.length; ++i)
251: for (uint256 i; i < _op.tokenIds.length; ++i)
269: for (uint256 i; i < _op.tokenIds.length; ++i)
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L47) | [251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L251) | [269](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L269)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

34: for (uint256 i; i < _op.tokenIds.length; ++i)
170: for (uint256 i; i < _tokenIds.length; ++i)
175: for (uint256 i; i < _tokenIds.length; ++i)
197: for (uint256 i; i < _op.tokenIds.length; ++i)
210: for (uint256 i; i < _op.tokenIds.length; ++i)
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L34) | [170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L170) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L175) | [197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L197) | [210](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L210)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

74: while (offset < _in.length
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L74)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

66: for (uint256 j = 0; j < out_.length; j++)
```
[66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L66)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

85: for (uint256 i = 0; i < proof.length; i++)
```
[85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L85)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

104: for (uint256 i; i < _ids.length; ++i)
210: for (uint256 i; i < _instances.length; ++i)
```
[104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L104) | [210](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L210)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

59: for (uint256 i; i < tokenIds.length; ++i)
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L59)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

80: for (uint256 i; i < serialNumBatch.length; ++i)
95: for (uint256 i; i < serialNumBatch.length; ++i)
191: for (uint256 i; i < enclaveId.tcbLevels.length; ++i)
214: for (uint256 i; i < tcb.tcbLevels.length; ++i)
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L80) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L95) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L191) | [214](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L214)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

244: for (uint256 i; i < split.length; ++i)
```
[244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L244)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

153: for (uint256 i; i < encoded.length; ++i)
```
[153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L153)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

174: for (uint256 i; i < _sha256.length; ++i)
283: for (uint256 i; i < sha1Prefix.length; ++i)
290: for (uint256 i; i < _sha1.length; ++i)
```
[174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L174) | [283](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L283) | [290](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L290)
</details>

### [L-12] Lack of index element validation in external/public function

There's no validation to check whether the index element provided as an argument actually exists in the call. This omission could lead to unintended behavior if an element that does not exist in the call is passed to the function.

The function should validate that the provided index element exists in the call before proceeding.

Without this validation, the function could cause unintended behaviour as it will call an non-existing index element. This could lead to inconsistencies in data and potentially affect the integrity of the call structure.

<details>
<summary><i>34 issue instances in 9 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

47: __addresses[_chainId][_name]
47: __addresses[_chainId]
49: __addresses[_chainId][_name]
49: __addresses[_chainId]
55: __addresses[_chainId][_name]
55: __addresses[_chainId]
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L47) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L47) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L49) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L49) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L55) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L55)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

102: _approvals[version][_hash]
```
[102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L102)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

203: l2Hashes[_blockId]
```
[203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L203)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

57: isAuthorized[_addr]
58: isAuthorized[_addr]
167: topBlockId[_chainId][_kind]
167: topBlockId[_chainId]
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L58) | [167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L167) | [167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L167)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

109: addressBanned[_addr]
110: addressBanned[_addr]
```
[109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L109) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L110)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

158: bridgedToCanonical[_btokenNew]
162: btokenBlacklist[_btokenNew]
180: bridgedToCanonical[_btokenNew]
188: bridgedToCanonical[_btokenNew]
```
[158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L158) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L162) | [180](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L180) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L188)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

83: claimedAmount[user]
90: withdrawnAmount[user]
109: claimedAmount[user]
120: withdrawnAmount[user]
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L83) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L90) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L109) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L120)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

137: recipients[_recipient]
142: recipients[_recipient]
151: recipients[_recipient]
187: recipients[_recipient]
205: recipients[_recipient]
```
[137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L137) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L142) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L151) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L187) | [205](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L205)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

66: _trustedUserMrSigner[_mrSigner]
70: _trustedUserMrEnclave[_mrEnclave]
81: _serialNumIsRevoked[index]
84: _serialNumIsRevoked[index]
96: _serialNumIsRevoked[index]
99: _serialNumIsRevoked[index]
111: tcbInfo[fmspc]
```
[66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L66) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L70) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L81) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L84) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L96) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L99) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L111)
</details>

### [L-13] Consider checking that transfer to `address(this)` is disabled

Functions allowing users to specify the receiving address should check whether the referenced address is not `address(this)`.

This would prevent tokens to remain lock inside the contract due to an incorrect `transfer` or `mint`.

<details>
<summary><i>9 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

41: _mint(_recipient, 1_000_000_000 ether)
62: super.transfer(_to, _amount)
112: super._mint(_to, _amount)
```
[41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L41) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L62) | [112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L112)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

44: usdc.mint(_account, _amount)
```
[44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L44)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

130: _mint(_account, _amount)
170: super._mint(_to, _amount)
```
[130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L130) | [170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L170)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

82: IBridgedERC20(migratingAddress).mint(_account, _amount)
```
[82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L82)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

333: IBridgedERC20(token_).mint(_to, _amount)
```
[333](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L333)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

176: BridgedERC721(token_).mint(_to, _tokenIds[i])
```
[176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L176)
</details>

### [L-14] Using `_disableInitializers()` in Upgradeable Contracts to Ensure Initialization Only

[_disableInitializers()](https://docs.openzeppelin.com/contracts/4.x/api/proxy#Initializable-_disableInitializers--) was added in Contracts v4.6.0 as part of the reinitializers support.
The Caution note in [Initializer](https://docs.openzeppelin.com/contracts/4.x/api/proxy#Initializable) provides more details on why this is needed.

By putting it in the constructor, this prevents initialization of the implementation contract itself, as extra protection [to prevent an attacker from initializing it](https://forum.openzeppelin.com/t/uupsupgradeable-vulnerability-post-mortem/15680).

<details>
<summary><i>7 issue instances in 7 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit Contract should have a `constructor()` and call `_disableInitializers()`
16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

/// @audit Contract should have a `constructor()` and call `_disableInitializers()`
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L9)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit Contract should have a `constructor()` and call `_disableInitializers()`
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit Contract should have a `constructor()` and call `_disableInitializers()`
15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

/// @audit Contract should have a `constructor()` and call `_disableInitializers()`
12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit Contract should have a `constructor()` and call `_disableInitializers()`
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit Contract should have a `constructor()` and call `_disableInitializers()`
29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)
</details>

### [L-15] Initializer missing `address(0)` Check before assignment

The initializer does not include a check for `address(0)` when initializing state variables that hold addresses.
Initializing a state variable with `address(0)` can lead to unintended behavior and vulnerabilities in the contract, 
such as sending funds to an inaccessible address. 
It is recommended to include a validation step to ensure that address parameters are not set to `address(0)`.

<details>
<summary><i>29 issue instances in 28 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit `_owner` has lack of `address(0)` check before use
30: function init(address _owner) external initializer {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L30)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

/// @audit `_addressManager` has lack of `address(0)` check before use
58: function __AddressResolver_init(address _addressManager) internal virtual onlyInitializing {
```
[58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L58)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit `_owner` has lack of `address(0)` check before use
95: function __Essential_init(
        address _owner,
        address _addressManager
    )
        internal
        virtual
        onlyInitializing
    {
/// @audit `_owner` has lack of `address(0)` check before use
108: function __Essential_init(address _owner) internal virtual {
```
[95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L95) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L108)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_token` has lack of `address(0)` check before use
/// @audit `_timelock` has lack of `address(0)` check before use
31: function init(
        address _owner,
        IVotesUpgradeable _token,
        TimelockControllerUpgradeable _timelock
    )
        external
        initializer
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L31)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

/// @audit `_owner` has lack of `address(0)` check before use
15: function init(address _owner, uint256 _minDelay) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L15)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
57: function init(address _owner, address _addressManager) external initializer {
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit `_state` has lack of `address(0)` check before use
47: function init(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        bytes32 _genesisBlockHash
    )
        external
    {
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L47)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
25: function init(address _owner, address _addressManager) external initializer {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
    {
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_recipient` has lack of `address(0)` check before use
25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

/// @audit `_owner` has lack of `address(0)` check before use
15: function init(address _owner) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit `_owner` has lack of `address(0)` check before use
15: function init(address _owner) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit `_owner` has lack of `address(0)` check before use
15: function init(address _owner) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit `_addressManager` has lack of `address(0)` check before use
60: function __CrossChainOwned_init(
        address _owner,
        address _addressManager,
        uint64 _ownerChainId
    )
        internal
        virtual
        onlyInitializing
    {
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L60)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
48: function init(address _owner, address _addressManager) external initializer {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
75: function init(address _owner, address _addressManager) external initializer {
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
/// @audit `_usdc` has lack of `address(0)` check before use
38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
32: function init(address _owner, address _addressManager) external initializer {
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
18: function init(address _owner, address _addressManager) external initializer {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_addressManager` has lack of `address(0)` check before use
83: function init(address _owner, address _addressManager) external initializer {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_token` has lack of `address(0)` check before use
/// @audit `_vault` has lack of `address(0)` check before use
27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_token` has lack of `address(0)` check before use
/// @audit `_vault` has lack of `address(0)` check before use
54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

/// @audit `_owner` has lack of `address(0)` check before use
/// @audit `_token` has lack of `address(0)` check before use
/// @audit `_vault` has lack of `address(0)` check before use
25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit `_owner` has lack of `address(0)` check before use
111: function init(
        address _owner,
        address _taikoToken,
        address _costToken,
        address _sharedVault
    )
        external
        initializer
    {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L111)
</details>

### [L-16] Missing checks for `address(0)` when updating state variables

Check for zero-address to avoid the risk of setting `address(0)` for state variables after an update.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

62: addressManager = _addressManager;
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L62)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

81: snapshooter = _snapshooter;
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L81)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

119: qeIdentity = qeIdentityInput;
```
[119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L119)
</details>

### [L-17] Input Validation Missing in Setter Functions

Setter functions are utilized to update the state variables of a contract.
It is critical to ensure these functions have adequate input sanitization to prevent unwanted alterations or malicious attacks.
Without input validation, there's a potential risk of enabling vulnerabilities like overflow/underflow, unauthorized access, or insertion of invalid data.
Consider incorporating appropriate validation mechanisms, such as checking the range or type of inputs, to enhance the security of your contract.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit `setSnapshoter` function does not validate `_snapshooter` input
80: function setSnapshoter(address _snapshooter) external onlyOwner {
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L80)
</details>

### [L-18] Usage of `symbol()` Function in ERC-20 Context

The `symbol()` function is not a part of the original ERC-20 standard and was added later as an optional extension.
Some valid ERC-20 tokens may not support this interface.
Blindly casting all tokens to an interface that includes `symbol()` and then calling this function may lead to issues.

Consider verifying the token's compatibility with the `symbol()` function or handling possible failures gracefully to maintain compatibility with all ERC-20 tokens.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

369: symbol: meta.symbol(),
```
[369](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L369)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

206: symbol: t.symbol(),
```
[206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L206)
</details>

### [L-19] Missing checks for state variable assignments

There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

<details>
<summary><i>6 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

37: gasExcess = _newGasExcess;
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L37)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

81: snapshooter = _snapshooter;
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L81)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

53: _setConfig(_claimStart, _claimEnd, _merkleRoot);
91: claimStart = _claimStart;
92: claimEnd = _claimEnd;
93: merkleRoot = _merkleRoot;
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L53) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L91) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L92) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L93)
</details>

### [L-20] Missing checks in constructor/initialize

There are some missing checks in these functions, and this could lead to unexpected scenarios. Consider always adding a sanity check for state variables.

<details>
<summary><i>10 issue instances in 10 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit `_token` is not validated before use
/// @audit `_timelock` is not validated before use
31: function init(
        address _owner,
        IVotesUpgradeable _token,
        TimelockControllerUpgradeable _timelock
    )
        external
        initializer
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L31)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

/// @audit `_minDelay` is not validated before use
15: function init(address _owner, uint256 _minDelay) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L15)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit `_name` is not validated before use
/// @audit `_name` is not validated before use
/// @audit `_symbol` is not validated before use
25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit `_l1ChainId` is not validated before use
/// @audit `_gasExcess` is not validated before use
71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

/// @audit `_usdc` is not validated before use
38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit `_decimals` is not validated before use
52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit `_symbol` is not validated before use
/// @audit `_name` is not validated before use
38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

/// @audit `_claimStart` is not validated before use
/// @audit `_claimEnd` is not validated before use
/// @audit `_merkleRoot` is not validated before use
27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit `_claimStart` is not validated before use
/// @audit `_claimEnd` is not validated before use
/// @audit `_merkleRoot` is not validated before use
/// @audit `_withdrawalWindow` is not validated before use
54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

/// @audit `_claimStart` is not validated before use
/// @audit `_claimEnd` is not validated before use
/// @audit `_merkleRoot` is not validated before use
25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)
</details>

### [L-21] Non-compliance with EIP-721 in `tokenURI()` Implementation

According to EIP-721, the `tokenURI()` function should revert if the token ID passed is not a valid NFT.
However, some contracts do not adhere to this standard.

If the NFT has not been minted, `tokenURI()` should revert as per the EIP-721 standard, ensuring better compliance and robustness.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

107: function tokenURI(uint256 _tokenId) public view virtual override returns (string memory) {
        return string(
            abi.encodePacked(
                LibBridgedToken.buildURI(srcToken, srcChainId), Strings.toString(_tokenId)
            )
        );
    }
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L107)
</details>

### [L-22] Owner can renounce Ownership

Each of the following contracts implements or inherits the `renounceOwnership` function.
This can represent a certain risk if the ownership is renounced for any other reason than by design. Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

5: import "@openzeppelin/contracts-upgradeable/access/Ownable2StepUpgradeable.sol";
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L5)
</details>

### [L-23] State variables are not limited to a reasonable range

There are some missing limits in these functions, and this could lead to unexpected scenarios. Consider adding a min/max limit for the following values, when appropriate.

<details>
<summary><i>3 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

37: gasExcess = _newGasExcess;
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L37)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

91: claimStart = _claimStart;
92: claimEnd = _claimEnd;
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L91) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L92)
</details>

### [L-24] Ensure Initialization of Upgradable Contracts

Upgradable contracts should include an initialization function with an initializer modifier.
This is a crucial part of the upgradeable contract pattern, as it facilitates the setup of contract state after deployment, thereby ensuring future upgrades are manageable and seamless.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)
</details>

### [L-25] External calls in an unbounded loop can result in a DoS

Consider limiting the number of iterations in loops that make external calls, as just a single one of them failing will result in a revert.

<details>
<summary><i>24 issue instances in 7 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit 1 external calls in unbounded for-loop -> 86: for (uint256 i; i < deposits_.length;) {
88: deposits_[i] = TaikoData.EthDeposit({
```
[88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L88)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit 1 external calls in unbounded for-loop -> 251: for (uint256 i; i < _op.tokenIds.length; ++i) {
252: BridgedERC1155(_op.token).burn(_user, _op.tokenIds[i], _op.amounts[i]);
/// @audit 1 external calls in unbounded for-loop -> 269: for (uint256 i; i < _op.tokenIds.length; ++i) {
270: IERC1155(_op.token).safeTransferFrom({
```
[252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L252) | [270](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L270)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit 1 external calls in unbounded for-loop -> 170: for (uint256 i; i < _tokenIds.length; ++i) {
171: IERC721(token_).safeTransferFrom(address(this), _to, _tokenIds[i]);
/// @audit 1 external calls in unbounded for-loop -> 175: for (uint256 i; i < _tokenIds.length; ++i) {
176: BridgedERC721(token_).mint(_to, _tokenIds[i]);
/// @audit 1 external calls in unbounded for-loop -> 197: for (uint256 i; i < _op.tokenIds.length; ++i) {
198: BridgedERC721(_op.token).burn(_user, _op.tokenIds[i]);
/// @audit 1 external calls in unbounded for-loop -> 210: for (uint256 i; i < _op.tokenIds.length; ++i) {
211: t.safeTransferFrom(_user, address(this), _op.tokenIds[i]);
```
[171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L171) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L176) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L198) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L211)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

/// @audit 7 external calls in unbounded for-loop -> 85: for (uint256 i = 0; i < proof.length; i++) {
94: Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
100: Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
106: Bytes.equal(currentNode.encoded, currentNodeID),
118: value_ = RLPReader.readBytes(currentNode.decoded[TREE_RADIX]);
143: bytes memory pathRemainder = Bytes.slice(path, offset);
144: bytes memory keyRemainder = Bytes.slice(key, currentKeyIndex);
171: value_ = RLPReader.readBytes(currentNode.decoded[1]);
/// @audit 1 external calls in unbounded for-loop -> 208: for (uint256 i = 0; i < length;) {
209: proof_[i] = TrieNode({ encoded: _proof[i], decoded: RLPReader.readList(_proof[i]) });
```
[94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L94) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L100) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L106) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L118) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L143) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L144) | [171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L171) | [209](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L209)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

/// @audit 1 external calls in unbounded for-loop -> 59: for (uint256 i; i < tokenIds.length; ++i) {
60: IERC721(token).safeTransferFrom(vault, user, tokenIds[i]);
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L60)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit 1 external calls in unbounded for-loop -> 259: for (uint256 i; i < n; ++i) {
285: verified = sigVerifyLib.verifyES256Signature(
```
[285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L285)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit 1 external calls in unbounded for-loop -> 54: for (uint256 i; i < size; ++i) {
57: input = LibString.slice(pemChainStr, index, index + len);
/// @audit 1 external calls in unbounded for-loop -> 244: for (uint256 i; i < split.length; ++i) {
245: contentStr = LibString.concat(contentStr, split[i]);
/// @audit 6 external calls in unbounded for-loop -> 354: for (uint256 i; i < SGX_TCB_CPUSVN_SIZE + 1; ++i) {
355: uint256 svnPtr = der.firstChildOf(svnParentPtr); // OID
356: uint256 svnValuePtr = der.nextSiblingOf(svnPtr); // value
357: bytes memory svnValueBytes = der.bytesAt(svnValuePtr);
361: if (BytesUtils.compareBytes(der.bytesAt(svnPtr), PCESVN_OID)) {
371: svnParentPtr = der.nextSiblingOf(svnParentPtr);
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L57) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L245) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L355) | [356](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L356) | [357](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L357) | [361](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L361) | [371](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L371)
</details>

### [L-26] For loops in public or external functions should be avoided due to high gas costs and possible `revert`

Loops in public or external functions can lead to high gas costs, as their unpredictable gas consumption and externally-influenced logic might make these functions costly.

<details>
<summary><i>5 issue instances in 5 files:</i></summary>

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

104: for (uint256 i; i < hopProofs.length; ++i) {
```
[104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L104)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

47: for (uint256 i; i < _op.amounts.length; ++i) {
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L47)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

34: for (uint256 i; i < _op.tokenIds.length; ++i) {
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L34)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

59: for (uint256 i; i < tokenIds.length; ++i) {
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L59)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

54: for (uint256 i; i < size; ++i) {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L54)
</details>

### [L-27] Input Arrays Lengths Not Checked

When a function takes two or more arrays as arguments, it is important to ensure that their lengths are equal to prevent unexpected behavior.
Add a check to compare the lengths of the arrays in the function body.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

83: function mintBatch(
        address _to,
        uint256[] memory _tokenIds,
        uint256[] memory _amounts
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L83)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

47: function claim(
        address user,
        uint256[] calldata tokenIds,
        bytes32[] calldata proof
    )
        external
        nonReentrant
    {
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L47)
</details>

### [L-28] Critical functions should be a two step procedure

Critical functions in Solidity contracts should follow a two-step procedure to enhance security, minimize human error, and ensure proper access control. By dividing sensitive operations into distinct phases, such as initiation and confirmation, developers can introduce a safeguard against unintended actions or unauthorized access.

<details>
<summary><i>9 issue instances in 8 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

38: function setAddress(
        uint64 _chainId,
        bytes32 _name,
        address _newAddress
    )
        external
        virtual
        onlyOwner
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L38)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

53: function setGuardians(
        address[] memory _newGuardians,
        uint8 _minGuardians
    )
        external
        onlyOwner
        nonReentrant
    {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L53)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

25: function setConfigAndExcess(
        Config memory _newConfig,
        uint64 _newGasExcess
    )
        external
        virtual
        onlyOwner
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L25)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

80: function setSnapshoter(address _snapshooter) external onlyOwner {
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L80)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

36: function changeMigrationStatus(
        address _migratingAddress,
        bool _migratingInbound
    )
        external
        nonReentrant
        whenNotPaused
        onlyFromOwnerOrNamed("erc20_vault")
    {
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L36)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

148: function changeBridgedToken(
        CanonicalERC20 calldata _ctoken,
        address _btokenNew
    )
        external
        nonReentrant
        whenNotPaused
        onlyOwner
        returns (address btokenOld_)
    {
```
[148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L148)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

45: function setConfig(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        external
        onlyOwner
    {
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L45)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

64: function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
68: function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L64) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L68)
</details>

### [L-29] `onlyOwner` functions not accessible if `owner` renounces ownership

The `owner` is able to perform certain privileged activities, but it's possible to set the `owner` to `address(0)`. This can represent a certain risk if the ownership is renounced for any other reason than by design.

Renouncing ownership will leave the contract without an `owner`, therefore limiting any functionality that needs authority.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

113: function _authorizeUpgrade(address) internal virtual override onlyOwner { }
115: function _authorizePause(address) internal virtual onlyOwner { }
```
[113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L113) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L115)
</details>

### [L-30] NFT doesn't handle hard forks

Functions related to Non-Fungible Tokens (NFTs) should include a check for the chain ID to handle potential 
hard forks. Users often face difficulties ensuring ownership control on every fork when hard forks occur. 
Consider adding `require(1 == chain.chainId)` or the chain ID of the preferred chain to the detected 
functions, or at least include the chain ID in the URI to eliminate confusion regarding which chain owns 
the NFT.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

107: function tokenURI(uint256 _tokenId) public view virtual override returns (string memory) {
        return string(
            abi.encodePacked(
                LibBridgedToken.buildURI(srcToken, srcChainId), Strings.toString(_tokenId)
            )
        );
    }
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L107)
</details>

### [L-31] Implement two-step ownership transfers

Single-step ownership transfers can be risky due to the potential for errors or wrong address inputs.
In worst-case scenarios, your contract could become `ownerless`.
To mitigate these risks, consider using a two-step ownership transfers.
In this process, a new potential owner is first designated, and then they must accept the ownership to complete the transfer.
This two-step procedure ensures a more secure and reliable transfer of contract ownership.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

110: _transferOwnership(_owner == address(0) ? msg.sender : _owner);
```
[110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L110)
</details>

### [L-32] Loss of precision on division

Solidity doesn't support fractions, so divisions by large numbers could result in the quotient being zero.

To avoid this, it's recommended to require a minimum numerator amount to ensure that it is always greater than the denominator.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

262: || _config.ethDepositMaxFee > type(uint96).max / _config.ethDepositMaxCountPerBlock
```
[262](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L262)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

264: return _amount * uint64(block.timestamp - _start) / _period;
```
[264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L264)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

359: ? uint16(bytes2(svnValueBytes)) / 256
```
[359](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L359)
</details>

### [L-33] Unsafe `uint` to `int` conversion

The `int` type in Solidity uses the [two's complement system](https://en.wikipedia.org/wiki/Two%27s_complement), so it is possible to accidentally overflow a very large `uint` to an `int`, even if they share the same number of bytes (e.g. a `uint256 number > type(uint128).max` will overflow a `int256` cast).

Consider using the [SafeCast](https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/utils/math/SafeCast.sol) library to prevent any overflows.

<details>
<summary><i>4 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

/// @audit cast from `uint256` to `int256`
45: return uint256(LibFixedPointMath.exp(int256(input)));
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L45)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit cast from `uint256` to `int256`
97: return int256(diff);
/// @audit cast from `uint256` to `int256`
104: return int256(len) - int256(otherlen);
/// @audit cast from `uint256` to `int256`
104: return int256(len) - int256(otherlen);
```
[97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L97) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L104) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L104)
</details>

### [L-34] Array is `push()`ed but not `pop()`ed

Arrays in the contract have entries added using the `push` method, but no corresponding `pop` method is found to remove them. 
Ensure to consider whether old entries need to be removed or if there should be a maximum array length.
Cases with specific potential issues might be reported separately under different issue categories.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

87: guardians.push(guardian);
```
[87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L87)
</details>

### [L-35] Risk of Revert on Direct supportsInterface() Calls

Making a direct call to `supportsInterface()` on a contract that doesn't implement the ERC-165 standard can cause the call to revert. Even if the contract does support the method, there's a risk that it could be malicious and deplete the transaction's gas. 
To mitigate this, it's recommended to:
1. Make the call using a low-level `staticcall()`, assigning a specific gas limit, and verify the return value.
2. Use OpenZeppelin's `ERC165Checker.supportsInterface()` utility, which manages these risks for you.

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

56: try IERC165(_addr).supportsInterface(_interfaceId) returns (bool _result) {
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L56)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

195: if (_message.from.supportsInterface(type(IRecallableSender).interfaceId)) {
```
[195](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L195)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

51: if (!_op.token.supportsInterface(ERC1155_INTERFACE_ID)) {
200: || BaseVault.supportsInterface(interfaceId);
```
[51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L51) | [200](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L200)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

38: if (!_op.token.supportsInterface(ERC721_INTERFACE_ID)) {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L38)
</details>

### [L-36] Unsafe downcast from larger to smaller integer types

When a type is downcast to a smaller type, the higher order bits are discarded, resulting in the application of a modulo operation to the original value.

If the downcasted value is large enough, this may result in an overflow that will not revert.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit cast from `uint256` to `uint96`
90: amount: uint96(data),
```
[90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L90)
</details>

### [L-37] Lack of two-step update for updating protocol addresses

Add a two-step process for any critical address changes.

<details>
<summary><i>7 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit `__addresses[_chainId][_name]` is changed
49: __addresses[_chainId][_name] = _newAddress;
```
[49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L49)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

/// @audit `addressManager` is changed
62: addressManager = _addressManager;
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L62)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit `minGuardians` is changed
93: minGuardians = _minGuardians;
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L93)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit `ownerChainId` is changed
73: ownerChainId = _ownerChainId;
```
[73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L73)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit `snapshooter` is changed
81: snapshooter = _snapshooter;
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L81)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

/// @audit `migratingAddress` is changed
48: migratingAddress = _migratingAddress;
/// @audit `migratingInbound` is changed
50: migratingInbound = _migratingInbound;
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L48) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L50)
</details>

### [L-38] Some `ERC20` can revert on a zero value `transfer`

Not all `ERC20` implementations are totally compliant, and some (e.g `LEND`) may fail while transfering a zero amount.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit `_amount` has not been checked for zero value before transfer
330: IERC20(token_).safeTransfer(_to, _amount);
```
[330](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L330)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit `costToWithdraw` has not been checked for zero value before transfer
220: IERC20(costToken).safeTransferFrom(_recipient, sharedVault, costToWithdraw);
```
[220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L220)
</details>

### [L-39] Potential Re-org Attack Vector

The contract appears to deploy new contracts using the `new` keyword.
In a re-org attack scenario, such deployments can be exploited by a malicious actor who might rewrite the blockchain's history and deploy the contract at an expected address. 

Consider deploying the contract via `CREATE2` opcode with a specific salt that includes `msg.sender` and the existing contract address.
This will ensure a predictable contract address, reducing the chances of such an attack.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

309: btoken_ = address(new ERC1967Proxy(resolve("bridged_erc1155", false), data));
```
[309](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L309)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

421: btoken = address(new ERC1967Proxy(resolve("bridged_erc20", false), data));
```
[421](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L421)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

246: btoken_ = address(new ERC1967Proxy(resolve("bridged_erc721", false), data));
```
[246](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L246)
</details>

### [L-40] Consider Adding a Denylist modifier to Your NFT Contracts

Given the rise in NFT thefts, it's important to implement safeguards to prevent hacked or stolen NFTs from being converted into liquidity on your platform. One such safeguard is a denylist modifier.

A denylist modifier would prevent reported stolen NFTs from being listed or transacted. Many marketplaces such as Opensea and NFT projects like Manifold already implement this feature in their smart contracts.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L16)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

9: contract ERC721Airdrop is MerkleClaimable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L9)
</details>

### [L-41] Missing checks for `address(0)` in constructor

Check for zero-address to avoid the risk of setting `address(0)` for state variables when deploying.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit `pemCertLibAddr` has lack of `address(0)` check before use
53: constructor(address sigVerifyLibAddr, address pemCertLibAddr) {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L53)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit `es256Verifier` has lack of `address(0)` check before use
19: constructor(address es256Verifier) {
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L19)
</details>

### [L-42] Using a vulnerable dependency from some libraries

The package.json configuration file says that the project is using OZ which has a not last update version.
Latest non vulnerable version `4.9.3` for @openzeppelin/contracts and @openzeppelin/contracts-upgradeable.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: app/2024-03-taiko/packages/protocol/package.json

38: "@openzeppelin/contracts": "4.8.2",
39: "@openzeppelin/contracts-upgradeable": "4.8.2",
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/app/2024-03-taiko/packages/protocol/package.json#L38) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/app/2024-03-taiko/packages/protocol/package.json#L39)
</details>


## NonCritical Findings Details

### [N-01] `internal/private` Function calls within for loops

Making function calls or external calls within loops in Solidity can lead to inefficient gas usage, potential bottlenecks, and increased vulnerability to attacks.
Each function call or external call consumes gas, and when executed within a loop, the gas cost multiplies, potentially causing the transaction to run out of gas or exceed block gas limits.
This can result in transaction failure or unpredictable behavior.

<details>
<summary><i>24 issue instances in 12 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

253: IHook(params.hookCalls[i].hook)
```
[253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L253)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

152: ITierProvider(tierProvider)
188: IERC20(_resolver.resolve("taiko_token", false))
```
[152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L152) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L188)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

107: _verifyHopProof(chainId, app, signal, value, hop, signalService)
117: resolve(hop.chainId, "signal_service", false)
122: _cacheChainData(hop, chainId, hop.blockId, signalRoot, isFullProof, isLastHop)
125: signalForChainData(chainId, kind, hop.blockId)
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L107) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L117) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L122) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L125)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

252: BridgedERC1155(_op.token)
270: IERC1155(_op.token)
```
[252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L252) | [270](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L270)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

171: IERC721(token_)
176: BridgedERC721(token_)
198: BridgedERC721(_op.token)
```
[171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L171) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L176) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L198)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

75: _decodeLength(
                RLPItem({
                    length: _in.length - offset,
                    ptr: MemoryPointer.wrap(MemoryPointer.unwrap(_in.ptr) + offset)
                })
            )
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L75)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

136: _getNodeID(nextNode)
140: _getNodePath(currentNode)
145: _getSharedNibbleLength(pathRemainder, keyRemainder)
188: _getNodeID(currentNode.decoded[1])
```
[136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L136) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L140) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L145) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L188)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

217: Instance(_instances[i], validSince)
```
[217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L217)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

60: IERC721(token)
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L60)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

217: _isCpuSvnHigherOrGreater(
                pck.sgxExtension.sgxTcbCompSvnArr, current.sgxTcbCompSvnArr
            )
```
[217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L217)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

62: _removeHeadersAndFooters(input)
308: _findTcb(der, extnValueOidPtr)
308: _findTcb(der, extnValueOidPtr)
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L62) | [308](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L308) | [308](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L308)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

49: isLeapYear(i)
```
[49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L49)
</details>

### [N-02] Events may be emitted out of order due to reentrancy

It's essential to ensure that events follow the best practice of check-effects-interaction and are emitted before any external calls to prevent out-of-order events due to reentrancy.
Emitting events post external interactions may cause them to be out of order due to reentrancy, which can be misleading or erroneous for event listeners.
[Refer to the Solidity Documentation for best practices.](https://solidity.readthedocs.io/en/latest/security-considerations.html#reentrancy)

<details>
<summary><i>8 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit `transferFrom()` before `BlockAssigned` event emit
128: emit BlockAssigned(_blk.assignedProver, _meta, assignment);
```
[128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L128)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit `transfer()` before `TransitionProved` event emit
208: emit TransitionProved({
                blockId: blk.blockId,
                tran: _tran,
                prover: msg.sender,
                validityBond: tier.validityBond,
                tier: _proof.tier
            });
/// @audit `transfer()` before `TransitionProved` event emit
229: emit TransitionProved({
                    blockId: blk.blockId,
                    tran: _tran,
                    prover: msg.sender,
                    validityBond: 0,
                    tier: _proof.tier
                });
/// @audit `transfer()` before `TransitionContested` event emit
253: emit TransitionContested({
                    blockId: blk.blockId,
                    tran: _tran,
                    contester: msg.sender,
                    contestBond: tier.contestBond,
                    tier: _proof.tier
                });
```
[208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L208) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L229) | [253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L253)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit `transfer()` before `BlockVerified` event emit
197: emit BlockVerified({
                    blockId: blockId,
                    assignedProver: blk.assignedProver,
                    prover: ts.prover,
                    blockHash: blockHash,
                    stateRoot: stateRoot,
                    tier: ts.tier,
                    contestations: ts.contestations
                });
```
[197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L197)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit `call()` before `TransactionExecuted` event emit
52: emit TransactionExecuted(nextTxId++, bytes4(txdata));
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L52)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit `transferFrom()` before `Withdrawn` event emit
92: emit Withdrawn(user, amount);
```
[92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L92)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit `transferFrom()` before `Withdrawn` event emit
221: emit Withdrawn(_recipient, _to, amountToWithdraw, costToWithdraw);
```
[221](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L221)
</details>

### [N-03] Function Parameters in Public Accessible Functions Need `address(0)` Check

Parameters of type `address` in your functions should be checked to ensure that they are not assigned the null address (`address(0x0)`). 
Failure to validate these parameters can lead to transaction reverts, wasted gas, the need for transaction resubmission, and may even require redeployment of contracts within the protocol in certain situations.
Implement checks for `address(0x0)` to avoid these potential issues.

<details>
<summary><i>60 issue instances in 28 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit `_owner` parameter without address(0) check
30: function init(address _owner) external initializer {
/// @audit `_newAddress` parameter without address(0) check
38: function setAddress(
        uint64 _chainId,
        bytes32 _name,
        address _newAddress
    )
        external
        virtual
        onlyOwner
    {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L30) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L38)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit `_owner` parameter without address(0) check
31: function init(
        address _owner,
        IVotesUpgradeable _token,
        TimelockControllerUpgradeable _timelock
    )
        external
        initializer
    {
/// @audit `_targets` parameter without address(0) check
48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
/// @audit `_targets` parameter without address(0) check
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L31) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

/// @audit `_owner` parameter without address(0) check
15: function init(address _owner, uint256 _minDelay) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L15)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
57: function init(address _owner, address _addressManager) external initializer {
/// @audit `_taikoL1Address` parameter without address(0) check
137: function hashAssignment(
        ProverAssignment memory _assignment,
        address _taikoL1Address,
        bytes32 _blobHash
    )
        public
        view
        returns (bytes32)
    {
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L137)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
25: function init(address _owner, address _addressManager) external initializer {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit `_newGuardians` parameter without address(0) check
53: function setGuardians(
        address[] memory _newGuardians,
        uint8 _minGuardians
    )
        external
        onlyOwner
        nonReentrant
    {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L53)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
    {
/// @audit `_recipient` parameter without address(0) check
119: function depositEtherToL2(address _recipient) external payable nonReentrant whenNotPaused {
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L119)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_recipient` parameter without address(0) check
25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
    {
/// @audit `_from` parameter without address(0) check
47: function burn(address _from, uint256 _amount) public onlyOwner {
/// @audit `_to` parameter without address(0) check
60: function transfer(address _to, uint256 _amount) public override returns (bool) {
/// @audit `_from` parameter without address(0) check
/// @audit `_to` parameter without address(0) check
70: function transferFrom(
        address _from,
        address _to,
        uint256 _amount
    )
        public
        override
        returns (bool)
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L47) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L60) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L70)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

/// @audit `_owner` parameter without address(0) check
15: function init(address _owner) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit `_owner` parameter without address(0) check
15: function init(address _owner) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit `_owner` parameter without address(0) check
15: function init(address _owner) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
48: function init(address _owner, address _addressManager) external initializer {
/// @audit `_addr` parameter without address(0) check
56: function authorize(address _addr, bool _authorize) external onlyOwner {
/// @audit `_app` parameter without address(0) check
83: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        public
        virtual
        validSender(_app)
        nonZeroValue(_signal)
    {
/// @audit `_app` parameter without address(0) check
153: function isSignalSent(address _app, bytes32 _signal) public view returns (bool) {
/// @audit `_app` parameter without address(0) check
194: function getSignalSlot(
        uint64 _chainId,
        address _app,
        bytes32 _signal
    )
        public
        pure
        returns (bytes32)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L56) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L83) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L153) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L194)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
75: function init(address _owner, address _addressManager) external initializer {
/// @audit `_addr` parameter without address(0) check
101: function banAddress(
        address _addr,
        bool _ban
    )
        external
        onlyFromOwnerOrNamed("bridge_watchdog")
        nonReentrant
    {
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L101)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
/// @audit `_srcToken` parameter without address(0) check
52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
/// @audit `_snapshooter` parameter without address(0) check
80: function setSnapshoter(address _snapshooter) external onlyOwner {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L80)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

/// @audit `_migratingAddress` parameter without address(0) check
36: function changeMigrationStatus(
        address _migratingAddress,
        bool _migratingInbound
    )
        external
        nonReentrant
        whenNotPaused
        onlyFromOwnerOrNamed("erc20_vault")
    {
/// @audit `_account` parameter without address(0) check
57: function mint(address _account, uint256 _amount) public nonReentrant whenNotPaused {
/// @audit `_account` parameter without address(0) check
75: function burn(address _account, uint256 _amount) public nonReentrant whenNotPaused {
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L36) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L57) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
/// @audit `_srcToken` parameter without address(0) check
31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
/// @audit `_account` parameter without address(0) check
54: function mint(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
/// @audit `_account` parameter without address(0) check
69: function burn(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L54) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L69)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
/// @audit `_srcToken` parameter without address(0) check
38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
/// @audit `_to` parameter without address(0) check
66: function mint(
        address _to,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
/// @audit `_to` parameter without address(0) check
83: function mintBatch(
        address _to,
        uint256[] memory _tokenIds,
        uint256[] memory _amounts
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
/// @audit `_account` parameter without address(0) check
100: function burn(
        address _account,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L66) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L83) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L100)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
32: function init(address _owner, address _addressManager) external initializer {
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit `address` parameter without address(0) check
/// @audit `address` parameter without address(0) check
160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
/// @audit `address` parameter without address(0) check
/// @audit `address` parameter without address(0) check
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit `address` parameter without address(0) check
/// @audit `address` parameter without address(0) check
142: function onERC721Received(
        address,
        address,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
```
[142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L142)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
18: function init(address _owner, address _addressManager) external initializer {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_addressManager` parameter without address(0) check
83: function init(address _owner, address _addressManager) external initializer {
/// @audit `_instances` parameter without address(0) check
90: function addInstances(address[] calldata _instances)
        external
        onlyOwner
        returns (uint256[] memory)
    {
/// @audit `_newInstance` parameter without address(0) check
/// @audit `_prover` parameter without address(0) check
171: function getSignedHash(
        TaikoData.Transition memory _tran,
        address _newInstance,
        address _prover,
        bytes32 _metaHash
    )
        public
        view
        returns (bytes32)
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L90) | [171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L171)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_token` parameter without address(0) check
/// @audit `_vault` parameter without address(0) check
27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
/// @audit `user` parameter without address(0) check
50: function claimAndDelegate(
        address user,
        uint256 amount,
        bytes32[] calldata proof,
        bytes calldata delegationData
    )
        external
        nonReentrant
    {
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L50)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_token` parameter without address(0) check
/// @audit `_vault` parameter without address(0) check
54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
    {
/// @audit `user` parameter without address(0) check
78: function claim(address user, uint256 amount, bytes32[] calldata proof) external nonReentrant {
/// @audit `user` parameter without address(0) check
88: function withdraw(address user) external ongoingWithdrawals {
/// @audit `user` parameter without address(0) check
104: function getBalance(address user)
        public
        view
        returns (uint256 balance, uint256 withdrawableAmount)
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L78) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L88) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L104)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

/// @audit `_owner` parameter without address(0) check
/// @audit `_token` parameter without address(0) check
/// @audit `_vault` parameter without address(0) check
25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
/// @audit `user` parameter without address(0) check
47: function claim(
        address user,
        uint256[] calldata tokenIds,
        bytes32[] calldata proof
    )
        external
        nonReentrant
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L47)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit `_owner` parameter without address(0) check
111: function init(
        address _owner,
        address _taikoToken,
        address _costToken,
        address _sharedVault
    )
        external
        initializer
    {
/// @audit `_recipient` parameter without address(0) check
150: function void(address _recipient) external onlyOwner {
/// @audit `_recipient` parameter without address(0) check
176: function getMyGrantSummary(address _recipient)
        public
        view
        returns (
            uint128 amountOwned,
            uint128 amountUnlocked,
            uint128 amountWithdrawn,
            uint128 amountToWithdraw,
            uint128 costToWithdraw
        )
    {
/// @audit `_recipient` parameter without address(0) check
204: function getMyGrant(address _recipient) public view returns (Grant memory) {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L111) | [150](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L150) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L176) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L204)
</details>

### [N-04] Array indices should be referenced via `enum`s rather than via numeric literals

Using constant array indexes can make your Solidity code harder to read and maintain.
To improve clarity, consider using commented enum values in place of constant array indexes.

Enums provide a way to define a type that has a few pre-defined values, making your code more self-explanatory and easy to understand.
This can be particularly helpful in large codebases or when working with a team.

<details>
<summary><i>42 issue instances in 13 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

80: _state.transitions[_slot][1]
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L80)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

62: _state.blocks[0]
68: _state.transitions[0][1]
68: _state.transitions[0]
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L62) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L68) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L68)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

49: tiers_[0]
50: tiers_[1]
```
[49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L50)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

60: tiers_[0]
61: tiers_[1]
62: tiers_[2]
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L62)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

60: tiers_[0]
61: tiers_[1]
62: tiers_[2]
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L62)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

228: bytes32[256]
240: inputs[255]
```
[228](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L228) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L240)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

14: _in[0]
35: out_[0]
45: out_[0]
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

141: path[0]
171: currentNode.decoded[1]
188: currentNode.decoded[1]
228: _node.decoded[0]
```
[141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L141) | [171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L171) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L188) | [228](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L228)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

133: _address[0]
135: _addInstances(_address, false)[0]
```
[133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L133) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L135)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

435: parsedQuoteCerts[0]
442: parsedQuoteCerts[0]
454: parsedQuoteCerts[0]
472: parsedQuoteCerts[0]
```
[435](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L435) | [442](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L442) | [454](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L454) | [472](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L472)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

285: quoteCerts[0]
285: quoteCerts[1]
285: quoteCerts[2]
```
[285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L285) | [285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L285) | [285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L285)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

53: uint8[17]
73: uint8[15]
137: decipher[0]
137: decipher[1]
222: uint8[15]
270: decipher[0]
270: decipher[1]
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L53) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L73) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L137) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L137) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L222) | [270](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L270) | [270](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L270)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

18: x509Time[0]
21: x509Time[0]
21: x509Time[1]
56: uint8[12]
57: monthDays[1]
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L57)
</details>

### [N-05] Consider splitting long calculations

For improved readability and maintainability, it's suggested to limit arithmetic operations to 3 per expression.
Excessive operations can convolute the code, making it more prone to errors and more difficult to debug or review.
Splitting operations across multiple lines is often a good approach.
Special care should be taken with division operations. The number of arithmetic operations per line ideally shouldn't exceed three.

<details>
<summary><i>4 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

47: bytes1(uint8((_len / (256 ** (lenLen - i))) % 256))
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

202: uint256(
                    der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8
                )
```
[202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L202)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

93: ~(2 ** (8 * (32 - shortest + idx)) - 1)
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L93)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

25: (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L25)
</details>

### [N-06] Use custom errors instead of `require()/assert()`

Starting from Solidity 0.8.4, custom errors have been introduced to improve readability and clarity in your code. Instead of using `require()/assert()` with strings, custom errors can provide more expressive and understandable error conditions.

This change not only reduces unnecessary clutter in your codebase but also promotes a more streamlined contract structure, ultimately improving the quality of your Solidity code.

<details>
<summary><i>64 issue instances in 10 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

223: assert(tier.validityBond == 0)
224: assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0))
```
[223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L223) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L224)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

486: assert(_message.from != address(this))
```
[486](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L486)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

25: require(_length + 31 >= _length, "slice_overflow")
26: require(_start + _length >= _start, "slice_overflow")
27: require(_bytes.length >= _start + _length, "slice_outOfBounds")
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L27)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

37: require(
            _in.length > 0,
            "RLPReader: length of an RLP item must be greater than zero to be decodable"
        )
56: require(
            itemType == RLPItemType.LIST_ITEM,
            "RLPReader: decoded item type for list is not a list item"
        )
61: require(
            listOffset + listLength == _in.length,
            "RLPReader: list item has an invalid data remainder"
        )
112: require(
            itemType == RLPItemType.DATA_ITEM,
            "RLPReader: decoded item type for bytes is not a data item"
        )
117: require(
            _in.length == itemOffset + itemLength,
            "RLPReader: bytes value contains an invalid remainder"
        )
152: require(
            _in.length > 0,
            "RLPReader: length of an RLP item must be greater than zero to be decodable"
        )
172: require(
                _in.length > strLen,
                "RLPReader: length of content must be greater than string length (short string)"
            )
182: require(
                strLen != 1 || firstByteOfContent >= 0x80,
                "RLPReader: invalid prefix, single byte < 0x80 are not prefixed (short string)"
            )
192: require(
                _in.length > lenOfStrLen,
                "RLPReader: length of content must be > than length of string length (long string)"
            )
202: require(
                firstByteOfContent != 0x00,
                "RLPReader: length of content must not have any leading zeros (long string)"
            )
212: require(
                strLen > 55,
                "RLPReader: length of content must be greater than 55 bytes (long string)"
            )
217: require(
                _in.length > lenOfStrLen + strLen,
                "RLPReader: length of content must be greater than total length (long string)"
            )
228: require(
                _in.length > listLen,
                "RLPReader: length of content must be greater than list length (short list)"
            )
238: require(
                _in.length > lenOfListLen,
                "RLPReader: length of content must be > than length of list length (long list)"
            )
248: require(
                firstByteOfContent != 0x00,
                "RLPReader: length of content must not have any leading zeros (long list)"
            )
258: require(
                listLen > 55,
                "RLPReader: length of content must be greater than 55 bytes (long list)"
            )
263: require(
                _in.length > lenOfListLen + listLen,
                "RLPReader: length of content must be greater than total length (long list)"
            )
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L37) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L56) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L61) | [112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L112) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L117) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L152) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L172) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L182) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L192) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L202) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L212) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L217) | [228](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L228) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L238) | [248](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L248) | [258](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L258) | [263](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L263)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

77: require(_key.length > 0, "MerkleTrie: empty key")
89: require(currentKeyIndex <= key.length, "MerkleTrie: key index exceeds total key length")
93: require(
                    Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
                    "MerkleTrie: invalid root hash"
                )
99: require(
                    Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
                    "MerkleTrie: invalid large internal hash"
                )
105: require(
                    Bytes.equal(currentNode.encoded, currentNodeID),
                    "MerkleTrie: invalid internal node hash"
                )
119: require(
                        value_.length > 0,
                        "MerkleTrie: value length must be greater than zero (branch)"
                    )
125: require(
                        i == proof.length - 1,
                        "MerkleTrie: value node must be last node in proof (branch)"
                    )
150: require(
                    pathRemainder.length == sharedNibbleLength,
                    "MerkleTrie: path remainder must share all nibbles with key"
                )
162: require(
                        keyRemainder.length == sharedNibbleLength,
                        "MerkleTrie: key remainder must be identical to path remainder"
                    )
172: require(
                        value_.length > 0,
                        "MerkleTrie: value length must be greater than zero (leaf)"
                    )
178: require(
                        i == proof.length - 1,
                        "MerkleTrie: value node must be last node in proof (leaf)"
                    )
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L77) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L89) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L93) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L99) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L105) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L119) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L125) | [150](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L150) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L162) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L172) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L178)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

61: require(msg.sender == owner, "onlyOwner")
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L61)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

77: require(
            localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
                && localEnclaveReport.reportData.length == 64,
            "local QE report has wrong length"
        )
82: require(
            pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
                && pckSignedQeReport.reportData.length == 64,
            "QE report has wrong length"
        )
87: require(
            v3Quote.v3AuthData.certification.certType == 5,
            "certType must be 5: Concatenated PCK Cert Chain (PEM formatted)"
        )
91: require(
            v3Quote.v3AuthData.certification.decodedCertDataArray.length == 3, "3 certs in chain"
        )
94: require(
            v3Quote.v3AuthData.ecdsa256BitSignature.length == 64
                && v3Quote.v3AuthData.ecdsaAttestationKey.length == 64
                && v3Quote.v3AuthData.qeReportSignature.length == 64,
            "Invalid ECDSA signature format"
        )
100: require(
            v3Quote.v3AuthData.qeAuthData.parsedDataSize
                == v3Quote.v3AuthData.qeAuthData.data.length,
            "Invalid QEAuthData size"
        )
116: require(totalQuoteSize >= MINIMUM_QUOTE_LENGTH, "Invalid quote size")
279: require(certParsedSuccessfully, "splitCertificateChain failed")
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L77) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L82) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L87) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L91) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L94) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L100) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L116) | [279](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L279)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

57: require(der[ptr.ixs()] == 0x03, "Not type BIT STRING")
67: require(der[ptr.ixs()] == 0x04, "Not type OCTET STRING")
88: require(der[ptr.ixs()] & 0x20 == 0x20, "Not a constructed type")
142: require(der[ptr.ixs()] == 0x02, "Not type INTEGER")
143: require(der[ptr.ixf()] & 0x80 == 0, "Not positive")
155: require(der[ptr.ixs()] == 0x02, "Not type INTEGER")
156: require(der[ptr.ixf()] & 0x80 == 0, "Not positive")
180: require(der[ptr.ixs()] == 0x03, "ixs Not type BIT STRING 0x03")
182: require(der[ptr.ixf()] == 0x00, "ixf Not 0")
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L57) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L67) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L88) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L142) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L143) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L155) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L156) | [180](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L180) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L182)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

25: require(offset + len <= self.length, "invalid offset")
199: require(idx + 2 <= self.length, "invalid idx")
212: require(idx + 4 <= self.length, "unexpected idx")
225: require(idx + 32 <= self.length, "unexpected idx")
238: require(idx + 20 <= self.length, "unexpected idx")
264: require(len <= 32, "unexpected len")
265: require(idx + len <= self.length, "unexpected idx")
293: require(offset + len <= self.length, "unexpected offset")
329: require(len <= 52, "unexpected len")
335: require(char >= 0x30 && char <= 0x7A, "invalid char")
337: require(decoded <= 0x20, "invalid decoded")
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L25) | [199](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L199) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L212) | [225](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L225) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L238) | [264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L264) | [265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L265) | [293](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L293) | [329](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L329) | [335](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L335) | [337](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L337)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

138: assert(success)
```
[138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L138)
</details>

### [N-07] Missing Event Emission After Critical Initialize() Function

Emitting an initialization event offers clear, on-chain evidence of the contract's initialization state, enhancing transparency and auditability.
This practice aids users and developers in accurately tracking the contract's lifecycle, pinpointing the precise moment of its initialization.
Moreover, it aligns with best practices for event logging in smart contracts, ensuring that significant state changes are both observable and verifiable through emitted events.

<details>
<summary><i>24 issue instances in 24 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

30: function init(address _owner) external initializer
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L30)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

31: function init(
        address _owner,
        IVotesUpgradeable _token,
        TimelockControllerUpgradeable _timelock
    )
        external
        initializer
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L31)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

15: function init(address _owner, uint256 _minDelay) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L15)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

57: function init(address _owner, address _addressManager) external initializer
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

25: function init(address _owner, address _addressManager) external initializer
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

15: function init(address _owner) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

15: function init(address _owner) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

15: function init(address _owner) external initializer
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

48: function init(address _owner, address _addressManager) external initializer
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

75: function init(address _owner, address _addressManager) external initializer
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

32: function init(address _owner, address _addressManager) external initializer
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

18: function init(address _owner, address _addressManager) external initializer
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

83: function init(address _owner, address _addressManager) external initializer
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

111: function init(
        address _owner,
        address _taikoToken,
        address _costToken,
        address _sharedVault
    )
        external
        initializer
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L111)
</details>

### [N-08] Avoid Hard-Coded Addresses

It's often better to declare these addresses as immutable and assign them via constructor arguments.
This approach allows the code to remain consistent across deployments on different networks and avoids recompilation when addresses change.

Refactoring your code in this manner can improve its maintainability and flexibility.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

32: address public constant GOLDEN_TOUCH_ADDRESS = 0x0000777735367b36bC9B61C50022d9D0700dB4Ec;
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L32)
</details>

### [N-09] Variables need not be initialized to zero

By default, `int/uint` variables in Solidity are initialized to `zero`.
Explicitly setting variables to zero during their declaration is redundant and might cause confusion.
Removing the explicit zero initialization can improve code readability and understanding.

<details>
<summary><i>13 issue instances in 8 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

80: for (uint256 i = 0; i < _newGuardians.length; ++i) {
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L80)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

72: uint256 itemCount = 0;
```
[72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L72)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

58: uint256 i = 0;
66: for (uint256 j = 0; j < out_.length; j++) {
```
[58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L58) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L66)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

30: uint8 internal constant PREFIX_EXTENSION_EVEN = 0;
82: uint256 currentKeyIndex = 0;
85: for (uint256 i = 0; i < proof.length; i++) {
208: for (uint256 i = 0; i < length;) {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L30) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L82) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L85) | [208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L208)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

51: uint256 index = 0;
```
[51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L51)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

18: bytes4 internal constant SUPPORTED_TEE_TYPE = 0;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L18)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

80: for (uint256 idx = 0; idx < shortest; idx += 32) {
331: uint256 ret = 0;
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L80) | [331](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L331)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

46: uint256 timestamp = 0;
```
[46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L46)
</details>

### [N-10] Multiple Interfaces in Single File

Declaring multiple Interfaces within a single file can make code more difficult to understand and maintain. 
It is recommended to declare each interfaces in its own file.

<details>
<summary><i>3 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

8: interface IBridge
160: interface IRecallableSender
174: interface IMessageInvocable
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L8) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L160) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L174)
</details>

### [N-11] Multiple Libraries in One File

Declaring multiple Libraries within a single file can make code more difficult to understand and maintain. 
It is recommended to declare each library in its own file.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

12: library NodePtr
38: library Asn1Decode
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L12) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L38)
</details>

### [N-12] Multiple `address`/ID mappings can be combined into a single `mapping` of an `address`/ID to a `struct`, for readability

Combining multiple address/ID mappings into a single mapping to a struct can enhance code clarity and maintainability. 
Consider refactoring multiple mappings into a single mapping with a struct for cleaner code structure.
This arrangement also promotes a more organized contract structure, making it easier for developers to navigate and understand.

<details>
<summary><i>8 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

35: mapping(bytes32 msgHash => Status status) public messageStatus
46: mapping(bytes32 msgHash => ProofReceipt receipt) public proofReceipt
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L35) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L46)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

45: mapping(address btoken => CanonicalERC20 canonical) public bridgedToCanonical
52: mapping(address btoken => bool blacklisted) public btokenBlacklist
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L45) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L52)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

22: mapping(address addr => uint256 amountClaimed) public claimedAmount
25: mapping(address addr => uint256 amountWithdrawn) public withdrawnAmount
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L22) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L25)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

39: mapping(bytes32 enclave => bool trusted) private _trustedUserMrEnclave
40: mapping(bytes32 signer => bool trusted) private _trustedUserMrSigner
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L40)
</details>

### [N-13] Consider returning a `struct` rather than having multiple `return` values

Functions that return many variables can become difficult to read and maintain.
Using a struct to encapsulate these return values can improve code readability, increase reusability, and reduce the likelihood of errors.
Consider refactoring functions that return more than three variables to use a struct instead.

<details>
<summary><i>7 issue instances in 5 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

348: function _handleMessage(
        address _user,
        address _token,
        address _to,
        uint256 _amount
    )
        private
        returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)
```
[348](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L348)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

144: function _decodeLength(RLPItem memory _in)
        private
        pure
        returns (uint256 offset_, uint256 length_, RLPItemType type_)
```
[144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L144)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

176: function getMyGrantSummary(address _recipient)
        public
        view
        returns (
            uint128 amountOwned,
            uint128 amountUnlocked,
            uint128 amountWithdrawn,
            uint128 amountToWithdraw,
            uint128 costToWithdraw
        )
```
[176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L176)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

216: function _removeHeadersAndFooters(string memory pemData)
        private
        pure
        returns (bool success, bytes memory extracted, uint256 endIndex)
269: function _findPckTcbInfo(
        bytes memory der,
        uint256 tbsPtr,
        uint256 tbsParentPtr
    )
        private
        pure
        returns (
            bool success,
            uint256 pcesvn,
            uint256[] memory cpusvns,
            bytes memory fmspcBytes,
            bytes memory pceidBytes
        )
341: function _findTcb(
        bytes memory der,
        uint256 oidPtr
    )
        private
        pure
        returns (bool success, uint256 pcesvn, uint256[] memory cpusvns)
```
[216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L216) | [269](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L269) | [341](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L341)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

62: function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
        internal
        pure
        returns (
            bool success,
            V3Struct.Header memory header,
            V3Struct.EnclaveReport memory localEnclaveReport,
            bytes memory signedQuoteData, // concatenation of header and local enclave report bytes
            V3Struct.ECDSAQuoteV3AuthData memory authDataV3
        )
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62)
</details>

### [N-14] Consider using a `struct` rather than having many function input parameters

Functions with many parameters can become difficult to read and maintain. 
Using a struct to encapsulate these parameters can improve code readability, increase reusability, and reduce the likelihood of errors.
Consider refactoring functions that take more than three parameters to use a struct instead.

<details>
<summary><i>23 issue instances in 16 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

30: function evaluatePoint(
        bytes32 _blobHash,
        uint256 _x,
        uint256 _y,
        bytes1[48] memory _commitment,
        bytes1[48] memory _pointProof
    )
        internal
        view
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L30)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

34: function verifyMerkleProof(
        bytes32 _rootHash,
        address _addr,
        bytes32 _slot,
        bytes32 _value,
        bytes[] memory _accountProof,
        bytes[] memory _storageProof
    )
        internal
        pure
        returns (bytes32 storageRoot_)
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L34)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
127: function _execute(
        uint256 _proposalId,
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
```
[69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L127)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

68: function proposeBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        bytes calldata _data,
        bytes calldata _txList
    )
        internal
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L68)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
350: function _overrideWithHigherProof(
        TaikoData.TransitionState storage _ts,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof,
        ITierProvider.Tier memory _tier,
        IERC20 _tko,
        bool _sameTransition
    )
        private
401: function _checkProverPermission(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        TaikoData.TransitionState storage _ts,
        uint32 _tid,
        ITierProvider.Tier memory _tier
    )
        private
        view
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L350) | [401](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L401)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

206: function _verifyHopProof(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes32 _value,
        HopProof memory _hop,
        address _signalService
    )
        internal
        virtual
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32)
271: function _cacheChainData(
        HopProof memory _hop,
        uint64 _chainId,
        uint64 _blockId,
        bytes32 _signalRoot,
        bool _isFullProof,
        bool _isLastHop
    )
        private
```
[206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L206) | [271](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L271)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
125: function _beforeTokenTransfer(
        address, /*_operator*/
        address, /*_from*/
        address _to,
        uint256[] memory, /*_ids*/
        uint256[] memory, /*_amounts*/
        bytes memory /*_data*/
    )
        internal
        virtual
        override
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L125)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25: function excessivelySafeCall(
        address _target,
        uint256 _gas,
        uint256 _value,
        uint16 _maxCopy,
        bytes memory _calldata
    )
        internal
        returns (bool, bytes memory)
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

56: function compare(
        bytes memory self,
        uint256 offset,
        uint256 len,
        bytes memory other,
        uint256 otheroffset,
        uint256 otherlen
    )
        internal
        pure
        returns (int256)
116: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other,
        uint256 otherOffset,
        uint256 len
    )
        internal
        pure
        returns (bool)
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L56) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L116)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

34: function toUnixTimestamp(
        uint16 year,
        uint8 month,
        uint8 day,
        uint8 hour,
        uint8 minute,
        uint8 second
    )
        internal
        pure
        returns (uint256)
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L34)
</details>

### [N-15] Prefer Custom Errors Over Unnamed `revert()`

Using custom error types with `revert()` in Solidity provides clearer, more informative error handling compared to unnamed `revert()` calls.
Custom errors, introduced in Solidity 0.8.4, allow you to define specific error conditions with descriptive names and optionally include additional data about the error.

<details>
<summary><i>6 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

191: revert("MerkleTrie: received a node with an unknown prefix")
194: revert("MerkleTrie: received an unparseable node")
198: revert("MerkleTrie: ran out of proof elements")
```
[191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L191) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L194) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L198)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

365: revert("unexpected len")
```
[365](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L365)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

50: revert("Unsupported algorithm")
75: revert("Unsupported algorithm")
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L50) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L75)
</details>

### [N-16] Avoid using constant decimals in expressions

The use of fixed decimal values such as `1e18/10 ** 18` in Solidity contracts can lead to bugs, and vulnerabilities, when interacting with tokens having different decimal configurations.
Not all ERC20 tokens follow the standard 18 decimal places, and assumptions about decimal places can lead to miscalculations.
        
Always retrieve and use the `decimals()` function from the token contract itself when performing calculations involving token amounts.
This ensures that your contract correctly handles tokens with any number of decimal places, mitigating the risk of numerical errors or under/overflows.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

197: uint128 _amountUnlocked = amountUnlocked / 1e18; // divide first
```
[197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L197)
</details>

### [N-17] Simplify complex require statements

Simplifying complex require statements with local variables and if(or revert) statements can improve readability, make debugging easier, and promote modularity and reusability in the code.

<details>
<summary><i>3 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

77: require(
            localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
                && localEnclaveReport.reportData.length == 64,
            "local QE report has wrong length"
        )
82: require(
            pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
                && pckSignedQeReport.reportData.length == 64,
            "QE report has wrong length"
        )
94: require(
            v3Quote.v3AuthData.ecdsa256BitSignature.length == 64
                && v3Quote.v3AuthData.ecdsaAttestationKey.length == 64
                && v3Quote.v3AuthData.qeReportSignature.length == 64,
            "Invalid ECDSA signature format"
        )
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L77) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L82) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L94)
</details>

### [N-18] Consider using descriptive `constant`s when passing zero as a function argument

In instances where utilizing a zero parameter is essential, it is recommended to employ descriptive constants or an enum instead of directly integrating zero within function calls.
This strategy aids in clearly articulating the caller's intention and minimizes the risk of errors.
Emitting zero also not recomended, as it is not clear what the intention is.

<details>
<summary><i>19 issue instances in 11 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

17: address[](0)
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L17)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

79: TaikoData.EthDeposit[](0)
```
[79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L79)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

157: blobhash(0)
```
[157](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L157)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

234: signalService.getSyncedChainData(
            _config.chainId, LibSignals.STATE_ROOT, 0 /* latest block Id*/
        )
```
[234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L234)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

136: _copy(_in.ptr, 0, _in.length)
```
[136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L136)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

154: Bytes.slice(_proof.data, 0, 4)
```
[154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L154)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

313: qeEnclaveReport.reportData.substring(0, 32)
```
[313](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L313)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

38: quote.substring(0, 48)
138: rawEnclaveReport.substring(0, 16)
170: rawHeader.substring(0, 2)
227: rawAuthData.substring(0, 64)
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L38) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L138) | [170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L170) | [227](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L227)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

48: _readNodeLength(der, 0)
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L48)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

40: compare(self, 0, self.length, other, 0, other.length)
169: equals(self, offset, other, 0, other.length)
179: equals(self, 0, other, 0, self.length)
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L40) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L169) | [179](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L179)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

89: publicKey.substring(0, 3)
106: publicKey.substring(0, 3)
126: signature.substring(0, 32)
132: publicKey.substring(0, 32)
```
[89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L89) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L106) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L126) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L132)
</details>

### [N-19] Avoid Empty Blocks in Code

Empty blocks in code can lead to confusion and the introduction of errors when the code is later modified.
They should be removed, or the block should do something useful, such as emitting an event or reverting. 

For contracts meant to be extended, the contract should be abstract and the function signatures added without any default implementation. 

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

58: catch { }
```
[58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L58)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

86: if (block.number == 0) {
            // This is the case in real L2 genesis
        }
```
[86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L86)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

70: receive() external payable { }
```
[70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L70)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

265: catch { }
268: catch { }
```
[265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L265) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L268)
</details>

### [N-20] Interfaces and Contracts in the Same File

Interfaces should be declared in a separate file and not in the same file where the contract resides.
This helps in maintaining a clean and organized codebase.

<details>
<summary><i>4 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

8: interface IUSDC
28: contract USDCAdapter
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L8) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

16: interface IERC1155NameAndSymbol
29: contract ERC1155Vault
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L16) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)
</details>

### [N-21] Custom error has no error details

Take advantage of custom error's return value property. 

An important feature of Custom Error is that values such as address, tokenID, msg.value can be written inside the () sign, providing a serious advantage in debugging and examining the revert details of dapps such as Tenderly.

<details>
<summary><i>160 issue instances in 37 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

25: error AM_INVALID_PARAMS()
26: error AM_UNSUPPORTED()
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L26)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

16: error RESOLVER_DENIED()
17: error RESOLVER_INVALID_MANAGER()
18: error RESOLVER_UNEXPECTED_CHAINID()
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L18)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

35: error REENTRANT_CALL()
36: error INVALID_PAUSE_STATUS()
37: error ZERO_ADDR_MANAGER()
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L37)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

19: error EVAL_FAILED_1()
20: error EVAL_FAILED_2()
21: error POINT_X_TOO_LARGE()
22: error POINT_Y_TOO_LARGE()
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L22)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

16: error ETH_TRANSFER_FAILED()
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L16)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

20: error LTP_INVALID_ACCOUNT_PROOF()
21: error LTP_INVALID_INCLUSION_PROOF()
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L21)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

25: error TG_INVALID_SIGNATURES_LENGTH()
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L25)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

50: error HOOK_ASSIGNMENT_EXPIRED()
51: error HOOK_ASSIGNMENT_INVALID_SIG()
52: error HOOK_TIER_NOT_FOUND()
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L52)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

22: error L1_INVALID_ETH_DEPOSIT()
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L22)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

44: error L1_BLOB_FOR_DA_DISABLED()
45: error L1_BLOB_NOT_FOUND()
46: error L1_BLOB_NOT_REUSABLE()
47: error L1_BLOB_REUSE_DISABLED()
48: error L1_INVALID_HOOK()
49: error L1_INVALID_PARAM()
50: error L1_INVALID_PROVER()
51: error L1_LIVENESS_BOND_NOT_RECEIVED()
52: error L1_PROPOSER_NOT_EOA()
53: error L1_TOO_MANY_BLOCKS()
54: error L1_TXLIST_OFFSET()
55: error L1_TXLIST_SIZE()
56: error L1_UNAUTHORIZED()
57: error L1_UNEXPECTED_PARENT()
```
[44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L57)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

59: error L1_ALREADY_CONTESTED()
60: error L1_ALREADY_PROVED()
61: error L1_ASSIGNED_PROVER_NOT_ALLOWED()
62: error L1_BLOCK_MISMATCH()
63: error L1_INVALID_BLOCK_ID()
64: error L1_INVALID_PAUSE_STATUS()
65: error L1_INVALID_TIER()
66: error L1_INVALID_TRANSITION()
67: error L1_MISSING_VERIFIER()
68: error L1_NOT_ASSIGNED_PROVER()
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L68)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

11: error L1_BLOCK_MISMATCH()
12: error L1_INVALID_BLOCK_ID()
13: error L1_TRANSITION_NOT_FOUND()
14: error L1_UNEXPECTED_TRANSITION_ID()
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L14)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

39: error L1_BLOCK_MISMATCH()
40: error L1_INVALID_CONFIG()
41: error L1_TRANSITION_ID_ZERO()
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L41)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

45: error INVALID_GUARDIAN()
46: error INVALID_GUARDIAN_SET()
47: error INVALID_MIN_GUARDIANS()
48: error INVALID_PROOF()
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L48)

```solidity
File: packages/protocol/contracts/L1/TaikoErrors.sol

12: error L1_ALREADY_CONTESTED()
13: error L1_ALREADY_PROVED()
14: error L1_ASSIGNED_PROVER_NOT_ALLOWED()
15: error L1_BLOB_FOR_DA_DISABLED()
16: error L1_BLOB_NOT_FOUND()
17: error L1_BLOB_NOT_REUSABLE()
18: error L1_BLOB_REUSE_DISABLED()
19: error L1_BLOCK_MISMATCH()
20: error L1_INVALID_BLOCK_ID()
21: error L1_INVALID_CONFIG()
22: error L1_INVALID_ETH_DEPOSIT()
23: error L1_INVALID_HOOK()
24: error L1_INVALID_PARAM()
25: error L1_INVALID_PAUSE_STATUS()
26: error L1_INVALID_PROVER()
27: error L1_INVALID_TIER()
28: error L1_INVALID_TRANSITION()
29: error L1_LIVENESS_BOND_NOT_RECEIVED()
30: error L1_NOT_ASSIGNED_PROVER()
31: error L1_PROPOSER_NOT_EOA()
32: error L1_PROVING_PAUSED()
33: error L1_RECEIVE_DISABLED()
34: error L1_MISSING_VERIFIER()
35: error L1_TOO_MANY_BLOCKS()
36: error L1_TOO_MANY_TIERS()
37: error L1_TRANSITION_ID_ZERO()
38: error L1_TRANSITION_NOT_FOUND()
39: error L1_TXLIST_SIZE()
40: error L1_UNAUTHORIZED()
41: error L1_UNEXPECTED_PARENT()
42: error L1_UNEXPECTED_TRANSITION_ID()
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L38) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L42)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

18: error TKO_INVALID_ADDR()
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L18)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

17: error TIER_NOT_FOUND()
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L17)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

28: error XCO_INVALID_OWNER_CHAINID()
29: error XCO_INVALID_TX_ID()
30: error XCO_PERMISSION_DENIED()
31: error XCO_TX_REVERTED()
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L31)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

11: error EIP1559_INVALID_PARAMS()
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L11)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

59: error L2_BASEFEE_MISMATCH()
60: error L2_INVALID_CHAIN_ID()
61: error L2_INVALID_PARAM()
62: error L2_INVALID_SENDER()
63: error L2_PUBLIC_INPUT_HASH_MISMATCH()
64: error L2_TOO_LATE()
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L64)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

20: error L2_INVALID_CONFIG()
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L20)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

25: error SS_EMPTY_PROOF()
26: error SS_INVALID_SENDER()
27: error SS_INVALID_LAST_HOP_CHAINID()
28: error SS_INVALID_MID_HOP_CHAINID()
29: error SS_INVALID_STATE()
30: error SS_INVALID_VALUE()
31: error SS_SIGNAL_NOT_FOUND()
32: error SS_UNAUTHORIZED()
33: error SS_UNSUPPORTED()
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L33)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

50: error B_INVALID_CHAINID()
51: error B_INVALID_CONTEXT()
52: error B_INVALID_GAS_LIMIT()
53: error B_INVALID_STATUS()
54: error B_INVALID_USER()
55: error B_INVALID_VALUE()
56: error B_MESSAGE_NOT_SENT()
57: error B_NON_RETRIABLE()
58: error B_NOT_FAILED()
59: error B_NOT_RECEIVED()
60: error B_PERMISSION_DENIED()
61: error B_STATUS_MISMATCH()
62: error B_INVOCATION_TOO_EARLY()
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L58) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L62)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

34: error BTOKEN_CANNOT_RECEIVE()
35: error BTOKEN_UNAUTHORIZED()
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L35)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

29: error BB_PERMISSION_DENIED()
30: error BB_INVALID_PARAMS()
31: error BB_MINT_DISALLOWED()
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L31)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

21: error BTOKEN_CANNOT_RECEIVE()
22: error BTOKEN_INVALID_BURN()
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L22)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

29: error BTOKEN_CANNOT_RECEIVE()
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L29)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

133: error VAULT_INVALID_TOKEN()
134: error VAULT_INVALID_AMOUNT()
135: error VAULT_INVALID_TO()
136: error VAULT_INTERFACE_NOT_SUPPORTED()
137: error VAULT_TOKEN_ARRAY_MISMATCH()
138: error VAULT_MAX_TOKEN_PER_TXN_EXCEEDED()
```
[133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L133) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L134) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L136) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L137) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L138)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

20: error VAULT_PERMISSION_DENIED()
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L20)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

136: error VAULT_BTOKEN_BLACKLISTED()
137: error VAULT_CTOKEN_MISMATCH()
138: error VAULT_INVALID_TOKEN()
139: error VAULT_INVALID_AMOUNT()
140: error VAULT_INVALID_NEW_BTOKEN()
141: error VAULT_INVALID_TO()
142: error VAULT_NOT_SAME_OWNER()
```
[136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L136) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L137) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L138) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L139) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L140) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L141) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L142)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

9: error BTOKEN_INVALID_PARAMS()
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

10: error Overflow()
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L10)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

13: error PERMISSION_DENIED()
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L13)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

74: error SGX_ALREADY_ATTESTED()
75: error SGX_INVALID_ATTESTATION()
76: error SGX_INVALID_INSTANCE()
77: error SGX_INVALID_PROOF()
78: error SGX_RA_NOT_SUPPORTED()
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L74) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L75) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L76) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L78)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

37: error WITHDRAWALS_NOT_ONGOING()
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L37)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

29: error CLAIM_NOT_ONGOING()
30: error CLAIMED_ALREADY()
31: error INVALID_PROOF()
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L31)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

101: error ALREADY_GRANTED()
102: error INVALID_GRANT()
103: error INVALID_PARAM()
104: error NOTHING_TO_VOID()
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L101) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L102) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L103) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L104)
</details>

### [N-22] File with Library declaration Shoulde contain only Library

Libraries should be declared in a separate file and not in the same file where other contract/interfases declared.
This helps in maintaining a clean and organized codebase.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

37: library LibTiers
7: interface ITierProvider
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L37) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L7)
</details>

### [N-23] Consider using OpenZeppelin's SafeCast for any casting

OpenZeppelin's has `SafeCast` library that provides functions to safely cast. Recommended to use it instead of casting directly in any case.

<details>
<summary><i>119 issue instances in 29 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

39: uint64(block.chainid)
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L39)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

57: uint256(first)
57: uint256(second)
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L57) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L57)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

61: uint256(_value)
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L61)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

53: uint96(msg.value)
83: uint96(_config.ethDepositMaxFee.min(block.basefee * _config.ethDepositGas))
89: uint160(data >> 96)
90: uint96(data)
151: uint256(uint160(_addr))
151: uint160(_addr)
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L53) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L83) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L89) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L90) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L151) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L151)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

130: uint64(block.timestamp)
131: uint64(block.number - 1)
171: uint256(params.txListByteOffset)
191: uint24(_txList.length)
208: uint256(meta_.difficulty)
220: uint64(block.number)
245: uint160(prevHook)
245: uint160(params.hookCalls[i].hook)
```
[130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L130) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L131) | [171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L171) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L191) | [208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L208) | [220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L220) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L245) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L245)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

78: uint64(block.timestamp)
264: uint64(block.timestamp)
414: uint256(_ts.timestamp)
```
[78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L78) | [264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L264) | [414](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L414)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

57: uint64(block.number)
58: uint64(block.timestamp)
64: uint64(block.timestamp)
71: uint64(block.timestamp)
152: uint256(ITierProvider(tierProvider).getTier(ts.tier).cooldownWindow)
153: uint256(ts.timestamp)
178: uint256(ts.validityBond)
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L58) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L64) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L71) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L152) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L153) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L178)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

126: uint64(block.timestamp)
```
[126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L126)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

45: uint256(LibFixedPointMath.exp(int256(input)))
45: int256(input)
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L45) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L45)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

265: uint256(gasExcess)
284: uint64(excess.min(type(uint64).max))
291: uint256(_config.basefeeAdjustmentQuotient)
```
[265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L265) | [284](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L284) | [291](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L291)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

264: uint64(block.chainid)
308: uint64(block.chainid)
```
[264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L264) | [308](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L308)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

89: uint64(block.timestamp)
146: uint64(block.chainid)
183: uint64(block.timestamp)
240: uint64(block.timestamp)
457: uint256(Status.FAILED)
531: uint64(0)
533: uint160(PLACEHOLDER)
533: uint64(PLACEHOLDER)
```
[89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L89) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L146) | [183](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L183) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L240) | [457](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L457) | [531](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L531) | [533](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L533) | [533](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L533)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

257: uint64(block.chainid)
```
[257](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L257)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

366: uint64(block.chainid)
```
[366](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L366)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

204: uint64(block.chainid)
```
[204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L204)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

56: uint160(_srcToken)
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L56)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

14: uint8(_in[0])
35: uint8(_len)
35: uint8(_offset)
45: uint8(lenLen)
45: uint8(_offset)
47: uint8((_len / (256 ** (lenLen - i))) % 256)
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

134: uint8(key[currentKeyIndex])
141: uint8(path[0])
```
[134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L134) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L141)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

76: int256(
                (uint256(r) * 3_822_833_074_963_236_453_042_738_258_902_158_003_155_416_615_667)
                    >> uint256(195 - k)
            )
77: uint256(r)
78: uint256(195 - k)
```
[76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L76) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L78)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

154: uint32(bytes4(Bytes.slice(_proof.data, 0, 4)))
204: uint64(block.timestamp)
229: uint64(block.timestamp)
```
[154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L154) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L204) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L229)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

264: uint64(block.timestamp - _start)
```
[264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L264)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

268: uint256(IPEMCertChainLib.CRL.ROOT)
271: uint256(IPEMCertChainLib.CRL.PCK)
```
[268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L268) | [271](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L271)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

359: uint16(bytes2(svnValueBytes))
360: uint16(bytes2(svnValueBytes))
363: uint256(svnValue)
366: uint256(svnValue)
```
[359](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L359) | [360](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L360) | [363](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L363) | [366](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L366)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

146: uint16(littleEndianDecode(rawEnclaveReport.substring(256, 2)))
147: uint16(littleEndianDecode(rawEnclaveReport.substring(258, 2)))
154: uint256(uint8(bytes1(encoded[i])))
154: uint8(bytes1(encoded[i]))
212: uint16(littleEndianDecode(rawAuthData.substring(576, 2)))
217: uint16(littleEndianDecode(rawAuthData.substring(offset, 2)))
222: uint32(littleEndianDecode(rawAuthData.substring(offset, 4)))
```
[146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L147) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L154) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L154) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L212) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L217) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L222)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

15: uint80(self)
20: uint80(self >> 80)
25: uint80(self >> 160)
145: uint256(der.readBytesN(ptr.ixf(), len) >> (32 - len) * 8)
192: uint8(der[ix + 1])
193: uint80(ix + 2)
194: uint80(ixFirstContentByte + length - 1)
196: uint8(der[ix + 1] & 0x7F)
202: uint256(
                    der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8
                )
206: uint80(ix + 2 + lengthbytesLength)
207: uint80(ixFirstContentByte + length - 1)
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L15) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L20) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L25) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L145) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L192) | [193](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L193) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L194) | [196](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L196) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L202) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L206) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L207)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

97: int256(diff)
104: int256(len)
104: int256(otherlen)
189: uint8(self[idx])
336: uint8(BASE32_HEX_TABLE[uint256(uint8(char)) - 0x30])
336: uint256(uint8(char))
336: uint8(char)
```
[97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L97) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L104) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L104) | [189](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L189) | [336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L336) | [336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L336) | [336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L336)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

125: uint8(decipher[decipherlen - 50])
128: uint8(decipher[decipherlen - 48])
```
[125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L125) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L128)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

126: uint256(bytes32(signature.substring(0, 32)))
127: uint256(bytes32(signature.substring(32, 32)))
132: uint256(bytes32(publicKey.substring(0, 32)))
133: uint256(bytes32(publicKey.substring(32, 32)))
```
[126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L126) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L127) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L133)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

18: uint8(x509Time[0])
21: uint8(x509Time[0])
21: uint8(x509Time[1])
24: uint8(x509Time[offset + 0])
24: uint8(x509Time[offset + 1])
25: uint8(x509Time[offset + 2])
25: uint8(x509Time[offset + 3])
26: uint8(x509Time[offset + 4])
26: uint8(x509Time[offset + 5])
27: uint8(x509Time[offset + 6])
27: uint8(x509Time[offset + 7])
28: uint8(x509Time[offset + 8])
28: uint8(x509Time[offset + 9])
29: uint8(x509Time[offset + 10])
29: uint8(x509Time[offset + 11])
60: uint256(monthDays[i - 1])
63: uint256(day - 1)
64: uint256(hour)
65: uint256(minute)
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L24) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L25) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L26) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L27) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L28) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L29) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L29) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L60) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L65)
</details>

### [N-24] Consider using `delete` rather than assigning `false` to clear values

The use of the delete keyword is recommended over simply assigning values to false when you intend to reset the state of a variable.
The delete keyword more closely aligns with the semantic intent of clearing or resetting a variable.
This practice also makes the code more readable and highlights the change in state, which may encourage a more thorough audit of the surrounding logic.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

495: success_ = false
```
[495](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L495)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

129: hasNullParam = false
```
[129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L129)
</details>

### [N-25] Consider using `delete` rather than assigning `zero` to clear values

Rather than merely setting a variable to zero, you can use the `delete` keyword to reset it to its default value.
This action is especially relevant for complex data types like arrays or mappings where the default is not necessarily zero.
Using `delete` not only provides explicit clarity that you intend to reset a variable, but it can also result in more concise and intuitive code.

<details>
<summary><i>10 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

190: meta_.txListByteOffset = 0
```
[190](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L190)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

197: blk.livenessBond = 0
300: ts_.blockHash = 0
301: ts_.stateRoot = 0
302: ts_.validityBond = 0
306: ts_.tier = 0
307: ts_.contestations = 0
```
[197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L197) | [300](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L300) | [301](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L301) | [302](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L302) | [306](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L306) | [307](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L307)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

231: _grant.grantStart = 0
232: _grant.grantPeriod = 0
```
[231](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L231) | [232](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L232)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

336: tbsPtr = 0
```
[336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L336)
</details>

### [N-26] Consider emitting an event at the end of the constructor

This will allow users to easily exactly pinpoint when and by whom a contract was constructed.

<details>
<summary><i>3 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

64: constructor()
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L64)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

54: constructor(address sigVerifyLibAddr, address pemCertLibAddr)
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

20: constructor(address es256Verifier)
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L20)
</details>

### [N-27] Consider moving duplicated strings to constants

Reusing string literals in this manner can lead to inconsistencies and makes the code harder to maintain.
It's recommended to define such strings as constants, which promotes easier updates and ensures uniformity across the codebase.

<details>
<summary><i>38 issue instances in 10 files:</i></summary>

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

101: "signal_service"
117: "signal_service"
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L101) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L117)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

150: "signal_service"
172: "signal_service"
229: "signal_service"
342: "signal_service"
363: "signal_service"
384: "signal_service"
522: "signal_service"
397: "bridge"
589: "bridge"
```
[150](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L150) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L172) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L229) | [342](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L342) | [363](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L363) | [384](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L384) | [522](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L522) | [397](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L397) | [589](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L589)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

64: "erc20_vault"
83: "erc20_vault"
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L64) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L83)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

52: "foo"
52: "foo"
76: ""
93: ""
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L52) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L52) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L76) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L93)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

226: ""
259: ""
260: ""
275: ""
```
[226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L226) | [259](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L259) | [260](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L260) | [275](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L275)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

25: "slice_overflow"
26: "slice_overflow"
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L26)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

39: "RLPReader: length of an RLP item must be greater than zero to be decodable"
154: "RLPReader: length of an RLP item must be greater than zero to be decodable"
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L39) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L154)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

143: "Not positive"
156: "Not positive"
142: "Not type INTEGER"
155: "Not type INTEGER"
```
[143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L143) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L156) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L142) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L155)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

212: "unexpected idx"
225: "unexpected idx"
238: "unexpected idx"
265: "unexpected idx"
264: "unexpected len"
329: "unexpected len"
365: "unexpected len"
```
[212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L212) | [225](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L225) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L238) | [265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L265) | [264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L264) | [329](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L329) | [365](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L365)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

50: "Unsupported algorithm"
75: "Unsupported algorithm"
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L50) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L75)
</details>

### [N-28] Consider providing a ranged getter for array state variables

While the compiler automatically provides a getter for accessing single elements within a public state variable array, it doesn't provide a way to fetch the whole array, or subsets thereof.
Consider adding a function to allow the fetching of slices of the array, especially if the contract doesn't already have multicall functionality.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

23: address[] public guardians
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L23)
</details>

### [N-29] Consider using named returns

Using named returns makes the code more self-documenting, makes it easier to fill out NatSpec, and in some cases can save gas.
The cases below are where there currently is at most one return statement, which is ideal for named returns.

<details>
<summary><i>144 issue instances in 43 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

54: function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address)
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L54)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

30: function resolve(
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
43: function resolve(
        uint64 _chainId,
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L30) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L43)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

88: function paused() public view returns (bool)
140: function _inNonReentrant() internal view returns (bool)
```
[88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L88) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L140)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

61: function isValidSignature(
        address _addr,
        bytes32 _hash,
        bytes memory _sig
    )
        internal
        view
        returns (bool)
77: function isSenderEOA() internal view returns (bool)
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L61) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L77)

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

12: function min(uint256 _a, uint256 _b) internal pure returns (uint256)
20: function max(uint256 _a, uint256 _b) internal pure returns (uint256)
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L12) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L20)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
99: function state(uint256 _proposalId)
        public
        view
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (ProposalState)
111: function votingDelay() public pure override returns (uint256)
117: function votingPeriod() public pure override returns (uint256)
123: function proposalThreshold() public pure override returns (uint256)
140: function _cancel(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (uint256)
153: function _executor()
        internal
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (address)
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L99) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L111) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L117) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L123) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L140) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L153)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

24: function getMinDelay() public view override returns (uint256)
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L24)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

137: function hashAssignment(
        ProverAssignment memory _assignment,
        address _taikoL1Address,
        bytes32 _blobHash
    )
        public
        view
        returns (bytes32)
164: function _getProverFee(
        TaikoData.TierFee[] memory _tierFees,
        uint16 _tierId
    )
        private
        pure
        returns (uint256)
```
[137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L137) | [164](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L164)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

122: function canDepositEthToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint256 _amount
    )
        internal
        view
        returns (bool)
149: function _encodeEthDeposit(address _addr, uint256 _amount) private pure returns (uint256)
```
[122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L122) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L149)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

287: function isBlobReusable(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        bytes32 _blobHash
    )
        internal
        view
        returns (bool)
299: function _isProposerPermitted(
        TaikoData.SlotB memory _slotB,
        IAddressResolver _resolver
    )
        private
        view
        returns (bool)
```
[287](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L287) | [299](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L299)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

23: function getTransition(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint64 _blockId,
        bytes32 _parentHash
    )
        external
        view
        returns (TaikoData.TransitionState storage)
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L23)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

245: function _isConfigValid(TaikoData.Config memory _config) private view returns (bool)
```
[245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L245)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

101: function isApproved(bytes32 _hash) public view returns (bool)
107: function numGuardians() public view returns (uint256)
128: function isApproved(uint256 _approvalBits) internal view returns (bool)
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L101) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L107) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L128)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

132: function canDepositEthToL2(uint256 _amount) public view returns (bool)
137: function isBlobReusable(bytes32 _blobHash) public view returns (bool)
162: function getTransition(
        uint64 _blockId,
        bytes32 _parentHash
    )
        public
        view
        returns (TaikoData.TransitionState memory)
186: function getConfig() public view virtual override returns (TaikoData.Config memory)
```
[132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L132) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L137) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L162) | [186](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L186)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

60: function transfer(address _to, uint256 _amount) public override returns (bool)
70: function transferFrom(
        address _from,
        address _to,
        uint256 _amount
    )
        public
        override
        returns (bool)
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L60) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L70)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory)
54: function getMinTier(uint256) public pure override returns (uint16)
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L20) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L54)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory)
66: function getMinTier(uint256 _rand) public pure override returns (uint16)
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L20) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory)
66: function getMinTier(uint256 _rand) public pure override returns (uint16)
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L20) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

16: function basefee(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        internal
        pure
        returns (uint256)
33: function _ethQty(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        private
        pure
        returns (uint256)
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L16) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L33)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

200: function getBlockHash(uint64 _blockId) public view returns (bytes32)
219: function skipFeeCheck() public pure virtual returns (bool)
```
[200](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L200) | [219](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L219)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

43: function getConfig() public view override returns (Config memory)
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L43)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

63: function sendSignal(bytes32 _signal) external returns (bytes32)
68: function syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        returns (bytes32)
137: function isChainDataSynced(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        public
        view
        nonZeroValue(_chainData)
        returns (bool)
153: function isSignalSent(address _app, bytes32 _signal) public view returns (bool)
177: function signalForChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        public
        pure
        returns (bytes32)
194: function getSignalSlot(
        uint64 _chainId,
        address _app,
        bytes32 _signal
    )
        public
        pure
        returns (bytes32)
206: function _verifyHopProof(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes32 _value,
        HopProof memory _hop,
        address _signalService
    )
        internal
        virtual
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32)
```
[63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L63) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L68) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L137) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L153) | [177](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L177) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L194) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L206)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

340: function isMessageSent(Message calldata _message) public view returns (bool)
352: function proveMessageFailed(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
374: function proveMessageReceived(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
449: function hashMessage(Message memory _message) public pure returns (bytes32)
456: function signalForFailedMessage(bytes32 _msgHash) public pure returns (bytes32)
555: function _loadContext() private view returns (Context memory)
```
[340](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L340) | [352](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L352) | [374](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L374) | [449](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L449) | [456](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L456) | [555](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L555)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

91: function name()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (string memory)
102: function symbol()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (string memory)
113: function decimals()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (uint8)
125: function canonical() public view returns (address, uint256)
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L91) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L102) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L113) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L125)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

93: function owner() public view override(IBridgedERC20, OwnableUpgradeable) returns (address)
101: function _isMigratingOut() internal view returns (bool)
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L93) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L101)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

87: function name() public view override(ERC721Upgradeable) returns (string memory)
93: function symbol() public view override(ERC721Upgradeable) returns (string memory)
100: function source() public view returns (address, uint256)
107: function tokenURI(uint256 _tokenId) public view virtual override returns (string memory)
```
[87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L87) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L93) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L100) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L107)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

115: function name() public view returns (string memory)
121: function symbol() public view returns (string memory)
```
[115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L115) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L121)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

39: function supportsInterface(bytes4 _interfaceId) public view virtual override returns (bool)
45: function name() public pure virtual returns (bytes32)
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L39) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L45)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
192: function supportsInterface(bytes4 interfaceId)
        public
        view
        virtual
        override(BaseVault, ERC1155ReceiverUpgradeable)
        returns (bool)
204: function name() public pure override returns (bytes32)
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L192) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L204)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

316: function name() public pure override returns (bytes32)
```
[316](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L316)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

142: function onERC721Received(
        address,
        address,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
156: function name() public pure override returns (bytes32)
```
[142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L142) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L156)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

28: function buildName(
        string memory _name,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
39: function buildSymbol(string memory _symbol) internal pure returns (string memory)
43: function buildURI(
        address _srcToken,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L28) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L39) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L43)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25: function excessivelySafeCall(
        address _target,
        uint256 _gas,
        uint256 _value,
        uint16 _maxCopy,
        bytes memory _calldata
    )
        internal
        returns (bool, bytes memory)
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

15: function slice(
        bytes memory _bytes,
        uint256 _start,
        uint256 _length
    )
        internal
        pure
        returns (bytes memory)
91: function slice(bytes memory _bytes, uint256 _start) internal pure returns (bytes memory)
102: function toNibbles(bytes memory _bytes) internal pure returns (bytes memory)
149: function equal(bytes memory _bytes, bytes memory _other) internal pure returns (bool)
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L15) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L91) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L102) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L149)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

90: function addInstances(address[] calldata _instances)
        external
        onlyOwner
        returns (uint256[] memory)
118: function registerInstance(V3Struct.ParsedV3QuoteStruct calldata _attestation)
        external
        returns (uint256)
171: function getSignedHash(
        TaikoData.Transition memory _tran,
        address _newInstance,
        address _prover,
        bytes32 _metaHash
    )
        public
        view
        returns (bytes32)
233: function _isInstanceValid(uint256 id, address instance) private view returns (bool)
```
[90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L90) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L118) | [171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L171) | [233](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L233)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

77: function _verifyMerkleProof(
        bytes32[] calldata _proof,
        bytes32 _merkleRoot,
        bytes32 _value
    )
        internal
        pure
        virtual
        returns (bool)
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L77)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

204: function getMyGrant(address _recipient) public view returns (Grant memory)
235: function _getAmountOwned(Grant memory _grant) private view returns (uint128)
239: function _getAmountUnlocked(Grant memory _grant) private view returns (uint128)
245: function _calcAmount(
        uint128 _amount,
        uint64 _start,
        uint64 _cliff,
        uint64 _period
    )
        private
        view
        returns (uint128)
```
[204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L204) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L235) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L239) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L245)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

138: function verifyAttestation(bytes calldata data) external view override returns (bool)
162: function _verify(bytes calldata quote) private view returns (bool, bytes memory)
175: function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)
        private
        view
        returns (bool, EnclaveIdStruct.EnclaveIdStatus status)
206: function _checkTcbLevels(
        IPEMCertChainLib.PCKCertificateField memory pck,
        TCBInfoStruct.TCBInfo memory tcb
    )
        private
        pure
        returns (bool, TCBInfoStruct.TCBStatus status)
229: function _isCpuSvnHigherOrGreater(
        uint256[] memory pckCpuSvns,
        uint8[] memory tcbCpuSvns
    )
        private
        pure
        returns (bool)
248: function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
        private
        view
        returns (bool)
303: function _enclaveReportSigVerification(
        bytes memory pckCertPubKey,
        bytes memory signedQuoteData,
        V3Struct.ECDSAQuoteV3AuthData memory authDataV3,
        V3Struct.EnclaveReport memory qeEnclaveReport
    )
        private
        view
        returns (bool)
355: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        view
        override
        returns (bool, bytes memory)
364: function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
        internal
        view
        returns (bool, bytes memory)
```
[138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L162) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229) | [248](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248) | [303](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355) | [364](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

14: function ixs(uint256 self) internal pure returns (uint256)
19: function ixf(uint256 self) internal pure returns (uint256)
24: function ixl(uint256 self) internal pure returns (uint256)
29: function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256)
47: function root(bytes memory der) internal pure returns (uint256)
56: function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256)
66: function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256)
77: function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256)
87: function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256)
98: function isChildOf(uint256 i, uint256 j) internal pure returns (bool)
111: function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory)
121: function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory)
131: function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32)
141: function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256)
154: function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory)
165: function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32)
169: function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32)
179: function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory)
187: function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256)
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L14) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L19) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L24) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L29) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L47) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L56) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L66) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L77) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L87) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L98) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L111) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L121) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L131) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L141) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L154) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L165) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L169) | [179](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L179) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L187)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

39: function compare(bytes memory self, bytes memory other) internal pure returns (int256)
56: function compare(
        bytes memory self,
        uint256 offset,
        uint256 len,
        bytes memory other,
        uint256 otheroffset,
        uint256 otherlen
    )
        internal
        pure
        returns (int256)
116: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other,
        uint256 otherOffset,
        uint256 len
    )
        internal
        pure
        returns (bool)
138: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other,
        uint256 otherOffset
    )
        internal
        pure
        returns (bool)
160: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other
    )
        internal
        pure
        returns (bool)
178: function equals(bytes memory self, bytes memory other) internal pure returns (bool)
284: function substring(
        bytes memory self,
        uint256 offset,
        uint256 len
    )
        internal
        pure
        returns (bytes memory)
320: function base32HexDecodeWord(
        bytes memory self,
        uint256 off,
        uint256 len
    )
        internal
        pure
        returns (bytes32)
371: function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool)
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L39) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L56) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L116) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L138) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L160) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L178) | [284](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L284) | [320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L320) | [371](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L371)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

43: function pkcs1Sha256(
        bytes32 _sha256,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
191: function pkcs1Sha256Raw(
        bytes memory _data,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
212: function pkcs1Sha1(
        bytes20 _sha1,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
307: function pkcs1Sha1Raw(
        bytes memory _data,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L43) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L191) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L212) | [307](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L307)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

24: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
54: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L24) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L54)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

8: function toTimestamp(bytes memory x509Time) internal pure returns (uint256)
34: function toUnixTimestamp(
        uint16 year,
        uint8 month,
        uint8 day,
        uint8 hour,
        uint8 minute,
        uint8 second
    )
        internal
        pure
        returns (uint256)
71: function isLeapYear(uint16 year) internal pure returns (bool)
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L8) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L34) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L71)
</details>

### [N-30] Style guide: Initialisms should be capitalized

According to the Solidity [style guide](https://docs.soliditylang.org/en/latest/style-guide.html#naming-styles) initialisms such as "NFT", "ERC", etc should be capitalized.

<details>
<summary><i>29 issue instances in 12 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

22: function sendEther(address _to, uint256 _amount, uint256 _gasLimit) internal
22: uint256 _gasLimit
42: function sendEther(address _to, uint256 _amount) internal
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L22) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L22) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L42)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

29: function depositEtherToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        address _recipient
    )
        internal
122: function canDepositEthToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint256 _amount
    )
        internal
        view
        returns (bool)
149: function _encodeEthDeposit(address _addr, uint256 _amount) private pure returns (uint256)
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L29) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L122) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L149)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

119: function depositEtherToL2(address _recipient) external payable nonReentrant whenNotPaused
132: function canDepositEthToL2(uint256 _amount) public view returns (bool)
```
[119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L119) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L132)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

16: uint64 public ownerChainId
63: uint64 _ownerChainId
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L16) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L63)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

17: uint256 _gasExcess
33: function _ethQty(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        private
        pure
        returns (uint256)
34: uint256 _gasExcess
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L17) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L34)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

47: uint64 public gasExcess
75: uint64 _gasExcess
111: uint32 _parentGasUsed
187: uint32 _parentGasUsed
255: uint32 _parentGasUsed
259: uint64 gasExcess_
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L47) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L75) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L111) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L187) | [255](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L255) | [259](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L259)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

25: function setConfigAndExcess(
        Config memory _newConfig,
        uint64 _newGasExcess
    )
        external
        virtual
        onlyOwner
27: uint64 _newGasExcess
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L25) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L27)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

480: uint256 _gasLimit
280: uint256 gasLimit = msg.sender == _message.destOwner ? gasleft() : _message.gasLimit
```
[480](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L480) | [280](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L280)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

27: uint256 _gas
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L27)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

82: uint256 currentKeyIndex = 0
```
[82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L82)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

74: uint256 index
89: uint256 index
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L74) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L89)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

219: uint256 endIndex
51: uint256 index = 0
```
[219](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L219) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L51)
</details>

### [N-31] Expressions for constant values should use `immutable` rather than `constant`

While it does not save gas for some simple binary expressions because the compiler knows that developers often make this mistake, it's still best to use the right tool for the task at hand. There is a difference between `constant` variables and immutable variables, and they should each be used in their appropriate contexts.
`constant`s should be used for literal values written into the code, and immutable variables should be used for expressions, or values calculated in, or passed into the constructor.

<details>
<summary><i>8 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

10: address public constant POINT_EVALUATION_PRECOMPILE_ADDRESS = address(0x0A)
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L10)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

21: uint256 public constant MAX_BYTES_PER_BLOB = 4096 * 32
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L21)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

20: bytes32 public constant RETURN_LIVENESS_BOND = keccak256("RETURN_LIVENESS_BOND")
23: bytes32 public constant TIER_OP = bytes32("tier_optimistic")
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L20) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L23)

```solidity
File: packages/protocol/contracts/signal/LibSignals.sol

8: bytes32 public constant STATE_ROOT = keccak256("STATE_ROOT")
11: bytes32 public constant SIGNAL_ROOT = keccak256("SIGNAL_ROOT")
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L8) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L11)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

27: uint256 internal constant PLACEHOLDER = type(uint256).max
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L27)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

24: uint256 internal constant BRANCH_NODE_LENGTH = TREE_RADIX + 1
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L24)
</details>

### [N-32] Consider using named function arguments

When calling functions in external contracts with multiple arguments, consider using named function parameters, rather than positional ones.

<details>
<summary><i>160 issue instances in 34 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

83: IAddressManager(addressManager).getAddress(_chainId, _name)
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L83)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

27: ExcessivelySafeCall.excessivelySafeCall(
            _to,
            _gasLimit,
            _amount,
            64, // return max 64 bytes
            ""
        )
71: IERC1271(_addr).isValidSignature(_hash, _sig)
73: ECDSA.recover(_hash, _sig)
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L27) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L71) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L73)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

48: SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash)
60: SecureMerkleTrie.verifyInclusionProof(
            bytes.concat(_slot), RLPWriter.writeUint(uint256(_value)), _storageProof, storageRoot_
        )
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L48) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L60)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

83: GovernorCompatibilityBravoUpgradeable.propose(
            _targets, _values, _signatures, _calldatas, _description
        )
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L83)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

96: _blk.assignedProver.isValidSignature(hash, assignment.signature)
111: _blk.assignedProver.sendEther(proverFee, MAX_GAS_PAYING_PROVER)
114: IERC20(assignment.feeToken).safeTransferFrom(
                _meta.coinbase, _blk.assignedProver, proverFee
            )
```
[96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L96) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L111) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L114)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

41: _resolver.resolve("bridge", false)
```
[41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L41)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

114: LibDepositing.processDeposits(_state, _config, params.coinbase)
207: _resolver.resolve("tier_provider", false)
237: _resolver.resolve("taiko_token", false)
309: _resolver.resolve("proposer_one", true)
315: _resolver.resolve("proposer", true)
```
[114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L114) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L207) | [237](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L237) | [309](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L309) | [315](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L315)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

141: _resolver.resolve("tier_provider", false)
161: _resolver.resolve(tier.verifierName, true)
177: IVerifier(verifier).verifyProof(ctx, _tran, _proof)
187: _resolver.resolve("taiko_token", false)
278: LibUtils.getTransitionId(_state, _blk, slot, _tran.parentHash)
```
[141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L141) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L161) | [177](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L177) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L187) | [278](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L278)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

133: LibUtils.getTransitionId(_state, blk, slot, blockHash)
149: _resolver.resolve("tier_provider", false)
188: _resolver.resolve("taiko_token", false)
232: _resolver.resolve("signal_service", false)
234: signalService.getSyncedChainData(
            _config.chainId, LibSignals.STATE_ROOT, 0 /* latest block Id*/
        )
239: signalService.syncChainData(
                _config.chainId, LibSignals.STATE_ROOT, _lastVerifiedBlockId, _stateRoot
            )
```
[133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L133) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L149) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L188) | [232](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L232) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L234) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L239)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

51: ITaikoL1(resolve("taiko", false)).proveBlock(_meta.id, abi.encode(_meta, _tran, _proof))
```
[51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L51)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

51: LibVerifying.init(state, getConfig(), _genesisBlockHash)
67: LibProposing.proposeBlock(state, config, this, _params, _txList)
70: LibVerifying.verifyBlocks(state, config, this, config.maxBlocksToVerifyPerProposal)
94: LibProving.proveBlock(state, config, this, meta, tran, proof)
96: LibVerifying.verifyBlocks(state, config, this, maxBlocksToVerify)
106: LibVerifying.verifyBlocks(state, getConfig(), this, _maxBlocksToVerify)
113: LibProving.pauseProving(state, _pause)
120: LibDepositing.depositEtherToL2(state, getConfig(), this, _recipient)
133: LibDepositing.canDepositEthToL2(state, getConfig(), _amount)
138: LibProposing.isBlobReusable(state, getConfig(), _blobHash)
151: LibUtils.getBlock(state, getConfig(), _blockId)
170: LibUtils.getTransition(state, getConfig(), _blockId, _parentHash)
```
[51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L51) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L67) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L70) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L94) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L96) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L106) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L113) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L120) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L133) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L138) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L151) | [170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L170)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

148: ISignalService(resolve("signal_service", false)).syncChainData(
                ownerChainId, LibSignals.STATE_ROOT, _l1BlockId, _l1StateRoot
            )
176: IERC20(_token).safeTransfer(_to, IERC20(_token).balanceOf(address(this)))
290: Lib1559Math.basefee(
                gasExcess_, uint256(_config.basefeeAdjustmentQuotient) * _config.gasTargetPerL1Block
            )
```
[148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L148) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L176) | [290](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L290)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

221: LibTrieProof.verifyMerkleProof(
            _hop.rootHash,
            _signalService,
            getSignalSlot(_chainId, _app, _signal),
            _value,
            _hop.accountProof,
            _hop.storageProof
        )
```
[221](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L221)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

174: ISignalService(signalService).isSignalSent(address(this), msgHash)
497: ExcessivelySafeCall.excessivelySafeCall(
                _message.to,
                _gasLimit,
                _message.value,
                64, // return max 64 bytes
                _message.data
            )
```
[174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L174) | [497](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L497)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

65: LibBridgedToken.validateInputs(_srcToken, _srcChainId, _symbol, _name)
97: LibBridgedToken.buildName(super.name(), srcChainId)
```
[65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L65) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L97)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

43: LibBridgedToken.validateInputs(_srcToken, _srcChainId, _symbol, _name)
88: LibBridgedToken.buildName(super.name(), srcChainId)
110: LibBridgedToken.buildURI(srcToken, srcChainId)
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L43) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L88) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L110)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

52: LibBridgedToken.validateInputs(_srcToken, _srcChainId, "foo", "foo")
54: LibBridgedToken.buildURI(_srcToken, _srcChainId)
116: LibBridgedToken.buildName(__name, srcChainId)
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L52) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L54) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L116)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

226: IERC1155(token).safeBatchTransferFrom(address(this), to, tokenIds, amounts, "")
```
[226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L226)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

184: IBridgedERC20(btokenOld_).changeMigrationStatus(_btokenNew, false)
185: IBridgedERC20(_btokenNew).changeMigrationStatus(btokenOld_, true)
330: IERC20(token_).safeTransfer(_to, _amount)
```
[184](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L184) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L185) | [330](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L330)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

171: IERC721(token_).safeTransferFrom(address(this), _to, _tokenIds[i])
211: t.safeTransferFrom(_user, address(this), _op.tokenIds[i])
```
[171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L171) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L211)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

36: string.concat("Bridged ", _name, unicode" (", Strings.toString(_srcChainId), ")")
40: string.concat(_symbol, ".t")
56: Strings.toHexString(uint160(_srcToken), 20)
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L36) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L40) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L56)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

60: Bytes.equal(_value, get(_key, _proof, _root))
94: Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID)
100: Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID)
106: Bytes.equal(currentNode.encoded, currentNodeID)
143: Bytes.slice(path, offset)
144: Bytes.slice(key, currentKeyIndex)
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L60) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L94) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L100) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L106) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L143) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L144)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

30: MerkleTrie.verifyInclusionProof(key, _value, _proof, _root)
48: MerkleTrie.get(key, _proof, _root)
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L30) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L48)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

154: Bytes.slice(_proof.data, 0, 4)
155: Bytes.slice(_proof.data, 4, 20)
156: Bytes.slice(_proof.data, 24)
159: ECDSA.recover(getSignedHash(_tran, newInstance, _ctx.prover, _ctx.metaHash), signature)
```
[154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L154) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L155) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L156) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L159)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

71: IVotes(token).delegateBySig(delegatee, nonce, expiry, v, r, s)
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L71)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

60: IERC721(token).safeTransferFrom(vault, user, tokenIds[i])
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L60)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

87: MerkleProof.verify(_proof, _merkleRoot, _value)
```
[87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L87)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

171: ECDSA.recover(hash, _sig)
220: IERC20(costToken).safeTransferFrom(_recipient, sharedVault, costToWithdraw)
```
[171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L171) | [220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L220)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

167: V3Parser.parseInput(quote, address(pemCertLib))
285: sigVerifyLib.verifyES256Signature(
                certs[i].tbsCertificate, certs[i].signature, issuer.pubKey
            )
313: qeEnclaveReport.reportData.substring(0, 32)
322: sigVerifyLib.verifyES256Signature(
                pckSignedQeReportBytes, authDataV3.qeReportSignature, pckCertPubKey
            )
325: sigVerifyLib.verifyES256Signature(
                signedQuoteData, authDataV3.ecdsa256BitSignature, authDataV3.ecdsaAttestationKey
            )
424: pemCertLib.decodeCert(
                    authDataV3.certification.decodedCertDataArray[i], isPckCert
                )
437: LibString.eq(parsedFmspc, fetchedTcbInfo.fmspc)
443: LibString.eq(pckCert.pck.sgxExtension.pceid, fetchedTcbInfo.pceid)
```
[167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L167) | [285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L285) | [313](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L313) | [322](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L322) | [325](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L325) | [424](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L424) | [437](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L437) | [443](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L443)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

57: LibString.slice(pemChainStr, index, index + len)
120: LibString.eq(cert.pck.issuerName, PLATFORM_ISSUER_NAME)
121: LibString.eq(cert.pck.issuerName, PROCESSOR_ISSUER_NAME)
152: LibString.eq(cert.pck.commonName, PCK_COMMON_NAME)
171: NodePtr.getPtr(sigPtr.ixs() + 3, sigPtr.ixf() + 3, sigPtr.ixl())
222: LibString.indexOf(pemData, HEADER)
223: LibString.indexOf(pemData, FOOTER)
240: LibString.slice(pemData, contentStart, endPos)
241: LibString.split(contentSlice, string(delimiter))
245: LibString.concat(contentStr, split[i])
266: input.substring(lengthDiff, expectedLength)
292: BytesUtils.compareBytes(der.bytesAt(internalPtr), SGX_EXTENSION_OID)
306: BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), TCB_OID)
310: BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), PCEID_OID)
316: BytesUtils.compareBytes(der.bytesAt(extnValueOidPtr), FMSPC_OID)
361: BytesUtils.compareBytes(der.bytesAt(svnPtr), PCESVN_OID)
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L57) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L120) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L121) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L152) | [171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L171) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L222) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L223) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L240) | [241](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L241) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L245) | [266](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L266) | [292](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L292) | [306](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L306) | [310](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L310) | [316](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L316) | [361](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L361)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

33: quote.substring(432, 4)
38: quote.substring(0, 48)
46: quote.substring(436, localAuthDataSize)
51: quote.substring(48, 384)
138: rawEnclaveReport.substring(0, 16)
139: rawEnclaveReport.substring(16, 4)
140: rawEnclaveReport.substring(20, 28)
141: rawEnclaveReport.substring(48, 16)
142: rawEnclaveReport.substring(64, 32)
143: rawEnclaveReport.substring(96, 32)
144: rawEnclaveReport.substring(128, 32)
145: rawEnclaveReport.substring(160, 96)
146: rawEnclaveReport.substring(256, 2)
147: rawEnclaveReport.substring(258, 2)
148: rawEnclaveReport.substring(260, 60)
149: rawEnclaveReport.substring(320, 64)
170: rawHeader.substring(0, 2)
175: rawHeader.substring(2, 2)
180: rawHeader.substring(4, 4)
185: rawHeader.substring(12, 16)
194: rawHeader.substring(8, 2)
195: rawHeader.substring(10, 2)
197: rawHeader.substring(28, 20)
212: rawAuthData.substring(576, 2)
213: rawAuthData.substring(578, qeAuthData.parsedDataSize)
217: rawAuthData.substring(offset, 2)
222: rawAuthData.substring(offset, 4)
224: rawAuthData.substring(offset, cert.certDataSize)
227: rawAuthData.substring(0, 64)
228: rawAuthData.substring(64, 64)
229: rawAuthData.substring(128, 384)
231: rawAuthData.substring(512, 64)
278: pemCertLib.splitCertificateChain(certBytes, 3)
```
[33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L33) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L38) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L46) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L51) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L138) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L139) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L140) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L141) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L142) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L143) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L144) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L145) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L148) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L149) | [170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L170) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L175) | [180](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L180) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L185) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L194) | [195](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L195) | [197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L197) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L212) | [213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L213) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L217) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L222) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L224) | [227](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L227) | [228](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L228) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L229) | [231](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L231) | [278](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L278)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

112: der.substring(ptr.ixf(), ptr.ixl() + 1 - ptr.ixf())
122: der.substring(ptr.ixs(), ptr.ixl() + 1 - ptr.ixs())
132: der.readBytesN(ptr.ixf(), ptr.ixl() + 1 - ptr.ixf())
145: der.readBytesN(ptr.ixf(), len)
159: der.substring(ptr.ixf() + 1, valueLength - 1)
161: der.substring(ptr.ixf(), valueLength)
166: der.keccak(ptr.ixf(), ptr.ixl() + 1 - ptr.ixf())
170: der.keccak(ptr.ixs(), ptr.ixl() + 1 - ptr.ixs())
184: der.substring(ptr.ixf() + 1, valueLength - 1)
203: der.readBytesN(ix + 2, lengthbytesLength)
209: NodePtr.getPtr(ix, ixFirstContentByte, ixLastContentByte)
```
[112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L112) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L122) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L132) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L145) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L159) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L161) | [166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L166) | [170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L170) | [184](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L184) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L203) | [209](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L209)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

94: bytes.concat(bytes32(_s.length), bytes32(_e.length), bytes32(_m.length), _s, _e, _m)
242: bytes.concat(bytes32(_s.length), bytes32(_e.length), bytes32(_m.length), _s, _e, _m)
```
[94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L94) | [242](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L242)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

89: publicKey.substring(0, 3)
90: publicKey.substring(3, publicKey.length - 3)
93: RsaVerify.pkcs1Sha256Raw(tbs, signature, exponent, modulus)
106: publicKey.substring(0, 3)
107: publicKey.substring(3, publicKey.length - 3)
110: RsaVerify.pkcs1Sha1Raw(tbs, signature, exponent, modulus)
126: signature.substring(0, 32)
127: signature.substring(32, 32)
132: publicKey.substring(0, 32)
133: publicKey.substring(32, 32)
```
[89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L89) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L90) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L93) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L106) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L107) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L110) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L126) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L127) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L133)
</details>

### [N-33] Assembly block creates dirty bits

Writing data to the free memory pointer without later updating the free memory pointer will cause dirty bits at that memory location.
This makes it harder for the optimizer to determine whether the memory needs to be cleaned before use, leading to suboptimal optimizations.
It is recommended to update the free memory pointer and annotate the assembly block with `memory-safe` to avoid this issue.

<details>
<summary><i>6 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

/// @audit - Assembly block has `mstore` without `memory-safe` annotation
43: assembly {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L43)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

/// @audit - Assembly block has `mstore` without `memory-safe` annotation
31: assembly {
/// @audit - Assembly block has `mstore` without `memory-safe` annotation
104: assembly {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L31) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L104)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

/// @audit - Assembly block has `mstore` without `memory-safe` annotation
94: assembly {
/// @audit - Assembly block has `mstore` without `memory-safe` annotation
295: assembly {
```
[94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L94) | [295](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L295)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

/// @audit - Assembly block has `mstore` without `memory-safe` annotation
12: assembly {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L12)
</details>

### [N-34] Contract/Library Names Not in `CapWords` Style (CamelCase)

Contracts and libraries should be named using the `CapWords` style for better readability and consistency with Solidity style guidelines.
Examples of good practice include: SimpleToken, SmartBank, CertificateHashRepository, Player, Congress, Owned.
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#contract-and-library-names)

<details>
<summary><i>18 issue instances in 18 files:</i></summary>

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

9: contract TaikoL2EIP1559Configurable is TaikoL2 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

28: contract USDCAdapter is BridgedERC20Base {
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

15: contract BridgedERC20 is
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

9: abstract contract BaseNFTVault is BaseVault {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

18: contract ERC20Vault is BaseVault {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L18)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L16)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

9: library RLPReader {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

9: library RLPWriter {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L9)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

11: contract ERC20Airdrop is MerkleClaimable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L11)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

12: contract ERC20Airdrop2 is MerkleClaimable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L12)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

9: contract ERC721Airdrop is MerkleClaimable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L9)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

12: contract PEMCertChainLib is IPEMCertChainLib {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L12)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol

6: library TCBInfoStruct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

10: library SHA1 {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L10)
</details>

### [N-35] Events are missing sender information

Events should include the sender information when emitted in `public` or `external` functions for better traceability.

<details>
<summary><i>34 issue instances in 17 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit external function `setAddress()` emits an event without sender information
50: emit AddressSet(_chainId, _name, _newAddress, oldAddress);
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L50)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit external function `onBlockProposed()` emits an event without sender information
128: emit BlockAssigned(_blk.assignedProver, _meta, assignment);
```
[128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L128)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit external function `pauseProving()` emits an event without sender information
80: emit ProvingPaused(_pause);
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L80)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit external function `init()` emits an event without sender information
72: emit BlockVerified({
            blockId: 0,
            assignedProver: address(0),
            prover: address(0),
            blockHash: _genesisBlockHash,
            stateRoot: 0,
            tier: 0,
            contestations: 0
        });
```
[72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L72)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit external function `setGuardians()` emits an event without sender information
95: emit GuardiansUpdated(version, _newGuardians);
```
[95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L95)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit external function `onMessageInvocation()` emits an event without sender information
52: emit TransactionExecuted(nextTxId++, bytes4(txdata));
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L52)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit external function `anchor()` emits an event without sender information
156: emit Anchored(blockhash(parentId), gasExcess);
```
[156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L156)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

/// @audit external function `setConfigAndExcess()` emits an event without sender information
38: emit ConfigAndExcessChanged(_newConfig, _newGasExcess);
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L38)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit external function `authorize()` emits an event without sender information
59: emit Authorized(_addr, _authorize);
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L59)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit external function `suspendMessages()` emits an event without sender information
93: emit MessageSuspended(msgHash, _suspend);
/// @audit external function `banAddress()` emits an event without sender information
111: emit AddressBanned(_addr, _ban);
/// @audit external function `sendMessage()` emits an event without sender information
151: emit MessageSent(msgHash_, message_);
/// @audit external function `recallMessage()` emits an event without sender information
208: emit MessageRecalled(msgHash);
/// @audit external function `recallMessage()` emits an event without sender information
210: emit MessageReceived(msgHash, _message, true);
/// @audit external function `processMessage()` emits an event without sender information
301: emit MessageExecuted(msgHash);
/// @audit external function `processMessage()` emits an event without sender information
303: emit MessageReceived(msgHash, _message, false);
/// @audit external function `retryMessage()` emits an event without sender information
336: emit MessageRetried(msgHash);
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L93) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L111) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L151) | [208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L208) | [210](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L210) | [301](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L301) | [303](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L303) | [336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L336)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

/// @audit external function `changeMigrationStatus()` emits an event without sender information
51: emit MigrationStatusChanged(_migratingAddress, _migratingInbound);
/// @audit public function `mint()` emits an event without sender information
63: emit MigratedTo(migratingAddress, _account, _amount);
/// @audit public function `burn()` emits an event without sender information
80: emit MigratedTo(migratingAddress, _account, _amount);
```
[51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L51) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L63) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L80)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit external function `sendToken()` emits an event without sender information
80: emit TokenSent({
            msgHash: msgHash,
            from: message_.srcOwner,
            to: _op.to,
            destChainId: message_.destChainId,
            ctoken: ctoken.addr,
            token: _op.token,
            tokenIds: _op.tokenIds,
            amounts: _op.amounts
        });
/// @audit external function `onMessageInvocation()` emits an event without sender information
113: emit TokenReceived({
            msgHash: ctx.msgHash,
            from: from,
            to: to,
            srcChainId: ctx.srcChainId,
            ctoken: ctoken.addr,
            token: token,
            tokenIds: tokenIds,
            amounts: amounts
        });
/// @audit external function `onMessageRecalled()` emits an event without sender information
149: emit TokenReleased({
            msgHash: msgHash,
            from: message.srcOwner,
            ctoken: ctoken.addr,
            token: token,
            tokenIds: tokenIds,
            amounts: amounts
        });
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L80) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L113) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L149)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit external function `changeBridgedToken()` emits an event without sender information
190: emit BridgedTokenChanged({
            srcChainId: _ctoken.chainId,
            ctoken: _ctoken.addr,
            btokenOld: btokenOld_,
            btokenNew: _btokenNew,
            ctokenSymbol: _ctoken.symbol,
            ctokenName: _ctoken.name,
            ctokenDecimal: _ctoken.decimals
        });
/// @audit external function `sendToken()` emits an event without sender information
240: emit TokenSent({
            msgHash: msgHash,
            from: message_.srcOwner,
            to: _op.to,
            destChainId: _op.destChainId,
            ctoken: ctoken.addr,
            token: _op.token,
            amount: balanceChange
        });
/// @audit external function `onMessageInvocation()` emits an event without sender information
272: emit TokenReceived({
            msgHash: ctx.msgHash,
            from: from,
            to: to,
            srcChainId: ctx.srcChainId,
            ctoken: ctoken.addr,
            token: token,
            amount: amount
        });
/// @audit external function `onMessageRecalled()` emits an event without sender information
305: emit TokenReleased({
            msgHash: _msgHash,
            from: _message.srcOwner,
            ctoken: ctoken.addr,
            token: token,
            amount: amount
        });
```
[190](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L190) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L240) | [272](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L272) | [305](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L305)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit external function `sendToken()` emits an event without sender information
63: emit TokenSent({
            msgHash: msgHash,
            from: message_.srcOwner,
            to: _op.to,
            destChainId: message_.destChainId,
            ctoken: ctoken.addr,
            token: _op.token,
            tokenIds: _op.tokenIds,
            amounts: _op.amounts
        });
/// @audit external function `onMessageInvocation()` emits an event without sender information
96: emit TokenReceived({
            msgHash: ctx.msgHash,
            from: from,
            to: to,
            srcChainId: ctx.srcChainId,
            ctoken: ctoken.addr,
            token: token,
            tokenIds: tokenIds,
            amounts: new uint256[](tokenIds.length)
        });
/// @audit external function `onMessageRecalled()` emits an event without sender information
130: emit TokenReleased({
            msgHash: _msgHash,
            from: _message.srcOwner,
            ctoken: ctoken.addr,
            token: token,
            tokenIds: tokenIds,
            amounts: new uint256[](tokenIds.length)
        });
```
[63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L63) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L96) | [130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L130)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit external function `deleteInstances()` emits an event without sender information
108: emit InstanceDeleted(idx, instances[idx].addr);
```
[108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L108)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit external function `withdraw()` emits an event without sender information
92: emit Withdrawn(user, amount);
```
[92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L92)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit external function `grant()` emits an event without sender information
143: emit Granted(_recipient, _grant);
/// @audit external function `void()` emits an event without sender information
157: emit Voided(_recipient, amountVoided);
```
[143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L143) | [157](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L157)
</details>

### [N-36] Non-constant/non-immutable variables using all capital letters

Variable names that consist of all capital letters should be reserved for constant/immutable variables. If the variable needs to be different based on which class it comes from, a view/pure function should be used instead.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

19: but WITHOUT ANY WARRANTY; without even the implied warranty of
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L19)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

18: address private ES256VERIFIER;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L18)
</details>

### [N-37] NatSpec: Function `@param` tag is missing

Natural Specification (NatSpec) comments are crucial for understanding the role of function arguments in your Solidity code.
Including `@param` tags will not only improve your code's readability but also its maintainability by clearly defining each argument's purpose.

[More information in Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>144 issue instances in 41 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit Missed @param `address`
58: function _authorizePause(address) internal pure override {
```
[58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L58)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit Missed @param `_owner, _addressManager`
95: function __Essential_init(
        address _owner,
        address _addressManager
    )
        internal
        virtual
        onlyInitializing
    {
/// @audit Missed @param `_owner`
109: function __Essential_init(address _owner) internal virtual {
/// @audit Missed @param `address`
114: function _authorizeUpgrade(address) internal virtual override onlyOwner { }
/// @audit Missed @param `address`
116: function _authorizePause(address) internal virtual onlyOwner { }
/// @audit Missed @param `_reentry`
119: function _storeReentryLock(uint8 _reentry) internal virtual {
```
[95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L95) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L109) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L114) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L116) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L119)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

/// @audit Missed @param `_addr, _interfaceId`
46: function supportsInterface(
        address _addr,
        bytes4 _interfaceId
    )
        internal
        view
        returns (bool result_)
    {
/// @audit Missed @param `_addr, _hash, _sig`
61: function isValidSignature(
        address _addr,
        bytes32 _hash,
        bytes memory _sig
    )
        internal
        view
        returns (bool)
    {
```
[46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L46) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L61)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit Missed @param `_targets, _values, _calldatas, _description`
48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
/// @audit Missed @param `_targets, _values, _signatures, _calldatas, _description`
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
/// @audit Missed @param `_interfaceId`
89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
    {
/// @audit Missed @param `_proposalId`
99: function state(uint256 _proposalId)
        public
        view
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (ProposalState)
    {
/// @audit Missed @param `_proposalId, _targets, _values, _calldatas, _descriptionHash`
127: function _execute(
        uint256 _proposalId,
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
    {
/// @audit Missed @param `_targets, _values, _calldatas, _descriptionHash`
140: function _cancel(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (uint256)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L99) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L127) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L140)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit Missed @param `_owner, _addressManager`
57: function init(address _owner, address _addressManager) external initializer {
/// @audit Missed @param `_tierFees, _tierId`
164: function _getProverFee(
        TaikoData.TierFee[] memory _tierFees,
        uint16 _tierId
    )
        private
        pure
        returns (uint256)
    {
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57) | [164](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L164)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit Missed @param `_state, _config, _feeRecipient`
67: function processDeposits(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        address _feeRecipient
    )
        internal
        returns (TaikoData.EthDeposit[] memory deposits_)
    {
/// @audit Missed @param `_state, _config, _amount`
122: function canDepositEthToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint256 _amount
    )
        internal
        view
        returns (bool)
    {
```
[67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L67) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L122)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

/// @audit Missed @param `_slotB, _resolver`
299: function _isProposerPermitted(
        TaikoData.SlotB memory _slotB,
        IAddressResolver _resolver
    )
        private
        view
        returns (bool)
    {
```
[299](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L299)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit Missed @param `_state, _blk, _tran, slot`
269: function _createTransition(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        TaikoData.Transition memory _tran,
        uint64 slot
    )
        private
        returns (uint32 tid_, TaikoData.TransitionState storage ts_)
    {
/// @audit Missed @param `_ts, _tran, _proof, _tier, _tko, _sameTransition`
350: function _overrideWithHigherProof(
        TaikoData.TransitionState storage _ts,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof,
        ITierProvider.Tier memory _tier,
        IERC20 _tko,
        bool _sameTransition
    )
        private
    {
/// @audit Missed @param `_state, _blk, _ts, _tid, _tier`
401: function _checkProverPermission(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        TaikoData.TransitionState storage _ts,
        uint32 _tid,
        ITierProvider.Tier memory _tier
    )
        private
        view
    {
```
[269](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L269) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L350) | [401](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L401)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

/// @audit Missed @param `_state, _blk, _slot, _parentHash`
70: function getTransitionId(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        uint64 _slot,
        bytes32 _parentHash
    )
        internal
        view
        returns (uint32 tid_)
    {
```
[70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L70)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit Missed @param `_state, _config, _resolver, _maxBlocksToVerify`
85: function verifyBlocks(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _maxBlocksToVerify
    )
        internal
    {
/// @audit Missed @param `_config, _resolver, _lastVerifiedBlockId, _stateRoot`
224: function _syncChainData(
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _lastVerifiedBlockId,
        bytes32 _stateRoot
    )
        private
    {
/// @audit Missed @param `_config`
245: function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {
```
[85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L85) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L224) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L245)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

/// @audit Missed @param `_owner, _addressManager`
25: function init(address _owner, address _addressManager) external initializer {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit Missed @param `_operationId, _hash`
111: function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {
/// @audit Missed @param `_hash`
124: function deleteApproval(bytes32 _hash) internal {
/// @audit Missed @param `_approvalBits`
128: function isApproved(uint256 _approvalBits) internal view returns (bool) {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L111) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L124) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L128)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit Missed @param `_owner, _addressManager`
42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
    {
/// @audit Missed @param `_blobHash`
137: function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
/// @audit Missed @param `address`
220: function _authorizePause(address)
        internal
        view
        virtual
        override
        onlyFromOwnerOrNamed("chain_pauser")
    { }
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L137) | [220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L220)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit Missed @param `_from, _to, _amount`
83: function _beforeTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20SnapshotUpgradeable)
    {
/// @audit Missed @param `_from, _to, _amount`
94: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
/// @audit Missed @param `_to, _amount`
105: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
/// @audit Missed @param `_from, _amount`
115: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L83) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L94) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L105) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L115)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit Missed @param `_owner, _addressManager`
60: function __CrossChainOwned_init(
        address _owner,
        address _addressManager,
        uint64 _ownerChainId
    )
        internal
        virtual
        onlyInitializing
    {
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L60)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

/// @audit Missed @param `_gasExcess, _adjustmentFactor`
33: function _ethQty(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        private
        pure
        returns (uint256)
    {
```
[33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L33)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit Missed @param `_owner, _addressManager`
71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
/// @audit Missed @param `_blockId`
223: function _calcPublicInputHash(uint256 _blockId)
        private
        view
        returns (bytes32 publicInputHashOld, bytes32 publicInputHashNew)
    {
/// @audit Missed @param `_config, _l1BlockId, _parentGasUsed`
252: function _calc1559BaseFee(
        Config memory _config,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        private
        view
        returns (uint256 basefee_, uint64 gasExcess_)
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L223) | [252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L252)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit Missed @param `_owner, _addressManager`
48: function init(address _owner, address _addressManager) external initializer {
/// @audit Missed @param `_chainId, _app, _signal, _value, _hop, _signalService`
206: function _verifyHopProof(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes32 _value,
        HopProof memory _hop,
        address _signalService
    )
        internal
        virtual
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32)
    {
/// @audit Missed @param `address`
231: function _authorizePause(address) internal pure override {
/// @audit Missed @param `_chainId, _kind, _blockId, _chainData`
235: function _syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        private
        returns (bytes32 signal_)
    {
/// @audit Missed @param `_app, _signal, _value`
253: function _sendSignal(
        address _app,
        bytes32 _signal,
        bytes32 _value
    )
        private
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32 slot_)
    {
/// @audit Missed @param `_hop, _chainId, _blockId, _signalRoot, _isFullProof, _isLastHop`
271: function _cacheChainData(
        HopProof memory _hop,
        uint64 _chainId,
        uint64 _blockId,
        bytes32 _signalRoot,
        bool _isFullProof,
        bool _isLastHop
    )
        private
    {
/// @audit Missed @param `_app, _signal`
298: function _loadSignalValue(
        address _app,
        bytes32 _signal
    )
        private
        view
        validSender(_app)
        nonZeroValue(_signal)
        returns (bytes32 value_)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L206) | [231](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L231) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L235) | [253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L253) | [271](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L271) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L298)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit Missed @param `_owner, _addressManager`
75: function init(address _owner, address _addressManager) external initializer {
/// @audit Missed @param `address`
461: function _authorizePause(address)
        internal
        view
        virtual
        override
        onlyFromOwnerOrNamed("bridge_pauser")
    { }
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75) | [461](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L461)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

/// @audit Missed @param `_owner, _addressManager`
38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
/// @audit Missed @param `_account, _amount`
43: function _mintToken(address _account, uint256 _amount) internal override {
/// @audit Missed @param `_from, _amount`
47: function _burnToken(address _from, uint256 _amount) internal override {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L43) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L47)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit Missed @param `_owner, _addressManager`
52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
/// @audit Missed @param `_account, _amount`
129: function _mintToken(address _account, uint256 _amount) internal override {
/// @audit Missed @param `_from, _amount`
133: function _burnToken(address _from, uint256 _amount) internal override {
/// @audit Missed @param `_from, _to, _amount`
139: function _beforeTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20SnapshotUpgradeable)
    {
/// @audit Missed @param `_from, _to, _amount`
152: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
/// @audit Missed @param `_to, _amount`
163: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
/// @audit Missed @param `_from, _amount`
173: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L129) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L133) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L139) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L152) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L163) | [173](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L173)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

/// @audit Missed @param `_owner, _addressManager`
31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
/// @audit Missed @param `address, _to, uint256, /*_batchSize*/`
115: function _beforeTokenTransfer(
        address, /*_from*/
        address _to,
        uint256, /*_firstTokenId*/
        uint256 /*_batchSize*/
    )
        internal
        virtual
        override
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L115)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit Missed @param `_owner, _addressManager`
38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
/// @audit Missed @param `address, address, _to, uint256[], uint256[], /*_data*/`
125: function _beforeTokenTransfer(
        address, /*_operator*/
        address, /*_from*/
        address _to,
        uint256[] memory, /*_ids*/
        uint256[] memory, /*_amounts*/
        bytes memory /*_data*/
    )
        internal
        virtual
        override
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L125)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

/// @audit Missed @param `_owner, _addressManager`
32: function init(address _owner, address _addressManager) external initializer {
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit Missed @param `address, address, uint256[], uint256[], bytes`
160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
/// @audit Missed @param `address, address, uint256, uint256, bytes`
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit Missed @param `_ctoken, _to, _amount`
320: function _transferTokens(
        CanonicalERC20 memory _ctoken,
        address _to,
        uint256 _amount
    )
        private
        returns (address token_)
    {
```
[320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L320)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit Missed @param `_ctoken, _to, _tokenIds`
160: function _transferTokens(
        CanonicalNFT memory _ctoken,
        address _to,
        uint256[] memory _tokenIds
    )
        private
        returns (address token_)
    {
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L160)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

/// @audit Missed @param `_srcToken, _srcChainId, _symbol, _name`
11: function validateInputs(
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        internal
        view
    {
/// @audit Missed @param `_name, _srcChainId`
28: function buildName(
        string memory _name,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
    {
/// @audit Missed @param `_symbol`
39: function buildSymbol(string memory _symbol) internal pure returns (string memory) {
/// @audit Missed @param `_srcToken, _srcChainId`
43: function buildURI(
        address _srcToken,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
    {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L11) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L28) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L39) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L43)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

/// @audit Missed @param `x`
13: function exp(int256 x) internal pure returns (int256 r) {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L13)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

/// @audit Missed @param `_owner, _addressManager`
18: function init(address _owner, address _addressManager) external initializer {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit Missed @param `_owner, _addressManager`
83: function init(address _owner, address _addressManager) external initializer {
/// @audit Missed @param `_instances, instantValid`
195: function _addInstances(
        address[] memory _instances,
        bool instantValid
    )
        private
        returns (uint256[] memory ids)
    {
/// @audit Missed @param `id, oldInstance, newInstance`
226: function _replaceInstance(uint256 id, address oldInstance, address newInstance) private {
/// @audit Missed @param `id, instance`
233: function _isInstanceValid(uint256 id, address instance) private view returns (bool) {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83) | [195](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L195) | [226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L226) | [233](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L233)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

/// @audit Missed @param `_claimStart, _claimEnd, _merkleRoot`
56: function __MerkleClaimable_init(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        internal
        onlyInitializing
    {
/// @audit Missed @param `data, proof`
67: function _verifyClaim(bytes memory data, bytes32[] calldata proof) internal ongoingClaim {
/// @audit Missed @param `_proof, _merkleRoot, _value`
77: function _verifyMerkleProof(
        bytes32[] calldata _proof,
        bytes32 _merkleRoot,
        bytes32 _value
    )
        internal
        pure
        virtual
        returns (bool)
    {
/// @audit Missed @param `_claimStart, _claimEnd, _merkleRoot`
90: function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L56) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L67) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L77) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L90)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit Missed @param `_recipient`
176: function getMyGrantSummary(address _recipient)
        public
        view
        returns (
            uint128 amountOwned,
            uint128 amountUnlocked,
            uint128 amountWithdrawn,
            uint128 amountToWithdraw,
            uint128 costToWithdraw
        )
    {
/// @audit Missed @param `_recipient, _to`
208: function _withdraw(address _recipient, address _to) private {
/// @audit Missed @param `_grant`
225: function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {
/// @audit Missed @param `_grant`
235: function _getAmountOwned(Grant memory _grant) private view returns (uint128) {
/// @audit Missed @param `_grant`
239: function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {
/// @audit Missed @param `_amount, _start, _cliff, _period`
245: function _calcAmount(
        uint128 _amount,
        uint64 _start,
        uint64 _cliff,
        uint64 _period
    )
        private
        view
        returns (uint128)
    {
/// @audit Missed @param `_grant`
267: function _validateGrant(Grant memory _grant) private pure {
/// @audit Missed @param `_start, _cliff, _period`
273: function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {
```
[176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L176) | [208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L208) | [225](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L225) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L235) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L239) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L245) | [267](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L267) | [273](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L273)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit Missed @param `sigVerifyLibAddr, pemCertLibAddr`
54: constructor(address sigVerifyLibAddr, address pemCertLibAddr) {
/// @audit Missed @param `_mrSigner, _trusted`
65: function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
/// @audit Missed @param `_mrEnclave, _trusted`
69: function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
/// @audit Missed @param `index, serialNumBatch`
73: function addRevokedCertSerialNum(
        uint256 index,
        bytes[] calldata serialNumBatch
    )
        external
        onlyOwner
    {
/// @audit Missed @param `index, serialNumBatch`
88: function removeRevokedCertSerialNum(
        uint256 index,
        bytes[] calldata serialNumBatch
    )
        external
        onlyOwner
    {
/// @audit Missed @param `fmspc, tcbInfoInput`
103: function configureTcbInfoJson(
        string calldata fmspc,
        TCBInfoStruct.TCBInfo calldata tcbInfoInput
    )
        public
        onlyOwner
    {
/// @audit Missed @param `qeIdentityInput`
114: function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)
        external
        onlyOwner
    {
/// @audit Missed @param `status`
126: function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)
        internal
        pure
        virtual
        returns (bool valid)
    {
/// @audit Missed @param `data`
138: function verifyAttestation(bytes calldata data) external view override returns (bool) {
/// @audit Missed @param `quote`
162: function _verify(bytes calldata quote) private view returns (bool, bytes memory) {
/// @audit Missed @param `quoteEnclaveReport`
175: function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)
        private
        view
        returns (bool, EnclaveIdStruct.EnclaveIdStatus status)
    {
/// @audit Missed @param `pck, tcb`
206: function _checkTcbLevels(
        IPEMCertChainLib.PCKCertificateField memory pck,
        TCBInfoStruct.TCBInfo memory tcb
    )
        private
        pure
        returns (bool, TCBInfoStruct.TCBStatus status)
    {
/// @audit Missed @param `pckCpuSvns, tcbCpuSvns`
229: function _isCpuSvnHigherOrGreater(
        uint256[] memory pckCpuSvns,
        uint8[] memory tcbCpuSvns
    )
        private
        pure
        returns (bool)
    {
/// @audit Missed @param `certs`
248: function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
        private
        view
        returns (bool)
    {
/// @audit Missed @param `pckCertPubKey, signedQuoteData, authDataV3, qeEnclaveReport`
303: function _enclaveReportSigVerification(
        bytes memory pckCertPubKey,
        bytes memory signedQuoteData,
        V3Struct.ECDSAQuoteV3AuthData memory authDataV3,
        V3Struct.EnclaveReport memory qeEnclaveReport
    )
        private
        view
        returns (bool)
    {
/// @audit Missed @param `v3quote`
355: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        view
        override
        returns (bool, bytes memory)
    {
/// @audit Missed @param `v3quote`
364: function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
        internal
        view
        returns (bool, bytes memory)
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L162) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229) | [248](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248) | [303](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355) | [364](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit Missed @param `pemChain, size`
40: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs)
    {
/// @audit Missed @param `der, isPckCert`
74: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
/// @audit Missed @param `pemData`
216: function _removeHeadersAndFooters(string memory pemData)
        private
        pure
        returns (bool success, bytes memory extracted, uint256 endIndex)
    {
/// @audit Missed @param `input, expectedLength`
252: function _trimBytes(
        bytes memory input,
        uint256 expectedLength
    )
        private
        pure
        returns (bytes memory output)
    {
/// @audit Missed @param `der, tbsPtr, tbsParentPtr`
269: function _findPckTcbInfo(
        bytes memory der,
        uint256 tbsPtr,
        uint256 tbsParentPtr
    )
        private
        pure
        returns (
            bool success,
            uint256 pcesvn,
            uint256[] memory cpusvns,
            bytes memory fmspcBytes,
            bytes memory pceidBytes
        )
    {
/// @audit Missed @param `der, oidPtr`
341: function _findTcb(
        bytes memory der,
        uint256 oidPtr
    )
        private
        pure
        returns (bool success, uint256 pcesvn, uint256[] memory cpusvns)
    {
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L40) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L74) | [216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L216) | [252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L252) | [269](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L269) | [341](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L341)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

/// @audit Missed @param `quote, pemCertLibAddr`
21: function parseInput(
        bytes memory quote,
        address pemCertLibAddr
    )
        internal
        pure
        returns (bool success, V3Struct.ParsedV3QuoteStruct memory v3ParsedQuote)
    {
/// @audit Missed @param `v3Quote`
62: function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
        internal
        pure
        returns (
            bool success,
            V3Struct.Header memory header,
            V3Struct.EnclaveReport memory localEnclaveReport,
            bytes memory signedQuoteData, // concatenation of header and local enclave report bytes
            V3Struct.ECDSAQuoteV3AuthData memory authDataV3
        )
    {
/// @audit Missed @param `rawEnclaveReport`
133: function parseEnclaveReport(bytes memory rawEnclaveReport)
        internal
        pure
        returns (V3Struct.EnclaveReport memory enclaveReport)
    {
/// @audit Missed @param `encoded`
152: function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {
/// @audit Missed @param `rawHeader`
165: function parseAndVerifyHeader(bytes memory rawHeader)
        private
        pure
        returns (bool success, V3Struct.Header memory header)
    {
/// @audit Missed @param `rawAuthData, pemCertLibAddr`
203: function parseAuthDataAndVerifyCertType(
        bytes memory rawAuthData,
        address pemCertLibAddr
    )
        private
        pure
        returns (bool success, V3Struct.ECDSAQuoteV3AuthData memory authDataV3)
    {
/// @audit Missed @param `certBytes, pemCertLibAddr`
267: function parseCerificationChainBytes(
        bytes memory certBytes,
        address pemCertLibAddr
    )
        internal
        pure
        returns (bytes[3] memory certChainData)
    {
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203) | [267](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

/// @audit Missed @param `self`
14: function ixs(uint256 self) internal pure returns (uint256) {
/// @audit Missed @param `self`
19: function ixf(uint256 self) internal pure returns (uint256) {
/// @audit Missed @param `self`
24: function ixl(uint256 self) internal pure returns (uint256) {
/// @audit Missed @param `_ixs, _ixf, _ixl`
29: function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {
/// @audit Missed @param `ptr`
56: function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {
/// @audit Missed @param `ptr`
66: function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {
/// @audit Missed @param `der, ptr`
165: function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
/// @audit Missed @param `der, ptr`
169: function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
/// @audit Missed @param `der, ix`
187: function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L14) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L19) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L24) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L29) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L56) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L66) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L165) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L169) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L187)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit Missed @param `dest, src, len`
272: function memcpy(uint256 dest, uint256 src, uint256 len) private pure {
/// @audit Missed @param `a, b`
371: function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {
```
[272](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L272) | [371](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L371)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

/// @audit Missed @param `data`
11: function sha1(bytes memory data) internal pure returns (bytes20 ret) {
/// @audit Missed @param `ptr, off, count`
27: function readword(ptr, off, count) -> result {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L11) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L27)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit Missed @param `es256Verifier`
20: constructor(address es256Verifier) {
/// @audit Missed @param `tbs, signature, publicKey, alg`
24: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
    {
/// @audit Missed @param `tbs, signature, publicKey, alg`
54: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
    {
/// @audit Missed @param `tbs, signature, publicKey`
79: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
/// @audit Missed @param `tbs, signature, publicKey`
96: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
/// @audit Missed @param `tbs, signature, publicKey`
113: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L20) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L24) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L54) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L79) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L96) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L113)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

/// @audit Missed @param `x509Time`
8: function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {
/// @audit Missed @param `year, month, day, hour, minute, second`
34: function toUnixTimestamp(
        uint16 year,
        uint8 month,
        uint8 day,
        uint8 hour,
        uint8 minute,
        uint8 second
    )
        internal
        pure
        returns (uint256)
    {
/// @audit Missed @param `year`
71: function isLeapYear(uint16 year) internal pure returns (bool) {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L8) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L34) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L71)
</details>

### [N-38] Consider Using OpenZeppelin's ReentrancyGuard Instead of Custom Implementation

OpenZeppelin's ReentrancyGuard and ReentrancyGuardUpgradeable contracts have been thoroughly tested and gas-optimized. Consider using them instead of writing your own reentrancy guard logic.

Using a proven and optimized library not only ensures security but can also save gas, contributing to overall efficiency and safety.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

45: modifier nonReentrant() {
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L45)
</details>

### [N-39] High cyclomatic complexity

Functions with high cyclomatic complexity are harder to understand, test, and maintain.
Consider breaking down these blocks into more manageable units, by splitting things into utility functions,
by reducing nesting, and by using early returns.

[Learn More About Cyclomatic Complexity](https://en.wikipedia.org/wiki/Cyclomatic_complexity)

<details>
<summary><i>22 issue instances in 16 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

/// @audit function `evaluatePoint` has a cyclomatic complexity of 6
30: function evaluatePoint(
        bytes32 _blobHash,
        uint256 _x,
        uint256 _y,
        bytes1[48] memory _commitment,
        bytes1[48] memory _pointProof
    )
        internal
        view
    {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L30)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit function `onBlockProposed` has a cyclomatic complexity of 6
62: function onBlockProposed(
        TaikoData.Block memory _blk,
        TaikoData.BlockMetadata memory _meta,
        bytes memory _data
    )
        external
        payable
        nonReentrant
        onlyFromNamed("taiko")
    {
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L62)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

/// @audit function `proposeBlock` has a cyclomatic complexity of 22
68: function proposeBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        bytes calldata _data,
        bytes calldata _txList
    )
        internal
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L68)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit function `proveBlock` has a cyclomatic complexity of 14
91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
    {
/// @audit function `_overrideWithHigherProof` has a cyclomatic complexity of 8
350: function _overrideWithHigherProof(
        TaikoData.TransitionState storage _ts,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof,
        ITierProvider.Tier memory _tier,
        IERC20 _tko,
        bool _sameTransition
    )
        private
    {
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L350)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit function `verifyBlocks` has a cyclomatic complexity of 12
85: function verifyBlocks(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _maxBlocksToVerify
    )
        internal
    {
```
[85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L85)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit function `setGuardians` has a cyclomatic complexity of 6
53: function setGuardians(
        address[] memory _newGuardians,
        uint8 _minGuardians
    )
        external
        onlyOwner
        nonReentrant
    {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L53)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit function `proveSignalReceived` has a cyclomatic complexity of 7
83: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        public
        virtual
        validSender(_app)
        nonZeroValue(_signal)
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L83)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit function `recallMessage` has a cyclomatic complexity of 9
155: function recallMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.srcChainId)
    {
/// @audit function `processMessage` has a cyclomatic complexity of 15
217: function processMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.destChainId)
    {
```
[155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L155) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L217)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

/// @audit function `_decodeLength` has a cyclomatic complexity of 11
144: function _decodeLength(RLPItem memory _in)
        private
        pure
        returns (uint256 offset_, uint256 length_, RLPItemType type_)
    {
```
[144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L144)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

/// @audit function `get` has a cyclomatic complexity of 12
68: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit function `_calcAmount` has a cyclomatic complexity of 6
244: function _calcAmount(
        uint128 _amount,
        uint64 _start,
        uint64 _cliff,
        uint64 _period
    )
        private
        view
        returns (uint128)
    {
```
[244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L244)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit function `_verifyCertChain` has a cyclomatic complexity of 9
247: function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
        private
        view
        returns (bool)
    {
/// @audit function `_verifyParsedQuote` has a cyclomatic complexity of 12
363: function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
        internal
        view
        returns (bool, bytes memory)
    {
```
[247](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L247) | [363](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L363)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit function `decodeCert` has a cyclomatic complexity of 8
73: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
/// @audit function `_findPckTcbInfo` has a cyclomatic complexity of 12
268: function _findPckTcbInfo(
        bytes memory der,
        uint256 tbsPtr,
        uint256 tbsParentPtr
    )
        private
        pure
        returns (
            bool success,
            uint256 pcesvn,
            uint256[] memory cpusvns,
            bytes memory fmspcBytes,
            bytes memory pceidBytes
        )
    {
```
[73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L73) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L268)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit function `compare` has a cyclomatic complexity of 8
56: function compare(
        bytes memory self,
        uint256 offset,
        uint256 len,
        bytes memory other,
        uint256 otheroffset,
        uint256 otherlen
    )
        internal
        pure
        returns (int256)
    {
/// @audit function `base32HexDecodeWord` has a cyclomatic complexity of 8
320: function base32HexDecodeWord(
        bytes memory self,
        uint256 off,
        uint256 len
    )
        internal
        pure
        returns (bytes32)
    {
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L56) | [320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L320)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

/// @audit function `pkcs1Sha256` has a cyclomatic complexity of 17
43: function pkcs1Sha256(
        bytes32 _sha256,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
/// @audit function `pkcs1Sha1` has a cyclomatic complexity of 9
212: function pkcs1Sha1(
        bytes20 _sha1,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L43) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L212)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit function `verifyAttStmtSignature` has a cyclomatic complexity of 7
23: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
    {
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L23)
</details>

### [N-40] Contract should expose an `interface`

Exposing an interface in a smart contract allows for easier integration by other projects and developers.
Without an interface, there's a risk that other projects will have to develop non-standard variants to interact with your contract.
It's highly recommended to define an interface for clearer and more robust collaboration.

<details>
<summary><i>59 issue instances in 14 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

31: function init(
        address _owner,
        IVotesUpgradeable _token,
        TimelockControllerUpgradeable _timelock
    )
        external
        initializer
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L31)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

15: function init(address _owner, uint256 _minDelay) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L15)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

25: function init(address _owner, address _addressManager) external initializer {
35: function approve(
        TaikoData.BlockMetadata calldata _meta,
        TaikoData.Transition calldata _tran,
        TaikoData.TierProof calldata _proof
    )
        external
        whenNotPaused
        nonReentrant
        returns (bool approved_)
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L35)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
    {
47: function burn(address _from, uint256 _amount) public onlyOwner {
52: function snapshot() public onlyFromOwnerOrNamed("snapshooter") {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L47) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L52)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
107: function anchor(
        bytes32 _l1BlockHash,
        bytes32 _l1StateRoot,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        external
        nonReentrant
    {
163: function withdraw(
        address _token,
        address _to
    )
        external
        onlyFromOwnerOrNamed("withdrawer")
        nonReentrant
        whenNotPaused
    {
185: function getBasefee(
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        public
        view
        returns (uint256 basefee_)
    {
200: function getBlockHash(uint64 _blockId) public view returns (bytes32) {
208: function getConfig() public view virtual returns (Config memory config_) {
219: function skipFeeCheck() public pure virtual returns (bool) {
222: function _calcPublicInputHash(uint256 _blockId)
        private
        view
        returns (bytes32 publicInputHashOld, bytes32 publicInputHashNew)
    {
251: function _calc1559BaseFee(
        Config memory _config,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        private
        view
        returns (uint256 basefee_, uint64 gasExcess_)
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L107) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L163) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L185) | [200](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L200) | [208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L208) | [219](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L219) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L222) | [251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L251)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

25: function setConfigAndExcess(
        Config memory _newConfig,
        uint64 _newGasExcess
    )
        external
        virtual
        onlyOwner
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L25)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
54: function mint(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
69: function burn(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
100: function source() public view returns (address, uint256) {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L54) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L69) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L100)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

39: function sendToken(BridgeTransferOp memory _op)
        external
        payable
        nonReentrant
        whenNotPaused
        withValidOperation(_op)
        returns (IBridge.Message memory message_)
    {
93: function onMessageInvocation(bytes calldata data) external payable nonReentrant whenNotPaused {
160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
214: function _transferTokens(
        CanonicalNFT memory ctoken,
        address to,
        uint256[] memory tokenIds,
        uint256[] memory amounts
    )
        private
        returns (address token)
    {
240: function _handleMessage(
        address _user,
        BridgeTransferOp memory _op
    )
        private
        returns (bytes memory msgData_, CanonicalNFT memory ctoken_)
    {
288: function _getOrDeployBridgedToken(CanonicalNFT memory _ctoken)
        private
        returns (address btoken_)
    {
303: function _deployBridgedToken(CanonicalNFT memory _ctoken) private returns (address btoken_) {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L39) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L93) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175) | [214](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L214) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L240) | [288](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L288) | [303](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L303)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

148: function changeBridgedToken(
        CanonicalERC20 calldata _ctoken,
        address _btokenNew
    )
        external
        nonReentrant
        whenNotPaused
        onlyOwner
        returns (address btokenOld_)
    {
207: function sendToken(BridgeTransferOp calldata _op)
        external
        payable
        nonReentrant
        whenNotPaused
        returns (IBridge.Message memory message_)
    {
253: function onMessageInvocation(bytes calldata _data)
        external
        payable
        nonReentrant
        whenNotPaused
    {
319: function _transferTokens(
        CanonicalERC20 memory _ctoken,
        address _to,
        uint256 _amount
    )
        private
        returns (address token_)
    {
348: function _handleMessage(
        address _user,
        address _token,
        address _to,
        uint256 _amount
    )
        private
        returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)
    {
391: function _getOrDeployBridgedToken(CanonicalERC20 memory ctoken)
        private
        returns (address btoken)
    {
407: function _deployBridgedToken(CanonicalERC20 memory ctoken) private returns (address btoken) {
```
[148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L148) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L207) | [253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L253) | [319](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L319) | [348](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L348) | [391](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L391) | [407](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L407)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
50: function claimAndDelegate(
        address user,
        uint256 amount,
        bytes32[] calldata proof,
        bytes calldata delegationData
    )
        external
        nonReentrant
    {
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L50)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
    {
78: function claim(address user, uint256 amount, bytes32[] calldata proof) external nonReentrant {
88: function withdraw(address user) external ongoingWithdrawals {
104: function getBalance(address user)
        public
        view
        returns (uint256 balance, uint256 withdrawableAmount)
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L78) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L88) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L104)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
47: function claim(
        address user,
        uint256[] calldata tokenIds,
        bytes32[] calldata proof
    )
        external
        nonReentrant
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L47)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

111: function init(
        address _owner,
        address _taikoToken,
        address _costToken,
        address _sharedVault
    )
        external
        initializer
    {
135: function grant(address _recipient, Grant memory _grant) external onlyOwner {
150: function void(address _recipient) external onlyOwner {
161: function withdraw() external {
168: function withdraw(address _to, bytes memory _sig) external {
176: function getMyGrantSummary(address _recipient)
        public
        view
        returns (
            uint128 amountOwned,
            uint128 amountUnlocked,
            uint128 amountWithdrawn,
            uint128 amountToWithdraw,
            uint128 costToWithdraw
        )
    {
204: function getMyGrant(address _recipient) public view returns (Grant memory) {
207: function _withdraw(address _recipient, address _to) private {
224: function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {
234: function _getAmountOwned(Grant memory _grant) private view returns (uint128) {
238: function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {
244: function _calcAmount(
        uint128 _amount,
        uint64 _start,
        uint64 _cliff,
        uint64 _period
    )
        private
        view
        returns (uint128)
    {
266: function _validateGrant(Grant memory _grant) private pure {
272: function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L111) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L135) | [150](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L150) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L161) | [168](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L168) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L176) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L204) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L207) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L224) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L234) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L238) | [244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L244) | [266](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L266) | [272](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L272)
</details>

### [N-41] NatSpec: Function declarations should have descriptions

The Ethereum Natural Specification Format (NatSpec) is an integral part of the Solidity language, serving as a rich, machine-readable, language-agnostic metadata tool.

Documenting all functions, irrespective of their visibility, significantly enhances code readability and auditability.
This is especially vital in complex projects, where clear comprehension of functions, their arguments, and returns is paramount.

Specifically, the `@notice` tag should be used for explanations that anyone should understand, making it a key element in providing a clear understanding of a function's intention.
[More information in Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>50 issue instances in 22 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

64: constructor() {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L64)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
    {
99: function state(uint256 _proposalId)
        public
        view
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (ProposalState)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L99)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

57: function init(address _owner, address _addressManager) external initializer {
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

25: function init(address _owner, address _addressManager) external initializer {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
    {
137: function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L137)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
223: function _calcPublicInputHash(uint256 _blockId)
        private
        view
        returns (bytes32 publicInputHashOld, bytes32 publicInputHashNew)
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L223)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

48: function init(address _owner, address _addressManager) external initializer {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

75: function init(address _owner, address _addressManager) external initializer {
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

32: function init(address _owner, address _addressManager) external initializer {
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
192: function supportsInterface(bytes4 interfaceId)
        public
        view
        virtual
        override(BaseVault, ERC1155ReceiverUpgradeable)
        returns (bool)
    {
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L192)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

18: function init(address _owner, address _addressManager) external initializer {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

83: function init(address _owner, address _addressManager) external initializer {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

54: constructor(address sigVerifyLibAddr, address pemCertLibAddr) {
65: function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
69: function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
73: function addRevokedCertSerialNum(
        uint256 index,
        bytes[] calldata serialNumBatch
    )
        external
        onlyOwner
    {
88: function removeRevokedCertSerialNum(
        uint256 index,
        bytes[] calldata serialNumBatch
    )
        external
        onlyOwner
    {
103: function configureTcbInfoJson(
        string calldata fmspc,
        TCBInfoStruct.TCBInfo calldata tcbInfoInput
    )
        public
        onlyOwner
    {
114: function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)
        external
        onlyOwner
    {
122: function toggleLocalReportCheck() external onlyOwner {
138: function verifyAttestation(bytes calldata data) external view override returns (bool) {
355: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        view
        override
        returns (bool, bytes memory)
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

9: function verifyAttestation(bytes calldata data) external returns (bool);
10: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        returns (bool success, bytes memory retData);
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L10)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

38: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        external
        view
        returns (bool);
48: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        external
        view
        returns (bool);
58: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
67: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
76: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L48) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L58) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L67) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L76)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

36: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs);
44: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert);
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L36) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L44)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

40: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs)
    {
74: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L40) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L74)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

20: constructor(address es256Verifier) {
24: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
    {
54: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
    {
79: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
96: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
113: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L20) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L24) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L54) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L79) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L96) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L113)
</details>

### [N-42] Contract uses both `require()`/`revert()` as well as custom errors

The contract uses both `require()/revert()` and `custom errors` for error handling.

It's recommended to use a consistent approach for error handling in a single file.

<details>
<summary><i>23 issue instances in 23 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

14: contract AssignmentHook is EssentialContract, IHook {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L14)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

10: contract GuardianProver is Guardians {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L10)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L22)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

10: contract DevnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

10: contract MainnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

10: contract TestnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

21: contract TaikoL2 is CrossChainOwned {
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L21)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

9: contract TaikoL2EIP1559Configurable is TaikoL2 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L9)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

14: contract SignalService is EssentialContract, ISignalService {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L14)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

16: contract Bridge is EssentialContract, IBridge {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

18: contract ERC20Vault is BaseVault {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L18)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L16)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

10: contract GuardianVerifier is EssentialContract, IVerifier {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L10)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

19: contract SgxVerifier is EssentialContract, IVerifier {
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L19)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

12: contract ERC20Airdrop2 is MerkleClaimable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L12)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

25: contract TimelockTokenPool is EssentialContract {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L25)
</details>

### [N-43] Modifiers Missing NatSpec `@param` Tag

Function modifiers should include NatSpec comments with `@param` tags describing each input parameter.
This promotes better code readability and documentation.

<details>
<summary><i>4 issue instances in 3 files:</i></summary>

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit Missed @param `_app`
35: modifier validSender(address _app) {
/// @audit Missed @param `_input`
40: modifier nonZeroValue(bytes32 _input) {
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L35) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L40)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit Missed @param `_chainId`
64: modifier sameChain(uint64 _chainId) {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L64)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

/// @audit Missed @param `_op`
140: modifier withValidOperation(BridgeTransferOp memory _op) {
```
[140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L140)
</details>

### [N-44] Solidity Version Too Recent to be Trusted

The current Solidity version used in the code is too recent to be trusted.
Using a newer version might introduce unrecovered bugs. It is recommended to use version 0.8.21.

<details>
<summary><i>81 issue instances in 81 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/IAddressManager.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L2)

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L2)

```solidity
File: packages/protocol/contracts/common/IAddressResolver.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L2)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L2)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L2)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L2)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L2)

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L2)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

7: pragma solidity 0.8.24;
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L7)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L2)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L2)

```solidity
File: packages/protocol/contracts/L1/hooks/IHook.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L2)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L2)

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L2)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L2)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L2)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L2)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L2)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L2)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L2)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L2)

```solidity
File: packages/protocol/contracts/L1/TaikoData.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L2)

```solidity
File: packages/protocol/contracts/L1/TaikoErrors.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L2)

```solidity
File: packages/protocol/contracts/L1/TaikoEvents.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L2)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L2)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L2)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L2)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L2)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L2)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L2)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L2)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L2)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L2)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L2)

```solidity
File: packages/protocol/contracts/signal/ISignalService.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L2)

```solidity
File: packages/protocol/contracts/signal/LibSignals.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L2)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L2)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L2)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/IBridgedERC20.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L2)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L2)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

3: pragma solidity 0.8.24;
```
[3](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L3)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L2)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L2)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L2)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L2)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L2)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

4: pragma solidity 0.8.24;
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L4)

```solidity
File: packages/protocol/contracts/verifiers/IVerifier.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L2)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L2)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L2)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L2)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L2)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L2)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L2)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

3: pragma solidity 0.8.24;
```
[3](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L3)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

3: pragma solidity 0.8.24;
```
[3](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L3)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

3: pragma solidity 0.8.24;
```
[3](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L3)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

2: pragma solidity 0.8.24;
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L2)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

3: pragma solidity 0.8.24;
```
[3](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L3)
</details>

### [N-45] Inconsistent spacing in comments

Some lines use // x and some use //x. The instances below point out the usages that don't follow the majority, within each file:

<details>
<summary><i>1700 issue instances in 81 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/IAddressManager.sol

4: /// @title IAddressManager
5: /// @notice Manages a mapping of (chainId, name) pairs to Ethereum addresses.
6: /// @custom:security-contact security@taiko.xyz
8: /// @notice Gets the address mapped to a specific chainId-name pair.
9: /// @dev Note that in production, this method shall be a pure function
10: /// without any storage access.
11: /// @param _chainId The chainId for which the address needs to be fetched.
12: /// @param _name The name for which the address needs to be fetched.
13: /// @return Address associated with the chainId-name pair.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L6) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L13)

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

7: /// @title AddressManager
8: /// @notice See the documentation in {IAddressManager}.
9: /// @custom:security-contact security@taiko.xyz
11: /// @dev Mapping of chainId to mapping of name to address.
16: /// @notice Emitted when an address is set.
17: /// @param chainId The chainId for the address mapping.
18: /// @param name The name for the address mapping.
19: /// @param newAddress The new address.
20: /// @param oldAddress The old address.
28: /// @notice Initializes the contract.
29: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
34: /// @notice Sets the address for a specific chainId-name pair.
35: /// @param _chainId The chainId to which the address will be mapped.
36: /// @param _name The name to which the address will be mapped.
37: /// @param _newAddress The Ethereum address to be mapped.
53: /// @inheritdoc IAddressManager
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L9) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L11) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L20) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L29) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L37) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L53)

```solidity
File: packages/protocol/contracts/common/IAddressResolver.sol

4: /// @title IAddressResolver
5: /// @notice This contract acts as a bridge for name-to-address resolution.
6: /// It delegates the resolution to the AddressManager. By separating the logic,
7: /// we can maintain flexibility in address management without affecting the
8: /// resolving process.
9: /// @dev Note that the address manager should be changed using upgradability, there
10: /// is no setAddressManager() function to guarantee atomicity across all
11: /// contracts that are resolvers.
12: /// @custom:security-contact security@taiko.xyz
14: /// @notice Resolves a name to its address deployed on this chain.
15: /// @param _name Name whose address is to be resolved.
16: /// @param _allowZeroAddress If set to true, does not throw if the resolved
17: /// address is `address(0)`.
18: /// @return Address associated with the given name.
27: /// @notice Resolves a name to its address deployed on a specified chain.
28: /// @param _chainId The chainId of interest.
29: /// @param _name Name whose address is to be resolved.
30: /// @param _allowZeroAddress If set to true, does not throw if the resolved
31: /// address is `address(0)`.
32: /// @return Address associated with the given name on the specified
33: /// chain.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L12) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L18) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L33)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

8: /// @title AddressResolver
9: /// @notice See the documentation in {IAddressResolver}.
10: /// @custom:security-contact security@taiko.xyz
12: /// @notice Address of the AddressManager.
21: /// @dev Modifier that ensures the caller is the resolved address of a given
22: /// name.
23: /// @param _name The name to check against.
29: /// @inheritdoc IAddressResolver
42: /// @inheritdoc IAddressResolver
56: /// @dev Initialization method for setting up AddressManager reference.
57: /// @param _addressManager Address of the AddressManager.
65: /// @dev Helper method to resolve name-to-address.
66: /// @param _chainId The chainId of interest.
67: /// @param _name Name whose address is to be resolved.
68: /// @param _allowZeroAddress If set to true, does not throw if the resolved
69: /// address is `address(0)`.
70: /// @return addr_ Address associated with the given name on the specified
71: /// chain.
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L10) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L12) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L23) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L29) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L42) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L57) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L68) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L69) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L70) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L71)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

8: /// @title EssentialContract
9: /// @custom:security-contact security@taiko.xyz
15: /// @dev The slot in transient storage of the reentry lock. This is the keccak256 hash
16: /// of "ownerUUPS.reentry_slot"
20: /// @dev Slot 1.
27: /// @notice Emitted when the contract is paused.
28: /// @param account The account that paused the contract.
31: /// @notice Emitted when the contract is unpaused.
32: /// @param account The account that unpaused the contract.
39: /// @dev Modifier that ensures the caller is the owner or resolved address of a given name.
40: /// @param _name The name to check against.
63: /// @custom:oz-upgrades-unsafe-allow constructor
68: /// @notice Pauses the contract.
77: /// @notice Unpauses the contract.
86: /// @notice Returns true if the contract is paused, and false otherwise.
87: /// @return True if paused, false otherwise.
92: /// @notice Initializes the contract.
93: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
94: /// @param _addressManager The address of the {AddressManager} contract.
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L9) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L16) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L20) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L28) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L32) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L40) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L63) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L68) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L77) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L86) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L87) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L92) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L93) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L94)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

4: /// @title Lib4844
5: /// @notice A library for handling EIP-4844 blobs
6: /// @dev `solc contracts/libs/Lib4844.sol --ir > contracts/libs/Lib4844.yul`
7: /// @custom:security-contact security@taiko.xyz
9: /// @notice The address of the point evaluation precompile
12: /// @notice The number of field elements per blob
15: /// @notice The modulus of the BLS curve
24: /// @notice Evaluates the 4844 point using the precompile.
25: /// @param _blobHash The versioned hash
26: /// @param _x The evaluation point
27: /// @param _y The expected output
28: /// @param _commitment The input kzg point
29: /// @param _pointProof The quotient kzg
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L7) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L9) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L12) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L15) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L29)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

10: /// @title LibAddress
11: /// @dev Provides utilities for address-related operations.
12: /// @custom:security-contact security@taiko.xyz
18: /// @dev Sends Ether to the specified address.
19: /// @param _to The recipient address.
20: /// @param _amount The amount of Ether to send in wei.
21: /// @param _gasLimit The max amount gas to pay for this transaction.
39: /// @dev Sends Ether to the specified address.
40: /// @param _to The recipient address.
41: /// @param _amount The amount of Ether to send in wei.
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L12) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L21) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L41)

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

4: /// @title LibMath
5: /// @dev This library offers additional math functions for uint256.
6: /// @custom:security-contact security@taiko.xyz
8: /// @dev Returns the smaller of the two given values.
9: /// @param _a The first number to compare.
10: /// @param _b The second number to compare.
11: /// @return The smaller of the two numbers.
16: /// @dev Returns the larger of the two given values.
17: /// @param _a The first number to compare.
18: /// @param _b The second number to compare.
19: /// @return The larger of the two numbers.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L6) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L11) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L19)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

2: //  _____     _ _         _         _
4: //   | |/ _` | | / / _ \ | |__/ _` | '_ (_-<
5: //   |_|\__,_|_|_\_\___/ |____\__,_|_.__/__/
13: /// @title LibTrieProof
14: /// @custom:security-contact security@taiko.xyz
23: /// @notice Verifies that the value of a slot in the storage of an account is value.
24: ///
25: /// @param _rootHash The merkle root of state tree or the account tree. If accountProof's length
26: /// is zero, it is used as the account's storage root, otherwise it will be used as the state
27: /// root.
28: /// @param _addr The address of contract.
29: /// @param _slot The slot in the contract.
30: /// @param _value The value to be verified.
31: /// @param _accountProof The account proof
32: /// @param _storageProof The storage proof
33: /// @return storageRoot_ The account's storage root
```
[2](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L2) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L5) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L14) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L33)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

14: /// @title TaikoGovernor
15: /// @custom:security-contact security@taiko.xyz
27: /// @notice Initializes the contract.
28: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
29: /// @param _token The Taiko token.
30: /// @param _timelock The timelock contract address.
47: /// @dev See {IGovernor-propose}
61: /// @notice An overwrite of GovernorCompatibilityBravoUpgradeable's propose() as that one does
62: /// not check that the length of signatures equal the calldata.
63: /// @dev See vulnerability description here:
64: /// https://github.com/taikoxyz/taiko-mono/security/dependabot/114
65: /// See fix in OZ 4.8.3 here (URL broken down for readability):
66: /// https://github.com/OpenZeppelin/openzeppelin-contracts/blob/
67: /// 0a25c1940ca220686588c4af3ec526f725fe2582/contracts/governance/compatibility/GovernorCompatibilityBravo.sol#L72
68: /// See {GovernorCompatibilityBravoUpgradeable-propose}
88: /// @dev See {GovernorUpgradeable-supportsInterface}
98: /// @dev See {GovernorUpgradeable-state}
108: /// @notice How long after a proposal is created should voting power be fixed. A
109: /// large voting delay gives users time to unstake tokens if necessary.
110: /// @return The duration of the voting delay.
115: /// @notice How long does a proposal remain open to votes.
116: /// @return The duration of the voting period.
121: /// @notice The number of votes required in order for a voter to become a proposer.
122: /// @return The number of votes required.
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L15) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L30) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L47) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L68) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L88) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L98) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L108) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L109) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L110) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L115) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L116) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L121) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L122)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

7: /// @title TaikoTimelockController
8: /// @custom:security-contact security@taiko.xyz
12: /// @notice Initializes the contract.
13: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
14: /// @param _minDelay The minimal delay.
21: /// @dev Gets the minimum delay for an operation to become valid, allows the admin to get around
22: /// of the min delay.
23: /// @return The minimum delay.
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L8) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L14) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L23)

```solidity
File: packages/protocol/contracts/L1/hooks/IHook.sol

6: /// @title IHook
7: /// @custom:security-contact security@taiko.xyz
9: /// @notice Called when a block is proposed.
10: /// @param _blk The proposed block.
11: /// @param _meta The metadata of the proposed block.
12: /// @param _data The data of the proposed block.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L7) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L12)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

11: /// @title AssignmentHook
12: /// @notice A hook that handles prover assignment verification and fee processing.
13: /// @custom:security-contact security@taiko.xyz
34: /// @notice Max gas paying the prover.
35: /// @dev This should be large enough to prevent the worst cases for the prover.
36: /// To assure a trustless relationship between the proposer and the prover it's
37: /// the prover's job to make sure it can get paid within this limit.
42: /// @notice Emitted when a block is assigned to a prover.
43: /// @param assignedProver The address of the assigned prover.
44: /// @param meta The metadata of the assigned block.
45: /// @param assignment The prover assignment.
54: /// @notice Initializes the contract.
55: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
56: /// @param _addressManager The address of the {AddressManager} contract.
61: /// @inheritdoc IHook
132: /// @notice Hashes the prover assignment.
133: /// @param _assignment The prover assignment.
134: /// @param _taikoL1Address The address of the TaikoL1 contract.
135: /// @param _blobHash The blob hash.
136: /// @return The hash of the prover assignment.
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L13) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L37) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L42) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L45) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L56) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L61) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L133) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L134) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L136)

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

6: /// @title ITaikoL1
7: /// @custom:security-contact security@taiko.xyz
9: /// @notice Proposes a Taiko L2 block.
10: /// @param _params Block parameters, currently an encoded BlockParams object.
11: /// @param _txList txList data if calldata is used for DA.
12: /// @return meta_ The metadata of the proposed L2 block.
13: /// @return deposits_ The Ether deposits processed.
22: /// @notice Proves or contests a block transition.
23: /// @param _blockId The index of the block to prove. This is also used to
24: /// select the right implementation version.
25: /// @param _input An abi-encoded (TaikoData.BlockMetadata, TaikoData.Transition,
26: /// TaikoData.TierProof) tuple.
29: /// @notice Verifies up to a certain number of blocks.
30: /// @param _maxBlocksToVerify Max number of blocks to verify.
33: /// @notice Gets the configuration of the TaikoL1 contract.
34: /// @return Config struct containing configuration parameters.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L7) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L13) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L26) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L30) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L34)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

9: /// @title LibDepositing
10: /// @notice A library for handling Ether deposits in the Taiko protocol.
11: /// @custom:security-contact security@taiko.xyz
17: /// @notice Emitted when Ether is deposited.
18: /// @dev Any events defined here must also be defined in TaikoEvents.sol.
21: /// @dev Any errors defined here must also be defined in TaikoErrors.sol.
24: /// @dev Deposits Ether to Layer 2.
25: /// @param _state Current TaikoData.State.
26: /// @param _config Actual TaikoData.Config.
27: /// @param _resolver Address resolver interface.
28: /// @param _recipient The recipient address.
66: /// @dev Processes the ETH deposits in a batched manner.
121: /// @dev Checks if Ether deposit is allowed for Layer 2.
145: /// @dev Encodes the given deposit into a uint256.
146: /// @param _addr The address of the deposit recipient.
147: /// @param _amount The amount of the deposit.
148: /// @return The encoded deposit.
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L11) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L21) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L28) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L66) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L121) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L145) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L148)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

12: /// @title LibProposing
13: /// @notice A library for handling block proposals in the Taiko protocol.
14: /// @custom:security-contact security@taiko.xyz
18: /// @notice The maximum number of bytes allowed per blob.
19: /// @dev According to EIP4844, each blob has up to 4096 field elements, and each
20: /// field element has 32 bytes.
24: /// @notice Emitted when a block is proposed.
25: /// @param blockId The ID of the proposed block.
26: /// @param assignedProver The address of the assigned prover.
27: /// @param livenessBond The liveness bond of the proposed block.
28: /// @param meta The metadata of the proposed block.
29: /// @param depositsProcessed The EthDeposit array about processed deposits in this proposed
30: /// block.
39: /// @notice Emitted when a blob is cached.
40: /// @param blobHash The hash of the cached blob.
59: /// @dev Proposes a Taiko L2 block.
60: /// @param _state Current TaikoData.State.
61: /// @param _config Actual TaikoData.Config.
62: /// @param _resolver Address resolver interface.
63: /// @param _data Encoded data bytes containing the block params.
64: /// @param _txList Transaction list bytes (if not blob).
65: /// @return meta_ The constructed block's metadata.
66: /// @return deposits_ The EthDeposit array about processed deposits in this proposed
67: /// block.
282: /// @notice Checks if a blob is reusable.
283: /// @param _state Current TaikoData.State.
284: /// @param _config The TaikoData.Config.
285: /// @param _blobHash The blob hash
286: /// @return true if the blob is reusable, false otherwise.
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L14) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L20) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L30) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L40) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L67) | [282](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L282) | [283](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L283) | [284](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L284) | [285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L285) | [286](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L286)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

12: /// @title LibProving
13: /// @notice A library for handling block contestation and proving in the Taiko
14: /// protocol.
15: /// @custom:security-contact security@taiko.xyz
19: /// @notice Keccak hash of the string "RETURN_LIVENESS_BOND".
22: /// @notice The tier name for optimistic proofs.
26: /// @notice Emitted when a transition is proved.
27: /// @param blockId The block ID.
28: /// @param tran The transition data.
29: /// @param prover The prover's address.
30: /// @param validityBond The validity bond amount.
31: /// @param tier The tier of the proof.
40: /// @notice Emitted when a transition is contested.
41: /// @param blockId The block ID.
42: /// @param tran The transition data.
43: /// @param contester The contester's address.
44: /// @param contestBond The contest bond amount.
45: /// @param tier The tier of the proof.
54: /// @notice Emitted when proving is paused or unpaused.
55: /// @param paused The pause status.
70: /// @notice Pauses or unpauses the proving process.
71: /// @param _state Current TaikoData.State.
72: /// @param _pause The pause status.
83: /// @dev Proves or contests a block transition.
84: /// @param _state Current TaikoData.State.
85: /// @param _config Actual TaikoData.Config.
86: /// @param _resolver Address resolver interface.
87: /// @param _meta The block's metadata.
88: /// @param _tran The transition data.
89: /// @param _proof The proof.
90: /// @param maxBlocksToVerify_ The number of blocks to be verified with this transaction.
268: /// @dev Handle the transition initialization logic
349: /// @dev Handles what happens when there is a higher proof incoming
400: /// @dev Check the msg.sender (the new prover) against the block's assigned prover.
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L15) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L19) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L22) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L31) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L42) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L45) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L55) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L70) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L71) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L72) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L83) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L84) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L85) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L86) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L87) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L88) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L89) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L90) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L268) | [349](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L349) | [400](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L400)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

6: /// @title LibUtils
7: /// @notice A library that offers helper functions.
8: /// @custom:security-contact security@taiko.xyz
16: /// @notice This function will revert if the transition is not found.
17: /// @dev Retrieves the transition with a given parentHash.
18: /// @param _state Current TaikoData.State.
19: /// @param _config Actual TaikoData.Config.
20: /// @param _blockId Id of the block.
21: /// @param _parentHash Parent hash of the block.
22: /// @return The state transition data of the block.
48: /// @dev Retrieves a block based on its ID.
49: /// @param _state Current TaikoData.State.
50: /// @param _config Actual TaikoData.Config.
51: /// @param _blockId Id of the block.
68: /// @dev Retrieves the ID of the transition with a given parentHash.
69: /// This function will return 0 if the transition is not found.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L8) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L22) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L51) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L68) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L69)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

13: /// @title LibVerifying
14: /// @notice A library for handling block verification in the Taiko protocol.
15: /// @custom:security-contact security@taiko.xyz
20: /// @notice Emitted when a block is verified.
21: /// @param blockId The block ID.
22: /// @param assignedProver The assigned prover of the block.
23: /// @param prover The actual prover of the block.
24: /// @param blockHash The block hash.
25: /// @param stateRoot The state root.
26: /// @param tier The tier of the transition used for verification.
27: /// @param contestations The number of contestations.
43: /// @notice Initializes the Taiko protocol state.
44: /// @param _state The state to initialize.
45: /// @param _config The configuration for the Taiko protocol.
46: /// @param _genesisBlockHash The block hash of the genesis block.
84: /// @dev Verifies up to N blocks.
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L15) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L27) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L46) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L84)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

8: /// @title GuardianProver
9: /// @custom:security-contact security@taiko.xyz
13: /// @notice Emitted when a guardian proof is approved.
14: /// @param addr The address of the guardian.
15: /// @param blockId The block ID.
16: /// @param blockHash The block hash.
17: /// @param approved If the proof is approved.
22: /// @notice Initializes the contract.
23: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
24: /// @param _addressManager The address of the {AddressManager} contract.
29: /// @dev Called by guardians to approve a guardian proof
30: /// @param _meta The block's metadata.
31: /// @param _tran The valid transition.
32: /// @param _proof The tier proof.
33: /// @return approved_ If the minimum number of participants sent the same proof, and proving
34: /// transaction is fired away returns true, false otherwise.
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L9) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L17) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L24) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L34)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

6: /// @title Guardians
7: /// @notice A contract that manages a set of guardians and their approvals.
8: /// @custom:security-contact security@taiko.xyz
10: /// @notice The minimum number of guardians
13: /// @notice Contains the index of the guardian in `guardians` plus one (zero means not a
14: /// guardian)
15: /// @dev Slot 1
18: /// @notice Mapping to store the approvals for a given hash, for a given version
21: /// @notice The set of guardians
22: /// @dev Slot 3
25: /// @notice The version of the guardians
26: /// @dev Slot 4
29: /// @notice The minimum number of guardians required to approve
34: /// @notice Emitted when the set of guardians is updated
35: /// @param version The new version
36: /// @param guardians The new set of guardians
39: /// @notice Emitted when an approval is made
40: /// @param operationId The operation ID
41: /// @param approvalBits The new approval bits
42: /// @param proofSubmitted If the proof was submitted
50: /// @notice Set the set of guardians
51: /// @param _newGuardians The new set of guardians
52: /// @param _minGuardians The minimum required to sign
98: /// @notice Returns if the hash is approved
99: /// @param _hash The hash to check
100: /// @return true if the hash is approved
105: /// @notice Returns the number of guardians
106: /// @return The number of guardians
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L10) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L15) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L22) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L26) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L29) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L36) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L42) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L52) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L100) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L105) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L106)

```solidity
File: packages/protocol/contracts/L1/TaikoData.sol

4: /// @title TaikoData
5: /// @notice This library defines various data structures used in the Taiko
6: /// protocol.
7: /// @custom:security-contact security@taiko.xyz
9: /// @dev Struct holding Taiko configuration parameters. See {TaikoConfig}.
62: /// @dev Struct representing prover assignment
90: /// @dev Struct containing data only required for proving a block
91: /// Note: On L2, `block.difficulty` is the pseudo name of
92: /// `block.prevrandao`, which returns a random number provided by the layer
93: /// 1 chain.
97: bytes32 blobHash; //or txListHash (if Blob not yet supported), // slot 3
112: /// @dev Struct representing transition to be proven.
120: /// @dev Struct representing state transition data.
121: /// 10 slots reserved for upgradability, 6 slots used.
135: /// @dev Struct containing data required for verifying a block.
136: /// 10 slots reserved for upgradability, 3 slots used.
148: /// @dev Struct representing an Ethereum deposit.
149: /// 1 slot used.
156: /// @dev Forge is only able to run coverage in case the contracts by default
157: /// capable of compiling without any optimization (neither optimizer runs,
158: /// no compiling --via-ir flag).
159: /// In order to resolve stack too deep without optimizations, we needed to
160: /// introduce outsourcing vars into structs below.
178: /// @dev Struct holding the state variables for the {TaikoL1} contract.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L7) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L9) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L62) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L90) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L91) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L92) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L93) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L97) | [112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L112) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L120) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L121) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L136) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L148) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L149) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L156) | [157](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L157) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L158) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L159) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L160) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L178)

```solidity
File: packages/protocol/contracts/L1/TaikoErrors.sol

4: /// @title TaikoErrors
5: /// @notice This abstract contract provides custom error declarations used in
6: /// the Taiko protocol. Each error corresponds to specific situations where
7: /// exceptions might be thrown.
8: /// @dev The errors defined here must match the definitions in the corresponding
9: /// L1 libraries.
10: /// @custom:security-contact security@taiko.xyz
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L10)

```solidity
File: packages/protocol/contracts/L1/TaikoEvents.sol

6: /// @title TaikoEvents
7: /// @notice This abstract contract provides event declarations for the Taiko
8: /// protocol, which are emitted during block proposal, proof, verification, and
9: /// Ethereum deposit processes.
10: /// @dev The events defined here must match the definitions in the corresponding
11: /// L1 libraries.
12: /// @custom:security-contact security@taiko.xyz
14: /// @dev Emitted when a block is proposed.
15: /// @param blockId The ID of the proposed block.
16: /// @param assignedProver The block's assigned prover.
17: /// @param livenessBond The bond in Taiko token from the assigned prover.
18: /// @param meta The block metadata containing information about the proposed
19: /// block.
20: /// @param depositsProcessed Ether deposits processed.
28: /// @dev Emitted when a block is verified.
29: /// @param blockId The ID of the verified block.
30: /// @param assignedProver The block's assigned prover.
31: /// @param prover The prover whose transition is used for verifying the
32: /// block.
33: /// @param blockHash The hash of the verified block.
34: /// @param stateRoot The block's state root.
35: /// @param tier The tier ID of the proof.
36: /// @param contestations Number of total contestations.
47: /// @dev Emitted when a block transition is proved or re-proved.
48: /// @param blockId The ID of the proven block.
49: /// @param tran The verified transition.
50: /// @param prover The prover address.
51: /// @param validityBond The validity bond amount.
52: /// @param tier The tier ID of the proof.
61: /// @dev Emitted when a block transition is contested.
62: /// @param blockId The ID of the proven block.
63: /// @param tran The verified transition.
64: /// @param contester The contester address.
65: /// @param contestBond The contesting bond amount.
66: /// @param tier The tier ID of the proof.
75: /// @dev Emitted when a blob is cached for reuse.
76: /// @param blobHash The blobHash cached.
79: /// @dev Emitted when proving has been paused
80: /// @param paused True if paused, false if unpaused.
83: /// @dev Emitted when an Ethereum deposit is made.
84: /// @param deposit The Ethereum deposit information including recipient,
85: /// amount, and ID.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L12) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L20) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L36) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L52) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L66) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L75) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L76) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L79) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L80) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L83) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L84) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L85)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

13: /// @title TaikoL1
14: /// @notice This contract serves as the "base layer contract" of the Taiko protocol, providing
15: /// functionalities for proposing, proving, and verifying blocks. The term "base layer contract"
16: /// means that although this is usually deployed on L1, it can also be deployed on L2s to create
17: /// L3 "inception layers". The contract also handles the deposit and withdrawal of Taiko tokens
18: /// and Ether. Additionally, this contract doesn't hold any Ether. Ether deposited to L2 are held
19: /// by the Bridge contract.
20: /// @dev Labeled in AddressResolver as "taiko"
21: /// @custom:security-contact security@taiko.xyz
23: /// @notice The TaikoL1 state.
33: /// @dev Fallback function to receive Ether from Hooks
38: /// @notice Initializes the contract.
39: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
40: /// @param _addressManager The address of the {AddressManager} contract.
41: /// @param _genesisBlockHash The block hash of the genesis block.
54: /// @inheritdoc ITaikoL1
74: /// @inheritdoc ITaikoL1
99: /// @inheritdoc ITaikoL1
109: /// @notice Pause block proving.
110: /// @param _pause True if paused.
116: /// @notice Deposits Ether to Layer 2.
117: /// @param _recipient Address of the recipient for the deposited Ether on
118: /// Layer 2.
123: /// @inheritdoc EssentialContract
129: /// @notice Checks if Ether deposit is allowed for Layer 2.
130: /// @param _amount Amount of Ether to be deposited.
131: /// @return true if Ether deposit is allowed, false otherwise.
136: /// @notice See {LibProposing-isBlobReusable}.
141: /// @notice Gets the details of a block.
142: /// @param _blockId Index of the block.
143: /// @return blk_ The block.
144: /// @return ts_ The transition used to verify this block.
158: /// @notice Gets the state transition for a specific block.
159: /// @param _blockId Index of the block.
160: /// @param _parentHash Parent hash of the block.
161: /// @return The state transition data of the block.
173: /// @notice Gets the state variables of the TaikoL1 contract.
174: /// @return a_ State variables stored at SlotA.
175: /// @return b_ State variables stored at SlotB.
185: /// @inheritdoc ITaikoL1
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L21) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L23) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L33) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L38) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L41) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L54) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L74) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L99) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L109) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L110) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L116) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L117) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L118) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L123) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L129) | [130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L130) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L131) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L136) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L141) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L142) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L143) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L144) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L158) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L159) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L160) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L161) | [173](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L173) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L174) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L175) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L185)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

9: /// @title TaikoToken
10: /// @notice The TaikoToken (TKO), in the protocol is used for prover collateral
11: /// in the form of bonds. It is an ERC20 token with 18 decimal places of
12: /// precision.
13: /// @dev Labeled in AddressResolver as "taiko_token"
14: /// @custom:security-contact security@taiko.xyz
20: /// @notice Initializes the contract.
21: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
22: /// @param _name The name of the token.
23: /// @param _symbol The symbol of the token.
24: /// @param _recipient The address to receive initial token minting.
44: /// @notice Burns tokens from the specified address.
45: /// @param _from The address to burn tokens from.
46: /// @param _amount The amount of tokens to burn.
51: /// @notice Creates a new token snapshot.
56: /// @notice Transfers tokens to a specified address.
57: /// @param _to The address to transfer tokens to.
58: /// @param _amount The amount of tokens to transfer.
59: /// @return A boolean indicating whether the transfer was successful or not.
65: /// @notice Transfers tokens from one address to another.
66: /// @param _from The address to transfer tokens from.
67: /// @param _to The address to transfer tokens to.
68: /// @param _amount The amount of tokens to transfer.
69: /// @return A boolean indicating whether the transfer was successful or not.
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L14) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L24) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L46) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L51) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L58) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L59) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L68) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L69)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

4: /// @title ITierProvider
5: /// @notice Defines interface to return tier configuration.
6: /// @custom:security-contact security@taiko.xyz
19: /// @dev Retrieves the configuration for a specified tier.
20: /// @param tierId ID of the tier.
21: /// @return Tier struct containing the tier's parameters.
24: /// @dev Retrieves the IDs of all supported tiers.
25: /// Note that the core protocol requires the number of tiers to be smaller
26: /// than 256. In reality, this number should be much smaller.
27: /// @return The ids of the tiers.
30: /// @dev Determines the minimal tier for a block based on a random input.
31: /// @param rand (Semi) random number.
32: /// @return The tier id.
36: /// @dev Tier ID cannot be zero!
38: /// @notice Optimistic tier ID.
41: /// @notice SGX tier ID.
44: /// @notice SGX + ZKVM tier ID.
47: /// @notice Guardian tier ID.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L6) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L21) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L27) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L32) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L36) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L38) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L41) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L44) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L47)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

7: /// @title DevnetTierProvider
8: /// @dev Labeled in AddressResolver as "tier_provider"
9: /// @custom:security-contact security@taiko.xyz
13: /// @notice Initializes the contract.
14: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
19: /// @inheritdoc ITierProvider
26: cooldownWindow: 1440, //24 hours
37: cooldownWindow: 60, //1 hours
46: /// @inheritdoc ITierProvider
53: /// @inheritdoc ITierProvider
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L9) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L14) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L19) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L26) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L37) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L46) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L53)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

7: /// @title MainnetTierProvider
8: /// @dev Labeled in AddressResolver as "tier_provider"
9: /// @custom:security-contact security@taiko.xyz
13: /// @notice Initializes the contract.
14: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
19: /// @inheritdoc ITierProvider
26: cooldownWindow: 1440, //24 hours
37: cooldownWindow: 1440, //24 hours
48: cooldownWindow: 60, //1 hours
57: /// @inheritdoc ITierProvider
65: /// @inheritdoc ITierProvider
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L9) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L14) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L19) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L26) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L37) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L48) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L57) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L65)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

7: /// @title TestnetTierProvider
8: /// @dev Labeled in AddressResolver as "tier_provider"
9: /// @custom:security-contact security@taiko.xyz
13: /// @notice Initializes the contract.
14: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
19: /// @inheritdoc ITierProvider
26: cooldownWindow: 1440, //24 hours
37: cooldownWindow: 1440, //24 hours
48: cooldownWindow: 60, //1 hours
57: /// @inheritdoc ITierProvider
65: /// @inheritdoc ITierProvider
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L9) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L14) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L19) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L26) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L37) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L48) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L57) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L65)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

8: /// @title CrossChainOwned
9: /// @notice This contract's owner can be a local address or one that lives on another chain and uses
10: /// signals for transaction approval.
11: /// @dev Notice that when sending the message on the owner chain, the gas limit of the message must
12: /// not be zero, so on this chain, some EOA can help execute this transaction.
13: /// @custom:security-contact security@taiko.xyz
15: /// @notice The owner chain ID.
18: /// @notice The next transaction ID.
23: /// @notice Emitted when a transaction is executed.
24: /// @param txId The transaction ID.
25: /// @param selector The function selector.
33: /// @inheritdoc IMessageInvocable
34: /// @dev Do not guard with nonReentrant as this function will re-enter the contract as _data
35: /// represents calls to address(this).
56: /// @notice Initializes the contract.
57: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
58: /// @param _addressManager The address of the {AddressManager} contract.
59: /// @param _ownerChainId The owner's deployment chain ID.
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L13) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L15) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L18) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L25) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L35) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L58) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L59)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

6: /// @title Lib1559Math
7: /// @notice Implements e^(x) based bonding curve for EIP-1559
8: /// @dev See https://ethresear.ch/t/make-eip-1559-more-like-an-amm-curve/9082
9: /// @custom:security-contact security@taiko.xyz
13: /// @dev eth_qty(excess_gas_issued) / (TARGET * ADJUSTMENT_QUOTIENT)
14: /// @param _gasExcess TBD
15: /// @param _adjustmentFactor The product of gasTarget and adjustmentQuotient
32: /// @dev exp(gas_qty / TARGET / ADJUSTMENT_QUOTIENT)
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L9) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L15) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L32)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

14: /// @title TaikoL2
15: /// @notice Taiko L2 is a smart contract that handles cross-layer message
16: /// verification and manages EIP-1559 gas pricing for Layer 2 (L2) operations.
17: /// It is used to anchor the latest L1 block details to L2 for cross-layer
18: /// communication, manage EIP-1559 parameters for gas pricing, and store
19: /// verified L1 block information.
20: /// @custom:security-contact security@taiko.xyz
31: /// @notice Golden touch address is the only address that can do the anchor transaction.
34: /// @notice The number of L2 blocks to wait before syncing L1 block details.
37: /// @notice Mapping from L2 block numbers to their block hashes. All L2 block hashes will
38: /// be saved in this mapping.
41: /// @notice A hash to check the integrity of public inputs.
42: /// @dev Slot 2.
45: /// @notice The gas excess value used to calculate the base fee.
46: /// @dev Slot 3.
49: /// @notice The last synced L1 block height.
54: /// @notice Emitted when the latest L1 block details are anchored to L2.
55: /// @param parentHash The hash of the parent block.
56: /// @param gasExcess The gas excess value used to calculate the base fee.
66: /// @notice Initializes the contract.
67: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
68: /// @param _addressManager The address of the {AddressManager} contract.
69: /// @param _l1ChainId The ID of the base layer.
70: /// @param _gasExcess The initial gasExcess.
100: /// @notice Anchors the latest L1 block details to L2 for cross-layer
101: /// message verification.
102: /// @param _l1BlockHash The latest L1 block hash when this block was
103: /// proposed.
104: /// @param _l1StateRoot The latest L1 block's state root.
105: /// @param _l1BlockId The latest L1 block height when this block was proposed.
106: /// @param _parentGasUsed The gas used in the parent block.
160: /// @notice Withdraw token or Ether from this address
161: /// @param _token Token address or address(0) if Ether.
162: /// @param _to Withdraw to address.
180: /// @notice Gets the basefee and gas excess using EIP-1559 configuration for
181: /// the given parameters.
182: /// @param _l1BlockId The synced L1 height in the next Taiko block
183: /// @param _parentGasUsed Gas used in the parent block.
184: /// @return basefee_ The calculated EIP-1559 base fee per gas.
196: /// @notice Retrieves the block hash for the given L2 block number.
197: /// @param _blockId The L2 block number to retrieve the block hash for.
198: /// @return The block hash for the specified L2 block id, or zero if the
199: /// block id is greater than or equal to the current block number.
206: /// @notice Returns EIP1559 related configurations.
207: /// @return config_ struct containing configuration parameters.
217: /// @notice Tells if we need to validate basefee (for simulation).
218: /// @return Returns true to skip checking basefee mismatch.
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L20) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L31) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L34) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L38) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L42) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L46) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L49) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L56) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L68) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L69) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L70) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L101) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L102) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L103) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L104) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L105) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L106) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L160) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L161) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L162) | [180](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L180) | [181](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L181) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L182) | [183](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L183) | [184](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L184) | [196](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L196) | [197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L197) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L198) | [199](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L199) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L206) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L207) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L217) | [218](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L218)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

6: /// @title TaikoL2EIP1559Configurable
7: /// @notice TaikoL2 with a setter to change EIP-1559 configurations and states.
8: /// @custom:security-contact security@taiko.xyz
10: /// @notice EIP-1559 configuration.
15: /// @notice Emits when the EIP-1559 configuration and gas excess are changed.
16: /// @param config The new EIP-1559 config.
17: /// @param gasExcess The new gas excess.
22: /// @notice Sets EIP1559 configuration and gas excess.
23: /// @param _newConfig The new EIP1559 config.
24: /// @param _newGasExcess The new gas excess
42: /// @inheritdoc TaikoL2
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L10) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L17) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L24) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L42)

```solidity
File: packages/protocol/contracts/signal/ISignalService.sol

4: /// @title ISignalService
5: /// @notice The SignalService contract serves as a secure cross-chain message
6: /// passing system. It defines methods for sending and verifying signals with
7: /// merkle proofs. The trust assumption is that the target chain has secure
8: /// access to the merkle root (such as Taiko injects it in the anchor
9: /// transaction). With this, verifying a signal is reduced to simply verifying
10: /// a merkle proof.
11: /// @custom:security-contact security@taiko.xyz
29: /// @notice Emitted when a remote chain's state root or signal root is
30: /// synced locally as a signal.
31: /// @param chainId The remote chainId.
32: /// @param blockId The chain data's corresponding blockId.
33: /// @param kind A value to mark the data type.
34: /// @param data The remote data.
35: /// @param signal The signal for this chain data.
44: /// @notice Emitted when a signal is sent.
45: /// @param app The address that initiated the signal.
46: /// @param signal The signal (message) that was sent.
47: /// @param slot The location in storage where this signal is stored.
48: /// @param value The value of the signal.
51: /// @notice Emitted when an address is authorized or deauthorized.
52: /// @param addr The address to be authorized or deauthorized.
53: /// @param authrized True if authorized, false otherwise.
56: /// @notice Send a signal (message) by setting the storage slot to a value of 1.
57: /// @param _signal The signal (message) to send.
58: /// @return slot_ The location in storage where this signal is stored.
61: /// @notice Sync a data from a remote chain locally as a signal. The signal is calculated
62: /// uniquely from chainId, kind, and data.
63: /// @param _chainId The remote chainId.
64: /// @param _kind A value to mark the data type.
65: /// @param _blockId The chain data's corresponding blockId
66: /// @param _chainData The remote data.
67: /// @return signal_ The signal for this chain data.
77: /// @notice Verifies if a signal has been received on the target chain.
78: /// @param _chainId The identifier for the source chain from which the
79: /// signal originated.
80: /// @param _app The address that initiated the signal.
81: /// @param _signal The signal (message) to send.
82: /// @param _proof Merkle proof that the signal was persisted on the
83: /// source chain.
92: /// @notice Verifies if a particular signal has already been sent.
93: /// @param _app The address that initiated the signal.
94: /// @param _signal The signal (message) that was sent.
95: /// @return true if the signal has been sent, otherwise false.
98: /// @notice Checks if a chain data has been synced.
99: /// uniquely from chainId, kind, and data.
100: /// @param _chainId The remote chainId.
101: /// @param _kind A value to mark the data type.
102: /// @param _blockId The chain data's corresponding blockId
103: /// @param _chainData The remote data.
104: /// @return true if the data has been synced, otherwise false.
115: /// @notice Returns the given block's  chain data.
116: /// @param _chainId Indenitifer of the chainId.
117: /// @param _kind A value to mark the data type.
118: /// @param _blockId The chain data's corresponding block id. If this value is 0, use the top
119: /// block id.
120: /// @return blockId_ The actual block id.
121: /// @return chainData_ The synced chain data.
131: /// @notice Returns the data to be used for caching slot generation.
132: /// @param _chainId Indenitifer of the chainId.
133: /// @param _kind A value to mark the data type.
134: /// @param _blockId The chain data's corresponding block id. If this value is 0, use the top
135: /// block id.
136: /// @return signal_ The signal used for caching slot creation.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L11) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L35) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L48) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L53) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L58) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L67) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L78) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L79) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L80) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L81) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L82) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L83) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L92) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L93) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L94) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L95) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L101) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L102) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L103) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L104) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L115) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L116) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L117) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L118) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L119) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L120) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L121) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L131) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L133) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L134) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L136)

```solidity
File: packages/protocol/contracts/signal/LibSignals.sol

4: /// @title LibSignals
5: /// @custom:security-contact security@taiko.xyz
7: /// @notice Keccak hash of the string "STATE_ROOT".
10: /// @notice Keccak hash of the string "SIGNAL_ROOT".
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L5) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L7) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L10)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

10: /// @title SignalService
11: /// @notice See the documentation in {ISignalService} for more details.
12: /// @dev Labeled in AddressResolver as "signal_service".
13: /// @custom:security-contact security@taiko.xyz
15: /// @notice Mapping to store the top blockId.
16: /// @dev Slot 1.
19: /// @notice Mapping to store the authorized addresses.
20: /// @dev Slot 2.
45: /// @notice Initializes the contract.
46: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
47: /// @param _addressManager The address of the {AddressManager} contract.
52: /// @dev Authorize or deauthorize an address for calling syncChainData.
53: /// @dev Note that addr is supposed to be TaikoL1 and TaikoL1 contracts deployed locally.
54: /// @param _addr The address to be authorized or deauthorized.
55: /// @param _authorize True if authorize, false otherwise.
62: /// @inheritdoc ISignalService
67: /// @inheritdoc ISignalService
81: /// @inheritdoc ISignalService
82: /// @dev This function may revert.
136: /// @inheritdoc ISignalService
152: /// @inheritdoc ISignalService
157: /// @inheritdoc ISignalService
176: /// @inheritdoc ISignalService
189: /// @notice Returns the slot for a signal.
190: /// @param _chainId The chainId of the signal.
191: /// @param _app The address that initiated the signal.
192: /// @param _signal The signal (message) that was sent.
193: /// @return The slot for the signal.
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L13) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L16) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L20) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L47) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L55) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L62) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L67) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L81) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L82) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L136) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L152) | [157](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L157) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L176) | [189](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L189) | [190](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L190) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L191) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L192) | [193](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L193)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

4: /// @title IBridge
5: /// @notice The bridge used in conjunction with the {ISignalService}.
6: /// @dev Ether is held by Bridges on L1 and L2s.
7: /// @custom:security-contact security@taiko.xyz
66: /// @notice Emitted when a message is sent.
67: /// @param msgHash The hash of the message.
68: /// @param message The message.
71: /// @notice Emitted when a message is received.
72: /// @param msgHash The hash of the message.
73: /// @param message The message.
74: /// @param isRecall True if the message is a recall.
77: /// @notice Emitted when a message is recalled.
78: /// @param msgHash The hash of the message.
81: /// @notice Emitted when a message is executed.
82: /// @param msgHash The hash of the message.
85: /// @notice Emitted when a message is retried.
86: /// @param msgHash The hash of the message.
89: /// @notice Emitted when the status of a message changes.
90: /// @param msgHash The hash of the message.
91: /// @param status The new status of the message.
94: /// @notice Emitted when a message is suspended or unsuspended.
95: /// @param msgHash The hash of the message.
96: /// @param suspended True if the message is suspended.
99: /// @notice Emitted when an address is banned or unbanned.
100: /// @param addr The address to ban or unban.
101: /// @param banned True if the address is banned.
104: /// @notice Sends a message to the destination chain and takes custody
105: /// of Ether required in this contract. All extra Ether will be refunded.
106: /// @param _message The message to be sent.
107: /// @return msgHash_ The hash of the sent message.
108: /// @return message_ The updated message sent.
114: /// @notice Recalls a failed message on its source chain, releasing
115: /// associated assets.
116: /// @dev This function checks if the message failed on the source chain and
117: /// releases associated Ether or tokens.
118: /// @param _message The message whose associated Ether should be released.
119: /// @param _proof The merkle inclusion proof.
122: /// @notice Processes a bridge message on the destination chain. This
123: /// function is callable by any address, including the `message.destOwner`.
124: /// @dev The process begins by hashing the message and checking the message
125: /// status in the bridge  If the status is "NEW", the message is invoked. The
126: /// status is updated accordingly, and processing fees are refunded as
127: /// needed.
128: /// @param _message The message to be processed.
129: /// @param _proof The merkle inclusion proof.
132: /// @notice Retries to invoke the messageCall after releasing associated
133: /// Ether and tokens.
134: /// @dev This function can be called by any address, including the
135: /// `message.destOwner`.
136: /// It attempts to invoke the messageCall and updates the message status
137: /// accordingly.
138: /// @param _message The message to retry.
139: /// @param _isLastAttempt Specifies if this is the last attempt to retry the
140: /// message.
143: /// @notice Returns the bridge state context.
144: /// @return ctx_ The context of the current bridge operation.
147: /// @notice Checks if the message was sent.
148: /// @param _message The message.
149: /// @return true if the message was sent.
152: /// @notice Hash the message
153: /// @param _message The message struct variable to be hashed.
154: /// @return The message's hash.
158: /// @title IRecallableSender
159: /// @notice An interface that all recallable message senders shall implement.
161: /// @notice Called when a message is recalled.
162: /// @param _message The recalled message.
163: /// @param _msgHash The hash of the recalled message.
172: /// @title IMessageInvocable
173: /// @notice An interface that all bridge message receiver shall implement
175: /// @notice Called when this contract is the bridge target.
176: /// @param _data The data for this contract to interpret.
177: /// @dev This method should be guarded with `onlyFromNamed("bridge")`.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L7) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L68) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L71) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L72) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L73) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L74) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L78) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L81) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L82) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L85) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L86) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L89) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L90) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L91) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L94) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L95) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L96) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L101) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L104) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L105) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L106) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L107) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L108) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L114) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L115) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L116) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L117) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L118) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L119) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L122) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L123) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L124) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L125) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L126) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L127) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L128) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L129) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L133) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L134) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L136) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L137) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L138) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L139) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L140) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L143) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L144) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L148) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L149) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L152) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L153) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L154) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L158) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L159) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L161) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L162) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L163) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L172) | [173](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L173) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L175) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L176) | [177](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L177)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

11: /// @title Bridge
12: /// @notice See the documentation for {IBridge}.
13: /// @dev Labeled in AddressResolver as "bridge". Additionally, the code hash for the same address on
14: /// L1 and L2 may be different.
15: /// @custom:security-contact security@taiko.xyz
21: /// @dev The slot in transient storage of the call context. This is the keccak256 hash
22: /// of "bridge.ctx_slot"
26: /// @dev Place holder value when not using transient storage
29: /// @notice The next message ID.
30: /// @dev Slot 1.
33: /// @notice Mapping to store the status of a message from its hash.
34: /// @dev Slot 2.
37: /// @dev Slots 3, 4, and 5.
40: /// @notice Mapping to store banned addresses.
41: /// @dev Slot 6.
44: /// @notice Mapping to store the proof receipt of a message from its hash.
45: /// @dev Slot 7.
69: /// @notice Function to receive Ether.
72: /// @notice Initializes the contract.
73: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
74: /// @param _addressManager The address of the {AddressManager} contract.
79: /// @notice Suspend or unsuspend invocation for a list of messages.
80: /// @param _msgHashes The array of msgHashes to be suspended.
81: /// @param _suspend True if suspend, false if unsuspend.
97: /// @notice Ban or unban an address. A banned addresses will not be invoked upon
98: /// with message calls.
99: /// @param _addr The address to ban or unban.
100: /// @param _ban True if ban, false if unban.
114: /// @inheritdoc IBridge
154: /// @inheritdoc IBridge
216: /// @inheritdoc IBridge
309: /// @inheritdoc IBridge
339: /// @inheritdoc IBridge
348: /// @notice Checks if a msgHash has failed on its destination chain.
349: /// @param _message The message.
350: /// @param _proof The merkle inclusion proof.
351: /// @return true if the message has failed, false otherwise.
370: /// @notice Checks if a msgHash has failed on its destination chain.
371: /// @param _message The message.
372: /// @param _proof The merkle inclusion proof.
373: /// @return true if the message has failed, false otherwise.
388: /// @notice Checks if the destination chain is enabled.
389: /// @param _chainId The destination chain ID.
390: /// @return enabled_ True if the destination chain is enabled.
391: /// @return destBridge_ The bridge of the destination chain.
401: /// @notice Gets the current context.
402: /// @inheritdoc IBridge
410: /// @notice Returns invocation delay values.
411: /// @dev Bridge contract deployed on L1 shall use a non-zero value for better
412: /// security.
413: /// @return invocationDelay_ The minimal delay in second before a message can be executed since
414: /// and the time it was received on the this chain.
415: /// @return invocationExtraDelay_ The extra delay in second (to be added to invocationDelay) if
416: /// the transactor is not the preferredExecutor who proved this message.
448: /// @inheritdoc IBridge
453: /// @notice Returns a signal representing a failed/recalled message.
454: /// @param _msgHash The message hash.
455: /// @return The failed representation of it as bytes32.
460: /// @notice Checks if the given address can pause and unpause the bridge.
469: /// @notice Invokes a call message on the Bridge.
470: /// @param _message The call message to be invoked.
471: /// @param _msgHash The hash of the message.
472: /// @param _gasLimit The gas limit for the message call.
473: /// @return success_ A boolean value indicating whether the message call was
474: /// successful.
475: /// @dev This function updates the context in the state before and after the
476: /// message call.
510: /// @notice Updates the status of a bridge message.
511: /// @dev If the new status is different from the current status in the
512: /// mapping, the status is updated and an event is emitted.
513: /// @param _msgHash The hash of the message.
514: /// @param _status The new status of the message.
528: /// @notice Resets the call context
537: /// @notice Stores the call context
538: /// @param _msgHash The message hash.
539: /// @param _from The sender's address.
540: /// @param _srcChainId The source chain ID.
553: /// @notice Loads and returns the call context.
554: /// @return ctx_ The call context.
571: /// @notice Checks if the signal was received.
572: /// @param _signalService The signal service address.
573: /// @param _signal The signal.
574: /// @param _chainId The ID of the chain the signal is stored on.
575: /// @param _proof The merkle inclusion proof.
576: /// @return success_ True if the message was received.
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L15) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L22) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L26) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L30) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L34) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L37) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L41) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L45) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L69) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L72) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L73) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L74) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L79) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L80) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L81) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L97) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L100) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L114) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L154) | [216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L216) | [309](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L309) | [339](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L339) | [348](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L348) | [349](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L349) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L350) | [351](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L351) | [370](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L370) | [371](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L371) | [372](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L372) | [373](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L373) | [388](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L388) | [389](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L389) | [390](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L390) | [391](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L391) | [401](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L401) | [402](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L402) | [410](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L410) | [411](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L411) | [412](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L412) | [413](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L413) | [414](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L414) | [415](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L415) | [416](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L416) | [448](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L448) | [453](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L453) | [454](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L454) | [455](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L455) | [460](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L460) | [469](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L469) | [470](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L470) | [471](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L471) | [472](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L472) | [473](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L473) | [474](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L474) | [475](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L475) | [476](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L476) | [510](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L510) | [511](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L511) | [512](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L512) | [513](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L513) | [514](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L514) | [528](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L528) | [537](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L537) | [538](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L538) | [539](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L539) | [540](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L540) | [553](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L553) | [554](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L554) | [571](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L571) | [572](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L572) | [573](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L573) | [574](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L574) | [575](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L575) | [576](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L576)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

6: /// @title IUSDC
7: /// @custom:security-contact security@taiko.xyz
9: /// @notice Burns a specific amount of tokens.
10: /// @param _amount The amount of token to be burned.
13: /// @notice Mints a specific amount of new tokens to an address.
14: /// @param _to The address that will receive the minted tokens.
15: /// @param _amount The amount of tokens to mint.
18: /// @notice Transfers tokens from one address to another.
19: /// @param from The address which you want to send tokens from.
20: /// @param _to The address which you want to transfer to.
21: /// @param _amount The amount of tokens to be transferred.
22: /// @return true if the transfer was successful, otherwise false.
26: /// @title USDCAdapter
27: /// @custom:security-contact security@taiko.xyz
29: /// @notice The USDC instance.
30: /// @dev Slot 1.
34: /// @notice Initializes the contract.
35: /// @param _owner The owner of this contract.
36: /// @param _addressManager The address of the {AddressManager} contract.
37: /// @param _usdc The USDC instance.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L7) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L10) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L15) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L22) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L27) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L30) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L37)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

11: /// @title BridgedERC20
12: /// @notice An upgradeable ERC20 contract that represents tokens bridged from
13: /// another chain.
14: /// @custom:security-contact security@taiko.xyz
21: /// @dev Slot 1.
26: /// @dev Slot 2.
29: /// @dev Slot 3.
44: /// @notice Initializes the contract.
45: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
46: /// @param _addressManager The address of the {AddressManager} contract.
47: /// @param _srcToken The source token address.
48: /// @param _srcChainId The source chain ID.
49: /// @param _decimals The number of decimal places of the source token.
50: /// @param _symbol The symbol of the token.
51: /// @param _name The name of the token.
78: /// @notice Set the snapshoter address.
79: /// @param _snapshooter snapshooter address.
84: /// @notice Creates a new token snapshot.
89: /// @notice Gets the name of the token.
90: /// @return The name.
100: /// @notice Gets the symbol of the bridged token.
101: /// @return The symbol.
111: /// @notice Gets the number of decimal places of the token.
112: /// @return The number of decimal places of the token.
122: /// @notice Gets the canonical token's address and chain ID.
123: /// @return The canonical token's address.
124: /// @return The canonical token's chain ID.
137: /// @dev For ERC20SnapshotUpgradeable and ERC20VotesUpgradeable, need to implement the following
138: /// functions
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L14) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L21) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L26) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L29) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L51) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L78) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L79) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L84) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L89) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L90) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L101) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L111) | [112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L112) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L122) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L123) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L124) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L137) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L138)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

7: /// @title BridgedERC20Base
8: /// @custom:security-contact security@taiko.xyz
10: /// @notice The address of the contract to migrate tokens to or from.
13: /// @notice If true, signals migrating 'to', false if migrating 'from'.
18: /// @notice Emitted when the migration status is changed.
19: /// @param addr The address migrating 'to' or 'from'.
20: /// @param inbound If false then signals migrating 'from', true if migrating 'into'.
23: /// @notice Emitted when tokens are migrated to or from the bridged token.
24: /// @param fromToken The address of the bridged token.
25: /// @param account The address of the account.
26: /// @param amount The amount of tokens migrated.
33: /// @notice Start or stop migration to/from a specified contract.
34: /// @param _migratingAddress The address migrating 'to' or 'from'.
35: /// @param _migratingInbound If false then signals migrating 'from', true if migrating 'into'.
54: /// @notice Mints tokens to the specified account.
55: /// @param _account The address of the account to receive the tokens.
56: /// @param _amount The amount of tokens to mint.
72: /// @notice Burns tokens from the specified account.
73: /// @param _account The address of the account to burn the tokens from.
74: /// @param _amount The amount of tokens to burn.
91: /// @notice Returns the owner.
92: /// @return The address of the owner.
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L10) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L13) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L20) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L26) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L35) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L56) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L72) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L73) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L74) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L91) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L92)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

9: /// @title BridgedERC721
10: /// @notice Contract for bridging ERC721 tokens across different chains.
11: /// @custom:security-contact security@taiko.xyz
13: /// @notice Address of the source token contract.
16: /// @notice Source chain ID where the token originates.
24: /// @notice Initializes the contract.
25: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
26: /// @param _addressManager The address of the {AddressManager} contract.
27: /// @param _srcToken Address of the source token.
28: /// @param _srcChainId Source chain ID.
29: /// @param _symbol Symbol of the bridged token.
30: /// @param _name Name of the bridged token.
51: /// @dev Mints tokens.
52: /// @param _account Address to receive the minted token.
53: /// @param _tokenId ID of the token to mint.
66: /// @dev Burns tokens.
67: /// @param _account Address from which the token is burned.
68: /// @param _tokenId ID of the token to burn.
85: /// @notice Gets the name of the token.
86: /// @return The name.
91: /// @notice Gets the symbol of the bridged token.
92: /// @return The symbol.
97: /// @notice Gets the source token and source chain ID being bridged.
98: /// @return The source token's address.
99: /// @return The source token's chain ID.
104: /// @notice Returns the token URI.
105: /// @param _tokenId The token id.
106: /// @return The token URI following EIP-681.
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L11) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L13) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L16) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L30) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L53) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L68) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L85) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L86) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L91) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L92) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L97) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L99) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L104) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L105) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L106)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

11: /// @title BridgedERC1155
12: /// @notice Contract for bridging ERC1155 tokens across different chains.
13: /// @custom:security-contact security@taiko.xyz
15: /// @notice Address of the source token contract.
18: /// @notice Source chain ID where the token originates.
21: /// @dev Symbol of the bridged token.
24: /// @dev Name of the bridged token.
31: /// @notice Initializes the contract.
32: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
33: /// @param _addressManager The address of the {AddressManager} contract.
34: /// @param _srcToken Address of the source token.
35: /// @param _srcChainId Source chain ID.
36: /// @param _symbol Symbol of the bridged token.
37: /// @param _name Name of the bridged token.
62: /// @dev Mints tokens.
63: /// @param _to Address to receive the minted tokens.
64: /// @param _tokenId ID of the token to mint.
65: /// @param _amount Amount of tokens to mint.
79: /// @dev Mints tokens.
80: /// @param _to Address to receive the minted tokens.
81: /// @param _tokenIds ID of the token to mint.
82: /// @param _amounts Amount of tokens to mint.
96: /// @dev Burns tokens.
97: /// @param _account Address from which tokens are burned.
98: /// @param _tokenId ID of the token to burn.
99: /// @param _amount Amount of tokens to burn.
113: /// @notice Gets the name of the bridged token.
114: /// @return The name.
119: /// @notice Gets the symbol of the bridged token.
120: /// @return The symbol.
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L13) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L15) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L21) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L24) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L37) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L65) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L79) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L80) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L81) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L82) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L96) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L97) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L99) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L113) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L114) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L119) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L120)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

6: /// @title BaseNFTVault
7: /// @notice Abstract contract for bridging NFTs across different chains.
8: /// @custom:security-contact security@taiko.xyz
46: /// @notice ERC1155 interface ID.
49: /// @notice ERC721 interface ID.
52: /// @notice Maximum number of tokens that can be transferred per transaction.
55: /// @notice Mapping to store bridged NFTs and their canonical counterparts.
58: /// @notice Mapping to store canonical NFTs and their bridged counterparts.
63: /// @notice Emitted when a new bridged token is deployed.
64: /// @param chainId The chain ID of the bridged token.
65: /// @param ctoken The address of the canonical token.
66: /// @param btoken The address of the bridged token.
67: /// @param ctokenSymbol The symbol of the canonical token.
68: /// @param ctokenName The name of the canonical token.
77: /// @notice Emitted when a token is sent to another chain.
78: /// @param msgHash The hash of the message.
79: /// @param from The sender of the message.
80: /// @param to The recipient of the message.
81: /// @param destChainId The destination chain ID.
82: /// @param ctoken The address of the canonical token.
83: /// @param token The address of the bridged token.
84: /// @param tokenIds The IDs of the tokens.
85: /// @param amounts The amounts of the tokens.
97: /// @notice Emitted when a token is released on the current chain.
98: /// @param msgHash The hash of the message.
99: /// @param from The sender of the message.
100: /// @param ctoken The address of the canonical token.
101: /// @param token The address of the bridged token.
102: /// @param tokenIds The IDs of the tokens.
103: /// @param amounts The amounts of the tokens.
113: /// @notice Emitted when a token is received from another chain.
114: /// @param msgHash The hash of the message.
115: /// @param from The sender of the message.
116: /// @param to The recipient of the message.
117: /// @param srcChainId The source chain ID.
118: /// @param ctoken The address of the canonical token.
119: /// @param token The address of the bridged token.
120: /// @param tokenIds The IDs of the tokens.
121: /// @param amounts The amounts of the tokens.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L8) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L46) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L49) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L52) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L55) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L58) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L68) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L78) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L79) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L80) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L81) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L82) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L83) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L84) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L85) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L97) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L101) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L102) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L103) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L113) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L114) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L115) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L116) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L117) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L118) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L119) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L120) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L121)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

9: /// @title BaseVault
10: /// @notice This abstract contract provides a base implementation for vaults.
11: /// @custom:security-contact security@taiko.xyz
29: /// @notice Initializes the contract.
30: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
31: /// @param _addressManager The address of the {AddressManager} contract.
36: /// @notice Checks if the contract supports the given interface.
37: /// @param _interfaceId The interface identifier.
38: /// @return true if the contract supports the interface, false otherwise.
43: /// @notice Returns the name of the vault.
44: /// @return The name of the vault.
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L11) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L31) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L38) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L44)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

11: /// @title IERC1155NameAndSymbol
12: /// @notice Interface for ERC1155 contracts that provide name() and symbol()
13: /// functions. These functions may not be part of the official interface but are
14: /// used by some contracts.
15: /// @custom:security-contact security@taiko.xyz
17: /// @notice Returns the name of the token.
20: /// @notice Returns the symbol of the token.
24: /// @title ERC1155Vault
25: /// @dev Labeled in AddressResolver as "erc1155_vault"
26: /// @notice This vault holds all ERC1155 tokens that users have deposited.
27: /// It also manages the mapping between canonical tokens and their bridged
28: /// tokens.
34: /// @notice Transfers ERC1155 tokens to this vault and sends a message to
35: /// the destination chain so the user can receive the same (bridged) tokens
36: /// by invoking the message call.
37: /// @param _op Option for sending the ERC1155 token.
38: /// @return message_ The constructed message.
92: /// @inheritdoc IMessageInvocable
126: /// @inheritdoc IRecallableSender
159: /// @notice See {ERC1155ReceiverUpgradeable-onERC1155BatchReceived}.
174: /// @notice See {ERC1155ReceiverUpgradeable-onERC1155Received}.
189: /// @dev See {BaseVault-supportsInterface}.
190: /// @param interfaceId The interface identifier.
191: /// @return true if supports, else otherwise.
203: /// @inheritdoc BaseVault
208: /// @dev Transfers ERC1155 tokens to the `to` address.
209: /// @param ctoken CanonicalNFT data.
210: /// @param to The address to transfer the tokens to.
211: /// @param tokenIds The token IDs to transfer.
212: /// @param amounts The amounts to transfer.
213: /// @return token The address of the token.
234: /// @dev Handles the message on the source chain and returns the encoded
235: /// call on the destination call.
236: /// @param _user The user's address.
237: /// @param _op BridgeTransferOp data.
238: /// @return msgData_ Encoded message data.
239: /// @return ctoken_ The canonical token.
285: /// @dev Retrieve or deploy a bridged ERC1155 token contract.
286: /// @param _ctoken CanonicalNFT data.
287: /// @return btoken_ Address of the bridged token contract.
298: /// @dev Deploy a new BridgedNFT contract and initialize it.
299: /// This must be called before the first time a bridged token is sent to
300: /// this chain.
301: /// @param _ctoken CanonicalNFT data.
302: /// @return btoken_ Address of the deployed bridged token contract.
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L15) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L17) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L20) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L28) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L38) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L92) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L126) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L159) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L174) | [189](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L189) | [190](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L190) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L191) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L203) | [208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L208) | [209](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L209) | [210](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L210) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L211) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L212) | [213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L213) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L234) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L235) | [236](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L236) | [237](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L237) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L238) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L239) | [285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L285) | [286](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L286) | [287](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L287) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L298) | [299](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L299) | [300](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L300) | [301](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L301) | [302](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L302)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

12: /// @title ERC20Vault
13: /// @notice This vault holds all ERC20 tokens (excluding Ether) that users have
14: /// deposited. It also manages the mapping between canonical ERC20 tokens and
15: /// their bridged tokens.
16: /// @dev Labeled in AddressResolver as "erc20_vault".
17: /// @custom:security-contact security@taiko.xyz
22: /// @dev Represents a canonical ERC20 token.
31: /// @dev Represents an operation to send tokens to another chain.
44: /// @notice Mappings from bridged tokens to their canonical tokens.
47: /// @notice Mappings from canonical tokens to their bridged tokens. Also storing
48: /// the chainId for tokens across other chains aside from Ethereum.
51: /// @notice Mappings from bridged tokens to their blacklist status.
56: /// @notice Emitted when a new bridged token is deployed.
57: /// @param srcChainId The chain ID of the canonical token.
58: /// @param ctoken The address of the canonical token.
59: /// @param btoken The address of the bridged token.
60: /// @param ctokenSymbol The symbol of the canonical token.
61: /// @param ctokenName The name of the canonical token.
62: /// @param ctokenDecimal The decimal of the canonical token.
72: /// @notice Emitted when a bridged token is changed.
73: /// @param srcChainId The chain ID of the canonical token.
74: /// @param ctoken The address of the canonical token.
75: /// @param btokenOld The address of the old bridged token.
76: /// @param btokenNew The address of the new bridged token.
77: /// @param ctokenSymbol The symbol of the canonical token.
78: /// @param ctokenName The name of the canonical token.
79: /// @param ctokenDecimal The decimal of the canonical token.
90: /// @notice Emitted when a token is sent to another chain.
91: /// @param msgHash The hash of the message.
92: /// @param from The address of the sender.
93: /// @param to The address of the recipient.
94: /// @param destChainId The chain ID of the destination chain.
95: /// @param ctoken The address of the canonical token.
96: /// @param token The address of the bridged token.
97: /// @param amount The amount of tokens sent.
108: /// @notice Emitted when a token is released from a message.
109: /// @param msgHash The hash of the message.
110: /// @param from The address of the sender.
111: /// @param ctoken The address of the canonical token.
112: /// @param token The address of the bridged token.
113: /// @param amount The amount of tokens released.
118: /// @notice Emitted when a token is received from another chain.
119: /// @param msgHash The hash of the message.
120: /// @param from The address of the sender.
121: /// @param to The address of the recipient.
122: /// @param srcChainId The chain ID of the source chain.
123: /// @param ctoken The address of the canonical token.
124: /// @param token The address of the bridged token.
125: /// @param amount The amount of tokens received.
144: /// @notice Change bridged token.
145: /// @param _ctoken The canonical token.
146: /// @param _btokenNew The new bridged token address.
147: /// @return btokenOld_ The old bridged token address.
202: /// @notice Transfers ERC20 tokens to this vault and sends a message to the
203: /// destination chain so the user can receive the same amount of tokens by
204: /// invoking the message call.
205: /// @param _op Option for sending ERC20 tokens.
206: /// @return message_ The constructed message.
252: /// @inheritdoc IMessageInvocable
284: /// @inheritdoc IRecallableSender
315: /// @inheritdoc BaseVault
337: /// @dev Handles the message on the source chain and returns the encoded
338: /// call on the destination call.
339: /// @param _user The user's address.
340: /// @param _token The token address.
341: /// @param _to To address.
342: /// @param _amount Amount to be sent.
343: /// @return msgData_ Encoded message data.
344: /// @return ctoken_ The canonical token.
345: /// @return balanceChange_ User token balance actual change after the token
346: /// transfer. This value is calculated so we do not assume token balance
347: /// change is the amount of token transferred away.
388: /// @dev Retrieve or deploy a bridged ERC20 token contract.
389: /// @param ctoken CanonicalERC20 data.
390: /// @return btoken Address of the bridged token contract.
402: /// @dev Deploy a new BridgedERC20 contract and initialize it.
403: /// This must be called before the first time a bridged token is sent to
404: /// this chain.
405: /// @param ctoken CanonicalERC20 data.
406: /// @return btoken Address of the deployed bridged token contract.
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L17) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L22) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L31) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L44) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L48) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L51) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L58) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L62) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L72) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L73) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L74) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L75) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L76) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L78) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L79) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L90) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L91) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L92) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L93) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L94) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L95) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L96) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L97) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L108) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L109) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L110) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L111) | [112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L112) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L113) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L118) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L119) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L120) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L121) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L122) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L123) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L124) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L125) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L144) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L145) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L147) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L202) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L203) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L204) | [205](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L205) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L206) | [252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L252) | [284](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L284) | [315](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L315) | [337](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L337) | [338](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L338) | [339](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L339) | [340](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L340) | [341](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L341) | [342](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L342) | [343](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L343) | [344](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L344) | [345](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L345) | [346](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L346) | [347](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L347) | [388](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L388) | [389](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L389) | [390](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L390) | [402](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L402) | [403](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L403) | [404](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L404) | [405](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L405) | [406](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L406)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

11: /// @title ERC721Vault
12: /// @notice This vault holds all ERC721 tokens that users have deposited. It also manages
13: /// the mapping between canonical tokens and their bridged tokens.
14: /// @dev Labeled in AddressResolver as "erc721_vault".
15: /// @custom:security-contact security@taiko.xyz
21: /// @notice Transfers ERC721 tokens to this vault and sends a message to the
22: /// destination chain so the user can receive the same (bridged) tokens
23: /// by invoking the message call.
24: /// @param _op Option for sending the ERC721 token.
25: /// @return message_ The constructed message.
76: /// @inheritdoc IMessageInvocable
109: /// @inheritdoc IRecallableSender
141: /// @inheritdoc IERC721Receiver
155: /// @inheritdoc BaseVault
181: /// @dev Handles the message on the source chain and returns the encoded
182: /// call on the destination call.
183: /// @param _user The user's address.
184: /// @param _op BridgeTransferOp data.
185: /// @return msgData_ Encoded message data.
186: /// @return ctoken_ The canonical token.
221: /// @dev Retrieve or deploy a bridged ERC721 token contract.
222: /// @param _ctoken CanonicalNFT data.
223: /// @return btoken_ Address of the bridged token contract.
235: /// @dev Deploy a new BridgedNFT contract and initialize it.
236: /// This must be called before the first time a bridged token is sent to
237: /// this chain.
238: /// @param _ctoken CanonicalNFT data.
239: /// @return btoken_ Address of the deployed bridged token contract.
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L15) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L25) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L76) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L109) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L141) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L155) | [181](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L181) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L182) | [183](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L183) | [184](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L184) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L185) | [186](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L186) | [221](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L221) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L222) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L223) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L235) | [236](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L236) | [237](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L237) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L238) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L239)

```solidity
File: packages/protocol/contracts/tokenvault/IBridgedERC20.sol

4: /// @title IBridgedERC20
5: /// @notice Interface for all bridged tokens.
6: /// @dev To facilitate compatibility with third-party bridged tokens, such as USDC's native
7: /// standard, it's necessary to implement an intermediary adapter contract which should conform to
8: /// this interface, enabling effective interaction with third-party contracts.
9: /// @custom:security-contact security@taiko.xyz
11: /// @notice Mints `amount` tokens and assigns them to the `account` address.
12: /// @param _account The account to receive the minted tokens.
13: /// @param _amount The amount of tokens to mint.
16: /// @notice Burns `amount` tokens from the `from` address.
17: /// @param _from The account from which the tokens will be burned.
18: /// @param _amount The amount of tokens to burn.
21: /// @notice Start or stop migration to/from a specified contract.
22: /// @param _addr The address migrating 'to' or 'from'.
23: /// @param _inbound If false then signals migrating 'from', true if migrating 'into'.
26: /// @notice Returns the owner.
27: /// @return The address of the owner.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L9) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L13) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L23) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L27)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

6: /// @title LibBridgedToken
7: /// @custom:security-contact security@taiko.xyz
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L7)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

9: /// @notice Use when you _really_ really _really_ don't trust the called
10: /// contract. This prevents the called contract from causing reversion of
11: /// the caller in as many ways as we can.
12: /// @dev The main difference between this and a solidity low-level call is
13: /// that we limit the number of bytes that the callee can cause to be
14: /// copied to caller memory. This prevents stupid things like malicious
15: /// contracts returning 10,000,000 bytes causing a local OOG when copying
16: /// to memory.
17: /// @param _target The address to call
18: /// @param _gas The amount of gas to forward to the remote contract
19: /// @param _value The value in wei to send to the remote contract
20: /// @param _maxCopy The maximum number of bytes of returndata to copy
21: /// to memory.
22: /// @param _calldata The data to send to the remote contract
23: /// @return success and returndata, as `.call()`. Returndata is capped to
24: /// `_maxCopy` bytes.
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L24)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

4: /// @title Bytes
5: /// @notice Bytes is a library for manipulating byte arrays.
7: /// @custom:attribution https://github.com/GNSPS/solidity-bytes-utils
8: /// @notice Slices a byte array with a given starting index and length. Returns a new byte array
9: ///         as opposed to a pointer to the original array. Will throw if trying to slice more
10: ///         bytes than exist in the array.
11: /// @param _bytes Byte array to slice.
12: /// @param _start Starting index of the slice.
13: /// @param _length Length of the slice.
14: /// @return Slice of the input byte array.
67: //update free-memory pointer
68: //allocating the array padded to 32 bytes like the compiler does now
71: //if we want a zero-length slice let's just return a zero-length array
75: //zero out the 32 bytes slice we are about to return
76: //we need to do it because Solidity does not garbage collect
86: /// @notice Slices a byte array with a given starting index up to the end of the original byte
87: ///         array. Returns a new array rathern than a pointer to the original.
88: /// @param _bytes Byte array to slice.
89: /// @param _start Starting index of the slice.
90: /// @return Slice of the input byte array.
98: /// @notice Converts a byte array into a nibble array by splitting each byte into two nibbles.
99: ///         Resulting nibble array will be exactly twice as long as the input byte array.
100: /// @param _bytes Input byte array to convert.
101: /// @return Resulting nibble array.
145: /// @notice Compares two byte arrays by comparing their keccak256 hashes.
146: /// @param _bytes First byte array to compare.
147: /// @param _other Second byte array to compare.
148: /// @return true if the two byte arrays are equal, false otherwise.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L5) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L14) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L68) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L71) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L75) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L76) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L86) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L87) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L88) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L89) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L90) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L101) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L145) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L148)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

4: /// @custom:attribution https://github.com/hamdiallam/Solidity-RLP
5: /// @title RLPReader
6: /// @notice RLPReader is a library for parsing RLP-encoded byte arrays into Solidity types. Adapted
7: ///         from Solidity-RLP (https://github.com/hamdiallam/Solidity-RLP) by Hamdi Allam with
8: ///         various tweaks to improve readability.
10: /// @notice Custom pointer type to avoid confusion between pointers and uint256s.
13: /// @notice RLP item types.
14: /// @custom:value DATA_ITEM Represents an RLP data item (NOT a list).
15: /// @custom:value LIST_ITEM Represents an RLP list item.
21: /// @notice Struct representing an RLP item.
22: /// @custom:field length Length of the RLP item.
23: /// @custom:field ptr    Pointer to the RLP item in memory.
29: /// @notice Max list length that this library will accept.
32: /// @notice Converts bytes to a reference to memory position and length.
33: /// @param _in Input bytes to convert.
34: /// @return out_ Output memory reference.
50: /// @notice Reads an RLP list value into a list of RLP items.
51: /// @param _in RLP list value.
52: /// @return out_ Decoded RLP list items.
99: /// @notice Reads an RLP list value into a list of RLP items.
100: /// @param _in RLP list value.
101: /// @return out_ Decoded RLP list items.
106: /// @notice Reads an RLP bytes value into bytes.
107: /// @param _in RLP bytes value.
108: /// @return out_ Decoded bytes.
125: /// @notice Reads an RLP bytes value into bytes.
126: /// @param _in RLP bytes value.
127: /// @return out_ Decoded bytes.
132: /// @notice Reads the raw bytes of an RLP item.
133: /// @param _in RLP item to read.
134: /// @return out_ Raw RLP bytes.
139: /// @notice Decodes the length of an RLP item.
140: /// @param _in RLP item to decode.
141: /// @return offset_ Offset of the encoded data.
142: /// @return length_ Length of the encoded data.
143: /// @return type_ RLP item type (LIST_ITEM or DATA_ITEM).
272: /// @notice Copies the bytes from a memory location.
273: /// @param _src    Pointer to the location to read from.
274: /// @param _offset Offset to start reading from.
275: /// @param _length Number of bytes to read.
276: /// @return out_ Copied bytes.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L10) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L15) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L23) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L29) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L34) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L52) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L101) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L106) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L107) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L108) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L125) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L126) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L127) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L133) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L134) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L139) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L140) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L141) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L142) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L143) | [272](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L272) | [273](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L273) | [274](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L274) | [275](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L275) | [276](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L276)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

4: /// @custom:attribution https://github.com/bakaoh/solidity-rlp-encode
5: /// @title RLPWriter
6: /// @author RLPWriter is a library for encoding Solidity types to RLP bytes. Adapted from Bakaoh's
7: ///         RLPEncode library (https://github.com/bakaoh/solidity-rlp-encode) with minor
8: ///         modifications to improve legibility.
10: /// @notice RLP encodes a byte string.
11: /// @param _in The byte string to encode.
12: /// @return out_ The RLP encoded string in bytes.
21: /// @notice RLP encodes a uint.
22: /// @param _in The uint256 to encode.
23: /// @return out_ The RLP encoded uint256 in bytes.
28: /// @notice Encode the first byte and then the `len` in binary form if `length` is more than 55.
29: /// @param _len    The length of the string or the payload.
30: /// @param _offset 128 if item is string, 192 if item is list.
31: /// @return out_ RLP encoded bytes.
52: /// @notice Encode integer in big endian binary form with no leading zeroes.
53: /// @param _x The integer to encode.
54: /// @return out_ RLP encoded bytes.
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L12) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L23) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L31) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L54)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

7: /// @title MerkleTrie
8: /// @notice MerkleTrie is a small library for verifying standard Ethereum Merkle-Patricia trie
9: ///         inclusion proofs. By default, this library assumes a hexary trie. One can change the
10: ///         trie radix constant to support other trie radixes.
12: /// @notice Struct representing a node in the trie.
13: /// @custom:field encoded The RLP-encoded node.
14: /// @custom:field decoded The RLP-decoded node.
20: /// @notice Determines the number of elements per branch node.
23: /// @notice Branch nodes have TREE_RADIX elements and one value element.
26: /// @notice Leaf nodes and extension nodes have two elements, a `path` and a `value`.
29: /// @notice Prefix for even-nibbled extension node paths.
32: /// @notice Prefix for odd-nibbled extension node paths.
35: /// @notice Prefix for even-nibbled leaf node paths.
38: /// @notice Prefix for odd-nibbled leaf node paths.
41: /// @notice Verifies a proof that a given key/value pair is present in the trie.
42: /// @param _key   Key of the node to search for, as a hex string.
43: /// @param _value Value of the node to search for, as a hex string.
44: /// @param _proof Merkle trie inclusion proof for the desired node. Unlike traditional Merkle
45: ///               trees, this proof is executed top-down and consists of a list of RLP-encoded
46: ///               nodes that make a path down to the target node.
47: /// @param _root  Known root of the Merkle trie. Used to verify that the included proof is
48: ///               correctly constructed.
49: /// @return valid_ Whether or not the proof is valid.
63: /// @notice Retrieves the value associated with a given key.
64: /// @param _key   Key to search for, as hex bytes.
65: /// @param _proof Merkle trie inclusion proof for the key.
66: /// @param _root  Known root of the Merkle trie.
67: /// @return value_ Value of the key if it exists.
201: /// @notice Parses an array of proof elements into a new array that contains both the original
202: ///         encoded element and the RLP-decoded element.
203: /// @param _proof Array of proof elements to parse.
204: /// @return proof_ Proof parsed into easily accessible structs.
216: /// @notice Picks out the ID for a node. Node ID is referred to as the "hash" within the
217: ///         specification, but nodes < 32 bytes are not actually hashed.
218: /// @param _node Node to pull an ID for.
219: /// @return id_ ID for the node, depending on the size of its contents.
224: /// @notice Gets the path for a leaf or extension node.
225: /// @param _node Node to get a path for.
226: /// @return nibbles_ Node path, converted to an array of nibbles.
231: /// @notice Utility; determines the number of nibbles shared between two nibble arrays.
232: /// @param _a First nibble array.
233: /// @param _b Second nibble array.
234: /// @return shared_ Number of shared nibbles.
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L10) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L14) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L20) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L23) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L26) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L29) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L32) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L35) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L38) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L42) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L49) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L67) | [201](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L201) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L202) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L203) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L204) | [216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L216) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L217) | [218](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L218) | [219](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L219) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L224) | [225](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L225) | [226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L226) | [231](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L231) | [232](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L232) | [233](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L233) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L234)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

6: /// @title SecureMerkleTrie
7: /// @notice SecureMerkleTrie is a thin wrapper around the MerkleTrie library that hashes the input
8: ///         keys. Ethereum's state trie hashes input keys before storing them.
10: /// @notice Verifies a proof that a given key/value pair is present in the Merkle trie.
11: /// @param _key   Key of the node to search for, as a hex string.
12: /// @param _value Value of the node to search for, as a hex string.
13: /// @param _proof Merkle trie inclusion proof for the desired node. Unlike traditional Merkle
14: ///               trees, this proof is executed top-down and consists of a list of RLP-encoded
15: ///               nodes that make a path down to the target node.
16: /// @param _root  Known root of the Merkle trie. Used to verify that the included proof is
17: ///               correctly constructed.
18: /// @return valid_ Whether or not the proof is valid.
33: /// @notice Retrieves the value associated with a given key.
34: /// @param _key   Key to search for, as hex bytes.
35: /// @param _proof Merkle trie inclusion proof for the key.
36: /// @param _root  Known root of the Merkle trie.
37: /// @return value_ Value of the key if it exists.
51: /// @notice Computes the hashed version of the input key.
52: /// @param _key Key to hash.
53: /// @return hash_ Hashed version of the key.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L18) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L37) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L53)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

70: //  * the scale factor s = ~6.031367120...,
71: //  * the 2**k factor from the range reduction, and
72: //  * the 1e18 / 2**96 factor for base converison.
```
[70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L70) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L71) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L72)

```solidity
File: packages/protocol/contracts/verifiers/IVerifier.sol

6: /// @title IVerifier
7: /// @notice Defines the function that handles proof verification.
8: /// @custom:security-contact security@taiko.xyz
20: /// @notice Verifies a proof.
21: /// @param _ctx The context of the proof verification.
22: /// @param _tran The transition to verify.
23: /// @param _proof The proof to verify.
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L8) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L23)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

8: /// @title GuardianVerifier
9: /// @custom:security-contact security@taiko.xyz
15: /// @notice Initializes the contract.
16: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
17: /// @param _addressManager The address of the {AddressManager} contract.
22: /// @inheritdoc IVerifier
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L9) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L17) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L22)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

12: /// @title SgxVerifier
13: /// @notice This contract is the implementation of verifying SGX signature proofs
14: /// onchain.
15: /// @dev Please see references below:
16: /// - Reference #1: https://ethresear.ch/t/2fa-zk-rollups-using-sgx/14462
17: /// - Reference #2: https://github.com/gramineproject/gramine/discussions/1579
18: /// @custom:security-contact security@taiko.xyz
20: /// @dev Each public-private key pair (Ethereum address) is generated within
21: /// the SGX program when it boots up. The off-chain remote attestation
22: /// ensures the validity of the program hash and has the capability of
23: /// bootstrapping the network with trustworthy instances.
29: /// @notice The expiry time for the SGX instance.
32: /// @notice A security feature, a delay until an instance is enabled when using onchain RA
33: /// verification
36: /// @dev For gas savings, we shall assign each SGX instance with an id that when we need to
37: /// set a new pub key, just write storage once.
38: /// Slot 1.
41: /// @dev One SGX instance is uniquely identified (on-chain) by it's ECDSA public key
42: /// (or rather ethereum address). Once that address is used (by proof verification) it has to be
43: /// overwritten by a new one (representing the same instance). This is due to side-channel
44: /// protection. Also this public key shall expire after some time
45: /// (for now it is a long enough 6 months setting).
46: /// Slot 2.
49: /// @dev One address shall be registered (during attestation) only once, otherwise it could
50: /// bypass this contract's expiry check by always registering with the same attestation and
51: /// getting multiple valid instanceIds. While during proving, it is technically possible to
52: /// register the old addresses, it is less of a problem, because the instanceId would be the
53: /// same for those addresses and if deleted - the attestation cannot be reused anyways.
54: /// Slot 3.
59: /// @notice Emitted when a new SGX instance is added to the registry, or replaced.
60: /// @param id The ID of the SGX instance.
61: /// @param instance The address of the SGX instance.
62: /// @param replaced The address of the SGX instance that was replaced. If it is the first
63: /// instance, this value is zero address.
64: /// @param validSince The time since the instance is valid.
69: /// @notice Emitted when an SGX instance is deleted from the registry.
70: /// @param id The ID of the SGX instance.
71: /// @param instance The address of the SGX instance.
80: /// @notice Initializes the contract.
81: /// @param _owner The owner of this contract. msg.sender will be used if this value is zero.
82: /// @param _addressManager The address of the {AddressManager} contract.
87: /// @notice Adds trusted SGX instances to the registry.
88: /// @param _instances The address array of trusted SGX instances.
89: /// @return The respective instanceId array per addresses.
98: /// @notice Deletes SGX instances from the registry.
99: /// @param _ids The ids array of SGX instances.
115: /// @notice Adds an SGX instance after the attestation is verified
116: /// @param _attestation The parsed attestation quote.
117: /// @return The respective instanceId
138: /// @inheritdoc IVerifier
165: /// @notice Gets the signed hash for the proof verification.
166: /// @param _tran The transition to verify.
167: /// @param _newInstance The new instance address.
168: /// @param _prover The prover address.
169: /// @param _metaHash The meta hash.
170: /// @return The signed hash.
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L18) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L23) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L29) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L33) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L38) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L42) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L46) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L54) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L64) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L69) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L70) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L71) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L80) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L81) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L82) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L87) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L88) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L89) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L99) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L115) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L116) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L117) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L138) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L165) | [166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L166) | [167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L167) | [168](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L168) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L169) | [170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L170)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

8: /// @title ERC20Airdrop
9: /// @notice Contract for managing Taiko token airdrop for eligible users.
10: /// @custom:security-contact security@taiko.xyz
12: /// @notice The address of the token contract.
15: /// @notice The address of the vault contract.
20: /// @notice Initializes the contract.
21: /// @param _owner The owner of this contract.
22: /// @param _claimStart The start time of the claim period.
23: /// @param _claimEnd The end time of the claim period.
24: /// @param _merkleRoot The merkle root.
25: /// @param _token The address of the token contract.
26: /// @param _vault The address of the vault contract.
45: /// @notice Claims the airdrop for the user and delegates the voting power to the delegatee.
46: /// @param user The address of the user.
47: /// @param amount The amount of tokens to claim.
48: /// @param proof The merkle proof.
49: /// @param delegationData The data for delegating the voting power.
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L10) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L12) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L15) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L26) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L49)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

8: /// @title ERC20Airdrop2
9: /// @notice Contract for managing Taiko token airdrop for eligible users, but the
10: /// withdrawal is not immediate and is subject to a withdrawal window.
11: /// @custom:security-contact security@taiko.xyz
15: /// @notice The address of the token contract.
18: /// @notice The address of the vault contract.
21: /// @notice Represents the token amount for which the user has claimed.
24: /// @notice Represents the already withdrawn amount.
27: /// @notice Length of the withdrawal window.
32: /// @notice Event emitted when a user withdraws their tokens.
33: /// @param user The address of the user.
34: /// @param amount The amount of tokens withdrawn.
46: /// @notice Initializes the contract.
47: /// @param _owner The owner of this contract.
48: /// @param _claimStart The start time of the claim period.
49: /// @param _claimEnd The end time of the claim period.
50: /// @param _merkleRoot The merkle root.
51: /// @param _token The address of the token contract.
52: /// @param _vault The address of the vault contract.
53: /// @param _withdrawalWindow The length of the withdrawal window.
74: /// @notice Claims the airdrop for the user.
75: /// @param user The address of the user.
76: /// @param amount The amount of tokens to claim.
77: /// @param proof The merkle proof.
86: /// @notice External withdraw function
87: /// @param user User address
96: /// @notice Getter for the balance and withdrawal amount per given user
97: /// The 2nd airdrop is subject to an unlock period. User has to claim his
98: /// tokens (within claimStart and claimEnd), but not immediately
99: /// withdrawable. With a time of X (withdrawalWindow) it becomes fully
100: /// withdrawable - and unlocks linearly.
101: /// @param user User address
102: /// @return balance The balance the user successfully claimed
103: /// @return withdrawableAmount The amount available to withdraw
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L11) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L15) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L21) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L24) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L27) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L34) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L53) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L74) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L75) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L76) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L77) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L86) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L87) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L96) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L97) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L101) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L102) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L103)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

7: /// @title ERC721Airdrop
8: /// @custom:security-contact security@taiko.xyz
10: /// @notice The address of the token contract.
13: /// @notice The address of the vault contract.
18: /// @notice Initializes the contract.
19: /// @param _owner The owner of this contract.
20: /// @param _claimStart The start time of the claim period.
21: /// @param _claimEnd The end time of the claim period.
22: /// @param _merkleRoot The merkle root.
23: /// @param _token The address of the token contract.
24: /// @param _vault The address of the vault contract.
43: /// @notice Claims the airdrop for the user.
44: /// @param user The address of the user.
45: /// @param tokenIds The token IDs to claim.
46: /// @param proof The merkle proof.
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L10) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L13) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L24) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L46)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

7: /// @title MerkleClaimable
8: /// @notice Contract for managing Taiko token airdrop for eligible users
9: /// @custom:security-contact security@taiko.xyz
11: /// @notice Mapping of hashes and their claim status
14: /// @notice Merkle root of the tree
17: /// @notice Unix timestamp for claim start
20: /// @notice Unix timestamp for claim end
25: /// @notice Event emitted when a claim is made
26: /// @param hash Hash of the claim
41: /// @notice Set config parameters
42: /// @param _claimStart Unix timestamp for claim start
43: /// @param _claimEnd Unix timestamp for claim end
44: /// @param _merkleRoot Merkle root of the tree
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L9) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L11) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L14) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L17) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L20) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L26) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L42) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L43) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L44)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

9: /// @title TimelockTokenPool
10: /// @notice Contract for managing Taiko tokens allocated to different roles and
11: /// individuals.
12: ///
13: /// Manages Taiko tokens through a three-state lifecycle: "allocated" to
14: /// "granted, owned, and locked," and finally to "granted, owned, and unlocked."
15: /// Allocation doesn't transfer ownership unless specified by grant settings.
16: /// Conditional allocated tokens can be canceled by invoking `void()`, making
17: /// them available for other uses. Once granted and owned, tokens are
18: /// irreversible and their unlock schedules are immutable.
19: ///
20: /// We should deploy multiple instances of this contract for different roles:
21: /// - investors
22: /// - team members, advisors, etc.
23: /// - grant program grantees
24: /// @custom:security-contact security@taiko.xyz
58: /// @notice The Taiko token address.
61: /// @notice The cost token address.
64: /// @notice The shared vault address.
67: /// @notice The total amount of tokens granted.
70: /// @notice The total amount of tokens voided.
73: /// @notice The total amount of tokens withdrawn.
76: /// @notice The total cost paid.
79: /// @notice Mapping of recipient address to grant information.
84: /// @notice Emitted when a grant is made.
85: /// @param recipient The grant recipient address.
86: /// @param grant The grant.
89: /// @notice Emitted when a grant is voided.
90: /// @param recipient The grant recipient address.
91: /// @param amount The amount of tokens voided.
94: /// @notice Emitted when tokens are withdrawn.
95: /// @param recipient The grant recipient address.
96: /// @param to The address where the granted and unlocked tokens shall be sent to.
97: /// @param amount The amount of tokens withdrawn.
98: /// @param cost The cost.
106: /// @notice Initializes the contract.
107: /// @param _owner The owner address.
108: /// @param _taikoToken The Taiko token address.
109: /// @param _costToken The cost token address.
110: /// @param _sharedVault The shared vault address.
131: /// @notice Gives a grant to a address with its own unlock schedule.
132: /// This transaction should happen on a regular basis, e.g., quarterly.
133: /// @param _recipient The grant recipient address.
134: /// @param _grant The grant struct.
146: /// @notice Puts a stop to all grants for a given recipient. Tokens already
147: /// granted to the recipient will NOT be voided but are subject to the
148: /// original unlock schedule.
149: /// @param _recipient The grant recipient address.
160: /// @notice Withdraws all withdrawable tokens.
165: /// @notice Withdraws all withdrawable tokens.
166: /// @param _to The address where the granted and unlocked tokens shall be sent to.
167: /// @param _sig Signature provided by the grant recipient.
175: /// @notice Returns the summary of the grant for a given recipient.
201: /// @notice Returns the grant for a given recipient.
202: /// @param _recipient The grant recipient address.
203: /// @return The grant.
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L24) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L58) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L61) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L64) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L67) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L70) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L73) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L76) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L79) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L84) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L85) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L86) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L89) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L90) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L91) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L94) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L95) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L96) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L97) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L98) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L106) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L107) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L108) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L109) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L110) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L131) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L133) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L134) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L148) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L149) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L160) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L165) | [166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L166) | [167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L167) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L175) | [201](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L201) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L202) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L203)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

1: //SPDX-License-Identifier: MIT
20: /// @title AutomataDcapV3Attestation
21: /// @custom:security-contact security@taiko.xyz
143: /// @dev Provide the raw quote binary as input
144: /// @dev The attestation data (or the returned data of this method)
145: /// is constructed depending on the validity of the quote verification.
146: /// @dev After confirming that a quote has been verified, the attestation's validity then
147: /// depends on the
148: /// status of the associated TCB.
149: /// @dev Example scenarios as below:
150: /// --------------------------------
151: /// @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
152: ///
153: /// @dev For all valid quote verification, the validity of the attestation depends on the status
154: /// of a
155: /// matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
156: /// overwritten
157: /// in derived contracts. (Except for "Revoked" status, which also returns (false,
158: /// INVALID_EXIT_CODE) value)
159: /// @dev For all valid quote verification, returns the following data:
160: /// (_attestationTcbIsValid(), abi.encodePacked(sha256(quote), uint8 exitCode))
161: /// @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum
334: /// --------------- validate parsed quote ---------------
336: /// @dev Provide the parsed quote binary as input
337: /// @dev The attestation data (or the returned data of this method)
338: /// is constructed depending on the validity of the quote verification.
339: /// @dev After confirming that a quote has been verified, the attestation's validity then
340: /// depends on the
341: /// status of the associated TCB.
342: /// @dev Example scenarios as below:
343: /// --------------------------------
344: /// @dev Invalid quote verification: returns (false, INVALID_EXIT_CODE)
345: ///
346: /// @dev For all valid quote verification, the validity of the attestation depends on the status
347: /// of a
348: /// matching TCBInfo and this is defined in the _attestationTcbIsValid() method, which can be
349: /// overwritten
350: /// in derived contracts. (Except for "Revoked" status, which also returns (false,
351: /// INVALID_EXIT_CODE) value)
352: /// @dev For all valid quote verification, returns the following data:
353: /// (_attestationTcbIsValid())
354: /// @dev exitCode is defined in the {{ TCBInfoStruct.TCBStatus }} enum
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L1) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L21) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L143) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L144) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L145) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L148) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L149) | [150](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L150) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L151) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L152) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L153) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L154) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L155) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L156) | [157](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L157) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L158) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L159) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L160) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L161) | [334](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L334) | [336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L336) | [337](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L337) | [338](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L338) | [339](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L339) | [340](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L340) | [341](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L341) | [342](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L342) | [343](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L343) | [344](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L344) | [345](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L345) | [346](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L346) | [347](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L347) | [348](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L348) | [349](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L349) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L350) | [351](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L351) | [352](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L352) | [353](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L353) | [354](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L354)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

1: //SPDX-License-Identifier: MIT
6: /// @title IAttestation
7: /// @custom:security-contact security@taiko.xyz
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L1) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L7)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

1: //SPDX-License-Identifier: MIT
4: /// @title ISigVerifyLib
5: /// @custom:security-contact security@taiko.xyz
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L1) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L5)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol

1: //SPDX-License-Identifier: MIT
4: /// @title EnclaveIdStruct
5: /// @custom:security-contact security@taiko.xyz
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L1) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L5)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

4: /// @title IPEMCertChainLib
5: /// @custom:security-contact security@taiko.xyz
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L5)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

10: /// @title PEMCertChainLib
11: /// @custom:security-contact security@taiko.xyz
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L11)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

1: //SPDX-License-Identifier: MIT
9: /// @title V3Parser
10: /// @custom:security-contact security@taiko.xyz
238: /// enclaveReport to bytes for hash calculation.
239: /// the only difference between enclaveReport and packedQEReport is the
240: /// order of isvProdId and isvSvn. enclaveReport is in little endian, while
241: /// in bytes should be in big endian according to Intel spec.
242: /// @param enclaveReport enclave report
243: /// @return packedQEReport enclave report in bytes
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L1) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L10) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L238) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L239) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L240) | [241](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L241) | [242](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L242) | [243](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L243)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

1: //SPDX-License-Identifier: MIT
4: /// @title V3Struct
5: /// @custom:security-contact security@taiko.xyz
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L1) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L5)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol

1: //SPDX-License-Identifier: MIT
4: /// @title TCBInfoStruct
5: /// @custom:security-contact security@taiko.xyz
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L1) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L5)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

10: /// @title NodePtr
11: /// @custom:security-contact security@taiko.xyz
36: /// @title Asn1Decode
37: /// @custom:security-contact security@taiko.xyz
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L11) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L37)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

6: /// @title BytesUtils
7: /// @custom:security-contact security@taiko.xyz
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L7)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

32: /// @title RsaVerify
33: /// @custom:security-contact security@taiko.xyz
117: //    digestAlgorithm AlgorithmIdentifier,
118: //      [optional algorithm parameters]
119: //    digest OCTET STRING
264: //    digestAlgorithm AlgorithmIdentifier,
265: //    digest OCTET STRING
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L33) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L117) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L118) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L119) | [264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L264) | [265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L265)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

8: /// @title SHA1
9: /// @custom:security-contact security@taiko.xyz
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L9)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

8: /// @title SigVerifyLib
9: /// @custom:security-contact security@taiko.xyz
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L9)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

5: /// @title X509DateUtils
6: /// @custom:security-contact security@taiko.xyz
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L6)
</details>

### [N-46] Unused `error` definition

Custom errors that aren't utilized within the contract add unnecessary complexity to the codebase. 
Cleaning up and removing these unused custom errors can enhance the readability and maintainability of the contract.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/TaikoErrors.sol

/// @audit Custom Error `L1_TOO_MANY_TIERS` declared but never used
36: error L1_TOO_MANY_TIERS();
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L36)
</details>

### [N-47] Critical system parameter changes should be behind a timelock

It is a good practice to give time for users to react and adjust to critical changes. A timelock provides more guarantees and reduces the level of trust required, thus decreasing risk for users. It also indicates that the project is legitimate (less risk of a malicious owner making a sandwich attack on a user).

<details>
<summary><i>9 issue instances in 8 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

38: function setAddress(
        uint64 _chainId,
        bytes32 _name,
        address _newAddress
    )
        external
        virtual
        onlyOwner
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L38)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

53: function setGuardians(
        address[] memory _newGuardians,
        uint8 _minGuardians
    )
        external
        onlyOwner
        nonReentrant
    {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L53)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

25: function setConfigAndExcess(
        Config memory _newConfig,
        uint64 _newGasExcess
    )
        external
        virtual
        onlyOwner
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L25)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

80: function setSnapshoter(address _snapshooter) external onlyOwner {
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L80)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

36: function changeMigrationStatus(
        address _migratingAddress,
        bool _migratingInbound
    )
        external
        nonReentrant
        whenNotPaused
        onlyFromOwnerOrNamed("erc20_vault")
    {
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L36)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

148: function changeBridgedToken(
        CanonicalERC20 calldata _ctoken,
        address _btokenNew
    )
        external
        nonReentrant
        whenNotPaused
        onlyOwner
        returns (address btokenOld_)
    {
```
[148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L148)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

45: function setConfig(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        external
        onlyOwner
    {
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L45)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

64: function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
68: function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L64) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L68)
</details>

### [N-48] Library Should be in a Separate File

Libraries should be declared in a separate file, variables/structs/errors/enums/constants etc should not be declared in the same file as library.
If they used in library, they should be declared in library scope.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

37: library LibTiers {
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L37)
</details>

### [N-49] Ensure Non-Empty Check for Bytes in Function Parameters

To avoid mistakenly accepting empty bytes as valid parameters, it is advisable to implement checks for non-empty bytes within functions.
This ensures that empty bytes are not treated as valid inputs, preventing potential issues.

<details>
<summary><i>100 issue instances in 34 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/IAddressManager.sol

14: function getAddress(uint64 _chainId, bytes32 _name) external view returns (address);
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L14)

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

38: function setAddress(
        uint64 _chainId,
        bytes32 _name,
        address _newAddress
    )
        external
        virtual
        onlyOwner
    {
54: function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L38) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L54)

```solidity
File: packages/protocol/contracts/common/IAddressResolver.sol

19: function resolve(
        bytes32 _name,
        bool _allowZeroAddress
    )
        external
        view
        returns (address payable);
34: function resolve(
        uint64 _chainId,
        bytes32 _name,
        bool _allowZeroAddress
    )
        external
        view
        returns (address payable);
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L19) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L34)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

30: function resolve(
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
    {
43: function resolve(
        uint64 _chainId,
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
    {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L30) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L43)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
    {
```
[89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89)

```solidity
File: packages/protocol/contracts/L1/hooks/IHook.sol

13: function onBlockProposed(
        TaikoData.Block memory _blk,
        TaikoData.BlockMetadata memory _meta,
        bytes memory _data
    )
        external
        payable;
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L13)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

62: function onBlockProposed(
        TaikoData.Block memory _blk,
        TaikoData.BlockMetadata memory _meta,
        bytes memory _data
    )
        external
        payable
        nonReentrant
        onlyFromNamed("taiko")
    {
137: function hashAssignment(
        ProverAssignment memory _assignment,
        address _taikoL1Address,
        bytes32 _blobHash
    )
        public
        view
        returns (bytes32)
    {
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L62) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L137)

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

14: function proposeBlock(
        bytes calldata _params,
        bytes calldata _txList
    )
        external
        payable
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_);
14: function proposeBlock(
        bytes calldata _params,
        bytes calldata _txList
    )
        external
        payable
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_);
27: function proveBlock(uint64 _blockId, bytes calldata _input) external;
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L14) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L14) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L27)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

23: function getTransition(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint64 _blockId,
        bytes32 _parentHash
    )
        external
        view
        returns (TaikoData.TransitionState storage)
    {
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L23)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

47: function init(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        bytes32 _genesisBlockHash
    )
        external
    {
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L47)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

101: function isApproved(bytes32 _hash) public view returns (bool) {
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L101)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
    {
55: function proposeBlock(
        bytes calldata _params,
        bytes calldata _txList
    )
        external
        payable
        nonReentrant
        whenNotPaused
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
55: function proposeBlock(
        bytes calldata _params,
        bytes calldata _txList
    )
        external
        payable
        nonReentrant
        whenNotPaused
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
75: function proveBlock(
        uint64 _blockId,
        bytes calldata _input
    )
        external
        nonReentrant
        whenNotPaused
        whenProvingNotPaused
    {
137: function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
162: function getTransition(
        uint64 _blockId,
        bytes32 _parentHash
    )
        public
        view
        returns (TaikoData.TransitionState memory)
    {
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L55) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L55) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L75) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L137) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L162)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

36: function onMessageInvocation(bytes calldata _data)
        external
        payable
        whenNotPaused
        onlyFromNamed("bridge")
    {
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L36)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

107: function anchor(
        bytes32 _l1BlockHash,
        bytes32 _l1StateRoot,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        external
        nonReentrant
    {
107: function anchor(
        bytes32 _l1BlockHash,
        bytes32 _l1StateRoot,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        external
        nonReentrant
    {
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L107) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L107)

```solidity
File: packages/protocol/contracts/signal/ISignalService.sol

59: function sendSignal(bytes32 _signal) external returns (bytes32 slot_);
68: function syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        returns (bytes32 signal_);
68: function syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        returns (bytes32 signal_);
84: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        external;
84: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        external;
96: function isSignalSent(address _app, bytes32 _signal) external view returns (bool);
105: function isChainDataSynced(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        view
        returns (bool);
105: function isChainDataSynced(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        view
        returns (bool);
122: function getSyncedChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        external
        view
        returns (uint64 blockId_, bytes32 chainData_);
137: function signalForChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        external
        pure
        returns (bytes32 signal_);
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L59) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L68) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L68) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L84) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L84) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L96) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L105) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L105) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L122) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L137)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

63: function sendSignal(bytes32 _signal) external returns (bytes32) {
68: function syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        returns (bytes32)
    {
68: function syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        returns (bytes32)
    {
137: function isChainDataSynced(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        public
        view
        nonZeroValue(_chainData)
        returns (bool)
    {
137: function isChainDataSynced(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        public
        view
        nonZeroValue(_chainData)
        returns (bool)
    {
153: function isSignalSent(address _app, bytes32 _signal) public view returns (bool) {
158: function getSyncedChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        public
        view
        returns (uint64 blockId_, bytes32 chainData_)
    {
177: function signalForChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        public
        pure
        returns (bytes32)
    {
194: function getSignalSlot(
        uint64 _chainId,
        address _app,
        bytes32 _signal
    )
        public
        pure
        returns (bytes32)
    {
```
[63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L63) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L68) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L68) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L137) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L137) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L153) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L158) | [177](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L177) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L194)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

120: function recallMessage(Message calldata _message, bytes calldata _proof) external;
130: function processMessage(Message calldata _message, bytes calldata _proof) external;
164: function onMessageRecalled(
        IBridge.Message calldata _message,
        bytes32 _msgHash
    )
        external
        payable;
178: function onMessageInvocation(bytes calldata _data) external payable;
```
[120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L120) | [130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L130) | [164](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L164) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L178)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

155: function recallMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.srcChainId)
    {
217: function processMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.destChainId)
    {
352: function proveMessageFailed(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
    {
374: function proveMessageReceived(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
    {
456: function signalForFailedMessage(bytes32 _msgHash) public pure returns (bytes32) {
```
[155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L155) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L217) | [352](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L352) | [374](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L374) | [456](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L456)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

39: function supportsInterface(bytes4 _interfaceId) public view virtual override returns (bool) {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L39)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

93: function onMessageInvocation(bytes calldata data) external payable nonReentrant whenNotPaused {
127: function onMessageRecalled(
        IBridge.Message calldata message,
        bytes32 msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
192: function supportsInterface(bytes4 interfaceId)
        public
        view
        virtual
        override(BaseVault, ERC1155ReceiverUpgradeable)
        returns (bool)
    {
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L93) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L127) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L192)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

253: function onMessageInvocation(bytes calldata _data)
        external
        payable
        nonReentrant
        whenNotPaused
    {
285: function onMessageRecalled(
        IBridge.Message calldata _message,
        bytes32 _msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
```
[253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L253) | [285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L285)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

77: function onMessageInvocation(bytes calldata _data)
        external
        payable
        nonReentrant
        whenNotPaused
    {
110: function onMessageRecalled(
        IBridge.Message calldata _message,
        bytes32 _msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L77) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L110)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

171: function getSignedHash(
        TaikoData.Transition memory _tran,
        address _newInstance,
        address _prover,
        bytes32 _metaHash
    )
        public
        view
        returns (bytes32)
    {
```
[171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L171)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
50: function claimAndDelegate(
        address user,
        uint256 amount,
        bytes32[] calldata proof,
        bytes calldata delegationData
    )
        external
        nonReentrant
    {
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L50)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

45: function setConfig(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        external
        onlyOwner
    {
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L45)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

168: function withdraw(address _to, bytes memory _sig) external {
```
[168](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L168)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

64: function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
68: function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
137: function verifyAttestation(bytes calldata data) external view override returns (bool) {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L64) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L68) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L137)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

9: function verifyAttestation(bytes calldata data) external returns (bool);
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L9)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

37: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        external
        view
        returns (bool);
37: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        external
        view
        returns (bool);
47: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        external
        view
        returns (bool);
47: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        external
        view
        returns (bool);
57: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
57: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
57: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
66: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
66: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
66: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
75: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
75: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
75: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L37) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L37) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L47) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L47) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L57) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L57) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L57) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L66) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L66) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L66) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L75) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L75) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L75)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

35: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs);
43: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert);
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L35) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L43)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

39: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs)
    {
73: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L39) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L73)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

23: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
    {
23: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
    {
53: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
    {
53: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
    {
78: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
78: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
78: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
95: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
95: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
95: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L23) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L23) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L53) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L53) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L78) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L78) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L78) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L95) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L95) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L95)
</details>

### [N-50] Adding a `return` statement when the function defines a named return variable, is redundant

Functions in Solidity can use named return variables which can enhance readability and reduce the complexity of the code. When using named return variables, a return statement without any parameters is implicitly added to the end of the function.
This means that explicitly writing return in a function that uses named return variables is redundant.
This redundancy could lead to confusion and misinterpretation of the function's behavior, particularly for developers who are new to the Solidity language or to the codebase.

Moreover, explicitly stating the return statement with the named variables might give the impression that the function could have different exit points or that it might return different values, which is not the case here.
Therefore, removing these redundant return statements can lead to cleaner, more maintainable code with reduced cognitive load for developers.
This helps in understanding the flow and the logic of the function at a quick glance and aids in faster debugging and fewer mistakes.

<details>
<summary><i>10 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

/// @audit - Redundant `return out_;` when function has named return variables
277: function _copy(
        MemoryPointer _src,
        uint256 _offset,
        uint256 _length
    )
        private
        pure
        returns (bytes memory out_)
    {
```
[277](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L277)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

/// @audit - Redundant `return value_;` when function has named return variables
/// @audit - Redundant `return value_;` when function has named return variables
68: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit - Redundant `if (block.timestamp < claimEnd) return (balance, 0);` when function has named return variables
104: function getBalance(address user)
        public
        view
        returns (uint256 balance, uint256 withdrawableAmount)
    {
```
[104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L104)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit - Redundant `return (
            miscselectMatched && attributesMatched && mrsignerMatched && isvprodidMatched
                && tcbFound,
            status
        );` when function has named return variables
174: function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)
        private
        view
        returns (bool, EnclaveIdStruct.EnclaveIdStatus status)
    {
/// @audit - Redundant `return (!tcbIsRevoked, status);` when function has named return variables
```
[174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L174)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit - Redundant `return (false, certs);` when function has named return variables
39: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs)
    {
/// @audit - Redundant `return (false, cert);` when function has named return variables
/// @audit - Redundant `return (false, cert);` when function has named return variables
/// @audit - Redundant `return (false, cert);` when function has named return variables
/// @audit - Redundant `return (false, cert);` when function has named return variables
/// @audit - Redundant `return (false, cert);` when function has named return variables
73: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
/// @audit - Redundant `return (false, extracted, endIndex);` when function has named return variables
/// @audit - Redundant `return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);` when function has named return variables
/// @audit - Redundant `return (false, pcesvn, cpusvns, fmspcBytes, pceidBytes);` when function has named return variables
268: function _findPckTcbInfo(
        bytes memory der,
        uint256 tbsPtr,
        uint256 tbsParentPtr
    )
        private
        pure
        returns (
            bool success,
            uint256 pcesvn,
            uint256[] memory cpusvns,
            bytes memory fmspcBytes,
            bytes memory pceidBytes
        )
    {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L39) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L73) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L268)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

/// @audit - Redundant `return (false, v3ParsedQuote);` when function has named return variables
/// @audit - Redundant `return (false, v3ParsedQuote);` when function has named return variables
/// @audit - Redundant `return (false, v3ParsedQuote);` when function has named return variables
/// @audit - Redundant `return (false, v3ParsedQuote);` when function has named return variables
20: function parseInput(
        bytes memory quote,
        address pemCertLibAddr
    )
        internal
        pure
        returns (bool success, V3Struct.ParsedV3QuoteStruct memory v3ParsedQuote)
    {
/// @audit - Redundant `return (false, header);` when function has named return variables
/// @audit - Redundant `return (false, header);` when function has named return variables
/// @audit - Redundant `return (false, header);` when function has named return variables
/// @audit - Redundant `return (false, header);` when function has named return variables
164: function parseAndVerifyHeader(bytes memory rawHeader)
        private
        pure
        returns (bool success, V3Struct.Header memory header)
    {
/// @audit - Redundant `return (false, authDataV3);` when function has named return variables
202: function parseAuthDataAndVerifyCertType(
        bytes memory rawAuthData,
        address pemCertLibAddr
    )
        private
        pure
        returns (bool success, V3Struct.ECDSAQuoteV3AuthData memory authDataV3)
    {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L20) | [164](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L164) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L202)
</details>

### [N-51] Assembly blocks should have extensive comments

Large assembly blocks require extensive comments to aid understanding and code auditing. Assembly code takes more time to audit than normal Solidity code and often contains intricate details that aren't as apparent as in higher-level languages.

The identified assembly blocks in your contract appear to lack sufficient comments. Consider adding more comments explaining what each step of the assembly code does.

<details>
<summary><i>33 issue instances in 11 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

121: assembly {
                tstore(_REENTRY_SLOT, _reentry)
            }
132: assembly {
                reentry_ := tload(_REENTRY_SLOT)
            }
```
[121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L121) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L132)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

53: assembly {
            first := mload(add(ret, 32))
            second := mload(add(ret, 64))
        }
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L53)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

241: assembly {
            publicInputHashOld := keccak256(inputs, 8192 /*mul(256, 32)*/ )
        }
247: assembly {
            publicInputHashNew := keccak256(inputs, 8192 /*mul(256, 32)*/ )
        }
```
[241](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L241) | [247](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L247)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

265: assembly {
            sstore(slot_, _value)
        }
309: assembly {
            value_ := sload(slot)
        }
```
[265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L265) | [309](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L309)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

543: assembly {
                tstore(_CTX_SLOT, _msgHash)
                tstore(add(_CTX_SLOT, 1), _from)
                tstore(add(_CTX_SLOT, 2), _srcChainId)
            }
560: assembly {
                msgHash := tload(_CTX_SLOT)
                from := tload(add(_CTX_SLOT, 1))
                srcChainId := tload(add(_CTX_SLOT, 2))
            }
```
[543](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L543) | [560](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L560)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

43: assembly {
            _success :=
                call(
                    _gas, // gas
                    _target, // recipient
                    _value, // ether value
                    add(_calldata, 0x20), // inloc
                    mload(_calldata), // inlen
                    0, // outloc
                    0 // outlen
                )
            // limit our copy to 256 bytes
            _toCopy := returndatasize()
            if gt(_toCopy, _maxCopy) { _toCopy := _maxCopy }
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L43)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

104: assembly {
            // Grab a free memory offset for the new array
            _nibbles := mload(0x40)

            // Load the length of the passed bytes array from memory
            let bytesLength := mload(_bytes)

            // Calculate the length of the new nibble array
            // This is the length of the input array times 2
            let nibblesLength := shl(0x01, bytesLength)

            // Update the free memory pointer to allocate memory for the new array.
            // To do this, we add the length of the new array + 32 bytes for the array length
            // rounded up to the nearest 32 byte boundary to the current free memory pointer.
            mstore(0x40, add(_nibbles, and(not(0x1F), add(nibblesLength, 0x3F))))

            // Store the length of the new array in memory
            mstore(_nibbles, nibblesLength)

            // Store the memory offset of the _bytes array's contents on the stack
            let bytesStart := add(_bytes, 0x20)

            // Store the memory offset of the nibbles array's contents on the stack
            let nibblesStart := add(_nibbles, 0x20)

            // Loop through each byte in the input array
            for { let i := 0x00 } lt(i, bytesLength) { i := add(i, 0x01) } {
```
[104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L104)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

43: assembly {
            ptr := add(_in, 32)
        }
94: assembly {
            mstore(out_, itemCount)
        }
159: assembly {
            prefix := byte(0, mload(ptr))
        }
178: assembly {
                firstByteOfContent := and(mload(add(ptr, 1)), shl(248, 0xff))
            }
198: assembly {
                firstByteOfContent := and(mload(add(ptr, 1)), shl(248, 0xff))
            }
208: assembly {
                strLen := shr(sub(256, mul(8, lenOfStrLen)), mload(add(ptr, 1)))
            }
244: assembly {
                firstByteOfContent := and(mload(add(ptr, 1)), shl(248, 0xff))
            }
254: assembly {
                listLen := shr(sub(256, mul(8, lenOfListLen)), mload(add(ptr, 1)))
            }
295: assembly {
            let dest := add(out_, 32)
            let i := 0
            for { } lt(i, _length) { i := add(i, 32) } { mstore(add(dest, i), mload(add(src, i))) }
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L43) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L94) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L159) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L178) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L198) | [208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L208) | [244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L244) | [254](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L254) | [295](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L295)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

26: assembly {
            ret := keccak256(add(add(self, 32), offset), len)
        }
75: assembly {
            selfptr := add(self, add(offset, 32))
            otherptr := add(other, add(otheroffset, 32))
        }
83: assembly {
                a := mload(selfptr)
                b := mload(otherptr)
            }
200: assembly {
            ret := and(mload(add(add(self, 2), idx)), 0xFFFF)
        }
213: assembly {
            ret := and(mload(add(add(self, 4), idx)), 0xFFFFFFFF)
        }
226: assembly {
            ret := mload(add(add(self, 32), idx))
        }
239: assembly {
            ret :=
                and(
                    mload(add(add(self, 32), idx)),
                    0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000000
                )
        }
266: assembly {
            let mask := not(sub(exp(256, sub(32, len)), 1))
            ret := and(mload(add(add(self, 32), idx)), mask)
        }
273: assembly {
            mcopy(dest, src, len)
        }
298: assembly {
            dest := add(ret, 32)
            src := add(add(self, 32), offset)
        }
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L26) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L75) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L83) | [200](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L200) | [213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L213) | [226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L226) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L239) | [266](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L266) | [273](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L273) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L298)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

99: assembly {
            pop(
                staticcall(
                    sub(gas(), 2000),
                    5,
                    add(input, 0x20),
                    inputlen,
                    add(decipher, 0x20),
                    decipherlen
                )
            )
        }
247: assembly {
            pop(
                staticcall(
                    sub(gas(), 2000),
                    5,
                    add(input, 0x20),
                    inputlen,
                    add(decipher, 0x20),
                    decipherlen
                )
            )
        }
```
[99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L99) | [247](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L247)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

12: assembly {
            // Get a safe scratch location
            let scratch := mload(0x40)

            // Get the data length, and point data at the first byte
            let len := mload(data)
            data := add(data, 32)

            // Find the length after padding
            let totallen := add(and(add(len, 1), 0xFFFFFFFFFFFFFFC0), 64)
            switch lt(sub(totallen, len), 9)
            case 1 { totallen := add(totallen, 64) }
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L12)
</details>

### [N-52] Use `bytes.concat()` instead of `abi.encodePacked()`

Solidity version 0.8.4 introduces `bytes.concat()` for concatenating byte arrays, which is more efficient than using `abi.encodePacked()`.
It is recommended to use `bytes.concat()` instead of `abi.encodePacked()` and upgrade to at least Solidity version 0.8.4 if required.

<details>
<summary><i>24 issue instances in 14 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

44: abi.encodePacked(_blobHash, _x, _y, _commitment, _pointProof)
```
[44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L44)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

48: SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash);
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L48)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

204: meta_.difficulty = keccak256(abi.encodePacked(block.prevrandao, b.numBlocks, block.number));
```
[204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L204)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

203: return keccak256(abi.encodePacked("SIGNAL", _chainId, _app, _signal));
```
[203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L203)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

109: abi.encodePacked(
```
[109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L109)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

54: abi.encodePacked(
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L54)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

17: out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);
56: bytes memory b = abi.encodePacked(_x);
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L17) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L56)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

81: bytes memory currentNodeID = abi.encodePacked(_root);
94: Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
100: Bytes.equal(abi.encodePacked(keccak256(currentNode.encoded)), currentNodeID),
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L81) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L94) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L100)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

55: hash_ = abi.encodePacked(keccak256(_key));
```
[55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L55)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

170: bytes32 hash = keccak256(abi.encodePacked("Withdraw unlocked Taiko token to: ", _to));
```
[170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L170)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

160: /// (_attestationTcbIsValid(), abi.encodePacked(sha256(quote), uint8 exitCode))
163: bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);
315: abi.encodePacked(authDataV3.ecdsaAttestationKey, authDataV3.qeAuthData.data);
369: bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);
482: retData = abi.encodePacked(sha256(abi.encode(v3quote)), tcbStatus);
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L160) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L163) | [315](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L315) | [369](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L369) | [482](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L482)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

14: // If RSA, pubKey = abi.encodePacked(exponent, modulus)
15: // If ECDSA, pubKey = abi.encodePacked(gx, gy)
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L15)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

181: cert.signature = abi.encodePacked(sigX, sigY);
```
[181](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L181)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

119: bytes memory headerBytes = abi.encodePacked(
129: signedQuoteData = abi.encodePacked(headerBytes, V3Parser.packQEReport(localEnclaveReport));
251: packedQEReport = abi.encodePacked(
```
[119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L119) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L129) | [251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L251)
</details>

### [N-53] Function/Constructor Argument Names Not in mixedCase

Underscore before of after function argument names is a common convention in Solidity NOT a documentation requirement.

Function arguments should use mixedCase for better readability and consistency with Solidity style guidelines. 
Examples of good practice include: initialSupply, account, recipientAddress, senderAddress, newOwner. 
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#function-argument-names)

Rule exceptions
- Allow constant variable name/symbol/decimals to be lowercase (ERC20).
- Allow `_` at the beginning of the mixedCase match for `private variables` and `unused parameters`.

<details>
<summary><i>235 issue instances in 54 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

30: function init(address _owner) external initializer {
38: function setAddress(
        uint64 _chainId,
        bytes32 _name,
        address _newAddress
    )
        external
        virtual
        onlyOwner
    {
54: function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L30) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L38) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L54)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

30: function resolve(
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
    {
43: function resolve(
        uint64 _chainId,
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
    {
58: function __AddressResolver_init(address _addressManager) internal virtual onlyInitializing {
72: function _resolve(
        uint64 _chainId,
        bytes32 _name,
        bool _allowZeroAddress
    )
        private
        view
        returns (address payable addr_)
    {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L30) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L43) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L58) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L72)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

95: function __Essential_init(
        address _owner,
        address _addressManager
    )
        internal
        virtual
        onlyInitializing
    {
108: function __Essential_init(address _owner) internal virtual {
119: function _storeReentryLock(uint8 _reentry) internal virtual {
```
[95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L95) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L108) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L119)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

30: function evaluatePoint(
        bytes32 _blobHash,
        uint256 _x,
        uint256 _y,
        bytes1[48] memory _commitment,
        bytes1[48] memory _pointProof
    )
        internal
        view
    {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L30)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

22: function sendEther(address _to, uint256 _amount, uint256 _gasLimit) internal {
42: function sendEther(address _to, uint256 _amount) internal {
45: function supportsInterface(
        address _addr,
        bytes4 _interfaceId
    )
        internal
        view
        returns (bool result_)
    {
60: function isValidSignature(
        address _addr,
        bytes32 _hash,
        bytes memory _sig
    )
        internal
        view
        returns (bool)
    {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L22) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L42) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L45) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L60)

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

12: function min(uint256 _a, uint256 _b) internal pure returns (uint256) {
20: function max(uint256 _a, uint256 _b) internal pure returns (uint256) {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L12) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L20)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

34: function verifyMerkleProof(
        bytes32 _rootHash,
        address _addr,
        bytes32 _slot,
        bytes32 _value,
        bytes[] memory _accountProof,
        bytes[] memory _storageProof
    )
        internal
        pure
        returns (bytes32 storageRoot_)
    {
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L34)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

31: function init(
        address _owner,
        IVotesUpgradeable _token,
        TimelockControllerUpgradeable _timelock
    )
        external
        initializer
    {
48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
    {
99: function state(uint256 _proposalId)
        public
        view
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (ProposalState)
    {
126: function _execute(
        uint256 _proposalId,
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
    {
139: function _cancel(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (uint256)
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L31) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L99) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L126) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L139)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

15: function init(address _owner, uint256 _minDelay) external initializer {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L15)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

57: function init(address _owner, address _addressManager) external initializer {
62: function onBlockProposed(
        TaikoData.Block memory _blk,
        TaikoData.BlockMetadata memory _meta,
        bytes memory _data
    )
        external
        payable
        nonReentrant
        onlyFromNamed("taiko")
    {
137: function hashAssignment(
        ProverAssignment memory _assignment,
        address _taikoL1Address,
        bytes32 _blobHash
    )
        public
        view
        returns (bytes32)
    {
163: function _getProverFee(
        TaikoData.TierFee[] memory _tierFees,
        uint16 _tierId
    )
        private
        pure
        returns (uint256)
    {
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L62) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L137) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L163)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

29: function depositEtherToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        address _recipient
    )
        internal
    {
67: function processDeposits(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        address _feeRecipient
    )
        internal
        returns (TaikoData.EthDeposit[] memory deposits_)
    {
122: function canDepositEthToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint256 _amount
    )
        internal
        view
        returns (bool)
    {
149: function _encodeEthDeposit(address _addr, uint256 _amount) private pure returns (uint256) {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L29) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L67) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L122) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L149)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

68: function proposeBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        bytes calldata _data,
        bytes calldata _txList
    )
        internal
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
287: function isBlobReusable(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        bytes32 _blobHash
    )
        internal
        view
        returns (bool)
    {
298: function _isProposerPermitted(
        TaikoData.SlotB memory _slotB,
        IAddressResolver _resolver
    )
        private
        view
        returns (bool)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L68) | [287](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L287) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L298)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

73: function pauseProving(TaikoData.State storage _state, bool _pause) external {
91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
    {
269: function _createTransition(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        TaikoData.Transition memory _tran,
        uint64 slot
    )
        private
        returns (uint32 tid_, TaikoData.TransitionState storage ts_)
    {
350: function _overrideWithHigherProof(
        TaikoData.TransitionState storage _ts,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof,
        ITierProvider.Tier memory _tier,
        IERC20 _tko,
        bool _sameTransition
    )
        private
    {
401: function _checkProverPermission(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        TaikoData.TransitionState storage _ts,
        uint32 _tid,
        ITierProvider.Tier memory _tier
    )
        private
        view
    {
```
[73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L73) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91) | [269](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L269) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L350) | [401](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L401)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

23: function getTransition(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint64 _blockId,
        bytes32 _parentHash
    )
        external
        view
        returns (TaikoData.TransitionState storage)
    {
52: function getBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint64 _blockId
    )
        external
        view
        returns (TaikoData.Block storage blk_, uint64 slot_)
    {
70: function getTransitionId(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        uint64 _slot,
        bytes32 _parentHash
    )
        internal
        view
        returns (uint32 tid_)
    {
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L23) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L52) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L70)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

47: function init(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        bytes32 _genesisBlockHash
    )
        external
    {
85: function verifyBlocks(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _maxBlocksToVerify
    )
        internal
    {
223: function _syncChainData(
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _lastVerifiedBlockId,
        bytes32 _stateRoot
    )
        private
    {
244: function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L47) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L85) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L223) | [244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L244)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

25: function init(address _owner, address _addressManager) external initializer {
35: function approve(
        TaikoData.BlockMetadata calldata _meta,
        TaikoData.Transition calldata _tran,
        TaikoData.TierProof calldata _proof
    )
        external
        whenNotPaused
        nonReentrant
        returns (bool approved_)
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L35)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

53: function setGuardians(
        address[] memory _newGuardians,
        uint8 _minGuardians
    )
        external
        onlyOwner
        nonReentrant
    {
101: function isApproved(bytes32 _hash) public view returns (bool) {
110: function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {
123: function deleteApproval(bytes32 _hash) internal {
127: function isApproved(uint256 _approvalBits) internal view returns (bool) {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L53) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L101) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L110) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L123) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L127)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
    {
55: function proposeBlock(
        bytes calldata _params,
        bytes calldata _txList
    )
        external
        payable
        nonReentrant
        whenNotPaused
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
75: function proveBlock(
        uint64 _blockId,
        bytes calldata _input
    )
        external
        nonReentrant
        whenNotPaused
        whenProvingNotPaused
    {
100: function verifyBlocks(uint64 _maxBlocksToVerify)
        external
        nonReentrant
        whenNotPaused
        whenProvingNotPaused
    {
111: function pauseProving(bool _pause) external {
119: function depositEtherToL2(address _recipient) external payable nonReentrant whenNotPaused {
132: function canDepositEthToL2(uint256 _amount) public view returns (bool) {
137: function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
145: function getBlock(uint64 _blockId)
        public
        view
        returns (TaikoData.Block memory blk_, TaikoData.TransitionState memory ts_)
    {
162: function getTransition(
        uint64 _blockId,
        bytes32 _parentHash
    )
        public
        view
        returns (TaikoData.TransitionState memory)
    {
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L55) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L75) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L100) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L111) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L119) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L132) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L137) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L145) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L162)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
    {
47: function burn(address _from, uint256 _amount) public onlyOwner {
60: function transfer(address _to, uint256 _amount) public override returns (bool) {
70: function transferFrom(
        address _from,
        address _to,
        uint256 _amount
    )
        public
        override
        returns (bool)
    {
82: function _beforeTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20SnapshotUpgradeable)
    {
93: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
104: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
114: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L47) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L60) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L70) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L82) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L93) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L104) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L114)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

15: function init(address _owner) external initializer {
20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L15) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L20)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

15: function init(address _owner) external initializer {
20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
66: function getMinTier(uint256 _rand) public pure override returns (uint16) {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L15) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L20) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

15: function init(address _owner) external initializer {
20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
66: function getMinTier(uint256 _rand) public pure override returns (uint16) {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L15) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L20) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

36: function onMessageInvocation(bytes calldata _data)
        external
        payable
        whenNotPaused
        onlyFromNamed("bridge")
    {
60: function __CrossChainOwned_init(
        address _owner,
        address _addressManager,
        uint64 _ownerChainId
    )
        internal
        virtual
        onlyInitializing
    {
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L36) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L60)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

16: function basefee(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        internal
        pure
        returns (uint256)
    {
33: function _ethQty(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        private
        pure
        returns (uint256)
    {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L16) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L33)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
107: function anchor(
        bytes32 _l1BlockHash,
        bytes32 _l1StateRoot,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        external
        nonReentrant
    {
163: function withdraw(
        address _token,
        address _to
    )
        external
        onlyFromOwnerOrNamed("withdrawer")
        nonReentrant
        whenNotPaused
    {
185: function getBasefee(
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        public
        view
        returns (uint256 basefee_)
    {
200: function getBlockHash(uint64 _blockId) public view returns (bytes32) {
222: function _calcPublicInputHash(uint256 _blockId)
        private
        view
        returns (bytes32 publicInputHashOld, bytes32 publicInputHashNew)
    {
251: function _calc1559BaseFee(
        Config memory _config,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        private
        view
        returns (uint256 basefee_, uint64 gasExcess_)
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L107) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L163) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L185) | [200](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L200) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L222) | [251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L251)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

25: function setConfigAndExcess(
        Config memory _newConfig,
        uint64 _newGasExcess
    )
        external
        virtual
        onlyOwner
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L25)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

48: function init(address _owner, address _addressManager) external initializer {
56: function authorize(address _addr, bool _authorize) external onlyOwner {
63: function sendSignal(bytes32 _signal) external returns (bytes32) {
68: function syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        external
        returns (bytes32)
    {
83: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        public
        virtual
        validSender(_app)
        nonZeroValue(_signal)
    {
137: function isChainDataSynced(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        public
        view
        nonZeroValue(_chainData)
        returns (bool)
    {
153: function isSignalSent(address _app, bytes32 _signal) public view returns (bool) {
158: function getSyncedChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        public
        view
        returns (uint64 blockId_, bytes32 chainData_)
    {
177: function signalForChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        public
        pure
        returns (bytes32)
    {
194: function getSignalSlot(
        uint64 _chainId,
        address _app,
        bytes32 _signal
    )
        public
        pure
        returns (bytes32)
    {
205: function _verifyHopProof(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes32 _value,
        HopProof memory _hop,
        address _signalService
    )
        internal
        virtual
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32)
    {
234: function _syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        private
        returns (bytes32 signal_)
    {
252: function _sendSignal(
        address _app,
        bytes32 _signal,
        bytes32 _value
    )
        private
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32 slot_)
    {
270: function _cacheChainData(
        HopProof memory _hop,
        uint64 _chainId,
        uint64 _blockId,
        bytes32 _signalRoot,
        bool _isFullProof,
        bool _isLastHop
    )
        private
    {
297: function _loadSignalValue(
        address _app,
        bytes32 _signal
    )
        private
        view
        validSender(_app)
        nonZeroValue(_signal)
        returns (bytes32 value_)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L56) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L63) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L68) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L83) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L137) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L153) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L158) | [177](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L177) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L194) | [205](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L205) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L234) | [252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L252) | [270](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L270) | [297](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L297)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

75: function init(address _owner, address _addressManager) external initializer {
82: function suspendMessages(
        bytes32[] calldata _msgHashes,
        bool _suspend
    )
        external
        onlyFromOwnerOrNamed("bridge_watchdog")
    {
101: function banAddress(
        address _addr,
        bool _ban
    )
        external
        onlyFromOwnerOrNamed("bridge_watchdog")
        nonReentrant
    {
115: function sendMessage(Message calldata _message)
        external
        payable
        override
        nonReentrant
        whenNotPaused
        returns (bytes32 msgHash_, Message memory message_)
    {
155: function recallMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.srcChainId)
    {
217: function processMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.destChainId)
    {
310: function retryMessage(
        Message calldata _message,
        bool _isLastAttempt
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.destChainId)
    {
340: function isMessageSent(Message calldata _message) public view returns (bool) {
352: function proveMessageFailed(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
    {
374: function proveMessageReceived(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
    {
392: function isDestChainEnabled(uint64 _chainId)
        public
        view
        returns (bool enabled_, address destBridge_)
    {
449: function hashMessage(Message memory _message) public pure returns (bytes32) {
456: function signalForFailedMessage(bytes32 _msgHash) public pure returns (bytes32) {
477: function _invokeMessageCall(
        Message calldata _message,
        bytes32 _msgHash,
        uint256 _gasLimit
    )
        private
        returns (bool success_)
    {
515: function _updateMessageStatus(bytes32 _msgHash, Status _status) private {
541: function _storeContext(bytes32 _msgHash, address _from, uint64 _srcChainId) private {
577: function _proveSignalReceived(
        address _signalService,
        bytes32 _signal,
        uint64 _chainId,
        bytes calldata _proof
    )
        private
        view
        returns (bool success_)
    {
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L82) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L101) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L115) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L155) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L217) | [310](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L310) | [340](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L340) | [352](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L352) | [374](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L374) | [392](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L392) | [449](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L449) | [456](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L456) | [477](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L477) | [515](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L515) | [541](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L541) | [577](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L577)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
42: function _mintToken(address _account, uint256 _amount) internal override {
46: function _burnToken(address _from, uint256 _amount) internal override {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L42) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L46)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
80: function setSnapshoter(address _snapshooter) external onlyOwner {
128: function _mintToken(address _account, uint256 _amount) internal override {
132: function _burnToken(address _from, uint256 _amount) internal override {
139: function _beforeTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20SnapshotUpgradeable)
    {
151: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
162: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
172: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L80) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L128) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L132) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L139) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L151) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L162) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L172)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

36: function changeMigrationStatus(
        address _migratingAddress,
        bool _migratingInbound
    )
        external
        nonReentrant
        whenNotPaused
        onlyFromOwnerOrNamed("erc20_vault")
    {
57: function mint(address _account, uint256 _amount) public nonReentrant whenNotPaused {
75: function burn(address _account, uint256 _amount) public nonReentrant whenNotPaused {
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L36) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L57) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
54: function mint(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
69: function burn(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
107: function tokenURI(uint256 _tokenId) public view virtual override returns (string memory) {
114: function _beforeTokenTransfer(
        address, /*_from*/
        address _to,
        uint256, /*_firstTokenId*/
        uint256 /*_batchSize*/
    )
        internal
        virtual
        override
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L54) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L69) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L107) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L114)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
66: function mint(
        address _to,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
83: function mintBatch(
        address _to,
        uint256[] memory _tokenIds,
        uint256[] memory _amounts
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
100: function burn(
        address _account,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
124: function _beforeTokenTransfer(
        address, /*_operator*/
        address, /*_from*/
        address _to,
        uint256[] memory, /*_ids*/
        uint256[] memory, /*_amounts*/
        bytes memory /*_data*/
    )
        internal
        virtual
        override
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L66) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L83) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L100) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L124)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

32: function init(address _owner, address _addressManager) external initializer {
39: function supportsInterface(bytes4 _interfaceId) public view virtual override returns (bool) {
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L39)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

39: function sendToken(BridgeTransferOp memory _op)
        external
        payable
        nonReentrant
        whenNotPaused
        withValidOperation(_op)
        returns (IBridge.Message memory message_)
    {
240: function _handleMessage(
        address _user,
        BridgeTransferOp memory _op
    )
        private
        returns (bytes memory msgData_, CanonicalNFT memory ctoken_)
    {
288: function _getOrDeployBridgedToken(CanonicalNFT memory _ctoken)
        private
        returns (address btoken_)
    {
303: function _deployBridgedToken(CanonicalNFT memory _ctoken) private returns (address btoken_) {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L39) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L240) | [288](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L288) | [303](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L303)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

148: function changeBridgedToken(
        CanonicalERC20 calldata _ctoken,
        address _btokenNew
    )
        external
        nonReentrant
        whenNotPaused
        onlyOwner
        returns (address btokenOld_)
    {
207: function sendToken(BridgeTransferOp calldata _op)
        external
        payable
        nonReentrant
        whenNotPaused
        returns (IBridge.Message memory message_)
    {
253: function onMessageInvocation(bytes calldata _data)
        external
        payable
        nonReentrant
        whenNotPaused
    {
285: function onMessageRecalled(
        IBridge.Message calldata _message,
        bytes32 _msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
319: function _transferTokens(
        CanonicalERC20 memory _ctoken,
        address _to,
        uint256 _amount
    )
        private
        returns (address token_)
    {
348: function _handleMessage(
        address _user,
        address _token,
        address _to,
        uint256 _amount
    )
        private
        returns (bytes memory msgData_, CanonicalERC20 memory ctoken_, uint256 balanceChange_)
    {
```
[148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L148) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L207) | [253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L253) | [285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L285) | [319](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L319) | [348](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L348)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

26: function sendToken(BridgeTransferOp memory _op)
        external
        payable
        nonReentrant
        whenNotPaused
        withValidOperation(_op)
        returns (IBridge.Message memory message_)
    {
77: function onMessageInvocation(bytes calldata _data)
        external
        payable
        nonReentrant
        whenNotPaused
    {
110: function onMessageRecalled(
        IBridge.Message calldata _message,
        bytes32 _msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
159: function _transferTokens(
        CanonicalNFT memory _ctoken,
        address _to,
        uint256[] memory _tokenIds
    )
        private
        returns (address token_)
    {
187: function _handleMessage(
        address _user,
        BridgeTransferOp memory _op
    )
        private
        returns (bytes memory msgData_, CanonicalNFT memory ctoken_)
    {
224: function _getOrDeployBridgedToken(CanonicalNFT memory _ctoken)
        private
        returns (address btoken_)
    {
240: function _deployBridgedToken(CanonicalNFT memory _ctoken) private returns (address btoken_) {
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L26) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L77) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L110) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L159) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L187) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L224) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L240)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

10: function validateInputs(
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        internal
        view
    {
27: function buildName(
        string memory _name,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
    {
38: function buildSymbol(string memory _symbol) internal pure returns (string memory) {
42: function buildURI(
        address _srcToken,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
    {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L10) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L27) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L38) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L42)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25: function excessivelySafeCall(
        address _target,
        uint256 _gas,
        uint256 _value,
        uint16 _maxCopy,
        bytes memory _calldata
    )
        internal
        returns (bool, bytes memory)
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

15: function slice(
        bytes memory _bytes,
        uint256 _start,
        uint256 _length
    )
        internal
        pure
        returns (bytes memory)
    {
91: function slice(bytes memory _bytes, uint256 _start) internal pure returns (bytes memory) {
102: function toNibbles(bytes memory _bytes) internal pure returns (bytes memory) {
149: function equal(bytes memory _bytes, bytes memory _other) internal pure returns (bool) {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L15) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L91) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L102) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L149)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

35: function toRLPItem(bytes memory _in) internal pure returns (RLPItem memory out_) {
53: function readList(RLPItem memory _in) internal pure returns (RLPItem[] memory out_) {
102: function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {
109: function readBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {
128: function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {
135: function readRawBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {
144: function _decodeLength(RLPItem memory _in)
        private
        pure
        returns (uint256 offset_, uint256 length_, RLPItemType type_)
    {
277: function _copy(
        MemoryPointer _src,
        uint256 _offset,
        uint256 _length
    )
        private
        pure
        returns (bytes memory out_)
    {
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L35) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L53) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L102) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L109) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L128) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L135) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L144) | [277](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L277)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

13: function writeBytes(bytes memory _in) internal pure returns (bytes memory out_) {
24: function writeUint(uint256 _in) internal pure returns (bytes memory out_) {
32: function _writeLength(uint256 _len, uint256 _offset) private pure returns (bytes memory out_) {
55: function _toBinary(uint256 _x) private pure returns (bytes memory out_) {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L13) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L24) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L32) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L55)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

50: function verifyInclusionProof(
        bytes memory _key,
        bytes memory _value,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bool valid_)
    {
68: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
205: function _parseProof(bytes[] memory _proof) private pure returns (TrieNode[] memory proof_) {
220: function _getNodeID(RLPReader.RLPItem memory _node) private pure returns (bytes memory id_) {
227: function _getNodePath(TrieNode memory _node) private pure returns (bytes memory nibbles_) {
235: function _getSharedNibbleLength(
        bytes memory _a,
        bytes memory _b
    )
        private
        pure
        returns (uint256 shared_)
    {
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L50) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68) | [205](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L205) | [220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L220) | [227](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L227) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L235)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

19: function verifyInclusionProof(
        bytes memory _key,
        bytes memory _value,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bool valid_)
    {
38: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
54: function _getSecureKey(bytes memory _key) private pure returns (bytes memory hash_) {
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L19) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L38) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L54)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

18: function init(address _owner, address _addressManager) external initializer {
23: function verifyProof(
        Context calldata _ctx,
        TaikoData.Transition calldata,
        TaikoData.TierProof calldata
    )
        external
        view
    {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L23)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

83: function init(address _owner, address _addressManager) external initializer {
90: function addInstances(address[] calldata _instances)
        external
        onlyOwner
        returns (uint256[] memory)
    {
100: function deleteInstances(uint256[] calldata _ids)
        external
        onlyFromOwnerOrNamed("rollup_watchdog")
    {
118: function registerInstance(V3Struct.ParsedV3QuoteStruct calldata _attestation)
        external
        returns (uint256)
    {
139: function verifyProof(
        Context calldata _ctx,
        TaikoData.Transition calldata _tran,
        TaikoData.TierProof calldata _proof
    )
        external
        onlyFromNamed("taiko")
    {
171: function getSignedHash(
        TaikoData.Transition memory _tran,
        address _newInstance,
        address _prover,
        bytes32 _metaHash
    )
        public
        view
        returns (bytes32)
    {
194: function _addInstances(
        address[] memory _instances,
        bool instantValid
    )
        private
        returns (uint256[] memory ids)
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83) | [90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L90) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L100) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L118) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L139) | [171](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L171) | [194](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L194)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

54: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault,
        uint64 _withdrawalWindow
    )
        external
        initializer
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L54)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

45: function setConfig(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        external
        onlyOwner
    {
55: function __MerkleClaimable_init(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        internal
        onlyInitializing
    {
76: function _verifyMerkleProof(
        bytes32[] calldata _proof,
        bytes32 _merkleRoot,
        bytes32 _value
    )
        internal
        pure
        virtual
        returns (bool)
    {
89: function _setConfig(uint64 _claimStart, uint64 _claimEnd, bytes32 _merkleRoot) private {
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L45) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L55) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L76) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L89)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

111: function init(
        address _owner,
        address _taikoToken,
        address _costToken,
        address _sharedVault
    )
        external
        initializer
    {
135: function grant(address _recipient, Grant memory _grant) external onlyOwner {
150: function void(address _recipient) external onlyOwner {
168: function withdraw(address _to, bytes memory _sig) external {
176: function getMyGrantSummary(address _recipient)
        public
        view
        returns (
            uint128 amountOwned,
            uint128 amountUnlocked,
            uint128 amountWithdrawn,
            uint128 amountToWithdraw,
            uint128 costToWithdraw
        )
    {
204: function getMyGrant(address _recipient) public view returns (Grant memory) {
207: function _withdraw(address _recipient, address _to) private {
224: function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {
234: function _getAmountOwned(Grant memory _grant) private view returns (uint128) {
238: function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {
244: function _calcAmount(
        uint128 _amount,
        uint64 _start,
        uint64 _cliff,
        uint64 _period
    )
        private
        view
        returns (uint128)
    {
266: function _validateGrant(Grant memory _grant) private pure {
272: function _validateCliff(uint64 _start, uint64 _cliff, uint32 _period) private pure {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L111) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L135) | [150](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L150) | [168](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L168) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L176) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L204) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L207) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L224) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L234) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L238) | [244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L244) | [266](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L266) | [272](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L272)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

64: function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
68: function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L64) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L68)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

28: function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L28)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

43: function pkcs1Sha256(
        bytes32 _sha256,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
191: function pkcs1Sha256Raw(
        bytes memory _data,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
212: function pkcs1Sha1(
        bytes20 _sha1,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
307: function pkcs1Sha1Raw(
        bytes memory _data,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L43) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L191) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L212) | [307](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L307)
</details>

### [N-54] NatSpec: Function `@return` tag is missing

Natural Specification (NatSpec) comments are crucial for understanding the role of function arguments in your Solidity code.
Including `@return` tag will not only improve your code's readability but also its maintainability by clearly defining each argument's purpose.

[More information in Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>97 issue instances in 32 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit Missed @return `reentry_`
130: function _loadReentryLock() internal view virtual returns (uint8 reentry_) {
/// @audit Missed @return ``
140: function _inNonReentrant() internal view returns (bool) {
```
[130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L130) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L140)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

/// @audit Missed @return `result_`
46: function supportsInterface(
        address _addr,
        bytes4 _interfaceId
    )
        internal
        view
        returns (bool result_)
/// @audit Missed @return ``
61: function isValidSignature(
        address _addr,
        bytes32 _hash,
        bytes memory _sig
    )
        internal
        view
        returns (bool)
/// @audit Missed @return ``
77: function isSenderEOA() internal view returns (bool) {
```
[46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L46) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L61) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L77)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit Missed @return ``
48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
/// @audit Missed @return ``
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
/// @audit Missed @return ``
89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
/// @audit Missed @return ``
99: function state(uint256 _proposalId)
        public
        view
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (ProposalState)
/// @audit Missed @return ``
140: function _cancel(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (uint256)
/// @audit Missed @return ``
153: function _executor()
        internal
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (address)
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L99) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L140) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L153)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit Missed @return ``
164: function _getProverFee(
        TaikoData.TierFee[] memory _tierFees,
        uint16 _tierId
    )
        private
        pure
        returns (uint256)
```
[164](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L164)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit Missed @return `deposits_`
67: function processDeposits(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        address _feeRecipient
    )
        internal
        returns (TaikoData.EthDeposit[] memory deposits_)
/// @audit Missed @return ``
122: function canDepositEthToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint256 _amount
    )
        internal
        view
        returns (bool)
```
[67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L67) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L122)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

/// @audit Missed @return ``
299: function _isProposerPermitted(
        TaikoData.SlotB memory _slotB,
        IAddressResolver _resolver
    )
        private
        view
        returns (bool)
```
[299](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L299)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit Missed @return `maxBlocksToVerify_`
91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
/// @audit Missed @return `tid_, ts_`
269: function _createTransition(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        TaikoData.Transition memory _tran,
        uint64 slot
    )
        private
        returns (uint32 tid_, TaikoData.TransitionState storage ts_)
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91) | [269](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L269)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

/// @audit Missed @return `blk_, slot_`
52: function getBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint64 _blockId
    )
        external
        view
        returns (TaikoData.Block storage blk_, uint64 slot_)
/// @audit Missed @return `tid_`
70: function getTransitionId(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        uint64 _slot,
        bytes32 _parentHash
    )
        internal
        view
        returns (uint32 tid_)
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L52) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L70)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit Missed @return ``
245: function _isConfigValid(TaikoData.Config memory _config) private view returns (bool) {
```
[245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L245)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit Missed @return `approved_`
111: function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {
/// @audit Missed @return ``
128: function isApproved(uint256 _approvalBits) internal view returns (bool) {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L111) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L128)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit Missed @return ``
137: function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
```
[137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L137)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

/// @audit Missed @return ``
16: function basefee(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        internal
        pure
        returns (uint256)
/// @audit Missed @return ``
33: function _ethQty(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        private
        pure
        returns (uint256)
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L16) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L33)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit Missed @return `publicInputHashOld, publicInputHashNew`
223: function _calcPublicInputHash(uint256 _blockId)
        private
        view
        returns (bytes32 publicInputHashOld, bytes32 publicInputHashNew)
/// @audit Missed @return `basefee_, gasExcess_`
252: function _calc1559BaseFee(
        Config memory _config,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        private
        view
        returns (uint256 basefee_, uint64 gasExcess_)
```
[223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L223) | [252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L252)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit Missed @return ``
206: function _verifyHopProof(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes32 _value,
        HopProof memory _hop,
        address _signalService
    )
        internal
        virtual
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32)
/// @audit Missed @return `signal_`
235: function _syncChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        private
        returns (bytes32 signal_)
/// @audit Missed @return `slot_`
253: function _sendSignal(
        address _app,
        bytes32 _signal,
        bytes32 _value
    )
        private
        validSender(_app)
        nonZeroValue(_signal)
        nonZeroValue(_value)
        returns (bytes32 slot_)
/// @audit Missed @return `value_`
298: function _loadSignalValue(
        address _app,
        bytes32 _signal
    )
        private
        view
        validSender(_app)
        nonZeroValue(_signal)
        returns (bytes32 value_)
```
[206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L206) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L235) | [253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L253) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L298)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

/// @audit Missed @return ``
101: function _isMigratingOut() internal view returns (bool) {
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L101)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

/// @audit Missed @return `ctx_`
58: function checkRecallMessageContext()
        internal
        view
        onlyFromBridge
        returns (IBridge.Context memory ctx_)
```
[58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L58)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit Missed @return ``
160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
/// @audit Missed @return ``
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit Missed @return `token_`
320: function _transferTokens(
        CanonicalERC20 memory _ctoken,
        address _to,
        uint256 _amount
    )
        private
        returns (address token_)
```
[320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L320)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit Missed @return `token_`
160: function _transferTokens(
        CanonicalNFT memory _ctoken,
        address _to,
        uint256[] memory _tokenIds
    )
        private
        returns (address token_)
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L160)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

/// @audit Missed @return ``
28: function buildName(
        string memory _name,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
/// @audit Missed @return ``
39: function buildSymbol(string memory _symbol) internal pure returns (string memory) {
/// @audit Missed @return ``
43: function buildURI(
        address _srcToken,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L28) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L39) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L43)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

/// @audit Missed @return `r`
13: function exp(int256 x) internal pure returns (int256 r) {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L13)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit Missed @return `ids`
195: function _addInstances(
        address[] memory _instances,
        bool instantValid
    )
        private
        returns (uint256[] memory ids)
/// @audit Missed @return ``
233: function _isInstanceValid(uint256 id, address instance) private view returns (bool) {
```
[195](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L195) | [233](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L233)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

/// @audit Missed @return ``
77: function _verifyMerkleProof(
        bytes32[] calldata _proof,
        bytes32 _merkleRoot,
        bytes32 _value
    )
        internal
        pure
        virtual
        returns (bool)
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L77)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit Missed @return `amountOwned, amountUnlocked, amountWithdrawn, amountToWithdraw, costToWithdraw`
176: function getMyGrantSummary(address _recipient)
        public
        view
        returns (
            uint128 amountOwned,
            uint128 amountUnlocked,
            uint128 amountWithdrawn,
            uint128 amountToWithdraw,
            uint128 costToWithdraw
        )
/// @audit Missed @return `amountVoided`
225: function _voidGrant(Grant storage _grant) private returns (uint128 amountVoided) {
/// @audit Missed @return ``
235: function _getAmountOwned(Grant memory _grant) private view returns (uint128) {
/// @audit Missed @return ``
239: function _getAmountUnlocked(Grant memory _grant) private view returns (uint128) {
/// @audit Missed @return ``
245: function _calcAmount(
        uint128 _amount,
        uint64 _start,
        uint64 _cliff,
        uint64 _period
    )
        private
        view
        returns (uint128)
```
[176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L176) | [225](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L225) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L235) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L239) | [245](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L245)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit Missed @return `valid`
126: function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)
        internal
        pure
        virtual
        returns (bool valid)
/// @audit Missed @return ``
138: function verifyAttestation(bytes calldata data) external view override returns (bool) {
/// @audit Missed @return `, `
162: function _verify(bytes calldata quote) private view returns (bool, bytes memory) {
/// @audit Missed @return `, status`
175: function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)
        private
        view
        returns (bool, EnclaveIdStruct.EnclaveIdStatus status)
/// @audit Missed @return `, status`
206: function _checkTcbLevels(
        IPEMCertChainLib.PCKCertificateField memory pck,
        TCBInfoStruct.TCBInfo memory tcb
    )
        private
        pure
        returns (bool, TCBInfoStruct.TCBStatus status)
/// @audit Missed @return ``
229: function _isCpuSvnHigherOrGreater(
        uint256[] memory pckCpuSvns,
        uint8[] memory tcbCpuSvns
    )
        private
        pure
        returns (bool)
/// @audit Missed @return ``
248: function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
        private
        view
        returns (bool)
/// @audit Missed @return ``
303: function _enclaveReportSigVerification(
        bytes memory pckCertPubKey,
        bytes memory signedQuoteData,
        V3Struct.ECDSAQuoteV3AuthData memory authDataV3,
        V3Struct.EnclaveReport memory qeEnclaveReport
    )
        private
        view
        returns (bool)
/// @audit Missed @return `, `
355: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        view
        override
        returns (bool, bytes memory)
/// @audit Missed @return `, `
364: function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
        internal
        view
        returns (bool, bytes memory)
```
[126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L126) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L162) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L175) | [206](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L206) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L229) | [248](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L248) | [303](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L303) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355) | [364](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L364)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit Missed @return `success, certs`
40: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs)
/// @audit Missed @return `success, cert`
74: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
/// @audit Missed @return `success, extracted, endIndex`
216: function _removeHeadersAndFooters(string memory pemData)
        private
        pure
        returns (bool success, bytes memory extracted, uint256 endIndex)
/// @audit Missed @return `output`
252: function _trimBytes(
        bytes memory input,
        uint256 expectedLength
    )
        private
        pure
        returns (bytes memory output)
/// @audit Missed @return `success, pcesvn, cpusvns, fmspcBytes, pceidBytes`
269: function _findPckTcbInfo(
        bytes memory der,
        uint256 tbsPtr,
        uint256 tbsParentPtr
    )
        private
        pure
        returns (
            bool success,
            uint256 pcesvn,
            uint256[] memory cpusvns,
            bytes memory fmspcBytes,
            bytes memory pceidBytes
        )
/// @audit Missed @return `success, pcesvn, cpusvns`
341: function _findTcb(
        bytes memory der,
        uint256 oidPtr
    )
        private
        pure
        returns (bool success, uint256 pcesvn, uint256[] memory cpusvns)
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L40) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L74) | [216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L216) | [252](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L252) | [269](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L269) | [341](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L341)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

/// @audit Missed @return `success, v3ParsedQuote`
21: function parseInput(
        bytes memory quote,
        address pemCertLibAddr
    )
        internal
        pure
        returns (bool success, V3Struct.ParsedV3QuoteStruct memory v3ParsedQuote)
/// @audit Missed @return `success, header, localEnclaveReport, signedQuoteData, authDataV3`
62: function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
        internal
        pure
        returns (
            bool success,
            V3Struct.Header memory header,
            V3Struct.EnclaveReport memory localEnclaveReport,
            bytes memory signedQuoteData, // concatenation of header and local enclave report bytes
            V3Struct.ECDSAQuoteV3AuthData memory authDataV3
        )
/// @audit Missed @return `enclaveReport`
133: function parseEnclaveReport(bytes memory rawEnclaveReport)
        internal
        pure
        returns (V3Struct.EnclaveReport memory enclaveReport)
/// @audit Missed @return `decoded`
152: function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {
/// @audit Missed @return `success, header`
165: function parseAndVerifyHeader(bytes memory rawHeader)
        private
        pure
        returns (bool success, V3Struct.Header memory header)
/// @audit Missed @return `success, authDataV3`
203: function parseAuthDataAndVerifyCertType(
        bytes memory rawAuthData,
        address pemCertLibAddr
    )
        private
        pure
        returns (bool success, V3Struct.ECDSAQuoteV3AuthData memory authDataV3)
/// @audit Missed @return `certChainData`
267: function parseCerificationChainBytes(
        bytes memory certBytes,
        address pemCertLibAddr
    )
        internal
        pure
        returns (bytes[3] memory certChainData)
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L21) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L62) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L133) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L152) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L165) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L203) | [267](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L267)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

/// @audit Missed @return ``
14: function ixs(uint256 self) internal pure returns (uint256) {
/// @audit Missed @return ``
19: function ixf(uint256 self) internal pure returns (uint256) {
/// @audit Missed @return ``
24: function ixl(uint256 self) internal pure returns (uint256) {
/// @audit Missed @return ``
29: function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {
/// @audit Missed @return ``
165: function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
/// @audit Missed @return ``
169: function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
/// @audit Missed @return ``
187: function _readNodeLength(bytes memory der, uint256 ix) private pure returns (uint256) {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L14) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L19) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L24) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L29) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L165) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L169) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L187)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit Missed @return `ret`
16: function keccak(
        bytes memory self,
        uint256 offset,
        uint256 len
    )
        internal
        pure
        returns (bytes32 ret)
/// @audit Missed @return `ret`
188: function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {
/// @audit Missed @return `ret`
198: function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {
/// @audit Missed @return `ret`
211: function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {
/// @audit Missed @return `ret`
224: function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {
/// @audit Missed @return `ret`
237: function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {
/// @audit Missed @return `ret`
255: function readBytesN(
        bytes memory self,
        uint256 idx,
        uint256 len
    )
        internal
        pure
        returns (bytes32 ret)
/// @audit Missed @return ``
284: function substring(
        bytes memory self,
        uint256 offset,
        uint256 len
    )
        internal
        pure
        returns (bytes memory)
/// @audit Missed @return ``
371: function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L16) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L188) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L198) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L211) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L224) | [237](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L237) | [255](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L255) | [284](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L284) | [371](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L371)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

/// @audit Missed @return `ret`
11: function sha1(bytes memory data) internal pure returns (bytes20 ret) {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L11)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit Missed @return ``
24: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
/// @audit Missed @return ``
54: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
/// @audit Missed @return `sigValid`
79: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
/// @audit Missed @return `sigValid`
96: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
/// @audit Missed @return `sigValid`
113: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L24) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L54) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L79) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L96) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L113)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

/// @audit Missed @return ``
8: function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {
/// @audit Missed @return ``
34: function toUnixTimestamp(
        uint16 year,
        uint8 month,
        uint8 day,
        uint8 hour,
        uint8 minute,
        uint8 second
    )
        internal
        pure
        returns (uint256)
/// @audit Missed @return ``
71: function isLeapYear(uint16 year) internal pure returns (bool) {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L8) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L34) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L71)
</details>

### [N-55] State-Altering Functions Should Emit Events

Functions that alter state should emit events to inform users of the state change.
This is crucial for functions that modify the state and don't return a value.
The absence of events in such scenarios could lead to lack of transparency and traceability, undermining the contract's reliability.

<details>
<summary><i>18 issue instances in 15 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

62: addressManager = _addressManager;
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L62)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

111: __paused = _FALSE;
125: __reentry = _reentry;
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L111) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L125)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

73: ownerChainId = _ownerChainId;
```
[73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L73)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

96: gasExcess = _gasExcess;
```
[96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L96)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

549: __ctx = Context(_msgHash, _from, _srcChainId);
```
[549](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L549)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

40: usdc = _usdc;
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L40)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

73: srcToken = _srcToken;
81: snapshooter = _snapshooter;
```
[73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L73) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L81)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

47: srcToken = _srcToken;
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L47)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

56: srcToken = _srcToken;
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L56)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

41: token = _token;
```
[41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L41)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

69: token = _token;
```
[69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L69)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

39: token = _token;
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L39)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

91: claimStart = _claimStart;
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L91)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

122: taikoToken = _taikoToken;
```
[122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L122)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

119: qeIdentity = qeIdentityInput;
123: _checkLocalEnclaveReport = !_checkLocalEnclaveReport;
```
[119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L119) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L123)
</details>

### [N-56] Contract Doesn't Handle All NFT Types

Supporting both ERC-721 and ERC-1155 standards increases the potential market for your NFT contract.
Consider implementing both standards to reach a broader audience.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit - noERC721Received() not implemented
174: /// @notice See {ERC1155ReceiverUpgradeable-onERC1155Received}.
```
[174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L174)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit - noERC1155Received() not implemented
142: function onERC721Received(
```
[142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L142)
</details>

### [N-57] Upgrade `openzeppelin` to the Latest Version - 5.0.0

These contracts import contracts from @openzeppelin/contracts but they are not using the latest version.
For more information, please visit: [OpenZeppelin GitHub Releases](https://github.com/OpenZeppelin/openzeppelin-contracts/releases)
It is recommended to always use the latest version to take advantage of updates and security fixes.

<details>
<summary><i>54 issue instances in 28 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

4: import "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L4)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

4: import "@openzeppelin/contracts/proxy/utils/UUPSUpgradeable.sol";
5: import "@openzeppelin/contracts-upgradeable/access/Ownable2StepUpgradeable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L5)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

4: import "@openzeppelin/contracts/utils/Address.sol";
5: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
6: import "@openzeppelin/contracts/utils/introspection/IERC165.sol";
7: import "@openzeppelin/contracts/interfaces/IERC1271.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L7)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";
5: import
    "@openzeppelin/contracts-upgradeable/governance/compatibility/GovernorCompatibilityBravoUpgradeable.sol";
7: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesUpgradeable.sol";
8: import
    "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesQuorumFractionUpgradeable.sol";
10: import
    "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorTimelockControlUpgradeable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L5) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L10)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

4: import "@openzeppelin/contracts-upgradeable/governance/TimelockControllerUpgradeable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L4)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L5)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L4)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L4)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L4)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/ERC20Upgradeable.sol";
5: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";
6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L6)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L4)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L5)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L4)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

4: import "@openzeppelin/contracts/utils/Address.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L4)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";
5: import "@openzeppelin/contracts/utils/Strings.sol";
6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";
7: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L7)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol";
5: import "@openzeppelin/contracts/utils/Strings.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L5)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";
5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/ERC1155Upgradeable.sol";
6: import
    "@openzeppelin/contracts-upgradeable/token/ERC1155/extensions/IERC1155MetadataURIUpgradeable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L6)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

4: import "@openzeppelin/contracts-upgradeable/utils/introspection/IERC165Upgradeable.sol";
5: import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L5)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

4: import "@openzeppelin/contracts/token/ERC1155/IERC1155.sol";
5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/utils/ERC1155ReceiverUpgradeable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L5)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";
6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L6)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
5: import "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L5)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L4)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L4)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/governance/utils/IVotes.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L5)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L4)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L4)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

4: import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L4)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
5: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L6)
</details>

### [N-58] Duplicated `require()`/`revert()` checks should be refactored to a modifier or function

Duplicated require() or revert() checks should be refactored to a modifier or function.
This helps in maintaining a clean and organized codebase and saves deployment costs.

<details>
<summary><i>14 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

105: if (blk.blockId != blockId) revert L1_BLOCK_MISMATCH();
131: if (blk.blockId != blockId) revert L1_BLOCK_MISMATCH();
```
[105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L105) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L131)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

61: if (_to == address(this)) revert TKO_INVALID_ADDR();
79: if (_to == address(this)) revert TKO_INVALID_ADDR();
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L61) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L79)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

166: if (messageStatus[msgHash] != Status.NEW) revert B_STATUS_MISMATCH();
227: if (messageStatus[msgHash] != Status.NEW) revert B_STATUS_MISMATCH();
```
[166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L166) | [227](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L227)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

37: require(
            _in.length > 0,
            "RLPReader: length of an RLP item must be greater than zero to be decodable"
        );
152: require(
            _in.length > 0,
            "RLPReader: length of an RLP item must be greater than zero to be decodable"
        );
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L37) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L152)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

142: require(der[ptr.ixs()] == 0x02, "Not type INTEGER");
155: require(der[ptr.ixs()] == 0x02, "Not type INTEGER");
143: require(der[ptr.ixf()] & 0x80 == 0, "Not positive");
156: require(der[ptr.ixf()] & 0x80 == 0, "Not positive");
```
[142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L142) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L155) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L143) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L156)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

50: revert("Unsupported algorithm");
75: revert("Unsupported algorithm");
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L50) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L75)
</details>

### [N-59] Non-specific Imports

The current form of relative path import is not recommended for use because it can unpredictably pollute the namespace.
Instead, the Solidity docs recommend specifying imported symbols explicitly.
https://docs.soliditylang.org/en/v0.8.15/layout-of-source-files.html#importing-other-source-files

Example:
import {OwnableUpgradeable} from "openzeppelin-contracts-upgradeable/contracts/access/OwnableUpgradeable.sol";
import {SafeTransferLib} from "solmate/utils/SafeTransferLib.sol";

<details>
<summary><i>179 issue instances in 51 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

4: import "./IAddressManager.sol";
5: import "./EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L5)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

4: import "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";
5: import "./IAddressManager.sol";
6: import "./IAddressResolver.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L6)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

4: import "@openzeppelin/contracts/proxy/utils/UUPSUpgradeable.sol";
5: import "@openzeppelin/contracts-upgradeable/access/Ownable2StepUpgradeable.sol";
6: import "./AddressResolver.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L6)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

4: import "@openzeppelin/contracts/utils/Address.sol";
5: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
6: import "@openzeppelin/contracts/utils/introspection/IERC165.sol";
7: import "@openzeppelin/contracts/interfaces/IERC1271.sol";
8: import "../thirdparty/nomad-xyz/ExcessivelySafeCall.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L8)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

9: import "../thirdparty/optimism/rlp/RLPReader.sol";
10: import "../thirdparty/optimism/rlp/RLPWriter.sol";
11: import "../thirdparty/optimism/trie/SecureMerkleTrie.sol";
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L11)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

4: import "@openzeppelin/contracts-upgradeable/governance/GovernorUpgradeable.sol";
5: import
    "@openzeppelin/contracts-upgradeable/governance/compatibility/GovernorCompatibilityBravoUpgradeable.sol";
7: import "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesUpgradeable.sol";
8: import
    "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorVotesQuorumFractionUpgradeable.sol";
10: import
    "@openzeppelin/contracts-upgradeable/governance/extensions/GovernorTimelockControlUpgradeable.sol";
12: import "../../common/EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L5) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L8) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L10) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L12)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

4: import "@openzeppelin/contracts-upgradeable/governance/TimelockControllerUpgradeable.sol";
5: import "../../common/EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L5)

```solidity
File: packages/protocol/contracts/L1/hooks/IHook.sol

4: import "../TaikoData.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L4)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
6: import "../../common/EssentialContract.sol";
7: import "../../libs/LibAddress.sol";
8: import "../ITaikoL1.sol";
9: import "./IHook.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L9)

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

4: import "./TaikoData.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L4)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

4: import "../../common/IAddressResolver.sol";
5: import "../../libs/LibAddress.sol";
6: import "../../libs/LibMath.sol";
7: import "../TaikoData.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L7)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "../../common/IAddressResolver.sol";
6: import "../../libs/LibAddress.sol";
7: import "../hooks/IHook.sol";
8: import "../tiers/ITierProvider.sol";
9: import "../TaikoData.sol";
10: import "./LibDepositing.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L10)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "../../common/IAddressResolver.sol";
6: import "../../libs/LibMath.sol";
7: import "../../verifiers/IVerifier.sol";
8: import "../tiers/ITierProvider.sol";
9: import "../TaikoData.sol";
10: import "./LibUtils.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L10)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

4: import "../TaikoData.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L4)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "../../common/IAddressResolver.sol";
6: import "../../libs/LibMath.sol";
7: import "../../signal/ISignalService.sol";
8: import "../../signal/LibSignals.sol";
9: import "../tiers/ITierProvider.sol";
10: import "../TaikoData.sol";
11: import "./LibUtils.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L11)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

4: import "../tiers/ITierProvider.sol";
5: import "../ITaikoL1.sol";
6: import "./Guardians.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L6)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

4: import "../../common/EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L4)

```solidity
File: packages/protocol/contracts/L1/TaikoEvents.sol

4: import "./TaikoData.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L4)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

4: import "../common/EssentialContract.sol";
5: import "./libs/LibDepositing.sol";
6: import "./libs/LibProposing.sol";
7: import "./libs/LibProving.sol";
8: import "./libs/LibVerifying.sol";
9: import "./ITaikoL1.sol";
10: import "./TaikoErrors.sol";
11: import "./TaikoEvents.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L11)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/ERC20Upgradeable.sol";
5: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";
6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";
7: import "../common/EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L7)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

4: import "../../common/EssentialContract.sol";
5: import "./ITierProvider.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L5)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

4: import "../../common/EssentialContract.sol";
5: import "./ITierProvider.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L5)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

4: import "../../common/EssentialContract.sol";
5: import "./ITierProvider.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L5)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "../common/EssentialContract.sol";
6: import "../bridge/IBridge.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L6)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

4: import "../thirdparty/solmate/LibFixedPointMath.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L4)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
7: import "../libs/LibAddress.sol";
8: import "../libs/LibMath.sol";
9: import "../signal/ISignalService.sol";
10: import "../signal/LibSignals.sol";
11: import "./Lib1559Math.sol";
12: import "./CrossChainOwned.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L5) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L10) | [11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L11) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L12)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

4: import "./TaikoL2.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L4)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";
5: import "../common/EssentialContract.sol";
6: import "../libs/LibTrieProof.sol";
7: import "./ISignalService.sol";
8: import "./LibSignals.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L8)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

4: import "@openzeppelin/contracts/utils/Address.sol";
5: import "../common/EssentialContract.sol";
6: import "../libs/LibAddress.sol";
7: import "../signal/ISignalService.sol";
8: import "../thirdparty/nomad-xyz/ExcessivelySafeCall.sol";
9: import "./IBridge.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

4: import "../BridgedERC20Base.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L4)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/IERC20MetadataUpgradeable.sol";
5: import "@openzeppelin/contracts/utils/Strings.sol";
6: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20SnapshotUpgradeable.sol";
7: import "@openzeppelin/contracts-upgradeable/token/ERC20/extensions/ERC20VotesUpgradeable.sol";
8: import "./LibBridgedToken.sol";
9: import "./BridgedERC20Base.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

4: import "../common/EssentialContract.sol";
5: import "./IBridgedERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L5)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

4: import "@openzeppelin/contracts-upgradeable/token/ERC721/ERC721Upgradeable.sol";
5: import "@openzeppelin/contracts/utils/Strings.sol";
6: import "../common/EssentialContract.sol";
7: import "./LibBridgedToken.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L7)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";
5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/ERC1155Upgradeable.sol";
6: import
    "@openzeppelin/contracts-upgradeable/token/ERC1155/extensions/IERC1155MetadataURIUpgradeable.sol";
8: import "../common/EssentialContract.sol";
9: import "./LibBridgedToken.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L6) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

4: import "./BaseVault.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L4)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

4: import "@openzeppelin/contracts-upgradeable/utils/introspection/IERC165Upgradeable.sol";
5: import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";
6: import "../bridge/IBridge.sol";
7: import "../common/EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L7)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

4: import "@openzeppelin/contracts/token/ERC1155/IERC1155.sol";
5: import "@openzeppelin/contracts-upgradeable/token/ERC1155/utils/ERC1155ReceiverUpgradeable.sol";
6: import "../bridge/IBridge.sol";
7: import "../libs/LibAddress.sol";
8: import "./BaseNFTVault.sol";
9: import "./BridgedERC1155.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/token/ERC20/extensions/IERC20Metadata.sol";
6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
7: import "../bridge/IBridge.sol";
8: import "../libs/LibAddress.sol";
9: import "./BridgedERC20.sol";
10: import "./BaseVault.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L10)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
5: import "@openzeppelin/contracts/token/ERC721/IERC721Receiver.sol";
6: import "../bridge/IBridge.sol";
7: import "../libs/LibAddress.sol";
8: import "./BaseNFTVault.sol";
9: import "./BridgedERC721.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

4: import "@openzeppelin/contracts/utils/Strings.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L4)

```solidity
File: packages/protocol/contracts/verifiers/IVerifier.sol

4: import "../L1/TaikoData.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L4)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

4: import "../common/EssentialContract.sol";
5: import "../L1/TaikoData.sol";
6: import "./IVerifier.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L6)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
5: import "../L1/ITaikoL1.sol";
6: import "../common/EssentialContract.sol";
7: import "../thirdparty/optimism/Bytes.sol";
8: import "../automata-attestation/interfaces/IAttestation.sol";
9: import "../automata-attestation/lib/QuoteV3Auth/V3Struct.sol";
10: import "./IVerifier.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L10)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "@openzeppelin/contracts/governance/utils/IVotes.sol";
6: import "./MerkleClaimable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L6)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
5: import "../../libs/LibMath.sol";
6: import "./MerkleClaimable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L6)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

4: import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
5: import "./MerkleClaimable.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L5)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

4: import "@openzeppelin/contracts/utils/cryptography/MerkleProof.sol";
5: import "../../common/EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L5)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

4: import "@openzeppelin/contracts/utils/cryptography/ECDSA.sol";
5: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
6: import "@openzeppelin/contracts/token/ERC20/utils/SafeERC20.sol";
7: import "../common/EssentialContract.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L7)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

8: import "./BytesUtils.sol";
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

5: import "./SHA1.sol";
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L5)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

4: import "../interfaces/ISigVerifyLib.sol";
5: import "./RsaVerify.sol";
6: import "./BytesUtils.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L6)
</details>

### [N-60] Event is not properly `indexed`

Index event fields make the field more quickly accessible to off-chain tools that parse events.
This is especially useful when it comes to filtering based on an address. However, note that each index field costs extra gas during emission, so it's not necessarily best to index the maximum allowed per event (three fields).
Where applicable, each event should use three indexed fields if there are three or more fields, and gas usage is not particularly of concern for the events in question.
If there are fewer than three applicable fields, all of the applicable fields should be indexed.

<details>
<summary><i>39 issue instances in 20 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

21: event AddressSet(
        uint64 indexed chainId, bytes32 indexed name, address newAddress, address oldAddress
    );
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L21)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

29: event Paused(address account);
33: event Unpaused(address account);
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L29) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L33)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

46: event BlockAssigned(
        address indexed assignedProver, TaikoData.BlockMetadata meta, ProverAssignment assignment
    );
```
[46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L46)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

19: event EthDeposited(TaikoData.EthDeposit deposit);
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L19)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

31: event BlockProposed(
        uint256 indexed blockId,
        address indexed assignedProver,
        uint96 livenessBond,
        TaikoData.BlockMetadata meta,
        TaikoData.EthDeposit[] depositsProcessed
    );
41: event BlobCached(bytes32 blobHash);
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L31) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L41)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

32: event TransitionProved(
        uint256 indexed blockId,
        TaikoData.Transition tran,
        address prover,
        uint96 validityBond,
        uint16 tier
    );
46: event TransitionContested(
        uint256 indexed blockId,
        TaikoData.Transition tran,
        address contester,
        uint96 contestBond,
        uint16 tier
    );
56: event ProvingPaused(bool paused);
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L32) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L46) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L56)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

18: event GuardianApproval(
        address indexed addr, uint256 indexed blockId, bytes32 blockHash, bool approved
    );
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L18)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

37: event GuardiansUpdated(uint32 version, address[] guardians);
43: event Approved(uint256 indexed operationId, uint256 approvalBits, bool proofSubmitted);
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L37) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L43)

```solidity
File: packages/protocol/contracts/L1/TaikoEvents.sol

21: event BlockProposed(
        uint256 indexed blockId,
        address indexed assignedProver,
        uint96 livenessBond,
        TaikoData.BlockMetadata meta,
        TaikoData.EthDeposit[] depositsProcessed
    );
53: event TransitionProved(
        uint256 indexed blockId,
        TaikoData.Transition tran,
        address prover,
        uint96 validityBond,
        uint16 tier
    );
67: event TransitionContested(
        uint256 indexed blockId,
        TaikoData.Transition tran,
        address contester,
        uint96 contestBond,
        uint16 tier
    );
77: event BlobCached(bytes32 blobHash);
81: event ProvingPaused(bool paused);
86: event EthDeposited(TaikoData.EthDeposit deposit);
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L21) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L53) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L67) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L77) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L81) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L86)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

57: event Anchored(bytes32 parentHash, uint64 gasExcess);
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L57)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

18: event ConfigAndExcessChanged(Config config, uint64 gasExcess);
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L18)

```solidity
File: packages/protocol/contracts/signal/ISignalService.sol

49: event SignalSent(address app, bytes32 signal, bytes32 slot, bytes32 value);
54: event Authorized(address indexed addr, bool authrized);
```
[49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L49) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L54)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

69: event MessageSent(bytes32 indexed msgHash, Message message);
75: event MessageReceived(bytes32 indexed msgHash, Message message, bool isRecall);
92: event MessageStatusChanged(bytes32 indexed msgHash, Status status);
97: event MessageSuspended(bytes32 msgHash, bool suspended);
102: event AddressBanned(address indexed addr, bool banned);
```
[69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L69) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L75) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L92) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L97) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L102)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

21: event MigrationStatusChanged(address addr, bool inbound);
27: event MigratedTo(address indexed fromToken, address indexed account, uint256 amount);
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L21) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L27)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

104: event TokenReleased(
        bytes32 indexed msgHash,
        address indexed from,
        address ctoken,
        address token,
        uint256[] tokenIds,
        uint256[] amounts
    );
```
[104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L104)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

80: event BridgedTokenChanged(
        uint256 indexed srcChainId,
        address indexed ctoken,
        address btokenOld,
        address btokenNew,
        string ctokenSymbol,
        string ctokenName,
        uint8 ctokenDecimal
    );
114: event TokenReleased(
        bytes32 indexed msgHash, address indexed from, address ctoken, address token, uint256 amount
    );
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L80) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L114)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

65: event InstanceAdded(
        uint256 indexed id, address indexed instance, address replaced, uint256 validSince
    );
```
[65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L65)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

35: event Withdrawn(address user, uint256 amount);
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L35)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

27: event Claimed(bytes32 hash);
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L27)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

87: event Granted(address indexed recipient, Grant grant);
92: event Voided(address indexed recipient, uint128 amount);
99: event Withdrawn(address indexed recipient, address to, uint128 amount, uint128 cost);
```
[87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L87) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L92) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L99)
</details>

### [N-61] Consider Adding Emergency-Stop Functionality

Smart contracts that hold significant value, interact with external contracts, or have complex logic should include an emergency-stop mechanism for added security. This allows pausing certain contract functionalities in case of emergencies, mitigating potential damages.

This contract seems to lack such a mechanism. Implementing an emergency stop can enhance contract security and reliability.

<details>
<summary><i>29 issue instances in 29 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L1)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L1)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L1)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L1)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L1)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L1)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L1)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L1)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L1)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L1)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L1)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L1)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L1)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L1)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L1)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L1)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L1)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L1)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L1)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L1)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L1)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L1)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L1)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L1)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L1)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L1)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L1)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L1)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

1: No emergency stop pattern found
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L1)
</details>

### [N-62] Missing NatSpec Descriptions for Modifier Declarations

Modifiers in the contract should include NatSpec comments, specifically with the `@dev` or `@notice` tags to elucidate their role and input parameters.
These annotations assist in offering a clearer insight into the contract's operation for developers, auditors, and end-users.
[Additional Details in Solidity Documentation](https://docs.soliditylang.org/en/latest/natspec-format.html)

<details>
<summary><i>13 issue instances in 10 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

46: modifier nonReentrant() {
53: modifier whenPaused() {
58: modifier whenNotPaused() {
```
[46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L46) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L53) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L58)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

28: modifier whenProvingNotPaused() {
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L28)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

35: modifier validSender(address _app) {
40: modifier nonZeroValue(bytes32 _input) {
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L35) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L40)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

64: modifier sameChain(uint64 _chainId) {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L64)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

37: modifier onlyOwnerOrSnapshooter() {
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L37)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

140: modifier withValidOperation(BridgeTransferOp memory _op) {
```
[140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L140)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

22: modifier onlyFromBridge() {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L22)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

39: modifier ongoingWithdrawals() {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L39)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

33: modifier ongoingClaim() {
```
[33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L33)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

60: modifier onlyOwner() {
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L60)
</details>

### [N-63] NatSpec: Public State variable declarations should have descriptions

State variables should ideally be accompanied by NatSpec comments to describe their purpose and usage. 
This aids developers in understanding the function and purpose of each variable, especially in large and complex contracts.
Consider adding `@dev` or `@notice` descriptions to your state variables.

<details>
<summary><i>7 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

7: uint128 public constant MAX_EXP_INPUT = 135_305_999_368_893_231_588;
8: uint256 public constant SCALING_FACTOR = 1e18; // For fixed point representation factor
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

25: ISigVerifyLib public immutable sigVerifyLib;
26: IPEMCertChainLib public immutable pemCertLib;
49: mapping(string fmspc => TCBInfoStruct.TCBInfo tcbInfo) public tcbInfo;
50: EnclaveIdStruct.EnclaveId public qeIdentity;
52: address public owner;
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L26) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L50) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L52)
</details>

### [N-64] Consider adding a block/deny-list

While adding a block or deny-list may increase the level of centralization in the contract, it provides an additional layer of security by preventing hackers from using stolen tokens or carrying out other malicious activities.

Although it's a trade-off, a block or deny-list can help improve the overall security posture of the contract.

<details>
<summary><i>10 issue instances in 10 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

14: contract AssignmentHook is EssentialContract, IHook {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L14)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L15)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

21: contract TaikoL2 is CrossChainOwned {
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L21)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

28: contract USDCAdapter is BridgedERC20Base {
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

11: contract ERC20Airdrop is MerkleClaimable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L11)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

12: contract ERC20Airdrop2 is MerkleClaimable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L12)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

25: contract TimelockTokenPool is EssentialContract {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L25)
</details>

### [N-65] Non-uppercase/Constant-case Naming for `immutable` Variables

For better readability and adherence to common naming conventions, variable names declared as immutable should be written in all uppercase letters.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

25: ISigVerifyLib public immutable sigVerifyLib;
26: IPEMCertChainLib public immutable pemCertLib;
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L26)
</details>

### [N-66] Not using the named return variables anywhere in the function is confusing

Declaring a named return variable but returning a different value within the function is an inconsistent use of named return variables.
This practice can lead to confusion and misinterpretation of the function's intended behavior, as it contradicts the purpose of declaring named return variables, which is to enhance readability and reduce complexity in the code.

This inconsistency might signal an error in the function logic where the declared return variable is not being used as intended.
It is recommended to revisit the function's logic to ensure that the named return variables are being utilized correctly, or to adjust the return statements to reflect the actual values being returned, fostering better clarity and coherence in the code.

<details>
<summary><i>11 issue instances in 10 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

/// @audit - `if (!Address.isContract(_addr)) return false;` statement in functions but `result_` are declared
45: function supportsInterface(
        address _addr,
        bytes4 _interfaceId
    )
        internal
        view
        returns (bool result_)
    {
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L45)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit - `return tier.maxBlocksToVerifyPerProof;` statement in functions but `maxBlocksToVerify_` are declared
91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
    {
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit - `return (1 hours, 384 seconds);` statement in functions but `invocationDelay_, invocationExtraDelay_` are declared
/// @audit - `return (30 minutes, 384 seconds);` statement in functions but `invocationDelay_, invocationExtraDelay_` are declared
/// @audit - `return (5 minutes, 384 seconds);` statement in functions but `invocationDelay_, invocationExtraDelay_` are declared
/// @audit - `return (0, 0);` statement in functions but `invocationDelay_, invocationExtraDelay_` are declared
417: function getInvocationDelays()
        public
        view
        virtual
        returns (uint256 invocationDelay_, uint256 invocationExtraDelay_)
    {
```
[417](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L417)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

/// @audit - `return (0, 1, RLPItemType.DATA_ITEM);` statement in functions but `offset_, length_, type_` are declared
/// @audit - `return (1, strLen, RLPItemType.DATA_ITEM);` statement in functions but `offset_, length_, type_` are declared
/// @audit - `return (1 + lenOfStrLen, strLen, RLPItemType.DATA_ITEM);` statement in functions but `offset_, length_, type_` are declared
/// @audit - `return (1, listLen, RLPItemType.LIST_ITEM);` statement in functions but `offset_, length_, type_` are declared
/// @audit - `return (1 + lenOfListLen, listLen, RLPItemType.LIST_ITEM);` statement in functions but `offset_, length_, type_` are declared
144: function _decodeLength(RLPItem memory _in)
        private
        pure
        returns (uint256 offset_, uint256 length_, RLPItemType type_)
    {
```
[144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L144)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

/// @audit - `return 0;` statement in functions but `r` are declared
13: function exp(int256 x) internal pure returns (int256 r) {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L13)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit - `if (balance == 0) return (0, 0);` statement in functions but `balance, withdrawableAmount` are declared
```


```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit - `return status == TCBInfoStruct.TCBStatus.OK
            || status == TCBInfoStruct.TCBStatus.TCB_SW_HARDENING_NEEDED
            || status == TCBInfoStruct.TCBStatus.TCB_CONFIGURATION_AND_SW_HARDENING_NEEDED
            || status == TCBInfoStruct.TCBStatus.TCB_OUT_OF_DATE_CONFIGURATION_NEEDED;` statement in functions but `valid` are declared
125: function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)
        internal
        pure
        virtual
        returns (bool valid)
    {
/// @audit - `return (true, TCBInfoStruct.TCBStatus.TCB_UNRECOGNIZED);` statement in functions but `status` are declared
205: function _checkTcbLevels(
        IPEMCertChainLib.PCKCertificateField memory pck,
        TCBInfoStruct.TCBInfo memory tcb
    )
        private
        pure
        returns (bool, TCBInfoStruct.TCBStatus status)
    {
```
[125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L125) | [205](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L205)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit - `return (true, contentBytes, endPos + FOOTER_LENGTH);` statement in functions but `success, extracted, endIndex` are declared
215: function _removeHeadersAndFooters(string memory pemData)
        private
        pure
        returns (bool success, bytes memory extracted, uint256 endIndex)
    {
/// @audit - `return input;` statement in functions but `output` are declared
251: function _trimBytes(
        bytes memory input,
        uint256 expectedLength
    )
        private
        pure
        returns (bytes memory output)
    {
```
[215](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L215) | [251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L251)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit - `return uint8(self[idx]);` statement in functions but `ret` are declared
188: function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {
```
[188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L188)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit - `return false;` statement in functions but `sigValid` are declared
/// @audit - `return false;` statement in functions but `sigValid` are declared
/// @audit - `return abi.decode(ret, (uint256)) == 1;` statement in functions but `sigValid` are declared
112: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
```
[112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L112)
</details>

### [N-67] Function Names Not in mixedCase

Function names should use mixedCase for better readability and consistency with Solidity style guidelines. 
Examples of good practice include: getBalance, transfer, verifyOwner, addMember, changeOwner. 
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#function-names)

<details>
<summary><i>16 issue instances in 11 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

58: function __AddressResolver_init(address _addressManager) internal virtual onlyInitializing {
```
[58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L58)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

95: function __Essential_init(
108: function __Essential_init(address _owner) internal virtual {
```
[95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L95) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L108)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

76: function isSenderEOA() internal view returns (bool) {
```
[76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L76)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

60: function __CrossChainOwned_init(
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L60)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

35: function toRLPItem(bytes memory _in) internal pure returns (RLPItem memory out_) {
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L35)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

220: function _getNodeID(RLPReader.RLPItem memory _node) private pure returns (bytes memory id_) {
```
[220](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L220)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

55: function __MerkleClaimable_init(
```
[55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L55)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

174: function _verifyQEReportWithIdentity(V3Struct.EnclaveReport memory quoteEnclaveReport)
```
[174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L174)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

57: function verifyRS256Signature(
66: function verifyRS1Signature(
75: function verifyES256Signature(
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L57) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L66) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L75)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

244: function packQEReport(V3Struct.EnclaveReport memory enclaveReport)
```
[244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L244)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

78: function verifyRS256Signature(
95: function verifyRS1Signature(
112: function verifyES256Signature(
```
[78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L78) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L95) | [112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L112)
</details>

### [N-68] Insufficient Comments in Complex Functions

Complex functions spanning multiple lines should have more comments to better explain the purpose of each logic step.
Proper commenting can greatly improve the readability and maintainability of the codebase. Consider adding explicit comments
to provide insights into the function's operation.

<details>
<summary><i>29 issue instances in 21 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit function with 33 lines has only 15 comment lines
62: function onBlockProposed(
        TaikoData.Block memory _blk,
        TaikoData.BlockMetadata memory _meta,
        bytes memory _data
    )
        external
        payable
        nonReentrant
        onlyFromNamed("taiko")
    {
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L62)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit function with 31 lines has only 10 comment lines
67: function processDeposits(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        address _feeRecipient
    )
        internal
        returns (TaikoData.EthDeposit[] memory deposits_)
    {
```
[67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L67)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

/// @audit function with 115 lines has only 63 comment lines
68: function proposeBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        bytes calldata _data,
        bytes calldata _txList
    )
        internal
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L68)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit function with 90 lines has only 50 comment lines
91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
    {
/// @audit function with 30 lines has only 5 comment lines
350: function _overrideWithHigherProof(
        TaikoData.TransitionState storage _ts,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof,
        ITierProvider.Tier memory _tier,
        IERC20 _tko,
        bool _sameTransition
    )
        private
    {
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L350)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit function with 63 lines has only 43 comment lines
85: function verifyBlocks(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _maxBlocksToVerify
    )
        internal
    {
```
[85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L85)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit function with 31 lines has only 12 comment lines
20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L20)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit function with 31 lines has only 12 comment lines
20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L20)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit function with 30 lines has only 5 comment lines
107: function anchor(
        bytes32 _l1BlockHash,
        bytes32 _l1StateRoot,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        external
        nonReentrant
    {
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L107)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit function with 32 lines has only 0 comment lines
83: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        public
        virtual
        validSender(_app)
        nonZeroValue(_signal)
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L83)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit function with 35 lines has only 4 comment lines
155: function recallMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.srcChainId)
    {
/// @audit function with 57 lines has only 11 comment lines
217: function processMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.destChainId)
    {
```
[155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L155) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L217)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit function with 35 lines has only 7 comment lines
39: function sendToken(BridgeTransferOp memory _op)
        external
        payable
        nonReentrant
        whenNotPaused
        withValidOperation(_op)
        returns (IBridge.Message memory message_)
    {
/// @audit function with 34 lines has only 2 comment lines
240: function _handleMessage(
        address _user,
        BridgeTransferOp memory _op
    )
        private
        returns (bytes memory msgData_, CanonicalNFT memory ctoken_)
    {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L39) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L240)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit function with 31 lines has only 2 comment lines
148: function changeBridgedToken(
        CanonicalERC20 calldata _ctoken,
        address _btokenNew
    )
        external
        nonReentrant
        whenNotPaused
        onlyOwner
        returns (address btokenOld_)
    {
/// @audit function with 32 lines has only 3 comment lines
207: function sendToken(BridgeTransferOp calldata _op)
        external
        payable
        nonReentrant
        whenNotPaused
        returns (IBridge.Message memory message_)
    {
```
[148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L148) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L207)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit function with 35 lines has only 3 comment lines
26: function sendToken(BridgeTransferOp memory _op)
        external
        payable
        nonReentrant
        whenNotPaused
        withValidOperation(_op)
        returns (IBridge.Message memory message_)
    {
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L26)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

/// @audit function with 88 lines has only 10 comment lines
144: function _decodeLength(RLPItem memory _in)
        private
        pure
        returns (uint256 offset_, uint256 length_, RLPItemType type_)
    {
```
[144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L144)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

/// @audit function with 79 lines has only 30 comment lines
68: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit function with 40 lines has only 2 comment lines
247: function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
        private
        view
        returns (bool)
    {
/// @audit function with 91 lines has only 15 comment lines
363: function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
        internal
        view
        returns (bool, bytes memory)
    {
```
[247](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L247) | [363](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L363)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit function with 87 lines has only 18 comment lines
73: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
/// @audit function with 43 lines has only 8 comment lines
268: function _findPckTcbInfo(
        bytes memory der,
        uint256 tbsPtr,
        uint256 tbsParentPtr
    )
        private
        pure
        returns (
            bool success,
            uint256 pcesvn,
            uint256[] memory cpusvns,
            bytes memory fmspcBytes,
            bytes memory pceidBytes
        )
    {
```
[73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L73) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L268)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

/// @audit function with 54 lines has only 9 comment lines
61: function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
        internal
        pure
        returns (
            bool success,
            V3Struct.Header memory header,
            V3Struct.EnclaveReport memory localEnclaveReport,
            bytes memory signedQuoteData, // concatenation of header and local enclave report bytes
            V3Struct.ECDSAQuoteV3AuthData memory authDataV3
        )
    {
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L61)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit function with 33 lines has only 2 comment lines
56: function compare(
        bytes memory self,
        uint256 offset,
        uint256 len,
        bytes memory other,
        uint256 otheroffset,
        uint256 otherlen
    )
        internal
        pure
        returns (int256)
    {
/// @audit function with 32 lines has only 5 comment lines
320: function base32HexDecodeWord(
        bytes memory self,
        uint256 off,
        uint256 len
    )
        internal
        pure
        returns (bytes32)
    {
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L56) | [320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L320)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

/// @audit function with 101 lines has only 12 comment lines
43: function pkcs1Sha256(
        bytes32 _sha256,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
/// @audit function with 57 lines has only 10 comment lines
212: function pkcs1Sha1(
        bytes20 _sha1,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L43) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L212)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

/// @audit function with 161 lines has only 11 comment lines
11: function sha1(bytes memory data) internal pure returns (bytes20 ret) {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L11)
</details>

### [N-69] Common functions should be refactored to a common base contract

The codebase contains several functions with the same implementations across multiple files.
To enhance maintainability and reduce potential errors, consider refactoring these common functions into a shared base contract.
This practice promotes code reuse and easier future upgrades.

<details>
<summary><i>31 issue instances in 17 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

30: function init(address _owner) external initializer {
        __Essential_init(_owner);
    }
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L30)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

15: function init(address _owner) external initializer {
        __Essential_init(_owner);
    }
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

15: function init(address _owner) external initializer {
        __Essential_init(_owner);
    }
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

15: function init(address _owner) external initializer {
        __Essential_init(_owner);
    }
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L15)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

57: function init(address _owner, address _addressManager) external initializer {
        __Essential_init(_owner, _addressManager);
    }
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

25: function init(address _owner, address _addressManager) external initializer {
        __Essential_init(_owner, _addressManager);
    }
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

48: function init(address _owner, address _addressManager) external initializer {
        __Essential_init(_owner, _addressManager);
    }
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

75: function init(address _owner, address _addressManager) external initializer {
        __Essential_init(_owner, _addressManager);
    }
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

32: function init(address _owner, address _addressManager) external initializer {
        __Essential_init(_owner, _addressManager);
    }
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

18: function init(address _owner, address _addressManager) external initializer {
        __Essential_init(_owner, _addressManager);
    }
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

83: function init(address _owner, address _addressManager) external initializer {
        __Essential_init(_owner, _addressManager);
    }
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

47: function burn(address _from, uint256 _amount) public onlyOwner {
        _burn(_from, _amount);
    }
52: function snapshot() public onlyFromOwnerOrNamed("snapshooter") {
        _snapshot();
    }
93: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
        super._afterTokenTransfer(_from, _to, _amount);
    }
104: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
        super._mint(_to, _amount);
    }
114: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
        super._burn(_from, _amount);
    }
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L47) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L52) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L93) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L104) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L114)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

132: function _burnToken(address _from, uint256 _amount) internal override {
        _burn(_from, _amount);
    }
85: function snapshot() external onlyOwnerOrSnapshooter {
        _snapshot();
    }
151: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
        super._afterTokenTransfer(_from, _to, _amount);
    }
162: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
        super._mint(_to, _amount);
    }
172: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
        super._burn(_from, _amount);
    }
91: function name()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (string memory)
    {
        return LibBridgedToken.buildName(super.name(), srcChainId);
    }
102: function symbol()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (string memory)
    {
        return LibBridgedToken.buildSymbol(super.symbol());
    }
125: function canonical() public view returns (address, uint256) {
        return (srcToken, srcChainId);
    }
```
[132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L132) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L85) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L151) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L162) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L172) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L91) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L102) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L125)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

87: function name() public view override(ERC721Upgradeable) returns (string memory) {
        return LibBridgedToken.buildName(super.name(), srcChainId);
    }
93: function symbol() public view override(ERC721Upgradeable) returns (string memory) {
        return LibBridgedToken.buildSymbol(super.symbol());
    }
100: function source() public view returns (address, uint256) {
        return (srcToken, srcChainId);
    }
```
[87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L87) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L93) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L100)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

27: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
        __Essential_init(_owner);
        __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);

        token = _token;
        vault = _vault;
    }
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L27)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

25: function init(
        address _owner,
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot,
        address _token,
        address _vault
    )
        external
        initializer
    {
        __Essential_init(_owner);
        __MerkleClaimable_init(_claimStart, _claimEnd, _merkleRoot);

        token = _token;
        vault = _vault;
    }
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L25)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

45: function setConfig(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        external
        onlyOwner
    {
        _setConfig(_claimStart, _claimEnd, _merkleRoot);
    }
55: function __MerkleClaimable_init(
        uint64 _claimStart,
        uint64 _claimEnd,
        bytes32 _merkleRoot
    )
        internal
        onlyInitializing
    {
        _setConfig(_claimStart, _claimEnd, _merkleRoot);
    }
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L45) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L55)
</details>

### [N-70] NatSpec: Error declarations should have descriptions

NatSpec comments are essential for understanding the purpose and functionality of error declarations. 
Adding descriptive comments improves readability and can aid in debugging.
It's a best practice to provide NatSpec comments for all error declarations in your Solidity contract.

<details>
<summary><i>157 issue instances in 35 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

25: error AM_INVALID_PARAMS();
26: error AM_UNSUPPORTED();
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L26)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

16: error RESOLVER_DENIED();
17: error RESOLVER_INVALID_MANAGER();
18: error RESOLVER_UNEXPECTED_CHAINID();
19: error RESOLVER_ZERO_ADDR(uint64 chainId, bytes32 name);
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L19)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

35: error REENTRANT_CALL();
36: error INVALID_PAUSE_STATUS();
37: error ZERO_ADDR_MANAGER();
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L37)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

19: error EVAL_FAILED_1();
20: error EVAL_FAILED_2();
21: error POINT_X_TOO_LARGE();
22: error POINT_Y_TOO_LARGE();
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L22)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

16: error ETH_TRANSFER_FAILED();
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L16)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

20: error LTP_INVALID_ACCOUNT_PROOF();
21: error LTP_INVALID_INCLUSION_PROOF();
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L21)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

25: error TG_INVALID_SIGNATURES_LENGTH();
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L25)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

50: error HOOK_ASSIGNMENT_EXPIRED();
51: error HOOK_ASSIGNMENT_INVALID_SIG();
52: error HOOK_TIER_NOT_FOUND();
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L52)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

44: error L1_BLOB_FOR_DA_DISABLED();
45: error L1_BLOB_NOT_FOUND();
46: error L1_BLOB_NOT_REUSABLE();
47: error L1_BLOB_REUSE_DISABLED();
48: error L1_INVALID_HOOK();
49: error L1_INVALID_PARAM();
50: error L1_INVALID_PROVER();
51: error L1_LIVENESS_BOND_NOT_RECEIVED();
52: error L1_PROPOSER_NOT_EOA();
53: error L1_TOO_MANY_BLOCKS();
54: error L1_TXLIST_OFFSET();
55: error L1_TXLIST_SIZE();
56: error L1_UNAUTHORIZED();
57: error L1_UNEXPECTED_PARENT();
```
[44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L57)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

59: error L1_ALREADY_CONTESTED();
60: error L1_ALREADY_PROVED();
61: error L1_ASSIGNED_PROVER_NOT_ALLOWED();
62: error L1_BLOCK_MISMATCH();
63: error L1_INVALID_BLOCK_ID();
64: error L1_INVALID_PAUSE_STATUS();
65: error L1_INVALID_TIER();
66: error L1_INVALID_TRANSITION();
67: error L1_MISSING_VERIFIER();
68: error L1_NOT_ASSIGNED_PROVER();
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L68)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

12: error L1_INVALID_BLOCK_ID();
13: error L1_TRANSITION_NOT_FOUND();
14: error L1_UNEXPECTED_TRANSITION_ID();
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L12) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L14)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

39: error L1_BLOCK_MISMATCH();
40: error L1_INVALID_CONFIG();
41: error L1_TRANSITION_ID_ZERO();
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L41)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

45: error INVALID_GUARDIAN();
46: error INVALID_GUARDIAN_SET();
47: error INVALID_MIN_GUARDIANS();
48: error INVALID_PROOF();
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L48)

```solidity
File: packages/protocol/contracts/L1/TaikoErrors.sol

13: error L1_ALREADY_PROVED();
14: error L1_ASSIGNED_PROVER_NOT_ALLOWED();
15: error L1_BLOB_FOR_DA_DISABLED();
16: error L1_BLOB_NOT_FOUND();
17: error L1_BLOB_NOT_REUSABLE();
18: error L1_BLOB_REUSE_DISABLED();
19: error L1_BLOCK_MISMATCH();
20: error L1_INVALID_BLOCK_ID();
21: error L1_INVALID_CONFIG();
22: error L1_INVALID_ETH_DEPOSIT();
23: error L1_INVALID_HOOK();
24: error L1_INVALID_PARAM();
25: error L1_INVALID_PAUSE_STATUS();
26: error L1_INVALID_PROVER();
27: error L1_INVALID_TIER();
28: error L1_INVALID_TRANSITION();
29: error L1_LIVENESS_BOND_NOT_RECEIVED();
30: error L1_NOT_ASSIGNED_PROVER();
31: error L1_PROPOSER_NOT_EOA();
32: error L1_PROVING_PAUSED();
33: error L1_RECEIVE_DISABLED();
34: error L1_MISSING_VERIFIER();
35: error L1_TOO_MANY_BLOCKS();
36: error L1_TOO_MANY_TIERS();
37: error L1_TRANSITION_ID_ZERO();
38: error L1_TRANSITION_NOT_FOUND();
39: error L1_TXLIST_SIZE();
40: error L1_UNAUTHORIZED();
41: error L1_UNEXPECTED_PARENT();
42: error L1_UNEXPECTED_TRANSITION_ID();
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L16) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L20) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L38) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L41) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L42)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

18: error TKO_INVALID_ADDR();
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L18)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

17: error TIER_NOT_FOUND();
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L17)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

28: error XCO_INVALID_OWNER_CHAINID();
29: error XCO_INVALID_TX_ID();
30: error XCO_PERMISSION_DENIED();
31: error XCO_TX_REVERTED();
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L31)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

59: error L2_BASEFEE_MISMATCH();
60: error L2_INVALID_CHAIN_ID();
61: error L2_INVALID_PARAM();
62: error L2_INVALID_SENDER();
63: error L2_PUBLIC_INPUT_HASH_MISMATCH();
64: error L2_TOO_LATE();
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L64)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

20: error L2_INVALID_CONFIG();
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L20)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

25: error SS_EMPTY_PROOF();
26: error SS_INVALID_SENDER();
27: error SS_INVALID_LAST_HOP_CHAINID();
28: error SS_INVALID_MID_HOP_CHAINID();
29: error SS_INVALID_STATE();
30: error SS_INVALID_VALUE();
31: error SS_SIGNAL_NOT_FOUND();
32: error SS_UNAUTHORIZED();
33: error SS_UNSUPPORTED();
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L31) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L33)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

50: error B_INVALID_CHAINID();
51: error B_INVALID_CONTEXT();
52: error B_INVALID_GAS_LIMIT();
53: error B_INVALID_STATUS();
54: error B_INVALID_USER();
55: error B_INVALID_VALUE();
56: error B_MESSAGE_NOT_SENT();
57: error B_NON_RETRIABLE();
58: error B_NOT_FAILED();
59: error B_NOT_RECEIVED();
60: error B_PERMISSION_DENIED();
61: error B_STATUS_MISMATCH();
62: error B_INVOCATION_TOO_EARLY();
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L50) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L52) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L58) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L62)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

34: error BTOKEN_CANNOT_RECEIVE();
35: error BTOKEN_UNAUTHORIZED();
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L34) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L35)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

29: error BB_PERMISSION_DENIED();
30: error BB_INVALID_PARAMS();
31: error BB_MINT_DISALLOWED();
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L31)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

21: error BTOKEN_CANNOT_RECEIVE();
22: error BTOKEN_INVALID_BURN();
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L21) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L22)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

29: error BTOKEN_CANNOT_RECEIVE();
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L29)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

133: error VAULT_INVALID_TOKEN();
134: error VAULT_INVALID_AMOUNT();
135: error VAULT_INVALID_TO();
136: error VAULT_INTERFACE_NOT_SUPPORTED();
137: error VAULT_TOKEN_ARRAY_MISMATCH();
138: error VAULT_MAX_TOKEN_PER_TXN_EXCEEDED();
```
[133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L133) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L134) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L136) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L137) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L138)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

20: error VAULT_PERMISSION_DENIED();
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L20)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

136: error VAULT_BTOKEN_BLACKLISTED();
137: error VAULT_CTOKEN_MISMATCH();
138: error VAULT_INVALID_TOKEN();
139: error VAULT_INVALID_AMOUNT();
140: error VAULT_INVALID_NEW_BTOKEN();
141: error VAULT_INVALID_TO();
142: error VAULT_NOT_SAME_OWNER();
```
[136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L136) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L137) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L138) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L139) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L140) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L141) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L142)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

9: error BTOKEN_INVALID_PARAMS();
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

10: error Overflow();
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L10)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

13: error PERMISSION_DENIED();
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L13)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

74: error SGX_ALREADY_ATTESTED();
75: error SGX_INVALID_ATTESTATION();
76: error SGX_INVALID_INSTANCE();
77: error SGX_INVALID_PROOF();
78: error SGX_RA_NOT_SUPPORTED();
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L74) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L75) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L76) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L78)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

37: error WITHDRAWALS_NOT_ONGOING();
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L37)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

29: error CLAIM_NOT_ONGOING();
30: error CLAIMED_ALREADY();
31: error INVALID_PROOF();
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L29) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L31)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

101: error ALREADY_GRANTED();
102: error INVALID_GRANT();
103: error INVALID_PARAM();
104: error NOTHING_TO_VOID();
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L101) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L102) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L103) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L104)
</details>

### [N-71] NatSpec: Non-public state variable declarations should use `@dev` tags

Non-public state variables in smart contracts often have specialized purposes that may not be immediately clear to developers who did not write the original code.
Adding comments to explain the role and functionality of these variables can greatly aid in code readability and maintainability.
This is especially beneficial for future code reviews and audits.

<details>
<summary><i>69 issue instances in 43 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

14: uint256[49] private __gap;
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L14)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

14: uint256[49] private __gap;
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L14)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

11: uint8 private constant _FALSE = 1;
13: uint8 private constant _TRUE = 2;
23: uint8 private __paused;
25: uint256[49] private __gap;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L11) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L13) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L23) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L25)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

14: bytes4 private constant _EIP1271_MAGICVALUE = 0x1626ba7e;
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L14)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

18: uint256 private constant _ACCOUNT_FIELD_INDEX_STORAGE_HASH = 2;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L18)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

23: uint256[50] private __gap;
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L23)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

10: uint256[50] private __gap;
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L10)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

40: uint256[50] private __gap;
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L40)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

11: uint256[50] private __gap;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L11)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

32: uint256[46] private __gap;
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L32)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

26: uint256[50] private __gap;
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L26)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

16: uint256[50] private __gap;
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L16)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

11: uint256[50] private __gap;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L11)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

11: uint256[50] private __gap;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L11)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

11: uint256[50] private __gap;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L11)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

21: uint256[49] private __gap;
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L21)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

52: uint256[47] private __gap;
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L52)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

13: uint256[49] private __gap;
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L13)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

23: uint256[48] private __gap;
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L23)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

48: uint256[43] private __gap;
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L48)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

32: uint256[49] private __gap;
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L32)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

24: uint8 private __srcDecimals;
32: uint256[47] private __gap;
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L24) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L32)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

16: uint256[49] private __gap;
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

19: uint256[48] private __gap;
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L19)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

27: uint256[46] private __gap;
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L27)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

61: uint256[48] private __gap;
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L61)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

18: uint256[50] private __gap;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L18)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

32: uint256[50] private __gap;
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L32)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

54: uint256[47] private __gap;
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L54)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

19: uint256[50] private __gap;
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L19)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

6: uint256 constant LOW_28_MASK =
        0x00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff;
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

11: uint256[50] private __gap;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L11)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

57: uint256[47] private __gap;
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L57)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

18: uint256[48] private __gap;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L18)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

30: uint256[45] private __gap;
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L30)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

16: uint256[48] private __gap;
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L16)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

23: uint256[47] private __gap;
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L23)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

82: uint128[44] private __gap;
```
[82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L82)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

29: uint256 internal constant CPUSVN_LENGTH = 16;
33: bytes32 internal constant ROOTCA_PUBKEY_HASH =
        0x89f72d7c488e5b53a77c23ebcb36970ef7eb5bcf6658e9b8292cfbe4703a8473;
36: uint8 internal constant INVALID_EXIT_CODE = 255;
38: bool private _checkLocalEnclaveReport;
39: mapping(bytes32 enclave => bool trusted) private _trustedUserMrEnclave;
40: mapping(bytes32 signer => bool trusted) private _trustedUserMrSigner;
47: mapping(uint256 idx => mapping(bytes serialNum => bool revoked)) private _serialNumIsRevoked;
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L29) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L33) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L36) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L38) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L40) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L47)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

17: string internal constant HEADER = "-----BEGIN CERTIFICATE-----";
18: string internal constant FOOTER = "-----END CERTIFICATE-----";
19: uint256 internal constant HEADER_LENGTH = 27;
20: uint256 internal constant FOOTER_LENGTH = 25;
22: string internal constant PCK_COMMON_NAME = "Intel SGX PCK Certificate";
23: string internal constant PLATFORM_ISSUER_NAME = "Intel SGX PCK Platform CA";
24: string internal constant PROCESSOR_ISSUER_NAME = "Intel SGX PCK Processor CA";
25: bytes internal constant SGX_EXTENSION_OID = hex"2A864886F84D010D01";
26: bytes internal constant TCB_OID = hex"2A864886F84D010D0102";
27: bytes internal constant PCESVN_OID = hex"2A864886F84D010D010211";
28: bytes internal constant PCEID_OID = hex"2A864886F84D010D0103";
29: bytes internal constant FMSPC_OID = hex"2A864886F84D010D0104";
32: uint256 constant SGX_TCB_CPUSVN_SIZE = 16;
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L20) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L29) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L32)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

14: uint256 internal constant MINIMUM_QUOTE_LENGTH = 1020;
15: bytes2 internal constant SUPPORTED_QUOTE_VERSION = 0x0300;
16: bytes2 internal constant SUPPORTED_ATTESTATION_KEY_TYPE = 0x0200;
18: bytes4 internal constant SUPPORTED_TEE_TYPE = 0;
19: bytes16 internal constant VALID_QE_VENDOR_ID = 0x939a7233f79c4ca9940a0db3957f0607;
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L16) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L19)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

310: bytes constant BASE32_HEX_TABLE =
        hex"00010203040506070809FFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1FFFFFFFFFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1F";
```
[310](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L310)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

18: address private ES256VERIFIER;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L18)
</details>

### [N-72] `constant`s should be defined rather than using magic numbers

Magic numbers are hardcoded numerical values used directly in the code, making it harder to read and maintain.
Consider using constants instead of magic numbers.

<details>
<summary><i>383 issue instances in 30 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit 0xa5054f728453d3dbe953bdc43e4d0cb97e662ea32d7958190f3dc2da31d9721a
18: 0xa5054f728453d3dbe953bdc43e4d0cb97e662ea32d7958190f3dc2da31d9721a;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L18)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

/// @audit 52_435_875_175_126_190_479_447_740_508_185_965_837_690_552_500_527_637_822_603_658_699_938_581_184_513
17: 52_435_875_175_126_190_479_447_740_508_185_965_837_690_552_500_527_637_822_603_658_699_938_581_184_513;
/// @audit 64
49: if (ret.length != 64) revert EVAL_FAILED_2();
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L17) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L49)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit 7200
112: return 7200; // 1 day
/// @audit 50_400
118: return 50_400; // 1 week
/// @audit 1_000_000_000
124: return 1_000_000_000 ether / 10_000; // 0.01% of Taiko Token
/// @audit 10_000
124: return 1_000_000_000 ether / 10_000; // 0.01% of Taiko Token
```
[112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L112) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L118) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L124) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L124)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit 96
89: recipient: address(uint160(data >> 96)),
/// @audit 96
151: return (uint256(uint160(_addr)) << 96) | _amount;
```
[89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L89) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L151)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit 32
192: bool returnLivenessBond = blk.livenessBond > 0 && _proof.data.length == 32
/// @audit 60
415: + _tier.provingWindow * 60 >= block.timestamp;
```
[192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L192) | [415](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L415)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit 60
152: uint256(ITierProvider(tierProvider).getTier(ts.tier).cooldownWindow) * 60
/// @audit 128
251: || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K
/// @audit 1024
251: || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K
/// @audit 32
256: || _config.ethDepositMaxCountPerBlock > 32
```
[152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L152) | [251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L251) | [251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L251) | [256](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L256)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit 167_008
192: chainId: 167_008,
/// @audit 864_000
195: blockMaxProposals: 864_000,
/// @audit 864_100
196: blockRingBufferSize: 864_100,
/// @audit 10
198: maxBlocksToVerifyPerProposal: 10,
/// @audit 15_000_000
199: blockMaxGasLimit: 15_000_000,
/// @audit 120_000
203: blockMaxTxListBytes: 120_000,
/// @audit 24
204: blobExpiry: 24 hours,
/// @audit 250e18
207: livenessBond: 250e18, // 250 Taiko token
/// @audit 250
207: livenessBond: 250e18, // 250 Taiko token
/// @audit 1024
209: ethDepositRingBufferSize: 1024,
/// @audit 32
211: ethDepositMaxCountPerBlock: 32,
/// @audit 10_000
213: ethDepositMaxAmount: 10_000 ether,
/// @audit 21_000
214: ethDepositGas: 21_000,
/// @audit 10
215: ethDepositMaxFee: 1 ether / 10,
/// @audit 16
216: blockSyncThreshold: 16
```
[192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L192) | [195](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L195) | [196](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L196) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L198) | [199](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L199) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L203) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L204) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L207) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L207) | [209](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L209) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L211) | [213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L213) | [214](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L214) | [215](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L215) | [216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L216)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit 1_000_000_000
41: _mint(_recipient, 1_000_000_000 ether);
```
[41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L41)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

/// @audit 250
24: validityBond: 250 ether, // TKO
/// @audit 500
25: contestBond: 500 ether, // TKO
/// @audit 1440
26: cooldownWindow: 1440, //24 hours
/// @audit 120
27: provingWindow: 120, // 2 hours
/// @audit 16
28: maxBlocksToVerifyPerProof: 16
/// @audit 60
37: cooldownWindow: 60, //1 hours
/// @audit 2880
38: provingWindow: 2880, // 48 hours
/// @audit 16
39: maxBlocksToVerifyPerProof: 16
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L28) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L38) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L39)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit 250
24: validityBond: 250 ether, // TKO
/// @audit 500
25: contestBond: 500 ether, // TKO
/// @audit 1440
26: cooldownWindow: 1440, //24 hours
/// @audit 60
27: provingWindow: 60, // 1 hours
/// @audit 500
35: validityBond: 500 ether, // TKO
/// @audit 1000
36: contestBond: 1000 ether, // TKO
/// @audit 1440
37: cooldownWindow: 1440, //24 hours
/// @audit 240
38: provingWindow: 240, // 4 hours
/// @audit 60
48: cooldownWindow: 60, //1 hours
/// @audit 2880
49: provingWindow: 2880, // 48 hours
/// @audit 16
50: maxBlocksToVerifyPerProof: 16
/// @audit 1000
68: if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L27) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L38) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L50) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit 250
24: validityBond: 250 ether, // TKO
/// @audit 500
25: contestBond: 500 ether, // TKO
/// @audit 1440
26: cooldownWindow: 1440, //24 hours
/// @audit 30
27: provingWindow: 30, // 0.5 hours
/// @audit 12
28: maxBlocksToVerifyPerProof: 12
/// @audit 500
35: validityBond: 500 ether, // TKO
/// @audit 1000
36: contestBond: 1000 ether, // TKO
/// @audit 1440
37: cooldownWindow: 1440, //24 hours
/// @audit 60
38: provingWindow: 60, // 1 hours
/// @audit 60
48: cooldownWindow: 60, //1 hours
/// @audit 2880
49: provingWindow: 2880, // 48 hours
/// @audit 16
50: maxBlocksToVerifyPerProof: 16
/// @audit 10
68: if (_rand % 10 == 0) return LibTiers.TIER_SGX;
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L28) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L37) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L38) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L49) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L50) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit 256
202: if (_blockId + 256 >= block.number) return blockhash(_blockId);
/// @audit 15
213: config_.gasTargetPerL1Block = 15 * 1e6 * 4;
/// @audit 1e6
213: config_.gasTargetPerL1Block = 15 * 1e6 * 4;
/// @audit 255
234: for (uint256 i; i < 255 && _blockId >= i + 1; ++i) {
/// @audit 255
236: inputs[j % 255] = blockhash(j);
```
[202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L202) | [213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L213) | [213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L213) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L234) | [236](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L236)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit 0xe4ece82196de19aabe639620d7f716c433d1348f96ce727c9989a982dbadc2b9
24: 0xe4ece82196de19aabe639620d7f716c433d1348f96ce727c9989a982dbadc2b9;
/// @audit 384
428: return (1 hours, 384 seconds);
/// @audit 42
433: || block.chainid == 42 // Kovan
/// @audit 17_000
434: || block.chainid == 17_000 // Holesky
/// @audit 11_155_111
435: || block.chainid == 11_155_111 // Sepolia
/// @audit 30
438: return (30 minutes, 384 seconds);
/// @audit 384
438: return (30 minutes, 384 seconds);
/// @audit 32_300
439: } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {
/// @audit 32_400
439: } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {
/// @audit 384
441: return (5 minutes, 384 seconds);
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L24) | [428](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L428) | [433](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L433) | [434](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L434) | [435](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L435) | [438](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L438) | [438](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L438) | [439](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L439) | [439](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L439) | [441](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L441)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

/// @audit 20
56: Strings.toHexString(uint160(_srcToken), 20),
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L56)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

/// @audit 0x00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff
7: 0x00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff;
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L7)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

/// @audit 31
25: require(_length + 31 >= _length, "slice_overflow");
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L25)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

/// @audit 128
14: if (_in.length == 1 && uint8(_in[0]) < 128) {
/// @audit 128
17: out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);
/// @audit 56
33: if (_len < 56) {
/// @audit 256
41: i *= 256;
/// @audit 55
45: out_[0] = bytes1(uint8(lenLen) + uint8(_offset) + 55);
/// @audit 256
47: out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));
/// @audit 32
59: for (; i < 32; i++) {
/// @audit 32
65: out_ = new bytes(32 - i);
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L17) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L33) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L41) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L59) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L65)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

/// @audit 32
97: } else if (currentNode.encoded.length >= 32) {
/// @audit 32
221: id_ = _node.length < 32 ? RLPReader.readRawBytes(_node) : RLPReader.readBytes(_node);
```
[97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L97) | [221](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L221)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

/// @audit 42_139_678_854_452_767_551
19: if (x <= -42_139_678_854_452_767_551) {
/// @audit 135_305_999_368_893_231_589
26: if (x >= 135_305_999_368_893_231_589) revert Overflow();
/// @audit 78
33: x = (x << 78) / 5 ** 18;
/// @audit 5 ** 18
33: x = (x << 78) / 5 ** 18;
/// @audit 96
39: int256 k = ((x << 96) / 54_916_777_467_707_473_351_141_471_128 + 2 ** 95) >> 96;
/// @audit 54_916_777_467_707_473_351_141_471_128
39: int256 k = ((x << 96) / 54_916_777_467_707_473_351_141_471_128 + 2 ** 95) >> 96;
/// @audit 2 ** 95
39: int256 k = ((x << 96) / 54_916_777_467_707_473_351_141_471_128 + 2 ** 95) >> 96;
/// @audit 54_916_777_467_707_473_351_141_471_128
40: x = x - k * 54_916_777_467_707_473_351_141_471_128;
/// @audit 1_346_386_616_545_796_478_920_950_773_328
45: int256 y = x + 1_346_386_616_545_796_478_920_950_773_328;
/// @audit 96
46: y = ((y * x) >> 96) + 57_155_421_227_552_351_082_224_309_758_442;
/// @audit 57_155_421_227_552_351_082_224_309_758_442
46: y = ((y * x) >> 96) + 57_155_421_227_552_351_082_224_309_758_442;
/// @audit 94_201_549_194_550_492_254_356_042_504_812
47: int256 p = y + x - 94_201_549_194_550_492_254_356_042_504_812;
/// @audit 96
48: p = ((p * y) >> 96) + 28_719_021_644_029_726_153_956_944_680_412_240;
/// @audit 28_719_021_644_029_726_153_956_944_680_412_240
48: p = ((p * y) >> 96) + 28_719_021_644_029_726_153_956_944_680_412_240;
/// @audit 4_385_272_521_454_847_904_659_076_985_693_276
49: p = p * x + (4_385_272_521_454_847_904_659_076_985_693_276 << 96);
/// @audit 96
49: p = p * x + (4_385_272_521_454_847_904_659_076_985_693_276 << 96);
/// @audit 2_855_989_394_907_223_263_936_484_059_900
53: int256 q = x - 2_855_989_394_907_223_263_936_484_059_900;
/// @audit 96
54: q = ((q * x) >> 96) + 50_020_603_652_535_783_019_961_831_881_945;
/// @audit 50_020_603_652_535_783_019_961_831_881_945
54: q = ((q * x) >> 96) + 50_020_603_652_535_783_019_961_831_881_945;
/// @audit 96
55: q = ((q * x) >> 96) - 533_845_033_583_426_703_283_633_433_725_380;
/// @audit 533_845_033_583_426_703_283_633_433_725_380
55: q = ((q * x) >> 96) - 533_845_033_583_426_703_283_633_433_725_380;
/// @audit 96
56: q = ((q * x) >> 96) + 3_604_857_256_930_695_427_073_651_918_091_429;
/// @audit 3_604_857_256_930_695_427_073_651_918_091_429
56: q = ((q * x) >> 96) + 3_604_857_256_930_695_427_073_651_918_091_429;
/// @audit 96
57: q = ((q * x) >> 96) - 14_423_608_567_350_463_180_887_372_962_807_573;
/// @audit 14_423_608_567_350_463_180_887_372_962_807_573
57: q = ((q * x) >> 96) - 14_423_608_567_350_463_180_887_372_962_807_573;
/// @audit 96
58: q = ((q * x) >> 96) + 26_449_188_498_355_588_339_934_803_723_976_023;
/// @audit 26_449_188_498_355_588_339_934_803_723_976_023
58: q = ((q * x) >> 96) + 26_449_188_498_355_588_339_934_803_723_976_023;
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L19) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L26) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L33) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L33) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L39) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L39) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L39) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L40) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L46) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L47) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L48) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L49) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L49) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L53) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L54) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L55) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L56) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L57) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L58) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L58)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit 89
152: if (_proof.data.length != 89) revert SGX_INVALID_PROOF();
/// @audit 20
155: address newInstance = address(bytes20(Bytes.slice(_proof.data, 4, 20)));
/// @audit 24
156: bytes memory signature = Bytes.slice(_proof.data, 24);
```
[152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L152) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L155) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L156)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit 1e18
197: uint128 _amountUnlocked = amountUnlocked / 1e18; // divide first
```
[197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L197)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit 0x89f72d7c488e5b53a77c23ebcb36970ef7eb5bcf6658e9b8292cfbe4703a8473
34: 0x89f72d7c488e5b53a77c23ebcb36970ef7eb5bcf6658e9b8292cfbe4703a8473;
/// @audit 32
313: bytes32 expectedAuthDataHash = bytes32(qeEnclaveReport.reportData.substring(0, 32));
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L34) | [313](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L313)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit 0x17
135: (notBeforeTag != 0x17 && notBeforeTag == 0x18)
/// @audit 0x18
135: (notBeforeTag != 0x17 && notBeforeTag == 0x18)
/// @audit 0x17
136: || (notAfterTag != 0x17 && notAfterTag != 0x18)
/// @audit 0x18
136: || (notAfterTag != 0x17 && notAfterTag != 0x18)
/// @audit 32
174: bytes memory sigX = _trimBytes(der.bytesAt(sigPtr), 32);
/// @audit 32
177: bytes memory sigY = _trimBytes(der.bytesAt(sigPtr), 32);
/// @audit 64
180: cert.pubKey = _trimBytes(der.bytesAt(subjectPublicKeyInfoPtr), 64);
/// @audit 0xA3
189: if (der[tbsPtr.ixs()] != 0xA3) {
/// @audit 0x06
288: if (der[internalPtr.ixs()] != 0x06) {
/// @audit 0x06
303: if (der[extnValueOidPtr.ixs()] != 0x06) {
/// @audit 256
359: ? uint16(bytes2(svnValueBytes)) / 256
```
[135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L135) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L136) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L136) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L174) | [177](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L177) | [180](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L180) | [189](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L189) | [288](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L288) | [303](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L303) | [359](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L359)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

/// @audit 432
33: uint256 localAuthDataSize = littleEndianDecode(quote.substring(432, 4));
/// @audit 436
34: if (quote.length - 436 != localAuthDataSize) {
/// @audit 48
38: bytes memory rawHeader = quote.substring(0, 48);
/// @audit 436
46: parseAuthDataAndVerifyCertType(quote.substring(436, localAuthDataSize), pemCertLibAddr);
/// @audit 48
51: bytes memory rawLocalEnclaveReport = quote.substring(48, 384);
/// @audit 384
51: bytes memory rawLocalEnclaveReport = quote.substring(48, 384);
/// @audit 96
78: localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
/// @audit 60
78: localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
/// @audit 64
79: && localEnclaveReport.reportData.length == 64,
/// @audit 96
83: pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
/// @audit 60
83: pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
/// @audit 64
84: && pckSignedQeReport.reportData.length == 64,
/// @audit 64
95: v3Quote.v3AuthData.ecdsa256BitSignature.length == 64
/// @audit 64
96: && v3Quote.v3AuthData.ecdsaAttestationKey.length == 64
/// @audit 64
97: && v3Quote.v3AuthData.qeReportSignature.length == 64,
/// @audit 48
106: uint32 totalQuoteSize = 48 // header
/// @audit 384
107: + 384 // local QE report
/// @audit 64
108: + 64 // ecdsa256BitSignature
/// @audit 64
109: + 64 // ecdsaAttestationKey
/// @audit 384
110: + 384 // QE report
/// @audit 64
111: + 64 // qeReportSignature
/// @audit 16
138: enclaveReport.cpuSvn = bytes16(rawEnclaveReport.substring(0, 16));
/// @audit 16
139: enclaveReport.miscSelect = bytes4(rawEnclaveReport.substring(16, 4));
/// @audit 20
140: enclaveReport.reserved1 = bytes28(rawEnclaveReport.substring(20, 28));
/// @audit 28
140: enclaveReport.reserved1 = bytes28(rawEnclaveReport.substring(20, 28));
/// @audit 48
141: enclaveReport.attributes = bytes16(rawEnclaveReport.substring(48, 16));
/// @audit 16
141: enclaveReport.attributes = bytes16(rawEnclaveReport.substring(48, 16));
/// @audit 64
142: enclaveReport.mrEnclave = bytes32(rawEnclaveReport.substring(64, 32));
/// @audit 32
142: enclaveReport.mrEnclave = bytes32(rawEnclaveReport.substring(64, 32));
/// @audit 96
143: enclaveReport.reserved2 = bytes32(rawEnclaveReport.substring(96, 32));
/// @audit 32
143: enclaveReport.reserved2 = bytes32(rawEnclaveReport.substring(96, 32));
/// @audit 128
144: enclaveReport.mrSigner = bytes32(rawEnclaveReport.substring(128, 32));
/// @audit 32
144: enclaveReport.mrSigner = bytes32(rawEnclaveReport.substring(128, 32));
/// @audit 160
145: enclaveReport.reserved3 = rawEnclaveReport.substring(160, 96);
/// @audit 96
145: enclaveReport.reserved3 = rawEnclaveReport.substring(160, 96);
/// @audit 256
146: enclaveReport.isvProdId = uint16(littleEndianDecode(rawEnclaveReport.substring(256, 2)));
/// @audit 258
147: enclaveReport.isvSvn = uint16(littleEndianDecode(rawEnclaveReport.substring(258, 2)));
/// @audit 260
148: enclaveReport.reserved4 = rawEnclaveReport.substring(260, 60);
/// @audit 60
148: enclaveReport.reserved4 = rawEnclaveReport.substring(260, 60);
/// @audit 320
149: enclaveReport.reportData = rawEnclaveReport.substring(320, 64);
/// @audit 64
149: enclaveReport.reportData = rawEnclaveReport.substring(320, 64);
/// @audit 16
155: uint256 upperDigit = digits / 16;
/// @audit 16
156: uint256 lowerDigit = digits % 16;
/// @audit 16
158: uint256 acc = lowerDigit * (16 ** (2 * i));
/// @audit 16
159: acc += upperDigit * (16 ** ((2 * i) + 1));
/// @audit 12
185: bytes16 qeVendorId = bytes16(rawHeader.substring(12, 16));
/// @audit 16
185: bytes16 qeVendorId = bytes16(rawHeader.substring(12, 16));
/// @audit 10
195: pceSvn: bytes2(rawHeader.substring(10, 2)),
/// @audit 28
197: userData: bytes20(rawHeader.substring(28, 20))
/// @audit 20
197: userData: bytes20(rawHeader.substring(28, 20))
/// @audit 576
212: qeAuthData.parsedDataSize = uint16(littleEndianDecode(rawAuthData.substring(576, 2)));
/// @audit 578
213: qeAuthData.data = rawAuthData.substring(578, qeAuthData.parsedDataSize);
/// @audit 578
215: uint256 offset = 578 + qeAuthData.parsedDataSize;
/// @audit 64
227: authDataV3.ecdsa256BitSignature = rawAuthData.substring(0, 64);
/// @audit 64
228: authDataV3.ecdsaAttestationKey = rawAuthData.substring(64, 64);
/// @audit 128
229: bytes memory rawQeReport = rawAuthData.substring(128, 384);
/// @audit 384
229: bytes memory rawQeReport = rawAuthData.substring(128, 384);
/// @audit 512
231: authDataV3.qeReportSignature = rawAuthData.substring(512, 64);
/// @audit 64
231: authDataV3.qeReportSignature = rawAuthData.substring(512, 64);
```
[33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L34) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L38) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L46) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L51) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L51) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L78) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L78) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L79) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L83) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L83) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L84) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L95) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L96) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L97) | [106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L106) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L107) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L108) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L109) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L110) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L111) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L138) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L139) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L140) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L140) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L141) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L141) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L142) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L142) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L143) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L143) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L144) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L144) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L145) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L145) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L146) | [147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L148) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L148) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L149) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L149) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L155) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L156) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L158) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L159) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L185) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L185) | [195](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L195) | [197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L197) | [197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L197) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L212) | [213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L213) | [215](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L215) | [227](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L227) | [228](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L228) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L229) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L229) | [231](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L231) | [231](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L231)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

/// @audit 80
20: return uint80(self >> 80);
/// @audit 160
25: return uint80(self >> 160);
/// @audit 80
30: _ixs |= _ixf << 80;
/// @audit 160
31: _ixs |= _ixl << 160;
/// @audit 0x03
57: require(der[ptr.ixs()] == 0x03, "Not type BIT STRING");
/// @audit 0x04
67: require(der[ptr.ixs()] == 0x04, "Not type OCTET STRING");
/// @audit 0x20
88: require(der[ptr.ixs()] & 0x20 == 0x20, "Not a constructed type");
/// @audit 0x02
142: require(der[ptr.ixs()] == 0x02, "Not type INTEGER");
/// @audit 0x80
143: require(der[ptr.ixf()] & 0x80 == 0, "Not positive");
/// @audit 32
145: return uint256(der.readBytesN(ptr.ixf(), len) >> (32 - len) * 8);
/// @audit 0x02
155: require(der[ptr.ixs()] == 0x02, "Not type INTEGER");
/// @audit 0x80
156: require(der[ptr.ixf()] & 0x80 == 0, "Not positive");
/// @audit 0x03
180: require(der[ptr.ixs()] == 0x03, "ixs Not type BIT STRING 0x03");
/// @audit 0x00
182: require(der[ptr.ixf()] == 0x00, "ixf Not 0");
/// @audit 0x80
191: if ((der[ix + 1] & 0x80) == 0) {
/// @audit 0x7F
196: uint8 lengthbytesLength = uint8(der[ix + 1] & 0x7F);
/// @audit 32
203: der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L20) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L25) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L30) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L31) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L57) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L67) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L88) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L142) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L143) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L145) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L155) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L156) | [180](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L180) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L182) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L191) | [196](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L196) | [203](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L203)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit 32
225: require(idx + 32 <= self.length, "unexpected idx");
/// @audit 20
238: require(idx + 20 <= self.length, "unexpected idx");
/// @audit 32
264: require(len <= 32, "unexpected len");
/// @audit 52
329: require(len <= 52, "unexpected len");
/// @audit 0x30
335: require(char >= 0x30 && char <= 0x7A, "invalid char");
/// @audit 0x7A
335: require(char >= 0x30 && char <= 0x7A, "invalid char");
/// @audit 0x30
336: decoded = uint8(BASE32_HEX_TABLE[uint256(uint8(char)) - 0x30]);
/// @audit 0x20
337: require(decoded <= 0x20, "invalid decoded");
/// @audit 256
368: return bytes32(ret << (256 - bitlen));
```
[225](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L225) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L238) | [264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L264) | [329](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L329) | [335](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L335) | [335](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L335) | [336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L336) | [337](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L337) | [368](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L368)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

/// @audit 2016
11: Copyright 2016, Adri Massanet
/// @audit 0x30
54: 0x30,
/// @audit 0x31
55: 0x31,
/// @audit 0x30
56: 0x30,
/// @audit 0x0d
57: 0x0d,
/// @audit 0x06
58: 0x06,
/// @audit 0x09
59: 0x09,
/// @audit 0x60
60: 0x60,
/// @audit 0x86
61: 0x86,
/// @audit 0x48
62: 0x48,
/// @audit 0x01
63: 0x01,
/// @audit 0x65
64: 0x65,
/// @audit 0x03
65: 0x03,
/// @audit 0x04
66: 0x04,
/// @audit 0x02
67: 0x02,
/// @audit 0x01
68: 0x01,
/// @audit 0x05
69: 0x05,
/// @audit 0x00
70: 0x00
/// @audit 0x30
74: 0x30,
/// @audit 0x2f
75: 0x2f,
/// @audit 0x30
76: 0x30,
/// @audit 0x0b
77: 0x0b,
/// @audit 0x06
78: 0x06,
/// @audit 0x09
79: 0x09,
/// @audit 0x60
80: 0x60,
/// @audit 0x86
81: 0x86,
/// @audit 0x48
82: 0x48,
/// @audit 0x01
83: 0x01,
/// @audit 0x65
84: 0x65,
/// @audit 0x03
85: 0x03,
/// @audit 0x04
86: 0x04,
/// @audit 0x02
87: 0x02,
/// @audit 0x01
88: 0x01
/// @audit 0x30
223: 0x30,
/// @audit 0x21
224: 0x21,
/// @audit 0x30
225: 0x30,
/// @audit 0x09
226: 0x09,
/// @audit 0x06
227: 0x06,
/// @audit 0x05
228: 0x05,
/// @audit 0x2b
229: 0x2b,
/// @audit 0x0e
230: 0x0e,
/// @audit 0x03
231: 0x03,
/// @audit 0x02
232: 0x02,
/// @audit 0x1a
233: 0x1a,
/// @audit 0x05
234: 0x05,
/// @audit 0x00
235: 0x00,
/// @audit 0x04
236: 0x04,
/// @audit 0x14
237: 0x14
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L11) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L54) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L57) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L58) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L61) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L62) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L66) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L67) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L68) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L69) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L70) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L74) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L75) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L76) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L77) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L78) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L79) | [80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L80) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L81) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L82) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L83) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L84) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L85) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L86) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L87) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L88) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L223) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L224) | [225](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L225) | [226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L226) | [227](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L227) | [228](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L228) | [229](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L229) | [230](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L230) | [231](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L231) | [232](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L232) | [233](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L233) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L234) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L235) | [236](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L236) | [237](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L237)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

/// @audit 32
32: if lt(count, 32) {
/// @audit 256
33: let mask := not(sub(exp(256, sub(32, count)), 1))
/// @audit 32
33: let mask := not(sub(exp(256, sub(32, count)), 1))
/// @audit 64
39: for { let i := 0 } lt(i, totallen) { i := add(i, 64) } {
/// @audit 32
41: mstore(add(scratch, 32), readword(data, add(i, 32), len))
/// @audit 64
44: switch lt(sub(len, i), 64)
/// @audit 0x80
45: case 1 { mstore8(add(scratch, sub(len, i)), 0x80) }
/// @audit 64
48: switch eq(i, sub(totallen, 64))
/// @audit 32
49: case 1 { mstore(add(scratch, 32), or(mload(add(scratch, 32)), mul(len, 8))) }
/// @audit 64
52: for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
/// @audit 128
52: for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
/// @audit 12
52: for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
/// @audit 12
55: xor(mload(add(scratch, sub(j, 12))), mload(add(scratch, sub(j, 32)))),
/// @audit 32
55: xor(mload(add(scratch, sub(j, 12))), mload(add(scratch, sub(j, 32)))),
/// @audit 56
56: xor(mload(add(scratch, sub(j, 56))), mload(add(scratch, sub(j, 64))))
/// @audit 64
56: xor(mload(add(scratch, sub(j, 56))), mload(add(scratch, sub(j, 64))))
/// @audit 0xFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE
62: 0xFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFEFFFFFFFE
/// @audit 0x80000000
65: div(temp, 0x80000000),
/// @audit 0x0000000100000001000000010000000100000001000000010000000100000001
66: 0x0000000100000001000000010000000100000001000000010000000100000001
/// @audit 128
71: for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
/// @audit 320
71: for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
/// @audit 24
71: for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
/// @audit 24
74: xor(mload(add(scratch, sub(j, 24))), mload(add(scratch, sub(j, 64)))),
/// @audit 64
74: xor(mload(add(scratch, sub(j, 24))), mload(add(scratch, sub(j, 64)))),
/// @audit 112
75: xor(mload(add(scratch, sub(j, 112))), mload(add(scratch, sub(j, 128))))
/// @audit 128
75: xor(mload(add(scratch, sub(j, 112))), mload(add(scratch, sub(j, 128))))
/// @audit 0xFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFC
81: 0xFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFCFFFFFFFC
/// @audit 0x40000000
84: div(temp, 0x40000000),
/// @audit 0x0000000300000003000000030000000300000003000000030000000300000003
85: 0x0000000300000003000000030000000300000003000000030000000300000003
/// @audit 80
94: for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
/// @audit 20
95: switch div(j, 20)
/// @audit 0x100000000000000000000
98: f := xor(div(x, 0x100000000000000000000), div(x, 0x10000000000))
/// @audit 0x10000000000
98: f := xor(div(x, 0x100000000000000000000), div(x, 0x10000000000))
/// @audit 0x1000000000000000000000000000000
99: f := and(div(x, 0x1000000000000000000000000000000), f)
/// @audit 0x10000000000
100: f := xor(div(x, 0x10000000000), f)
/// @audit 0x5A827999
101: k := 0x5A827999
/// @audit 0x1000000000000000000000000000000
107: div(x, 0x1000000000000000000000000000000),
/// @audit 0x100000000000000000000
108: div(x, 0x100000000000000000000)
/// @audit 0x10000000000
110: f := xor(div(x, 0x10000000000), f)
/// @audit 0x6ED9EBA1
111: k := 0x6ED9EBA1
/// @audit 0x1000000000000000000000000000000
117: div(x, 0x1000000000000000000000000000000),
/// @audit 0x100000000000000000000
118: div(x, 0x100000000000000000000)
/// @audit 0x10000000000
120: f := and(div(x, 0x10000000000), f)
/// @audit 0x1000000000000000000000000000000
124: div(x, 0x1000000000000000000000000000000),
/// @audit 0x100000000000000000000
125: div(x, 0x100000000000000000000)
/// @audit 0x8F1BBCDC
129: k := 0x8F1BBCDC
/// @audit 0x1000000000000000000000000000000
135: div(x, 0x1000000000000000000000000000000),
/// @audit 0x100000000000000000000
136: div(x, 0x100000000000000000000)
/// @audit 0x10000000000
138: f := xor(div(x, 0x10000000000), f)
/// @audit 0xCA62C1D6
139: k := 0xCA62C1D6
/// @audit 0x80000000000000000000000000000000000000000000000
142: let temp := and(div(x, 0x80000000000000000000000000000000000000000000000), 0x1F)
/// @audit 0x1F
142: let temp := and(div(x, 0x80000000000000000000000000000000000000000000000), 0x1F)
/// @audit 0x800000000000000000000000000000000000000
144: or(and(div(x, 0x800000000000000000000000000000000000000), 0xFFFFFFE0), temp)
/// @audit 0xFFFFFFE0
144: or(and(div(x, 0x800000000000000000000000000000000000000), 0xFFFFFFE0), temp)
/// @audit 0xFFFFFFFF
146: temp := add(and(x, 0xFFFFFFFF), temp)
/// @audit 0x100000000000000000000000000000000000000000000000000000000
152: 0x100000000000000000000000000000000000000000000000000000000
/// @audit 0x10000000000
158: div(x, 0x10000000000),
/// @audit 0x10000000000000000000000000000000000000000
159: mul(temp, 0x10000000000000000000000000000000000000000)
/// @audit 0xFFFFFFFF00FFFFFFFF000000000000FFFFFFFF00FFFFFFFF
163: and(x, 0xFFFFFFFF00FFFFFFFF000000000000FFFFFFFF00FFFFFFFF),
/// @audit 0x4000000000000
166: and(div(x, 0x4000000000000), 0xC0000000),
/// @audit 0xC0000000
166: and(div(x, 0x4000000000000), 0xC0000000),
/// @audit 0x400000000000000000000
167: and(div(x, 0x400000000000000000000), 0x3FFFFFFF)
/// @audit 0x3FFFFFFF
167: and(div(x, 0x400000000000000000000), 0x3FFFFFFF)
/// @audit 0x100000000000000000000
169: 0x100000000000000000000
/// @audit 0xFFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF
174: h := and(add(h, x), 0xFFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF00FFFFFFFF)
/// @audit 0x100000000
182: and(div(h, 0x100000000), 0xFFFFFFFF00000000000000000000000000000000),
/// @audit 0xFFFFFFFF00000000000000000000000000000000
182: and(div(h, 0x100000000), 0xFFFFFFFF00000000000000000000000000000000),
/// @audit 0x1000000
183: and(div(h, 0x1000000), 0xFFFFFFFF000000000000000000000000)
/// @audit 0xFFFFFFFF000000000000000000000000
183: and(div(h, 0x1000000), 0xFFFFFFFF000000000000000000000000)
/// @audit 0x10000
185: and(div(h, 0x10000), 0xFFFFFFFF0000000000000000)
/// @audit 0xFFFFFFFF0000000000000000
185: and(div(h, 0x10000), 0xFFFFFFFF0000000000000000)
/// @audit 0x100
187: and(div(h, 0x100), 0xFFFFFFFF00000000)
/// @audit 0xFFFFFFFF00000000
187: and(div(h, 0x100), 0xFFFFFFFF00000000)
/// @audit 0xFFFFFFFF
189: and(h, 0xFFFFFFFF)
/// @audit 0x1000000000000000000000000
191: 0x1000000000000000000000000
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L32) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L33) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L33) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L39) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L41) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L44) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L45) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L48) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L49) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L52) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L52) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L52) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L55) | [55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L55) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L56) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L56) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L62) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L65) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L66) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L71) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L71) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L71) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L74) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L74) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L75) | [75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L75) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L81) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L84) | [85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L85) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L94) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L95) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L98) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L98) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L99) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L100) | [101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L101) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L107) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L108) | [110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L110) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L111) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L117) | [118](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L118) | [120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L120) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L124) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L125) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L129) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L135) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L136) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L138) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L139) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L142) | [142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L142) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L144) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L144) | [146](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L146) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L152) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L158) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L159) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L163) | [166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L166) | [166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L166) | [167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L167) | [167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L167) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L169) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L174) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L182) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L182) | [183](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L183) | [183](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L183) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L185) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L185) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L187) | [187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L187) | [189](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L189) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L191)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit 64
123: if (signature.length != 64) {
/// @audit 32
126: uint256 r = uint256(bytes32(signature.substring(0, 32)));
/// @audit 32
127: uint256 s = uint256(bytes32(signature.substring(32, 32)));
/// @audit 64
129: if (publicKey.length != 64) {
/// @audit 32
132: uint256 gx = uint256(bytes32(publicKey.substring(0, 32)));
/// @audit 32
133: uint256 gy = uint256(bytes32(publicKey.substring(32, 32)));
```
[123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L123) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L126) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L127) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L129) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L133)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

/// @audit 13
17: if (x509Time.length == 13) {
/// @audit 48
18: if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;
/// @audit 2000
18: if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;
/// @audit 1900
19: else yrs += 1900;
/// @audit 48
21: yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;
/// @audit 1000
21: yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;
/// @audit 100
21: yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;
/// @audit 48
24: yrs += (uint8(x509Time[offset + 0]) - 48) * 10 + uint8(x509Time[offset + 1]) - 48;
/// @audit 10
24: yrs += (uint8(x509Time[offset + 0]) - 48) * 10 + uint8(x509Time[offset + 1]) - 48;
/// @audit 48
25: mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;
/// @audit 10
25: mnths = (uint8(x509Time[offset + 2]) - 48) * 10 + uint8(x509Time[offset + 3]) - 48;
/// @audit 48
26: dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;
/// @audit 10
26: dys += (uint8(x509Time[offset + 4]) - 48) * 10 + uint8(x509Time[offset + 5]) - 48;
/// @audit 48
27: hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;
/// @audit 10
27: hrs += (uint8(x509Time[offset + 6]) - 48) * 10 + uint8(x509Time[offset + 7]) - 48;
/// @audit 48
28: mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;
/// @audit 10
28: mins += (uint8(x509Time[offset + 8]) - 48) * 10 + uint8(x509Time[offset + 9]) - 48;
/// @audit 10
29: secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;
/// @audit 48
29: secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;
/// @audit 11
29: secs += (uint8(x509Time[offset + 10]) - 48) * 10 + uint8(x509Time[offset + 11]) - 48;
/// @audit 1970
48: for (uint16 i = 1970; i < year; ++i) {
/// @audit 31_622_400
50: timestamp += 31_622_400; // Leap year in seconds
/// @audit 31_536_000
52: timestamp += 31_536_000; // Normal year in seconds
/// @audit 28
56: uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
/// @audit 31
56: uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
/// @audit 30
56: uint8[12] memory monthDays = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
/// @audit 29
57: if (isLeapYear(year)) monthDays[1] = 29;
/// @audit 86_400
60: timestamp += uint256(monthDays[i - 1]) * 86_400; // Days in seconds
/// @audit 86_400
63: timestamp += uint256(day - 1) * 86_400; // Days in seconds
/// @audit 3600
64: timestamp += uint256(hour) * 3600; // Hours in seconds
/// @audit 60
65: timestamp += uint256(minute) * 60; // Minutes in seconds
/// @audit 100
73: if (year % 100 != 0) return true;
/// @audit 400
74: if (year % 400 != 0) return false;
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L18) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L19) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L24) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L25) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L26) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L27) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L28) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L29) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L29) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L29) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L48) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L50) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L52) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L56) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L56) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L56) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L57) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L60) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L63) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L65) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L73) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L74)
</details>

### [N-73] `require()`/`revert()` statements should have descriptive reason strings

In Solidity, require() and revert() functions can include an optional 'reason' string that describes what caused the function to fail. This string can be incredibly helpful during testing and debugging, as it provides more context for what went wrong.

Please ensure that the reason strings are comprehensive and descriptive. Strings with fewer than 12 characters may not provide enough context to understand the cause of the function failure.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit Reason string `onlyOwner` is not informative enough
61: require(msg.sender == owner, "onlyOwner");
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L61)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

/// @audit Reason string `ixf Not 0` is not informative enough
182: require(der[ptr.ixf()] == 0x00, "ixf Not 0");
```
[182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L182)
</details>

### [N-74] Variable Names Not in mixedCase

State or Local Variable names in your contract don't align with the Solidity naming convention.
For clarity and code consistency, it's recommended to use mixedCase for local and state variables that are not constants, and add a trailing underscore for internal variables.
Adhering to this convention helps in improving code readability and maintenance.
[More information in Documentation](https://docs.soliditylang.org/en/v0.8.20/style-guide.html#function-names)

<details>
<summary><i>11 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit - Variable name `__addresses` should be in mixedCase
12: mapping(uint256 chainId => mapping(bytes32 name => address addr)) private __addresses;
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L12)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit - Variable name `__reentry` should be in mixedCase
21: uint8 private __reentry;
/// @audit - Variable name `__paused` should be in mixedCase
23: uint8 private __paused;
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L21) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L23)

```solidity
File: packages/protocol/contracts/L1/TaikoData.sol

/// @audit - Variable name `__reserved1` should be in mixedCase
172: uint8 __reserved1;
/// @audit - Variable name `__reserved2` should be in mixedCase
173: uint16 __reserved2;
/// @audit - Variable name `__reserved3` should be in mixedCase
174: uint32 __reserved3;
/// @audit - Variable name `blockId_mod_blockRingBufferSize` should be in mixedCase
186: uint64 blockId_mod_blockRingBufferSize
                => mapping(uint32 transitionId => TransitionState ts)
```
[172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L172) | [173](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L173) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L174) | [186](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L186)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit - Variable name `__ctx` should be in mixedCase
38: Context private __ctx;
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit - Variable name `__srcDecimals` should be in mixedCase
24: uint8 private __srcDecimals;
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L24)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit - Variable name `__symbol` should be in mixedCase
22: string private __symbol;
/// @audit - Variable name `__name` should be in mixedCase
25: string private __name;
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L22) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L25)
</details>

### [N-75] Consider moving `msg.sender` checks to a common authorization `modifier`

Functions that are only allowed to be called by a specific actor should use a modifier to check if the caller is the specified actor (e.g., owner, specific role, etc.).
Using `require` to check `msg.sender` in the function body is less efficient and less clear.

Consider refactoring these `require` statements into a modifier for better readability, organization, and gas efficiency.

<details>
<summary><i>10 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

310: if (proposerOne != address(0) && msg.sender != proposerOne) {
```
[310](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L310)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

122: if (msg.sender != GOLDEN_TOUCH_ADDRESS) revert L2_INVALID_SENDER();
```
[122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L122)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

77: if (!isAuthorized[msg.sender]) revert SS_UNAUTHORIZED();
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L77)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

249: if (invocationDelay != 0 && msg.sender != proofReceipt[msgHash].preferredExecutor) {
260: if (_message.gasLimit == 0 && msg.sender != _message.destOwner) {
294: if (msg.sender == refundTo) {
322: if (msg.sender != _message.destOwner) revert B_PERMISSION_DENIED();
```
[249](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L249) | [260](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L260) | [294](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L294) | [322](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L322)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

60: if (msg.sender == migratingAddress) {
78: if (msg.sender != _account) revert BB_PERMISSION_DENIED();
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L60) | [78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L78)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

65: if (ctx_.from != msg.sender) revert VAULT_PERMISSION_DENIED();
```
[65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L65)
</details>

### [N-76] NatSpec: Contract declarations should have descriptions

NatSpec descriptions are crucial for self-documenting smart contracts. They provide vital information 
about the contract's purpose and behavior.

Specifically, the `@dev` or `@notice` tags are quintessential 
for detailed explanations about the contract. 

Ensure these descriptions are present directly above the contract definition braces. 
This positioning allows the compiler to correctly identify and associate the descriptions with the contract.

[Learn More about Proper NatSpec Formatting](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>4 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

11: abstract contract AddressResolver is IAddressResolver, Initializable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L11)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

4: library ExcessivelySafeCall {
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L4)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

5: library LibFixedPointMath {
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L5)
</details>

### [N-77] NatSpec: Contract declarations should have `@author` tag

In the world of decentralized code, giving credit is key. NatSpec's `@author` tag acknowledges the minds behind the code.
It appears this Solidity contract omits the `@author` directive in its NatSpec annotations.
Properly attributing code to its contributors not only recognizes effort but also aids in establishing trust and credibility.
[Dive Deeper into NatSpec Guidelines](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>76 issue instances in 70 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/IAddressManager.sol

7: interface IAddressManager {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L7)

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/common/IAddressResolver.sol

13: interface IAddressResolver {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressResolver.sol#L13)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

8: library Lib4844 {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L8)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

13: library LibAddress {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L13)

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

7: library LibMath {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L7)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

15: library LibTrieProof {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L15)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L9)

```solidity
File: packages/protocol/contracts/L1/hooks/IHook.sol

8: interface IHook {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L8)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

14: contract AssignmentHook is EssentialContract, IHook {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L14)

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

8: interface ITaikoL1 {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L8)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

12: library LibDepositing {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L12)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

15: library LibProposing {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L15)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

16: library LibProving {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L16)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

9: library LibUtils {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L9)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

16: library LibVerifying {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L16)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

10: contract GuardianProver is Guardians {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L10)

```solidity
File: packages/protocol/contracts/L1/TaikoData.sol

8: library TaikoData {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L8)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L22)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

7: interface ITierProvider {
37: library LibTiers {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L7) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L37)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

10: contract DevnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

10: contract MainnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

10: contract TestnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

10: library Lib1559Math {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L10)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

21: contract TaikoL2 is CrossChainOwned {
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L21)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

9: contract TaikoL2EIP1559Configurable is TaikoL2 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L9)

```solidity
File: packages/protocol/contracts/signal/ISignalService.sol

12: interface ISignalService {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L12)

```solidity
File: packages/protocol/contracts/signal/LibSignals.sol

6: library LibSignals {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L6)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

14: contract SignalService is EssentialContract, ISignalService {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L14)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

8: interface IBridge {
160: interface IRecallableSender {
174: interface IMessageInvocable {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L8) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L160) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L174)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

16: contract Bridge is EssentialContract, IBridge {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

8: interface IUSDC {
28: contract USDCAdapter is BridgedERC20Base {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L8) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

16: interface IERC1155NameAndSymbol {
29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L16) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

18: contract ERC20Vault is BaseVault {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L18)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/IBridgedERC20.sol

10: interface IBridgedERC20 {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/IBridgedERC20.sol#L10)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

8: library LibBridgedToken {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L8)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

6: library Bytes {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L6)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

9: library RLPReader {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

11: library MerkleTrie {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L11)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

9: library SecureMerkleTrie {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

6: library LibFixedPointMath {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L6)

```solidity
File: packages/protocol/contracts/verifiers/IVerifier.sol

9: interface IVerifier {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L9)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

10: contract GuardianVerifier is EssentialContract, IVerifier {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L10)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

19: contract SgxVerifier is EssentialContract, IVerifier {
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L19)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

11: contract ERC20Airdrop is MerkleClaimable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L11)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

12: contract ERC20Airdrop2 is MerkleClaimable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L12)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

9: contract ERC721Airdrop is MerkleClaimable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L9)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

25: contract TimelockTokenPool is EssentialContract {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L25)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

22: contract AutomataDcapV3Attestation is IAttestation {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L22)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

8: interface IAttestation {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

6: interface ISigVerifyLib {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol

6: library EnclaveIdStruct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

6: interface IPEMCertChainLib {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

12: contract PEMCertChainLib is IPEMCertChainLib {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L12)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

11: library V3Parser {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L11)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

6: library V3Struct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol

6: library TCBInfoStruct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

12: library NodePtr {
38: library Asn1Decode {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L12) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L38)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

8: library BytesUtils {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

34: library RsaVerify {
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L34)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

10: library SHA1 {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L10)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

15: contract SigVerifyLib is ISigVerifyLib {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L15)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

7: library X509DateUtils {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L7)
</details>

### [N-78] Style guide: Non-`external`/`public` function names should begin with an underscore

In Solidity, it is suggested to use a leading underscore for non-public (private and internal) function names.
This convention helps to distinguish clearly between public/external and non-public functions, improving code clarity.
By adhering to this convention, developers can mitigate potential misinterpretation or errors, thus making the code more comprehensible and easier to maintain.

<details>
<summary><i>96 issue instances in 26 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

30: function evaluatePoint(
        bytes32 _blobHash,
        uint256 _x,
        uint256 _y,
        bytes1[48] memory _commitment,
        bytes1[48] memory _pointProof
    )
        internal
        view
    {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L30)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

22: function sendEther(address _to, uint256 _amount, uint256 _gasLimit) internal {
42: function sendEther(address _to, uint256 _amount) internal {
45: function supportsInterface(
        address _addr,
        bytes4 _interfaceId
    )
        internal
        view
        returns (bool result_)
    {
60: function isValidSignature(
        address _addr,
        bytes32 _hash,
        bytes memory _sig
    )
        internal
        view
        returns (bool)
    {
76: function isSenderEOA() internal view returns (bool) {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L22) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L42) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L45) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L60) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L76)

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

12: function min(uint256 _a, uint256 _b) internal pure returns (uint256) {
20: function max(uint256 _a, uint256 _b) internal pure returns (uint256) {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L12) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L20)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

34: function verifyMerkleProof(
        bytes32 _rootHash,
        address _addr,
        bytes32 _slot,
        bytes32 _value,
        bytes[] memory _accountProof,
        bytes[] memory _storageProof
    )
        internal
        pure
        returns (bytes32 storageRoot_)
    {
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L34)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

29: function depositEtherToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        address _recipient
    )
        internal
    {
67: function processDeposits(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        address _feeRecipient
    )
        internal
        returns (TaikoData.EthDeposit[] memory deposits_)
    {
122: function canDepositEthToL2(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint256 _amount
    )
        internal
        view
        returns (bool)
    {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L29) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L67) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L122)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

68: function proposeBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        bytes calldata _data,
        bytes calldata _txList
    )
        internal
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
287: function isBlobReusable(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        bytes32 _blobHash
    )
        internal
        view
        returns (bool)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L68) | [287](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L287)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
    {
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

70: function getTransitionId(
        TaikoData.State storage _state,
        TaikoData.Block storage _blk,
        uint64 _slot,
        bytes32 _parentHash
    )
        internal
        view
        returns (uint32 tid_)
    {
```
[70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L70)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

85: function verifyBlocks(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _maxBlocksToVerify
    )
        internal
    {
```
[85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L85)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

110: function approve(uint256 _operationId, bytes32 _hash) internal returns (bool approved_) {
123: function deleteApproval(bytes32 _hash) internal {
127: function isApproved(uint256 _approvalBits) internal view returns (bool) {
```
[110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L110) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L123) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L127)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

16: function basefee(
        uint256 _gasExcess,
        uint256 _adjustmentFactor
    )
        internal
        pure
        returns (uint256)
    {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

46: function checkProcessMessageContext()
        internal
        view
        onlyFromBridge
        returns (IBridge.Context memory ctx_)
    {
57: function checkRecallMessageContext()
        internal
        view
        onlyFromBridge
        returns (IBridge.Context memory ctx_)
    {
```
[46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L46) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L57)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

10: function validateInputs(
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        internal
        view
    {
27: function buildName(
        string memory _name,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
    {
38: function buildSymbol(string memory _symbol) internal pure returns (string memory) {
42: function buildURI(
        address _srcToken,
        uint256 _srcChainId
    )
        internal
        pure
        returns (string memory)
    {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L10) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L27) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L38) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L42)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

25: function excessivelySafeCall(
        address _target,
        uint256 _gas,
        uint256 _value,
        uint16 _maxCopy,
        bytes memory _calldata
    )
        internal
        returns (bool, bytes memory)
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L25)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

15: function slice(
        bytes memory _bytes,
        uint256 _start,
        uint256 _length
    )
        internal
        pure
        returns (bytes memory)
    {
91: function slice(bytes memory _bytes, uint256 _start) internal pure returns (bytes memory) {
102: function toNibbles(bytes memory _bytes) internal pure returns (bytes memory) {
149: function equal(bytes memory _bytes, bytes memory _other) internal pure returns (bool) {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L15) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L91) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L102) | [149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L149)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

35: function toRLPItem(bytes memory _in) internal pure returns (RLPItem memory out_) {
53: function readList(RLPItem memory _in) internal pure returns (RLPItem[] memory out_) {
102: function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {
109: function readBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {
128: function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {
135: function readRawBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L35) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L53) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L102) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L109) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L128) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L135)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

13: function writeBytes(bytes memory _in) internal pure returns (bytes memory out_) {
24: function writeUint(uint256 _in) internal pure returns (bytes memory out_) {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L13) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L24)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

50: function verifyInclusionProof(
        bytes memory _key,
        bytes memory _value,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bool valid_)
    {
68: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
```
[50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L50) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

19: function verifyInclusionProof(
        bytes memory _key,
        bytes memory _value,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bool valid_)
    {
38: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L19) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L38)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

13: function exp(int256 x) internal pure returns (int256 r) {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L13)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

20: function parseInput(
        bytes memory quote,
        address pemCertLibAddr
    )
        internal
        pure
        returns (bool success, V3Struct.ParsedV3QuoteStruct memory v3ParsedQuote)
    {
61: function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
        internal
        pure
        returns (
            bool success,
            V3Struct.Header memory header,
            V3Struct.EnclaveReport memory localEnclaveReport,
            bytes memory signedQuoteData, // concatenation of header and local enclave report bytes
            V3Struct.ECDSAQuoteV3AuthData memory authDataV3
        )
    {
132: function parseEnclaveReport(bytes memory rawEnclaveReport)
        internal
        pure
        returns (V3Struct.EnclaveReport memory enclaveReport)
    {
151: function littleEndianDecode(bytes memory encoded) private pure returns (uint256 decoded) {
164: function parseAndVerifyHeader(bytes memory rawHeader)
        private
        pure
        returns (bool success, V3Struct.Header memory header)
    {
202: function parseAuthDataAndVerifyCertType(
        bytes memory rawAuthData,
        address pemCertLibAddr
    )
        private
        pure
        returns (bool success, V3Struct.ECDSAQuoteV3AuthData memory authDataV3)
    {
244: function packQEReport(V3Struct.EnclaveReport memory enclaveReport)
        internal
        pure
        returns (bytes memory packedQEReport)
    {
266: function parseCerificationChainBytes(
        bytes memory certBytes,
        address pemCertLibAddr
    )
        internal
        pure
        returns (bytes[3] memory certChainData)
    {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L20) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L61) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L132) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L151) | [164](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L164) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L202) | [244](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L244) | [266](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L266)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

14: function ixs(uint256 self) internal pure returns (uint256) {
18: function ixf(uint256 self) internal pure returns (uint256) {
23: function ixl(uint256 self) internal pure returns (uint256) {
28: function getPtr(uint256 _ixs, uint256 _ixf, uint256 _ixl) internal pure returns (uint256) {
47: function root(bytes memory der) internal pure returns (uint256) {
56: function rootOfBitStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {
66: function rootOfOctetStringAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {
77: function nextSiblingOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {
87: function firstChildOf(bytes memory der, uint256 ptr) internal pure returns (uint256) {
98: function isChildOf(uint256 i, uint256 j) internal pure returns (bool) {
111: function bytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {
121: function allBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {
131: function bytes32At(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
141: function uintAt(bytes memory der, uint256 ptr) internal pure returns (uint256) {
154: function uintBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {
164: function keccakOfBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
168: function keccakOfAllBytesAt(bytes memory der, uint256 ptr) internal pure returns (bytes32) {
179: function bitstringAt(bytes memory der, uint256 ptr) internal pure returns (bytes memory) {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L14) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L18) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L23) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L28) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L47) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L56) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L66) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L77) | [87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L87) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L98) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L111) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L121) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L131) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L141) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L154) | [164](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L164) | [168](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L168) | [179](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L179)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

16: function keccak(
        bytes memory self,
        uint256 offset,
        uint256 len
    )
        internal
        pure
        returns (bytes32 ret)
    {
39: function compare(bytes memory self, bytes memory other) internal pure returns (int256) {
56: function compare(
        bytes memory self,
        uint256 offset,
        uint256 len,
        bytes memory other,
        uint256 otheroffset,
        uint256 otherlen
    )
        internal
        pure
        returns (int256)
    {
116: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other,
        uint256 otherOffset,
        uint256 len
    )
        internal
        pure
        returns (bool)
    {
138: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other,
        uint256 otherOffset
    )
        internal
        pure
        returns (bool)
    {
160: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other
    )
        internal
        pure
        returns (bool)
    {
178: function equals(bytes memory self, bytes memory other) internal pure returns (bool) {
188: function readUint8(bytes memory self, uint256 idx) internal pure returns (uint8 ret) {
198: function readUint16(bytes memory self, uint256 idx) internal pure returns (uint16 ret) {
211: function readUint32(bytes memory self, uint256 idx) internal pure returns (uint32 ret) {
224: function readBytes32(bytes memory self, uint256 idx) internal pure returns (bytes32 ret) {
237: function readBytes20(bytes memory self, uint256 idx) internal pure returns (bytes20 ret) {
255: function readBytesN(
        bytes memory self,
        uint256 idx,
        uint256 len
    )
        internal
        pure
        returns (bytes32 ret)
    {
271: function memcpy(uint256 dest, uint256 src, uint256 len) private pure {
284: function substring(
        bytes memory self,
        uint256 offset,
        uint256 len
    )
        internal
        pure
        returns (bytes memory)
    {
320: function base32HexDecodeWord(
        bytes memory self,
        uint256 off,
        uint256 len
    )
        internal
        pure
        returns (bytes32)
    {
370: function compareBytes(bytes memory a, bytes memory b) internal pure returns (bool) {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L16) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L39) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L56) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L116) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L138) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L160) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L178) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L188) | [198](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L198) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L211) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L224) | [237](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L237) | [255](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L255) | [271](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L271) | [284](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L284) | [320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L320) | [370](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L370)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

43: function pkcs1Sha256(
        bytes32 _sha256,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
191: function pkcs1Sha256Raw(
        bytes memory _data,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
212: function pkcs1Sha1(
        bytes20 _sha1,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
307: function pkcs1Sha1Raw(
        bytes memory _data,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L43) | [191](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L191) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L212) | [307](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L307)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

11: function sha1(bytes memory data) internal pure returns (bytes20 ret) {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L11)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

8: function toTimestamp(bytes memory x509Time) internal pure returns (uint256) {
33: function toUnixTimestamp(
        uint16 year,
        uint8 month,
        uint8 day,
        uint8 hour,
        uint8 minute,
        uint8 second
    )
        internal
        pure
        returns (uint256)
    {
70: function isLeapYear(uint16 year) internal pure returns (bool) {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L8) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L33) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L70)
</details>

### [N-79] Consider defining system-wide constants in a single file

System-wide constants should be declared in a single file for better maintainability and readability.
This contract seems to contain constants which could potentially be system-wide and could be better managed if they were centralized in a single location.

<details>
<summary><i>18 issue instances in 9 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

11: uint8 private constant _FALSE = 1;
13: uint8 private constant _TRUE = 2;
17: bytes32 private constant _REENTRY_SLOT =
        0xa5054f728453d3dbe953bdc43e4d0cb97e662ea32d7958190f3dc2da31d9721a;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L11) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L13) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L17)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

38: uint256 public constant MAX_GAS_PAYING_PROVER = 50_000;
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L38)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

11: uint256 public constant MIN_NUM_GUARDIANS = 5;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L11)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

32: address public constant GOLDEN_TOUCH_ADDRESS = 0x0000777735367b36bC9B61C50022d9D0700dB4Ec;
35: uint8 public constant BLOCK_SYNC_THRESHOLD = 5;
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L32) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L35)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

23: bytes32 private constant _CTX_SLOT =
        0xe4ece82196de19aabe639620d7f716c433d1348f96ce727c9989a982dbadc2b9;
27: uint256 internal constant PLACEHOLDER = type(uint256).max;
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L23) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L27)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

47: bytes4 public constant ERC1155_INTERFACE_ID = 0xd9b67a26;
50: bytes4 public constant ERC721_INTERFACE_ID = 0x80ac58cd;
53: uint256 public constant MAX_TOKEN_PER_TXN = 10;
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L47) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L50) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L53)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

30: uint256 internal constant MAX_LIST_LENGTH = 32;
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L30)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

30: uint64 public constant INSTANCE_EXPIRY = 180 days;
34: uint64 public constant INSTANCE_VALIDITY_DELAY = 1 days;
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L30) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L34)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

29: uint256 internal constant CPUSVN_LENGTH = 16;
33: bytes32 internal constant ROOTCA_PUBKEY_HASH =
        0x89f72d7c488e5b53a77c23ebcb36970ef7eb5bcf6658e9b8292cfbe4703a8473;
36: uint8 internal constant INVALID_EXIT_CODE = 255;
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L29) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L33) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L36)
</details>

### [N-80] Add inline comments for unnamed variables

Having unnamed variables in function definitions can be confusing and decrease the code readability. 
Adding inline comments to explain the purpose of unnamed variables could make the code easier to understand and maintain.

For example, convert function declarations like `function foo(address x, address)` to `function foo(address x, address /* y */)` to indicate that the unnamed variable could have been named 'y'.

<details>
<summary><i>14 issue instances in 12 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit - `address`
57: function _authorizePause(address) internal pure override {
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L57)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit - `address`
113: function _authorizeUpgrade(address) internal virtual override onlyOwner { }
/// @audit - `address`
115: function _authorizePause(address) internal virtual onlyOwner { }
```
[113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L113) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L115)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit - `address`
219: function _authorizePause(address)
        internal
        view
        virtual
        override
        onlyFromOwnerOrNamed("chain_pauser")
    { }
```
[219](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L219)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

/// @audit - `uint256`
54: function getMinTier(uint256) public pure override returns (uint16) {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L54)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit - `address`
230: function _authorizePause(address) internal pure override {
```
[230](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L230)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit - `address`
461: function _authorizePause(address)
        internal
        view
        virtual
        override
        onlyFromOwnerOrNamed("bridge_pauser")
    { }
```
[461](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L461)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

/// @audit - `address,uint256`
114: function _beforeTokenTransfer(
        address, /*_from*/
        address _to,
        uint256, /*_firstTokenId*/
        uint256 /*_batchSize*/
    )
        internal
        virtual
        override
    {
```
[114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L114)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit - `address,uint256[]`
124: function _beforeTokenTransfer(
        address, /*_operator*/
        address, /*_from*/
        address _to,
        uint256[] memory, /*_ids*/
        uint256[] memory, /*_amounts*/
        bytes memory /*_data*/
    )
        internal
        virtual
        override
    {
```
[124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L124)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit - `address,address,uint256[],uint256[],bytes`
160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
/// @audit - `address,address,uint256,uint256,bytes`
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit - `address,address,uint256,bytes`
142: function onERC721Received(
        address,
        address,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
```
[142](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L142)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

/// @audit - `TaikoData.Transition,TaikoData.TierProof`
23: function verifyProof(
        Context calldata _ctx,
        TaikoData.Transition calldata,
        TaikoData.TierProof calldata
    )
        external
        view
    {
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L23)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

/// @audit - `ptr,off,count`
26: function readword(ptr, off, count) -> result {
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L26)
</details>

### [N-81] Consider making contracts `Upgradeable`

Contract uses a non-upgradeable design.
Transitioning to an upgradeable contract structure is more aligned with contemporary smart contract practices.
This approach not only enhances flexibility but also allows for continuous improvement and adaptation, ensuring the contract stays relevant and robust in an ever-evolving ecosystem.

<details>
<summary><i>31 issue instances in 31 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit - Contract `AddressManager` is not upgradeable
10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

/// @audit - Contract `AddressResolver` is not upgradeable
11: abstract contract AddressResolver is IAddressResolver, Initializable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L11)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit - Contract `AssignmentHook` is not upgradeable
14: contract AssignmentHook is EssentialContract, IHook {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L14)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

/// @audit - Contract `GuardianProver` is not upgradeable
10: contract GuardianProver is Guardians {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L10)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit - Contract `Guardians` is not upgradeable
9: abstract contract Guardians is EssentialContract {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L9)

```solidity
File: packages/protocol/contracts/L1/TaikoErrors.sol

/// @audit - Contract `TaikoErrors` is not upgradeable
11: abstract contract TaikoErrors {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoErrors.sol#L11)

```solidity
File: packages/protocol/contracts/L1/TaikoEvents.sol

/// @audit - Contract `TaikoEvents` is not upgradeable
13: abstract contract TaikoEvents {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoEvents.sol#L13)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit - Contract `TaikoL1` is not upgradeable
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L22)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

/// @audit - Contract `DevnetTierProvider` is not upgradeable
10: contract DevnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit - Contract `MainnetTierProvider` is not upgradeable
10: contract MainnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit - Contract `TestnetTierProvider` is not upgradeable
10: contract TestnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit - Contract `CrossChainOwned` is not upgradeable
14: abstract contract CrossChainOwned is EssentialContract, IMessageInvocable {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L14)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit - Contract `TaikoL2` is not upgradeable
21: contract TaikoL2 is CrossChainOwned {
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L21)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

/// @audit - Contract `TaikoL2EIP1559Configurable` is not upgradeable
9: contract TaikoL2EIP1559Configurable is TaikoL2 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L9)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit - Contract `SignalService` is not upgradeable
14: contract SignalService is EssentialContract, ISignalService {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L14)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit - Contract `Bridge` is not upgradeable
16: contract Bridge is EssentialContract, IBridge {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

/// @audit - Contract `USDCAdapter` is not upgradeable
28: contract USDCAdapter is BridgedERC20Base {
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

/// @audit - Contract `BridgedERC20Base` is not upgradeable
9: abstract contract BridgedERC20Base is EssentialContract, IBridgedERC20 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

/// @audit - Contract `BaseNFTVault` is not upgradeable
9: abstract contract BaseNFTVault is BaseVault {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L9)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit - Contract `ERC20Vault` is not upgradeable
18: contract ERC20Vault is BaseVault {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L18)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit - Contract `ERC721Vault` is not upgradeable
16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L16)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

/// @audit - Contract `GuardianVerifier` is not upgradeable
10: contract GuardianVerifier is EssentialContract, IVerifier {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L10)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit - Contract `SgxVerifier` is not upgradeable
19: contract SgxVerifier is EssentialContract, IVerifier {
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L19)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

/// @audit - Contract `ERC20Airdrop` is not upgradeable
11: contract ERC20Airdrop is MerkleClaimable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L11)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit - Contract `ERC20Airdrop2` is not upgradeable
12: contract ERC20Airdrop2 is MerkleClaimable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L12)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

/// @audit - Contract `ERC721Airdrop` is not upgradeable
9: contract ERC721Airdrop is MerkleClaimable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L9)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

/// @audit - Contract `MerkleClaimable` is not upgradeable
10: abstract contract MerkleClaimable is EssentialContract {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L10)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit - Contract `TimelockTokenPool` is not upgradeable
25: contract TimelockTokenPool is EssentialContract {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L25)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit - Contract `AutomataDcapV3Attestation` is not upgradeable
22: contract AutomataDcapV3Attestation is IAttestation {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L22)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit - Contract `PEMCertChainLib` is not upgradeable
12: contract PEMCertChainLib is IPEMCertChainLib {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L12)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit - Contract `SigVerifyLib` is not upgradeable
15: contract SigVerifyLib is ISigVerifyLib {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L15)
</details>

### [N-82] Events that mark critical parameter changes should contain both the old and the new value

When emitting events that signify critical changes in parameters, it's important to include both the old and new values. 

This aids in auditability, providing more complete information about the state change. It's especially necessary when the new value isn't required to be different from the old one, as this prevents ambiguity in event logs.

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

166: emit BlobCached(meta_.blobHash);
```
[166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L166)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

80: emit ProvingPaused(_pause);
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L80)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

208: emit MessageRecalled(msgHash);
301: emit MessageExecuted(msgHash);
```
[208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L208) | [301](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L301)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

74: emit Claimed(hash);
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L74)
</details>

### [N-83] Non-Standard Annotations Detected Use `@inheritdoc` instead

Using non-standard annotations like `@dev see Ellipsis` can lead to inconsistencies and lack of clarity in your smart contract documentation.
It's recommended to use the `@inheritdoc` annotation for enhanced clarity and uniformity in smart contract development.

`@inheritdoc` copies all state variables, internal and public function comments from the base contract to avoid repetition.

<details>
<summary><i>4 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

47: /// @dev See {IGovernor-propose}
88: /// @dev See {GovernorUpgradeable-supportsInterface}
98: /// @dev See {GovernorUpgradeable-state}
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L47) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L88) | [98](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L98)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

189: /// @dev See {BaseVault-supportsInterface}.
```
[189](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L189)
</details>

### [N-84] Style guide: Non-`external`/`public` variable names should begin with an underscore

The naming convention for non-public (private and internal) variables in Solidity recommends the use of a leading underscore.

Since `constants` can be public, to avoid confusion, they should also be prefixed with an underscore.

This practice clearly differentiates between public/external and non-public variables, enhancing code clarity and reducing the likelihood of misinterpretation or errors.
Following this convention improves code readability and maintainability.

<details>
<summary><i>34 issue instances in 9 files:</i></summary>

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

27: uint256 internal constant PLACEHOLDER = type(uint256).max;
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L27)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

6: uint256 constant LOW_28_MASK =
        0x00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff;
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

11: type MemoryPointer is uint256;
30: uint256 internal constant MAX_LIST_LENGTH = 32;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L11) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L30)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

21: uint256 internal constant TREE_RADIX = 16;
24: uint256 internal constant BRANCH_NODE_LENGTH = TREE_RADIX + 1;
27: uint256 internal constant LEAF_OR_EXTENSION_NODE_LENGTH = 2;
30: uint8 internal constant PREFIX_EXTENSION_EVEN = 0;
33: uint8 internal constant PREFIX_EXTENSION_ODD = 1;
36: uint8 internal constant PREFIX_LEAF_EVEN = 2;
39: uint8 internal constant PREFIX_LEAF_ODD = 3;
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L21) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L24) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L27) | [30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L30) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L33) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L36) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L39)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

29: uint256 internal constant CPUSVN_LENGTH = 16;
33: bytes32 internal constant ROOTCA_PUBKEY_HASH =
        0x89f72d7c488e5b53a77c23ebcb36970ef7eb5bcf6658e9b8292cfbe4703a8473;
36: uint8 internal constant INVALID_EXIT_CODE = 255;
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L29) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L33) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L36)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

17: string internal constant HEADER = "-----BEGIN CERTIFICATE-----";
18: string internal constant FOOTER = "-----END CERTIFICATE-----";
19: uint256 internal constant HEADER_LENGTH = 27;
20: uint256 internal constant FOOTER_LENGTH = 25;
22: string internal constant PCK_COMMON_NAME = "Intel SGX PCK Certificate";
23: string internal constant PLATFORM_ISSUER_NAME = "Intel SGX PCK Platform CA";
24: string internal constant PROCESSOR_ISSUER_NAME = "Intel SGX PCK Processor CA";
25: bytes internal constant SGX_EXTENSION_OID = hex"2A864886F84D010D01";
26: bytes internal constant TCB_OID = hex"2A864886F84D010D0102";
27: bytes internal constant PCESVN_OID = hex"2A864886F84D010D010211";
28: bytes internal constant PCEID_OID = hex"2A864886F84D010D0103";
29: bytes internal constant FMSPC_OID = hex"2A864886F84D010D0104";
32: uint256 constant SGX_TCB_CPUSVN_SIZE = 16;
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L17) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L19) | [20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L20) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L22) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L23) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L24) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L25) | [26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L26) | [27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L27) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L28) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L29) | [32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L32)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

14: uint256 internal constant MINIMUM_QUOTE_LENGTH = 1020;
15: bytes2 internal constant SUPPORTED_QUOTE_VERSION = 0x0300;
16: bytes2 internal constant SUPPORTED_ATTESTATION_KEY_TYPE = 0x0200;
18: bytes4 internal constant SUPPORTED_TEE_TYPE = 0;
19: bytes16 internal constant VALID_QE_VENDOR_ID = 0x939a7233f79c4ca9940a0db3957f0607;
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L15) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L16) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L19)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

310: bytes constant BASE32_HEX_TABLE =
        hex"00010203040506070809FFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1FFFFFFFFFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1F";
```
[310](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L310)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

18: address private ES256VERIFIER;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L18)
</details>

### [N-85] Style guide: Contract does not follow the Solidity style guide's suggested layout ordering

Adhering to a recommended order in Solidity contracts enhances code readability and maintenance.
[More information in Documentation](https://docs.soliditylang.org/en/latest/style-guide.html#order-of-layout)
It's recommended to use the following order:
1. Type declarations
2. State variables
3. Events
4. Errors
5. Modifiers
6. Functions

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit `modifier` declared after `constructor`
59: modifier onlyOwner() {
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L59)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit `type` declared after `state variable`
33: struct PCKTCBFlags {
        bool fmspcFound;
        bool pceidFound;
        bool tcbFound;
    }
```
[33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L33)
</details>

### [N-86] Style guide: Control structures do not follow the Solidity Style Guide

Following best practices for control structures in solidity code is vital for readability and maintainability. The control structures in contracts, libraries, functions, and structs should adhere to the following standards:

- Braces denoting the body should open on the same line as the declaration and close on their own line at the same indentation level as the beginning of the declaration. 
- A single space should precede the opening brace. 
- Control structures such as 'if', 'else', 'while', and 'for' should also follow these spacing and brace placement recommendations.

It is advised to revisit the [control structures](https://docs.soliditylang.org/en/latest/style-guide.html#control-structures) sections in documentation to ensure conformity with these best practices, fostering cleaner and more maintainable code.

<details>
<summary><i>135 issue instances in 39 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit `Return or revert statement should be on new line.`
48: if (_newAddress == oldAddress) revert AM_INVALID_PARAMS();
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L48)

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

/// @audit `Return or revert statement should be on new line.`
25: if (msg.sender != resolve(_name, true)) revert RESOLVER_DENIED();
/// @audit `Return or revert statement should be on new line.`
81: if (addressManager == address(0)) revert RESOLVER_INVALID_MANAGER();
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L25) | [81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L81)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit `Return or revert statement should be on new line.`
42: if (msg.sender != owner() && msg.sender != resolve(_name, true)) revert RESOLVER_DENIED();
/// @audit `Return or revert statement should be on new line.`
47: if (_loadReentryLock() == _TRUE) revert REENTRANT_CALL();
/// @audit `Return or revert statement should be on new line.`
54: if (!paused()) revert INVALID_PAUSE_STATUS();
/// @audit `Return or revert statement should be on new line.`
59: if (paused()) revert INVALID_PAUSE_STATUS();
/// @audit `Return or revert statement should be on new line.`
104: if (_addressManager == address(0)) revert ZERO_ADDR_MANAGER();
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L42) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L47) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L54) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L59) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L104)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

/// @audit `Return or revert statement should be on new line.`
40: if (_x >= BLS_MODULUS) revert POINT_X_TOO_LARGE();
/// @audit `Return or revert statement should be on new line.`
41: if (_y >= BLS_MODULUS) revert POINT_Y_TOO_LARGE();
/// @audit `Return or revert statement should be on new line.`
46: if (!ok) revert EVAL_FAILED_1();
/// @audit `Return or revert statement should be on new line.`
48: if (ret.length != 64) revert EVAL_FAILED_2();
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L40) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L41) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L46) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L48)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

/// @audit `Return or revert statement should be on new line.`
24: if (_to == address(0)) revert ETH_TRANSFER_FAILED();
/// @audit `Return or revert statement should be on new line.`
36: if (!success) revert ETH_TRANSFER_FAILED();
/// @audit `Return or revert statement should be on new line.`
54: if (!Address.isContract(_addr)) return false;
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L24) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L36) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L54)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

/// @audit `Return or revert statement should be on new line.`
49: if (rlpAccount.length == 0) revert LTP_INVALID_ACCOUNT_PROOF();
/// @audit `Return or revert statement should be on new line.`
63: if (!verified) revert LTP_INVALID_INCLUSION_PROOF();
```
[49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L49) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L63)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit `Return or revert statement should be on new line.`
81: if (_signatures.length != _calldatas.length) revert TG_INVALID_SIGNATURES_LENGTH();
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L81)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit `Return or revert statement should be on new line.`
173: if (_tierFees[i].tier == _tierId) return _tierFees[i].fee;
```
[173](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L173)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit `Return or revert statement should be on new line.`
150: if (_amount > type(uint96).max) revert L1_INVALID_ETH_DEPOSIT();
```
[150](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L150)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

/// @audit `Return or revert statement should be on new line.`
94: if (!_isProposerPermitted(b, _resolver)) revert L1_UNAUTHORIZED();
/// @audit `Return or revert statement should be on new line.`
141: if (meta_.blobUsed) {
            if (!_config.blobAllowedForDA) revert L1_BLOB_FOR_DA_DISABLED();
/// @audit `Return or revert statement should be on new line.`
143: if (params.blobHash != 0) {
                if (!_config.blobReuseEnabled) revert L1_BLOB_REUSE_DISABLED();
/// @audit `Return or revert statement should be on new line.`
158: if (meta_.blobHash == 0) revert L1_BLOB_NOT_FOUND();
/// @audit `Return or revert statement should be on new line.`
182: if (!LibAddress.isSenderEOA()) revert L1_PROPOSER_NOT_EOA();
```
[94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L94) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L141) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L143) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L158) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L182)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit `Return or revert statement should be on new line.`
74: if (_state.slotB.provingPaused == _pause) revert L1_INVALID_PAUSE_STATUS();
/// @audit `Return or revert statement should be on new line.`
219: if (sameTransition) revert L1_ALREADY_PROVED();
/// @audit `Return or revert statement should be on new line.`
239: if (ts.contester != address(0)) revert L1_ALREADY_CONTESTED();
/// @audit `Return or revert statement should be on new line.`
374: if (_sameTransition) revert L1_ALREADY_PROVED();
/// @audit `Return or revert statement should be on new line.`
412: if (_tier.contestBond == 0) return;
/// @audit `Return or revert statement should be on new line.`
419: if (_tid == 1 && _ts.tier == 0 && inProvingWindow) {
            if (!isAssignedPover) revert L1_NOT_ASSIGNED_PROVER();
/// @audit `Return or revert statement should be on new line.`
424: if (isAssignedPover) revert L1_ASSIGNED_PROVER_NOT_ALLOWED();
```
[74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L74) | [219](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L219) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L239) | [374](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L374) | [412](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L412) | [419](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L419) | [424](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L424)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

/// @audit `Return or revert statement should be on new line.`
40: if (blk.blockId != _blockId) revert L1_BLOCK_MISMATCH();
/// @audit `Return or revert statement should be on new line.`
43: if (tid == 0) revert L1_TRANSITION_NOT_FOUND();
/// @audit `Return or revert statement should be on new line.`
84: }

        if (tid_ >= _blk.nextTransitionId) revert L1_UNEXPECTED_TRANSITION_ID();
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L40) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L43) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L84)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

/// @audit `Return or revert statement should be on new line.`
54: if (!_isConfigValid(_config)) revert L1_INVALID_CONFIG();
/// @audit `Return or revert statement should be on new line.`
105: if (blk.blockId != blockId) revert L1_BLOCK_MISMATCH();
/// @audit `Return or revert statement should be on new line.`
111: if (tid == 0) revert L1_TRANSITION_ID_ZERO();
/// @audit `Return or revert statement should be on new line.`
131: if (blk.blockId != blockId) revert L1_BLOCK_MISMATCH();
/// @audit `Return or revert statement should be on new line.`
246: if (
            _config.chainId <= 1 || _config.chainId == block.chainid //
                || _config.blockMaxProposals == 1
                || _config.blockRingBufferSize <= _config.blockMaxProposals + 1
                || _config.blockMaxGasLimit == 0 || _config.blockMaxTxListBytes == 0
                || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K
                || _config.livenessBond == 0 || _config.ethDepositRingBufferSize <= 1
                || _config.ethDepositMinCountPerBlock == 0
            // Audit recommendation, and gas tested. Processing 32 deposits (as initially set in
            // TaikoL1.sol) costs 72_502 gas.
            || _config.ethDepositMaxCountPerBlock > 32
                || _config.ethDepositMaxCountPerBlock < _config.ethDepositMinCountPerBlock
                || _config.ethDepositMinAmount == 0
                || _config.ethDepositMaxAmount <= _config.ethDepositMinAmount
                || _config.ethDepositMaxAmount > type(uint96).max || _config.ethDepositGas == 0
                || _config.ethDepositMaxFee == 0
                || _config.ethDepositMaxFee > type(uint96).max / _config.ethDepositMaxCountPerBlock
        ) return false;
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L54) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L105) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L111) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L131) | [246](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L246)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

/// @audit `Return or revert statement should be on new line.`
45: if (_proof.tier != LibTiers.TIER_GUARDIAN) revert INVALID_PROOF();
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L45)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit `Return or revert statement should be on new line.`
82: if (guardian == address(0)) revert INVALID_GUARDIAN();
/// @audit `Return or revert statement should be on new line.`
84: if (guardianIds[guardian] != 0) revert INVALID_GUARDIAN_SET();
/// @audit `Return or revert statement should be on new line.`
113: if (id == 0) revert INVALID_GUARDIAN();
/// @audit `Return or revert statement should be on new line.`
135: if (count == minGuardians) return true;
```
[82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L82) | [84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L84) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L113) | [135](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L135)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit `Return or revert statement should be on new line.`
29: if (state.slotB.provingPaused) revert L1_PROVING_PAUSED();
/// @audit `Return or revert statement should be on new line.`
35: if (!_inNonReentrant()) revert L1_RECEIVE_DISABLED();
/// @audit `Return or revert statement should be on new line.`
89: if (_blockId != meta.id) revert L1_INVALID_BLOCK_ID();
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L29) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L35) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L89)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit `Return or revert statement should be on new line.`
61: if (_to == address(this)) revert TKO_INVALID_ADDR();
/// @audit `Return or revert statement should be on new line.`
79: if (_to == address(this)) revert TKO_INVALID_ADDR();
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L61) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L79)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit `Return or revert statement should be on new line.`
68: if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit `Return or revert statement should be on new line.`
68: if (_rand % 10 == 0) return LibTiers.TIER_SGX;
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit `Return or revert statement should be on new line.`
43: if (txId != nextTxId) revert XCO_INVALID_TX_ID();
/// @audit `Return or revert statement should be on new line.`
51: if (!success) revert XCO_TX_REVERTED();
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L43) | [51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L51)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit `Return or revert statement should be on new line.`
121: }

        if (msg.sender != GOLDEN_TOUCH_ADDRESS) revert L2_INVALID_SENDER();
/// @audit `Return or revert statement should be on new line.`
172: if (_to == address(0)) revert L2_INVALID_PARAM();
/// @audit `Return or revert statement should be on new line.`
201: if (_blockId >= block.number) return 0;
/// @audit `Return or revert statement should be on new line.`
202: if (_blockId + 256 >= block.number) return blockhash(_blockId);
```
[121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L121) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L172) | [201](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L201) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L202)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

/// @audit `Return or revert statement should be on new line.`
33: if (_newConfig.gasTargetPerL1Block == 0) revert L2_INVALID_CONFIG();
/// @audit `Return or revert statement should be on new line.`
34: if (_newConfig.basefeeAdjustmentQuotient == 0) revert L2_INVALID_CONFIG();
```
[33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L34)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit `Return or revert statement should be on new line.`
36: if (_app == address(0)) revert SS_INVALID_SENDER();
/// @audit `Return or revert statement should be on new line.`
41: if (_input == 0) revert SS_INVALID_VALUE();
/// @audit `Return or revert statement should be on new line.`
57: if (isAuthorized[_addr] == _authorize) revert SS_INVALID_STATE();
/// @audit `Return or revert statement should be on new line.`
77: if (!isAuthorized[msg.sender]) revert SS_UNAUTHORIZED();
/// @audit `Return or revert statement should be on new line.`
95: if (hopProofs.length == 0) revert SS_EMPTY_PROOF();
/// @audit `Return or revert statement should be on new line.`
109: if (isLastHop) {
                if (hop.chainId != block.chainid) revert SS_INVALID_LAST_HOP_CHAINID();
/// @audit `Return or revert statement should be on new line.`
172: if (chainData_ == 0) revert SS_SIGNAL_NOT_FOUND();
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L36) | [41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L41) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L57) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L77) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L95) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L109) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L172)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit `Return or revert statement should be on new line.`
65: if (_chainId != block.chainid) revert B_INVALID_CHAINID();
/// @audit `Return or revert statement should be on new line.`
109: if (addressBanned[_addr] == _ban) revert B_INVALID_STATUS();
/// @audit `Return or revert statement should be on new line.`
132: if (!destChainEnabled) revert B_INVALID_CHAINID();
/// @audit `Return or revert statement should be on new line.`
139: if (expectedAmount != msg.value) revert B_INVALID_VALUE();
/// @audit `Return or revert statement should be on new line.`
165: if (messageStatus[msgHash] != Status.NEW) revert B_STATUS_MISMATCH();
/// @audit `Return or revert statement should be on new line.`
227: if (messageStatus[msgHash] != Status.NEW) revert B_STATUS_MISMATCH();
/// @audit `Return or revert statement should be on new line.`
321: if (_message.gasLimit == 0 || _isLastAttempt) {
            if (msg.sender != _message.destOwner) revert B_PERMISSION_DENIED();
/// @audit `Return or revert statement should be on new line.`
341: if (_message.srcChainId != block.chainid) return false;
/// @audit `Return or revert statement should be on new line.`
360: if (_message.srcChainId != block.chainid) return false;
/// @audit `Return or revert statement should be on new line.`
382: if (_message.destChainId != block.chainid) return false;
/// @audit `Return or revert statement should be on new line.`
485: if (_gasLimit == 0) revert B_INVALID_GAS_LIMIT();
/// @audit `Return or revert statement should be on new line.`
516: if (messageStatus[_msgHash] == _status) return;
```
[65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L65) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L109) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L132) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L139) | [165](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L165) | [227](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L227) | [321](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L321) | [341](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L341) | [360](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L360) | [382](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L382) | [485](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L485) | [516](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L516)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit `Return or revert statement should be on new line.`
147: if (_to == address(this)) revert BTOKEN_CANNOT_RECEIVE();
/// @audit `Return or revert statement should be on new line.`
148: if (paused()) revert INVALID_PAUSE_STATUS();
```
[147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L147) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L148)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

/// @audit `Return or revert statement should be on new line.`
59: if (_isMigratingOut()) revert BB_MINT_DISALLOWED();
/// @audit `Return or revert statement should be on new line.`
76: if (_isMigratingOut()) {
            // Only the owner of the tokens himself can migrate out
            if (msg.sender != _account) revert BB_PERMISSION_DENIED();
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L59) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L76)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

/// @audit `Return or revert statement should be on new line.`
125: if (_to == address(this)) revert BTOKEN_CANNOT_RECEIVE();
/// @audit `Return or revert statement should be on new line.`
126: if (paused()) revert INVALID_PAUSE_STATUS();
```
[125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L125) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L126)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit `Return or revert statement should be on new line.`
137: if (_to == address(this)) revert BTOKEN_CANNOT_RECEIVE();
/// @audit `Return or revert statement should be on new line.`
138: if (paused()) revert INVALID_PAUSE_STATUS();
```
[137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L137) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L138)

```solidity
File: packages/protocol/contracts/tokenvault/BaseNFTVault.sol

/// @audit `Return or revert statement should be on new line.`
147: }

        if (_op.token == address(0)) revert VAULT_INVALID_TOKEN();
```
[147](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseNFTVault.sol#L147)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

/// @audit `Return or revert statement should be on new line.`
55: if (ctx_.from != selfOnSourceChain) revert VAULT_PERMISSION_DENIED();
/// @audit `Return or revert statement should be on new line.`
65: if (ctx_.from != msg.sender) revert VAULT_PERMISSION_DENIED();
```
[55](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L55) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L65)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit `Return or revert statement should be on new line.`
48: if (_op.amounts[i] == 0) revert VAULT_INVALID_AMOUNT();
/// @audit `Return or revert statement should be on new line.`
108: if (to == address(0) || to == address(this)) revert VAULT_INVALID_TO();
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L48) | [108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L108)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit `Return or revert statement should be on new line.`
160: }

        if (btokenBlacklist[_btokenNew]) revert VAULT_BTOKEN_BLACKLISTED();
/// @audit `Return or revert statement should be on new line.`
174: if (
                ctoken.decimals != _ctoken.decimals
                    || keccak256(bytes(ctoken.symbol)) != keccak256(bytes(_ctoken.symbol))
                    || keccak256(bytes(ctoken.name)) != keccak256(bytes(_ctoken.name))
            ) revert VAULT_CTOKEN_MISMATCH();
/// @audit `Return or revert statement should be on new line.`
214: if (_op.amount == 0) revert VAULT_INVALID_AMOUNT();
/// @audit `Return or revert statement should be on new line.`
215: if (_op.token == address(0)) revert VAULT_INVALID_TOKEN();
/// @audit `Return or revert statement should be on new line.`
216: if (btokenBlacklist[_op.token]) revert VAULT_BTOKEN_BLACKLISTED();
/// @audit `Return or revert statement should be on new line.`
267: if (to == address(0) || to == address(this)) revert VAULT_INVALID_TO();
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L160) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L174) | [214](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L214) | [215](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L215) | [216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L216) | [267](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L267)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit `Return or revert statement should be on new line.`
35: if (_op.amounts[i] != 0) revert VAULT_INVALID_AMOUNT();
/// @audit `Return or revert statement should be on new line.`
91: if (to == address(0) || to == address(this)) revert VAULT_INVALID_TO();
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L35) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L91)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

/// @audit `Return or revert statement should be on new line.`
26: if (x >= 135_305_999_368_893_231_589) revert Overflow();
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L26)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit `Return or revert statement should be on new line.`
106: if (instances[idx].addr == address(0)) revert SGX_INVALID_INSTANCE();
/// @audit `Return or revert statement should be on new line.`
129: if (!verified) revert SGX_INVALID_ATTESTATION();
/// @audit `Return or revert statement should be on new line.`
148: if (_ctx.isContesting) return;
/// @audit `Return or revert statement should be on new line.`
152: if (_proof.data.length != 89) revert SGX_INVALID_PROOF();
/// @audit `Return or revert statement should be on new line.`
160: if (!_isInstanceValid(id, oldInstance)) revert SGX_INVALID_INSTANCE();
/// @audit `Return or revert statement should be on new line.`
211: if (addressRegistered[_instances[i]]) revert SGX_ALREADY_ATTESTED();
/// @audit `Return or revert statement should be on new line.`
214: if (_instances[i] == address(0)) revert SGX_INVALID_INSTANCE();
/// @audit `Return or revert statement should be on new line.`
234: if (instance == address(0)) return false;
/// @audit `Return or revert statement should be on new line.`
235: if (instance != instances[id].addr) return false;
```
[106](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L106) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L129) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L148) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L152) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L160) | [211](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L211) | [214](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L214) | [234](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L234) | [235](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L235)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit `Return or revert statement should be on new line.`
111: if (balance == 0) return (0, 0);
/// @audit `Return or revert statement should be on new line.`
114: if (block.timestamp < claimEnd) return (balance, 0);
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L111) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L114)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

/// @audit `Return or revert statement should be on new line.`
34: if (
            merkleRoot == 0x0 || claimStart == 0 || claimEnd == 0 || claimStart > block.timestamp
                || claimEnd < block.timestamp
        ) revert CLAIM_NOT_ONGOING();
/// @audit `Return or revert statement should be on new line.`
69: if (isClaimed[hash]) revert CLAIMED_ALREADY();
/// @audit `Return or revert statement should be on new line.`
71: if (!_verifyMerkleProof(proof, merkleRoot, hash)) revert INVALID_PROOF();
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L34) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L69) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L71)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit `Return or revert statement should be on new line.`
121: if (_taikoToken == address(0)) revert INVALID_PARAM();
/// @audit `Return or revert statement should be on new line.`
123: if (_costToken == address(0)) revert INVALID_PARAM();
/// @audit `Return or revert statement should be on new line.`
126: if (_sharedVault == address(0)) revert INVALID_PARAM();
/// @audit `Return or revert statement should be on new line.`
136: if (_recipient == address(0)) revert INVALID_PARAM();
/// @audit `Return or revert statement should be on new line.`
137: if (recipients[_recipient].grant.amount != 0) revert ALREADY_GRANTED();
/// @audit `Return or revert statement should be on new line.`
153: if (amountVoided == 0) revert NOTHING_TO_VOID();
/// @audit `Return or revert statement should be on new line.`
169: if (_to == address(0)) revert INVALID_PARAM();
/// @audit `Return or revert statement should be on new line.`
255: if (_amount == 0) return 0;
/// @audit `Return or revert statement should be on new line.`
256: if (_start == 0) return _amount;
/// @audit `Return or revert statement should be on new line.`
257: if (block.timestamp <= _start) return 0;
/// @audit `Return or revert statement should be on new line.`
258: if (_period == 0) return _amount;
/// @audit `Return or revert statement should be on new line.`
260: if (block.timestamp >= _start + _period) return _amount;
/// @audit `Return or revert statement should be on new line.`
261: if (block.timestamp <= _cliff) return 0;
/// @audit `Return or revert statement should be on new line.`
268: if (_grant.amount == 0) revert INVALID_GRANT();
/// @audit `Return or revert statement should be on new line.`
274: if (_start == 0 || _period == 0) {
            if (_cliff > 0) revert INVALID_GRANT();
/// @audit `Return or revert statement should be on new line.`
277: if (_cliff > 0 && _cliff <= _start) revert INVALID_GRANT();
/// @audit `Return or revert statement should be on new line.`
278: if (_cliff >= _start + _period) revert INVALID_GRANT();
```
[121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L121) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L123) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L126) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L136) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L137) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L153) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L169) | [255](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L255) | [256](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L256) | [257](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L257) | [258](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L258) | [260](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L260) | [261](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L261) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L268) | [274](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L274) | [277](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L277) | [278](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L278)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

/// @audit `Return or revert statement should be on new line.`
72: if (year % 4 != 0) return false;
/// @audit `Return or revert statement should be on new line.`
73: if (year % 100 != 0) return true;
/// @audit `Return or revert statement should be on new line.`
74: if (year % 400 != 0) return false;
```
[72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L72) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L73) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L74)
</details>

### [N-87] Consider bounding input array length

The functions in question operate on arrays without established boundaries, executing function calls for each of their entries.
If these arrays become excessively long, a function might revert due to gas constraints.
To enhance user experience, consider incorporating a `require()` statement that enforces a sensible maximum array length.
This approach can avoid unnecessary computational work and ensure smoother transactions.

<details>
<summary><i>11 issue instances in 7 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit `_tierFees` is a function array parameter and `_tierFees.length` is not bounded
172: for (uint256 i; i < _tierFees.length; ++i) {
```
[172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L172)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit `_msgHashes` is a function array parameter and `_msgHashes.length` is not bounded
90: for (uint256 i; i < _msgHashes.length; ++i) {
```
[90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L90)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit `_tokenIds` is a function array parameter and `_tokenIds.length` is not bounded
170: for (uint256 i; i < _tokenIds.length; ++i) {
/// @audit `_tokenIds` is a function array parameter and `_tokenIds.length` is not bounded
175: for (uint256 i; i < _tokenIds.length; ++i) {
```
[170](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L170) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L175)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

/// @audit `length` equal to `_proof.length` and it not bounded
208: for (uint256 i = 0; i < length;) {
```
[208](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L208)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit `_ids` is a function array parameter and `_ids.length` is not bounded
104: for (uint256 i; i < _ids.length; ++i) {
/// @audit `_instances` is a function array parameter and `_instances.length` is not bounded
210: for (uint256 i; i < _instances.length; ++i) {
```
[104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L104) | [210](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L210)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

/// @audit `tokenIds` is a function array parameter and `tokenIds.length` is not bounded
59: for (uint256 i; i < tokenIds.length; ++i) {
```
[59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L59)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit `serialNumBatch` is a function array parameter and `serialNumBatch.length` is not bounded
80: for (uint256 i; i < serialNumBatch.length; ++i) {
/// @audit `serialNumBatch` is a function array parameter and `serialNumBatch.length` is not bounded
95: for (uint256 i; i < serialNumBatch.length; ++i) {
/// @audit `n` equal to `certs.length` and it not bounded
259: for (uint256 i; i < n; ++i) {
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L80) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L95) | [259](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L259)
</details>

### [N-88] NatSpec: Function declarations should have `@notice` tag

In Solidity, the `@notice` tag in NatSpec comments is used to provide important explanations to end users about what a function does. 
It appears that this contract's function declarations are missing `@notice` tags in their NatSpec annotations.

The absence of `@notice` tags reduces the contract's transparency and could lead to misunderstandings about a function's purpose and behavior.
Note that the Solidity compiler treats comments beginning with `///` or `/**` as `@notice` tags if one wasn't explicitly provided.
[Learn More About NatSpec Guidelines](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>62 issue instances in 25 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

64: constructor() {
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L64)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
    {
99: function state(uint256 _proposalId)
        public
        view
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (ProposalState)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L99)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

24: function getMinDelay() public view override returns (uint256) {
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L24)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

57: function init(address _owner, address _addressManager) external initializer {
```
[57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L57)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

52: function getBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        uint64 _blockId
    )
        external
        view
        returns (TaikoData.Block storage blk_, uint64 slot_)
    {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L52)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

25: function init(address _owner, address _addressManager) external initializer {
35: function approve(
        TaikoData.BlockMetadata calldata _meta,
        TaikoData.Transition calldata _tran,
        TaikoData.TierProof calldata _proof
    )
        external
        whenNotPaused
        nonReentrant
        returns (bool approved_)
    {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L25) | [35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L35)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

42: function init(
        address _owner,
        address _addressManager,
        bytes32 _genesisBlockHash
    )
        external
        initializer
    {
137: function isBlobReusable(bytes32 _blobHash) public view returns (bool) {
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L42) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L137)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

22: function getTier(uint16 tierId) external view returns (Tier memory);
28: function getTierIds() external view returns (uint16[] memory);
33: function getMinTier(uint256 rand) external view returns (uint16);
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L22) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L28) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L33)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

71: function init(
        address _owner,
        address _addressManager,
        uint64 _l1ChainId,
        uint64 _gasExcess
    )
        external
        initializer
    {
223: function _calcPublicInputHash(uint256 _blockId)
        private
        view
        returns (bytes32 publicInputHashOld, bytes32 publicInputHashNew)
    {
```
[71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L71) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L223)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

48: function init(address _owner, address _addressManager) external initializer {
56: function authorize(address _addr, bool _authorize) external onlyOwner {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L48) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L56)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

75: function init(address _owner, address _addressManager) external initializer {
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

38: function init(address _owner, address _addressManager, IUSDC _usdc) external initializer {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L38)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

52: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        uint8 _decimals,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
```
[52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L52)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

31: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
54: function mint(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
69: function burn(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L31) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L54) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L69)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

38: function init(
        address _owner,
        address _addressManager,
        address _srcToken,
        uint256 _srcChainId,
        string memory _symbol,
        string memory _name
    )
        external
        initializer
    {
66: function mint(
        address _to,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
83: function mintBatch(
        address _to,
        uint256[] memory _tokenIds,
        uint256[] memory _amounts
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
100: function burn(
        address _account,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L38) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L66) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L83) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L100)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

32: function init(address _owner, address _addressManager) external initializer {
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L32)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

160: function onERC1155BatchReceived(
        address,
        address,
        uint256[] calldata,
        uint256[] calldata,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
175: function onERC1155Received(
        address,
        address,
        uint256,
        uint256,
        bytes calldata
    )
        external
        pure
        returns (bytes4)
    {
192: function supportsInterface(bytes4 interfaceId)
        public
        view
        virtual
        override(BaseVault, ERC1155ReceiverUpgradeable)
        returns (bool)
    {
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L160) | [175](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L175) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L192)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

18: function init(address _owner, address _addressManager) external initializer {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L18)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

83: function init(address _owner, address _addressManager) external initializer {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L83)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

54: constructor(address sigVerifyLibAddr, address pemCertLibAddr) {
65: function setMrSigner(bytes32 _mrSigner, bool _trusted) external onlyOwner {
69: function setMrEnclave(bytes32 _mrEnclave, bool _trusted) external onlyOwner {
73: function addRevokedCertSerialNum(
        uint256 index,
        bytes[] calldata serialNumBatch
    )
        external
        onlyOwner
    {
88: function removeRevokedCertSerialNum(
        uint256 index,
        bytes[] calldata serialNumBatch
    )
        external
        onlyOwner
    {
103: function configureTcbInfoJson(
        string calldata fmspc,
        TCBInfoStruct.TCBInfo calldata tcbInfoInput
    )
        public
        onlyOwner
    {
114: function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)
        external
        onlyOwner
    {
122: function toggleLocalReportCheck() external onlyOwner {
138: function verifyAttestation(bytes calldata data) external view override returns (bool) {
355: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        view
        override
        returns (bool, bytes memory)
    {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L54) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L65) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L69) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L73) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L88) | [103](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L103) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L114) | [122](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L122) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L138) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

9: function verifyAttestation(bytes calldata data) external returns (bool);
10: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        returns (bool success, bytes memory retData);
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L10)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

38: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        external
        view
        returns (bool);
48: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        external
        view
        returns (bool);
58: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
67: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
76: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        external
        view
        returns (bool sigValid);
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L38) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L48) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L58) | [67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L67) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L76)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

36: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs);
44: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert);
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L36) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L44)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

40: function splitCertificateChain(
        bytes memory pemChain,
        uint256 size
    )
        external
        pure
        returns (bool success, bytes[] memory certs)
    {
74: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L40) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L74)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

20: constructor(address es256Verifier) {
24: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
    {
54: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
    {
79: function verifyRS256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
96: function verifyRS1Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
113: function verifyES256Signature(
        bytes memory tbs,
        bytes memory signature,
        bytes memory publicKey
    )
        public
        view
        returns (bool sigValid)
    {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L20) | [24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L24) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L54) | [79](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L79) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L96) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L113)
</details>

### [N-89] Constants in comparisons should appear on the left side

Placing constants on the left side of comparison statements can help prevent accidental assignments and improve code readability.
In languages like C, placing constants on the left can protect against unintended assignments that would be treated as true conditions, leading to bugs.
Although Solidity does not have this specific issue, using the same practice can still be beneficial for code readability and consistency.

Consider placing constants on the left side of comparison operators like `==`, `!=`, `<`, `>`, `<=`, and `>=`."

<details>
<summary><i>153 issue instances in 37 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

120: if (block.chainid == 1) {
131: if (block.chainid == 1) {
```
[120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L120) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L131)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

49: if (ret.length != 64) revert EVAL_FAILED_2();
```
[49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L49)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

46: if (_accountProof.length != 0) {
50: if (rlpAccount.length == 0) revert LTP_INVALID_ACCOUNT_PROOF();
```
[46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L46) | [50](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L50)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

120: if (input.tip != 0 && block.coinbase != address(0)) {
```
[120](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L120)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

89: recipient: address(uint160(data >> 96)),
```
[89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L89)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

108: if (params.parentMetaHash != 0 && parentMetaHash != params.parentMetaHash) {
144: if (params.blobHash != 0) {
159: if (meta_.blobHash == 0) revert L1_BLOB_NOT_FOUND();
185: if (params.txListByteOffset != 0) {
195: if (meta_.txListByteSize == 0 || meta_.txListByteSize > _config.blockMaxTxListBytes) {
307: if (_slotB.numBlocks == 1) {
```
[108](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L108) | [144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L144) | [159](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L159) | [185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L185) | [195](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L195) | [307](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L307)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

105: if (_tran.parentHash == 0 || _tran.blockHash == 0 || _tran.stateRoot == 0) {
134: if (_proof.tier == 0 || _proof.tier < _meta.minTier || _proof.tier < ts.tier) {
223: assert(tier.validityBond == 0);
224: assert(ts.validityBond == 0 && ts.contestBond == 0 && ts.contester == address(0));
280: if (tid_ == 0) {
309: if (tid_ == 1) {
412: if (_tier.contestBond == 0) return;
419: if (_tid == 1 && _ts.tier == 0 && inProvingWindow) {
```
[105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L105) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L134) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L223) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L224) | [280](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L280) | [309](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L309) | [412](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L412) | [419](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L419)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

43: if (tid == 0) revert L1_TRANSITION_NOT_FOUND();
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L43)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

93: if (_maxBlocksToVerify == 0) {
111: if (tid == 0) revert L1_TRANSITION_ID_ZERO();
137: if (tid == 0) break;
212: if (numBlocksVerified > 0) {
246: if (
            _config.chainId <= 1 || _config.chainId == block.chainid //
                || _config.blockMaxProposals == 1
                || _config.blockRingBufferSize <= _config.blockMaxProposals + 1
                || _config.blockMaxGasLimit == 0 || _config.blockMaxTxListBytes == 0
                || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K
                || _config.livenessBond == 0 || _config.ethDepositRingBufferSize <= 1
                || _config.ethDepositMinCountPerBlock == 0
            // Audit recommendation, and gas tested. Processing 32 deposits (as initially set in
            // TaikoL1.sol) costs 72_502 gas.
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L93) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L111) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L137) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L212) | [246](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L246)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

84: if (guardianIds[guardian] != 0) revert INVALID_GUARDIAN_SET();
113: if (id == 0) revert INVALID_GUARDIAN();
134: if (bits & 1 == 1) ++count;
```
[84](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L84) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L113) | [134](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L134)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

153: if (blk_.verifiedTransitionId != 0) {
```
[153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L153)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

68: if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

68: if (_rand % 10 == 0) return LibTiers.TIER_SGX;
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

70: if (_ownerChainId == 0 || _ownerChainId == block.chainid) {
```
[70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L70)

```solidity
File: packages/protocol/contracts/L2/Lib1559Math.sol

24: if (_adjustmentFactor == 0) {
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/Lib1559Math.sol#L24)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

82: if (block.chainid <= 1 || block.chainid > type(uint64).max) {
86: if (block.number == 0) {
88: } else if (block.number == 1) {
116: if (
            _l1BlockHash == 0 || _l1StateRoot == 0 || _l1BlockId == 0
                || (block.number != 1 && _parentGasUsed == 0)
262: if (gasExcess > 0) {
275: if (lastSyncedBlock > 0 && _l1BlockId > lastSyncedBlock) {
279: if (numL1Blocks > 0) {
296: if (basefee_ == 0) basefee_ = 1;
```
[82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L82) | [86](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L86) | [88](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L88) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L116) | [262](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L262) | [275](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L275) | [279](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L279) | [296](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L296)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

33: if (_newConfig.gasTargetPerL1Block == 0) revert L2_INVALID_CONFIG();
34: if (_newConfig.basefeeAdjustmentQuotient == 0) revert L2_INVALID_CONFIG();
```
[33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L33) | [34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L34)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

41: if (_input == 0) revert SS_INVALID_VALUE();
95: if (hopProofs.length == 0) revert SS_EMPTY_PROOF();
114: if (hop.chainId == 0 || hop.chainId == block.chainid) {
131: if (value == 0 || value != _loadSignalValue(address(this), signal)) {
169: if (blockId_ != 0) {
172: if (chainData_ == 0) revert SS_SIGNAL_NOT_FOUND();
```
[41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L41) | [95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L95) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L114) | [131](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L131) | [169](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L169) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L172)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

242: if (invocationDelay != 0) {
250: if (invocationDelay != 0 && msg.sender != proofReceipt[msgHash].preferredExecutor) {
260: if (_message.gasLimit == 0 && msg.sender != _message.destOwner) {
321: if (_message.gasLimit == 0 || _isLastAttempt) {
405: if (ctx_.msgHash == 0 || ctx_.msgHash == bytes32(PLACEHOLDER)) {
423: if (
            block.chainid == 1 // Ethereum mainnet
        ) {
429: } else if (
            block.chainid == 2 // Ropsten
                || block.chainid == 4 // Rinkeby
                || block.chainid == 5 // Goerli
                || block.chainid == 42 // Kovan
                || block.chainid == 17_000 // Holesky
                || block.chainid == 11_155_111 // Sepolia
        ) {
439: } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {
485: if (_gasLimit == 0) revert B_INVALID_GAS_LIMIT();
490: if (
            _message.data.length >= 4 // msg can be empty
                && bytes4(_message.data) != IMessageInvocable.onMessageInvocation.selector
530: if (block.chainid == 1) {
542: if (block.chainid == 1) {
556: if (block.chainid == 1) {
```
[242](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L242) | [250](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L250) | [260](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L260) | [321](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L321) | [405](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L405) | [423](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L423) | [429](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L429) | [439](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L439) | [485](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L485) | [490](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L490) | [530](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L530) | [542](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L542) | [556](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L556)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

48: if (_op.amounts[i] == 0) revert VAULT_INVALID_AMOUNT();
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L48)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

214: if (_op.amount == 0) revert VAULT_INVALID_AMOUNT();
```
[214](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L214)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

35: if (_op.amounts[i] != 0) revert VAULT_INVALID_AMOUNT();
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L35)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

37: require(
            _in.length > 0,
            "RLPReader: length of an RLP item must be greater than zero to be decodable"
        );
152: require(
            _in.length > 0,
            "RLPReader: length of an RLP item must be greater than zero to be decodable"
        );
163: if (prefix <= 0x7f) {
166: } else if (prefix <= 0xb7) {
182: require(
                strLen != 1 || firstByteOfContent >= 0x80,
                "RLPReader: invalid prefix, single byte < 0x80 are not prefixed (short string)"
188: } else if (prefix <= 0xbf) {
202: require(
                firstByteOfContent != 0x00,
                "RLPReader: length of content must not have any leading zeros (long string)"
212: require(
                strLen > 55,
                "RLPReader: length of content must be greater than 55 bytes (long string)"
223: } else if (prefix <= 0xf7) {
248: require(
                firstByteOfContent != 0x00,
                "RLPReader: length of content must not have any leading zeros (long list)"
258: require(
                listLen > 55,
                "RLPReader: length of content must be greater than 55 bytes (long list)"
287: if (_length == 0) {
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L37) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L152) | [163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L163) | [166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L166) | [182](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L182) | [188](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L188) | [202](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L202) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L212) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L223) | [248](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L248) | [258](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L258) | [287](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L287)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

14: if (_in.length == 1 && uint8(_in[0]) < 128) {
33: if (_len < 56) {
39: while (_len / i != 0) {
60: if (b[i] != 0) {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L33) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L39) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L60)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

77: require(_key.length > 0, "MerkleTrie: empty key");
91: if (currentKeyIndex == 0) {
97: } else if (currentNode.encoded.length >= 32) {
119: require(
                        value_.length > 0,
                        "MerkleTrie: value length must be greater than zero (branch)"
172: require(
                        value_.length > 0,
                        "MerkleTrie: value length must be greater than zero (leaf)"
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L77) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L91) | [97](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L97) | [119](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L119) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L172)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

26: if (x >= 135_305_999_368_893_231_589) revert Overflow();
33: x = (x << 78) / 5 ** 18;
39: int256 k = ((x << 96) / 54_916_777_467_707_473_351_141_471_128 + 2 ** 95) >> 96;
49: p = p * x + (4_385_272_521_454_847_904_659_076_985_693_276 << 96);
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L26) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L33) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L39) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L49)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

152: if (_proof.data.length != 89) revert SGX_INVALID_PROOF();
```
[152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L152)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

111: if (balance == 0) return (0, 0);
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L111)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

34: if (
            merkleRoot == 0x0 || claimStart == 0 || claimEnd == 0 || claimStart > block.timestamp
                || claimEnd < block.timestamp
        ) revert CLAIM_NOT_ONGOING();
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L34)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

137: if (recipients[_recipient].grant.amount != 0) revert ALREADY_GRANTED();
154: if (amountVoided == 0) revert NOTHING_TO_VOID();
255: if (_amount == 0) return 0;
256: if (_start == 0) return _amount;
259: if (_period == 0) return _amount;
268: if (_grant.amount == 0) revert INVALID_GRANT();
274: if (_start == 0 || _period == 0) {
275: if (_cliff > 0) revert INVALID_GRANT();
277: if (_cliff > 0 && _cliff <= _start) revert INVALID_GRANT();
```
[137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L137) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L154) | [255](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L255) | [256](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L256) | [259](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L259) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L268) | [274](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L274) | [275](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L275) | [277](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L277)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

56: if (i > 0) {
136: || (notAfterTag != 0x17 && notAfterTag != 0x18)
286: while (tbsPtr != 0) {
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L56) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L136) | [286](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L286)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

77: require(
            localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
                && localEnclaveReport.reportData.length == 64,
            "local QE report has wrong length"
        );
82: require(
            pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
                && pckSignedQeReport.reportData.length == 64,
            "QE report has wrong length"
        );
91: require(
            v3Quote.v3AuthData.certification.decodedCertDataArray.length == 3, "3 certs in chain"
        );
218: if (cert.certType < 1 || cert.certType > 5) {
249: uint16 isvProdIdPackBE = (enclaveReport.isvProdId >> 8) | (enclaveReport.isvProdId << 8);
249: uint16 isvProdIdPackBE = (enclaveReport.isvProdId >> 8) | (enclaveReport.isvProdId << 8);
250: uint16 isvSvnPackBE = (enclaveReport.isvSvn >> 8) | (enclaveReport.isvSvn << 8);
250: uint16 isvSvnPackBE = (enclaveReport.isvSvn >> 8) | (enclaveReport.isvSvn << 8);
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L77) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L82) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L91) | [218](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L218) | [249](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L249) | [249](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L249) | [250](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L250) | [250](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L250)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

20: return uint80(self >> 80);
25: return uint80(self >> 160);
197: if (lengthbytesLength == 1) {
199: } else if (lengthbytesLength == 2) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L20) | [25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L25) | [197](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L197) | [199](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L199)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

90: if (shortest > 32) {
96: if (diff != 0) {
264: require(len <= 32, "unexpected len");
329: require(len <= 52, "unexpected len");
335: require(char >= 0x30 && char <= 0x7A, "invalid char");
337: require(decoded <= 0x20, "invalid decoded");
341: ret = (ret << 5) | decoded;
345: if (len % 8 == 0) {
347: ret = (ret << 5) | decoded;
348: } else if (len % 8 == 2) {
350: ret = (ret << 3) | (decoded >> 2);
350: ret = (ret << 3) | (decoded >> 2);
352: } else if (len % 8 == 4) {
354: ret = (ret << 1) | (decoded >> 4);
354: ret = (ret << 1) | (decoded >> 4);
356: } else if (len % 8 == 5) {
358: ret = (ret << 4) | (decoded >> 1);
358: ret = (ret << 4) | (decoded >> 1);
360: } else if (len % 8 == 7) {
362: ret = (ret << 2) | (decoded >> 3);
362: ret = (ret << 2) | (decoded >> 3);
```
[90](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L90) | [96](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L96) | [264](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L264) | [329](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L329) | [335](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L335) | [337](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L337) | [341](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L341) | [345](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L345) | [347](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L347) | [348](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L348) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L350) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L350) | [352](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L352) | [354](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L354) | [354](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L354) | [356](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L356) | [358](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L358) | [358](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L358) | [360](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L360) | [362](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L362) | [362](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L362)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

137: if (decipher[0] != 0 || decipher[1] != 0x01) {
141: if (decipher[i] != 0xff) {
145: if (decipher[2 + paddingLen] != 0) {
167: if (
            decipher[3 + paddingLen + digestAlgoWithParamLen] != 0x04
                || decipher[4 + paddingLen + digestAlgoWithParamLen] != 0x20
        ) {
270: if (decipher[0] != 0 || decipher[1] != 0x01) {
274: if (decipher[i] != 0xff) {
278: if (decipher[2 + paddingLen] != 0) {
```
[137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L137) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L141) | [145](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L145) | [167](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L167) | [270](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L270) | [274](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L274) | [278](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L278)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

123: if (signature.length != 64) {
129: if (publicKey.length != 64) {
```
[123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L123) | [129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L129)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

17: if (x509Time.length == 13) {
72: if (year % 4 != 0) return false;
73: if (year % 100 != 0) return true;
74: if (year % 400 != 0) return false;
```
[17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L17) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L72) | [73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L73) | [74](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L74)
</details>

### [N-90] NatSpec: Contract declarations should have `@notice` tag

The `@notice` tag in NatSpec annotations serves to provide information about the contract's functionality that is visible to end-users.
Including `@notice` comments helps to improve the contract's transparency and ease of understanding, contributing to the overall trust and credibility of the code.
[NatSpec Guidelines](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>41 issue instances in 39 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

13: library LibAddress {
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L13)

```solidity
File: packages/protocol/contracts/libs/LibMath.sol

7: library LibMath {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibMath.sol#L7)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

15: library LibTrieProof {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L15)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L9)

```solidity
File: packages/protocol/contracts/L1/hooks/IHook.sol

8: interface IHook {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L8)

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

8: interface ITaikoL1 {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L8)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

10: contract GuardianProver is Guardians {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

37: library LibTiers {
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L37)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

10: contract DevnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

10: contract MainnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

10: contract TestnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/signal/LibSignals.sol

6: library LibSignals {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L6)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

14: contract SignalService is EssentialContract, ISignalService {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L14)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

8: interface IBridge {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L8)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

16: contract Bridge is EssentialContract, IBridge {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

8: interface IUSDC {
28: contract USDCAdapter is BridgedERC20Base {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L8) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

8: library LibBridgedToken {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L8)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

9: library RLPWriter {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

6: library LibFixedPointMath {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L6)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

10: contract GuardianVerifier is EssentialContract, IVerifier {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L10)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

9: contract ERC721Airdrop is MerkleClaimable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L9)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

22: contract AutomataDcapV3Attestation is IAttestation {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L22)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

8: interface IAttestation {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

6: interface ISigVerifyLib {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol

6: library EnclaveIdStruct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

6: interface IPEMCertChainLib {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

12: contract PEMCertChainLib is IPEMCertChainLib {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L12)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

11: library V3Parser {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L11)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

6: library V3Struct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol

6: library TCBInfoStruct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

12: library NodePtr {
38: library Asn1Decode {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L12) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L38)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

8: library BytesUtils {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

34: library RsaVerify {
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L34)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

10: library SHA1 {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L10)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

15: contract SigVerifyLib is ISigVerifyLib {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L15)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

7: library X509DateUtils {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L7)
</details>

### [N-91] Large numeric literals should use underscores for readability

Large numeric literals are often hard to read and prone to mistakes.
To improve readability and reduce the likelihood of errors, it is recommended to separate the digits of large numeric literals using underscores.
For example, instead of '1000000', use '1_000_000'.

<details>
<summary><i>28 issue instances in 13 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

13: uint32 public constant FIELD_ELEMENTS_PER_BLOB = 4096;
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L13)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

112: return 7200; // 1 day
```
[112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L112)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

21: uint256 public constant MAX_BYTES_PER_BLOB = 4096 * 32;
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L21)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

251: || _config.blockMaxTxListBytes > 128 * 1024 // calldata up to 128K
```
[251](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L251)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

209: ethDepositRingBufferSize: 1024,
```
[209](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L209)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

48: uint16 public constant TIER_GUARDIAN = 1000;
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L48)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

26: cooldownWindow: 1440, //24 hours
38: provingWindow: 2880, // 48 hours
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L26) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L38)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

26: cooldownWindow: 1440, //24 hours
36: contestBond: 1000 ether, // TKO
37: cooldownWindow: 1440, //24 hours
49: provingWindow: 2880, // 48 hours
68: if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L26) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L37) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L49) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

26: cooldownWindow: 1440, //24 hours
36: contestBond: 1000 ether, // TKO
37: cooldownWindow: 1440, //24 hours
49: provingWindow: 2880, // 48 hours
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L26) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L36) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L37) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L49)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

243: publicInputHashOld := keccak256(inputs, 8192 /*mul(256, 32)*/ )
248: publicInputHashNew := keccak256(inputs, 8192 /*mul(256, 32)*/ )
```
[243](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L243) | [248](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L248)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

14: uint256 internal constant MINIMUM_QUOTE_LENGTH = 1020;
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L14)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

11: Copyright 2016, Adri Massanet
102: sub(gas(), 2000),
250: sub(gas(), 2000),
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L11) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L102) | [250](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L250)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

18: if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;
19: else yrs += 1900;
21: yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;
48: for (uint16 i = 1970; i < year; ++i) {
64: timestamp += uint256(hour) * 3600; // Hours in seconds
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L18) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L19) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L48) | [64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L64)
</details>

### [N-92] Named Imports of Parent Contracts Are Missing

It's important to have named imports for parent contracts to ensure code readability and maintainability.
Missing named imports can make it difficult to understand the code hierarchy and can lead to issues in the future.

<details>
<summary><i>55 issue instances in 28 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit Missing named import for parent contract: `EssentialContract`
10: contract AddressManager is EssentialContract, IAddressManager {
/// @audit Missing named import for parent contract: `IAddressManager`
10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit Missing named import for parent contract: `EssentialContract`
16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
/// @audit Missing named import for parent contract: `GovernorCompatibilityBravoUpgradeable`
16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
/// @audit Missing named import for parent contract: `GovernorVotesUpgradeable`
16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
/// @audit Missing named import for parent contract: `GovernorVotesQuorumFractionUpgradeable`
16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
/// @audit Missing named import for parent contract: `GovernorTimelockControlUpgradeable`
16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

/// @audit Missing named import for parent contract: `EssentialContract`
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {
/// @audit Missing named import for parent contract: `TimelockControllerUpgradeable`
9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L9) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L9)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit Missing named import for parent contract: `EssentialContract`
14: contract AssignmentHook is EssentialContract, IHook {
/// @audit Missing named import for parent contract: `IHook`
14: contract AssignmentHook is EssentialContract, IHook {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L14) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L14)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

/// @audit Missing named import for parent contract: `Guardians`
10: contract GuardianProver is Guardians {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L10)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit Missing named import for parent contract: `EssentialContract`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {
/// @audit Missing named import for parent contract: `ITaikoL1`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {
/// @audit Missing named import for parent contract: `TaikoEvents`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {
/// @audit Missing named import for parent contract: `TaikoErrors`
22: contract TaikoL1 is EssentialContract, ITaikoL1, TaikoEvents, TaikoErrors {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L22) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L22) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L22) | [22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L22)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit Missing named import for parent contract: `EssentialContract`
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {
/// @audit Missing named import for parent contract: `ERC20SnapshotUpgradeable`
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {
/// @audit Missing named import for parent contract: `ERC20VotesUpgradeable`
15: contract TaikoToken is EssentialContract, ERC20SnapshotUpgradeable, ERC20VotesUpgradeable {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L15) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L15) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L15)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

/// @audit Missing named import for parent contract: `EssentialContract`
10: contract DevnetTierProvider is EssentialContract, ITierProvider {
/// @audit Missing named import for parent contract: `ITierProvider`
10: contract DevnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L10) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit Missing named import for parent contract: `EssentialContract`
10: contract MainnetTierProvider is EssentialContract, ITierProvider {
/// @audit Missing named import for parent contract: `ITierProvider`
10: contract MainnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L10) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit Missing named import for parent contract: `EssentialContract`
10: contract TestnetTierProvider is EssentialContract, ITierProvider {
/// @audit Missing named import for parent contract: `ITierProvider`
10: contract TestnetTierProvider is EssentialContract, ITierProvider {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L10) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L10)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit Missing named import for parent contract: `CrossChainOwned`
21: contract TaikoL2 is CrossChainOwned {
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L21)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

/// @audit Missing named import for parent contract: `TaikoL2`
9: contract TaikoL2EIP1559Configurable is TaikoL2 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L9)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit Missing named import for parent contract: `EssentialContract`
14: contract SignalService is EssentialContract, ISignalService {
/// @audit Missing named import for parent contract: `ISignalService`
14: contract SignalService is EssentialContract, ISignalService {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L14) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L14)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit Missing named import for parent contract: `EssentialContract`
16: contract Bridge is EssentialContract, IBridge {
/// @audit Missing named import for parent contract: `IBridge`
16: contract Bridge is EssentialContract, IBridge {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L16) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

/// @audit Missing named import for parent contract: `BridgedERC20Base`
28: contract USDCAdapter is BridgedERC20Base {
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit Missing named import for parent contract: `BridgedERC20Base`
15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
/// @audit Missing named import for parent contract: `IERC20MetadataUpgradeable`
15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
/// @audit Missing named import for parent contract: `ERC20SnapshotUpgradeable`
15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
/// @audit Missing named import for parent contract: `ERC20VotesUpgradeable`
15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

/// @audit Missing named import for parent contract: `EssentialContract`
12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
/// @audit Missing named import for parent contract: `ERC721Upgradeable`
12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12) | [12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit Missing named import for parent contract: `EssentialContract`
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
/// @audit Missing named import for parent contract: `IERC1155MetadataURIUpgradeable`
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
/// @audit Missing named import for parent contract: `ERC1155Upgradeable`
14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit Missing named import for parent contract: `BaseNFTVault`
29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
/// @audit Missing named import for parent contract: `ERC1155ReceiverUpgradeable`
29: contract ERC1155Vault is BaseNFTVault, ERC1155ReceiverUpgradeable {
```
[29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29) | [29](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L29)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit Missing named import for parent contract: `BaseVault`
18: contract ERC20Vault is BaseVault {
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L18)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit Missing named import for parent contract: `BaseNFTVault`
16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {
/// @audit Missing named import for parent contract: `IERC721Receiver`
16: contract ERC721Vault is BaseNFTVault, IERC721Receiver {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L16) | [16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L16)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

/// @audit Missing named import for parent contract: `EssentialContract`
10: contract GuardianVerifier is EssentialContract, IVerifier {
/// @audit Missing named import for parent contract: `IVerifier`
10: contract GuardianVerifier is EssentialContract, IVerifier {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L10) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L10)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit Missing named import for parent contract: `EssentialContract`
19: contract SgxVerifier is EssentialContract, IVerifier {
/// @audit Missing named import for parent contract: `IVerifier`
19: contract SgxVerifier is EssentialContract, IVerifier {
```
[19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L19) | [19](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L19)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

/// @audit Missing named import for parent contract: `MerkleClaimable`
11: contract ERC20Airdrop is MerkleClaimable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L11)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

/// @audit Missing named import for parent contract: `MerkleClaimable`
12: contract ERC20Airdrop2 is MerkleClaimable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L12)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

/// @audit Missing named import for parent contract: `MerkleClaimable`
9: contract ERC721Airdrop is MerkleClaimable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L9)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

/// @audit Missing named import for parent contract: `EssentialContract`
25: contract TimelockTokenPool is EssentialContract {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L25)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

/// @audit Missing named import for parent contract: `ISigVerifyLib`
15: contract SigVerifyLib is ISigVerifyLib {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L15)
</details>

### [N-93] Long functions should be refactored into multiple, smaller, functions

Functions that span many lines can be hard to understand and maintain.
It is often beneficial to refactor long functions into multiple smaller functions.
This improves readability, makes testing easier, and can even lead to gas optimization if it eliminates the need for variables that would otherwise have to be stored in memory.

<details>
<summary><i>29 issue instances in 21 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

 /// @audit 33 lines (excluding comments)
62: function onBlockProposed(
        TaikoData.Block memory _blk,
        TaikoData.BlockMetadata memory _meta,
        bytes memory _data
    )
        external
        payable
        nonReentrant
        onlyFromNamed("taiko")
    {
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L62)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

 /// @audit 31 lines (excluding comments)
67: function processDeposits(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        address _feeRecipient
    )
        internal
        returns (TaikoData.EthDeposit[] memory deposits_)
    {
```
[67](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L67)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

 /// @audit 115 lines (excluding comments)
68: function proposeBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        bytes calldata _data,
        bytes calldata _txList
    )
        internal
        returns (TaikoData.BlockMetadata memory meta_, TaikoData.EthDeposit[] memory deposits_)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L68)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

 /// @audit 90 lines (excluding comments)
91: function proveBlock(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        TaikoData.BlockMetadata memory _meta,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof
    )
        internal
        returns (uint8 maxBlocksToVerify_)
    {
 /// @audit 30 lines (excluding comments)
350: function _overrideWithHigherProof(
        TaikoData.TransitionState storage _ts,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof,
        ITierProvider.Tier memory _tier,
        IERC20 _tko,
        bool _sameTransition
    )
        private
    {
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L91) | [350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L350)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

 /// @audit 63 lines (excluding comments)
85: function verifyBlocks(
        TaikoData.State storage _state,
        TaikoData.Config memory _config,
        IAddressResolver _resolver,
        uint64 _maxBlocksToVerify
    )
        internal
    {
```
[85](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L85)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

 /// @audit 31 lines (excluding comments)
20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L20)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

 /// @audit 31 lines (excluding comments)
20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L20)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

 /// @audit 30 lines (excluding comments)
107: function anchor(
        bytes32 _l1BlockHash,
        bytes32 _l1StateRoot,
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        external
        nonReentrant
    {
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L107)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

 /// @audit 32 lines (excluding comments)
83: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        public
        virtual
        validSender(_app)
        nonZeroValue(_signal)
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L83)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

 /// @audit 35 lines (excluding comments)
155: function recallMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.srcChainId)
    {
 /// @audit 57 lines (excluding comments)
217: function processMessage(
        Message calldata _message,
        bytes calldata _proof
    )
        external
        nonReentrant
        whenNotPaused
        sameChain(_message.destChainId)
    {
```
[155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L155) | [217](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L217)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

 /// @audit 35 lines (excluding comments)
39: function sendToken(BridgeTransferOp memory _op)
        external
        payable
        nonReentrant
        whenNotPaused
        withValidOperation(_op)
        returns (IBridge.Message memory message_)
    {
 /// @audit 34 lines (excluding comments)
240: function _handleMessage(
        address _user,
        BridgeTransferOp memory _op
    )
        private
        returns (bytes memory msgData_, CanonicalNFT memory ctoken_)
    {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L39) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L240)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

 /// @audit 31 lines (excluding comments)
148: function changeBridgedToken(
        CanonicalERC20 calldata _ctoken,
        address _btokenNew
    )
        external
        nonReentrant
        whenNotPaused
        onlyOwner
        returns (address btokenOld_)
    {
 /// @audit 32 lines (excluding comments)
207: function sendToken(BridgeTransferOp calldata _op)
        external
        payable
        nonReentrant
        whenNotPaused
        returns (IBridge.Message memory message_)
    {
```
[148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L148) | [207](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L207)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

 /// @audit 35 lines (excluding comments)
26: function sendToken(BridgeTransferOp memory _op)
        external
        payable
        nonReentrant
        whenNotPaused
        withValidOperation(_op)
        returns (IBridge.Message memory message_)
    {
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L26)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

 /// @audit 88 lines (excluding comments)
144: function _decodeLength(RLPItem memory _in)
        private
        pure
        returns (uint256 offset_, uint256 length_, RLPItemType type_)
    {
```
[144](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L144)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

 /// @audit 79 lines (excluding comments)
68: function get(
        bytes memory _key,
        bytes[] memory _proof,
        bytes32 _root
    )
        internal
        pure
        returns (bytes memory value_)
    {
```
[68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L68)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

 /// @audit 40 lines (excluding comments)
247: function _verifyCertChain(IPEMCertChainLib.ECSha256Certificate[] memory certs)
        private
        view
        returns (bool)
    {
 /// @audit 91 lines (excluding comments)
363: function _verifyParsedQuote(V3Struct.ParsedV3QuoteStruct memory v3quote)
        internal
        view
        returns (bool, bytes memory)
    {
```
[247](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L247) | [363](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L363)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

 /// @audit 87 lines (excluding comments)
73: function decodeCert(
        bytes memory der,
        bool isPckCert
    )
        external
        pure
        returns (bool success, ECSha256Certificate memory cert)
    {
 /// @audit 43 lines (excluding comments)
268: function _findPckTcbInfo(
        bytes memory der,
        uint256 tbsPtr,
        uint256 tbsParentPtr
    )
        private
        pure
        returns (
            bool success,
            uint256 pcesvn,
            uint256[] memory cpusvns,
            bytes memory fmspcBytes,
            bytes memory pceidBytes
        )
    {
```
[73](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L73) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L268)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

 /// @audit 54 lines (excluding comments)
61: function validateParsedInput(V3Struct.ParsedV3QuoteStruct memory v3Quote)
        internal
        pure
        returns (
            bool success,
            V3Struct.Header memory header,
            V3Struct.EnclaveReport memory localEnclaveReport,
            bytes memory signedQuoteData, // concatenation of header and local enclave report bytes
            V3Struct.ECDSAQuoteV3AuthData memory authDataV3
        )
    {
```
[61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L61)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

 /// @audit 33 lines (excluding comments)
56: function compare(
        bytes memory self,
        uint256 offset,
        uint256 len,
        bytes memory other,
        uint256 otheroffset,
        uint256 otherlen
    )
        internal
        pure
        returns (int256)
    {
 /// @audit 32 lines (excluding comments)
320: function base32HexDecodeWord(
        bytes memory self,
        uint256 off,
        uint256 len
    )
        internal
        pure
        returns (bytes32)
    {
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L56) | [320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L320)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

 /// @audit 101 lines (excluding comments)
43: function pkcs1Sha256(
        bytes32 _sha256,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
 /// @audit 57 lines (excluding comments)
212: function pkcs1Sha1(
        bytes20 _sha1,
        bytes memory _s,
        bytes memory _e,
        bytes memory _m
    )
        internal
        view
        returns (bool)
    {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L43) | [212](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L212)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

 /// @audit 161 lines (excluding comments)
11: function sha1(bytes memory data) internal pure returns (bytes20 ret) {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L11)
</details>

### [N-94] NatSpec: Contract declarations should have `@dev` tags

NatSpec comments are a critical part of Solidity's documentation system, designed to help developers and others understand the behavior and purpose of a contract.
The `@dev` tag, in particular, provides context and insight into the contract's development considerations.
A missing `@dev` comment can lead to misunderstandings about the contract, making it harder for others to contribute to or use the contract effectively.
Therefore, it's highly recommended to include `@dev` comments in the documentation to enhance code readability and maintainability.
[Refer to NatSpec Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>58 issue instances in 55 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/IAddressManager.sol

7: interface IAddressManager {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/IAddressManager.sol#L7)

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

15: library LibTrieProof {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L15)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

16: contract TaikoGovernor is
    EssentialContract,
    GovernorCompatibilityBravoUpgradeable,
    GovernorVotesUpgradeable,
    GovernorVotesQuorumFractionUpgradeable,
    GovernorTimelockControlUpgradeable
{
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L16)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

9: contract TaikoTimelockController is EssentialContract, TimelockControllerUpgradeable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L9)

```solidity
File: packages/protocol/contracts/L1/hooks/IHook.sol

8: interface IHook {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/IHook.sol#L8)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

14: contract AssignmentHook is EssentialContract, IHook {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L14)

```solidity
File: packages/protocol/contracts/L1/ITaikoL1.sol

8: interface ITaikoL1 {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/ITaikoL1.sol#L8)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

12: library LibDepositing {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L12)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

15: library LibProposing {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L15)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

16: library LibProving {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L16)

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

9: library LibUtils {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L9)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

16: library LibVerifying {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L16)

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

10: contract GuardianProver is Guardians {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L10)

```solidity
File: packages/protocol/contracts/L1/TaikoData.sol

8: library TaikoData {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L8)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

7: interface ITierProvider {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L7)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

21: contract TaikoL2 is CrossChainOwned {
```
[21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L21)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

9: contract TaikoL2EIP1559Configurable is TaikoL2 {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L9)

```solidity
File: packages/protocol/contracts/signal/ISignalService.sol

12: interface ISignalService {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/ISignalService.sol#L12)

```solidity
File: packages/protocol/contracts/signal/LibSignals.sol

6: library LibSignals {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/LibSignals.sol#L6)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

160: interface IRecallableSender {
174: interface IMessageInvocable {
```
[160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L160) | [174](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L174)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

8: interface IUSDC {
28: contract USDCAdapter is BridgedERC20Base {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L8) | [28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L28)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

15: contract BridgedERC20 is
    BridgedERC20Base,
    IERC20MetadataUpgradeable,
    ERC20SnapshotUpgradeable,
    ERC20VotesUpgradeable
{
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L15)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

12: contract BridgedERC721 is EssentialContract, ERC721Upgradeable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L12)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

14: contract BridgedERC1155 is EssentialContract, IERC1155MetadataURIUpgradeable, ERC1155Upgradeable {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L14)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

16: interface IERC1155NameAndSymbol {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L16)

```solidity
File: packages/protocol/contracts/tokenvault/LibBridgedToken.sol

8: library LibBridgedToken {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/LibBridgedToken.sol#L8)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

6: library Bytes {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L6)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

9: library RLPReader {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

9: library RLPWriter {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

11: library MerkleTrie {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L11)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

9: library SecureMerkleTrie {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L9)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

6: library LibFixedPointMath {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L6)

```solidity
File: packages/protocol/contracts/verifiers/IVerifier.sol

9: interface IVerifier {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/IVerifier.sol#L9)

```solidity
File: packages/protocol/contracts/verifiers/GuardianVerifier.sol

10: contract GuardianVerifier is EssentialContract, IVerifier {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/GuardianVerifier.sol#L10)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

11: contract ERC20Airdrop is MerkleClaimable {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L11)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

12: contract ERC20Airdrop2 is MerkleClaimable {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L12)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol

9: contract ERC721Airdrop is MerkleClaimable {
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC721Airdrop.sol#L9)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

25: contract TimelockTokenPool is EssentialContract {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L25)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

22: contract AutomataDcapV3Attestation is IAttestation {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L22)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

8: interface IAttestation {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol

6: interface ISigVerifyLib {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/ISigVerifyLib.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol

6: library EnclaveIdStruct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/EnclaveIdStruct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol

6: interface IPEMCertChainLib {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/interfaces/IPEMCertChainLib.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

12: contract PEMCertChainLib is IPEMCertChainLib {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L12)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

11: library V3Parser {
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L11)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

6: library V3Struct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol

6: library TCBInfoStruct {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/TCBInfoStruct.sol#L6)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

12: library NodePtr {
38: library Asn1Decode {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L12) | [38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L38)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

8: library BytesUtils {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L8)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

34: library RsaVerify {
```
[34](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L34)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

10: library SHA1 {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L10)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

15: contract SigVerifyLib is ISigVerifyLib {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L15)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

7: library X509DateUtils {
```
[7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L7)
</details>

### [N-95] The nonReentrant modifier should occur before all other modifiers

This is a best-practice to protect against reentrancy in other modifiers.

<details>
<summary><i>4 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

35: function approve(
        TaikoData.BlockMetadata calldata _meta,
        TaikoData.Transition calldata _tran,
        TaikoData.TierProof calldata _proof
    )
        external
        whenNotPaused
        nonReentrant
        returns (bool approved_)
    {
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L35)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

53: function setGuardians(
        address[] memory _newGuardians,
        uint8 _minGuardians
    )
        external
        onlyOwner
        nonReentrant
    {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L53)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

163: function withdraw(
        address _token,
        address _to
    )
        external
        onlyFromOwnerOrNamed("withdrawer")
        nonReentrant
        whenNotPaused
    {
```
[163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L163)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

101: function banAddress(
        address _addr,
        bool _ban
    )
        external
        onlyFromOwnerOrNamed("bridge_watchdog")
        nonReentrant
    {
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L101)
</details>

### [N-96] `public` functions not called by the contract should be declared `external` instead

Contracts are allowed to override their parents' functions and change the visibility from `external` to `public`.
If a `public` function is not called internally within the contract, it should be declared as `external` to save gas.

<details>
<summary><i>44 issue instances in 19 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

54: function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L54)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

111: function votingDelay() public pure override returns (uint256) {
117: function votingPeriod() public pure override returns (uint256) {
123: function proposalThreshold() public pure override returns (uint256) {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L111) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L117) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L123)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

107: function numGuardians() public view returns (uint256) {
```
[107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L107)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

176: function getStateVariables()
        public
        view
        returns (TaikoData.SlotA memory a_, TaikoData.SlotB memory b_)
    {
```
[176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L176)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

25: function init(
        address _owner,
        string calldata _name,
        string calldata _symbol,
        address _recipient
    )
        public
        initializer
    {
47: function burn(address _from, uint256 _amount) public onlyOwner {
52: function snapshot() public onlyFromOwnerOrNamed("snapshooter") {
```
[25](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L25) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L47) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L52)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
47: function getTierIds() public pure override returns (uint16[] memory tiers_) {
54: function getMinTier(uint256) public pure override returns (uint16) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L20) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L47) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L54)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
58: function getTierIds() public pure override returns (uint16[] memory tiers_) {
66: function getMinTier(uint256 _rand) public pure override returns (uint16) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L20) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L58) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
58: function getTierIds() public pure override returns (uint16[] memory tiers_) {
66: function getMinTier(uint256 _rand) public pure override returns (uint16) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L20) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L58) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

185: function getBasefee(
        uint64 _l1BlockId,
        uint32 _parentGasUsed
    )
        public
        view
        returns (uint256 basefee_)
    {
200: function getBlockHash(uint64 _blockId) public view returns (bytes32) {
```
[185](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L185) | [200](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L200)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

43: function getConfig() public view override returns (Config memory) {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L43)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

83: function proveSignalReceived(
        uint64 _chainId,
        address _app,
        bytes32 _signal,
        bytes calldata _proof
    )
        public
        virtual
        validSender(_app)
        nonZeroValue(_signal)
    {
137: function isChainDataSynced(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId,
        bytes32 _chainData
    )
        public
        view
        nonZeroValue(_chainData)
        returns (bool)
    {
153: function isSignalSent(address _app, bytes32 _signal) public view returns (bool) {
158: function getSyncedChainData(
        uint64 _chainId,
        bytes32 _kind,
        uint64 _blockId
    )
        public
        view
        returns (uint64 blockId_, bytes32 chainData_)
    {
```
[83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L83) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L137) | [153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L153) | [158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L158)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

340: function isMessageSent(Message calldata _message) public view returns (bool) {
352: function proveMessageFailed(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
    {
374: function proveMessageReceived(
        Message calldata _message,
        bytes calldata _proof
    )
        public
        view
        returns (bool)
    {
403: function context() public view returns (Context memory ctx_) {
```
[340](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L340) | [352](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L352) | [374](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L374) | [403](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L403)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

113: function decimals()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (uint8)
    {
125: function canonical() public view returns (address, uint256) {
```
[113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L113) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L125)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

75: function burn(address _account, uint256 _amount) public nonReentrant whenNotPaused {
```
[75](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L75)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

54: function mint(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
69: function burn(
        address _account,
        uint256 _tokenId
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc721_vault")
    {
100: function source() public view returns (address, uint256) {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L54) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L69) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L100)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

66: function mint(
        address _to,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
83: function mintBatch(
        address _to,
        uint256[] memory _tokenIds,
        uint256[] memory _amounts
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
100: function burn(
        address _account,
        uint256 _tokenId,
        uint256 _amount
    )
        public
        nonReentrant
        whenNotPaused
        onlyFromNamed("erc1155_vault")
    {
115: function name() public view returns (string memory) {
121: function symbol() public view returns (string memory) {
```
[66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L66) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L83) | [100](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L100) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L115) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L121)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

204: function getMyGrant(address _recipient) public view returns (Grant memory) {
```
[204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L204)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

102: function configureTcbInfoJson(
        string calldata fmspc,
        TCBInfoStruct.TCBInfo calldata tcbInfoInput
    )
        public
        onlyOwner
    {
```
[102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L102)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

23: function verifyAttStmtSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        Algorithm alg
    )
        public
        view
        returns (bool)
    {
53: function verifyCertificateSignature(
        bytes memory tbs,
        bytes memory signature,
        PublicKey memory publicKey,
        CertSigAlgorithm alg
    )
        public
        view
        returns (bool)
    {
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L23) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L53)
</details>

### [N-97] Large multiples of ten should use scientific notation

Large multiples of ten should use scientific notation (e.g., 1e4) instead of decimal literals (e.g., 10000)
for better code readability.

<details>
<summary><i>13 issue instances in 9 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

/// @audit `1_000_000_000` should be written as `1e9`
124: return 1_000_000_000 ether / 10_000; // 0.01% of Taiko Token
/// @audit `10_000` should be written as `1e4`
124: return 1_000_000_000 ether / 10_000; // 0.01% of Taiko Token
```
[124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L124) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L124)

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

/// @audit `50_000` should be written as `5e4`
38: uint256 public constant MAX_GAS_PAYING_PROVER = 50_000;
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L38)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit `10_000` should be written as `1e4`
213: ethDepositMaxAmount: 10_000 ether,
```
[213](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L213)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

/// @audit `1_000_000_000` should be written as `1e9`
41: _mint(_recipient, 1_000_000_000 ether);
```
[41](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L41)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

/// @audit `1000` should be written as `1e3`
48: uint16 public constant TIER_GUARDIAN = 1000;
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L48)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

/// @audit `1000` should be written as `1e3`
36: contestBond: 1000 ether, // TKO
/// @audit `1000` should be written as `1e3`
68: if (_rand % 1000 == 0) return LibTiers.TIER_SGX_ZKVM;
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L36) | [68](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L68)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

/// @audit `1000` should be written as `1e3`
36: contestBond: 1000 ether, // TKO
```
[36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L36)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

/// @audit `2000` should be written as `2e3`
102: sub(gas(), 2000),
/// @audit `2000` should be written as `2e3`
250: sub(gas(), 2000),
```
[102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L102) | [250](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L250)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

/// @audit `2000` should be written as `2e3`
18: if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;
/// @audit `1000` should be written as `1e3`
21: yrs += (uint8(x509Time[0]) - 48) * 1000 + (uint8(x509Time[1]) - 48) * 100;
```
[18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L18) | [21](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L21)
</details>

### [N-98] Prefer Casting to `bytes` or `bytes32` Over `abi.encodePacked()` for Single Arguments

When using `abi.encodePacked()` on a single argument, it is often clearer to use a cast to `bytes` or `bytes32`.
This improves the semantic clarity of the code, making it easier for reviewers to understand the developer's intentions.

<details>
<summary><i>5 issue instances in 4 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

48: SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash);
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L48)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

56: bytes memory b = abi.encodePacked(_x);
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L56)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

81: bytes memory currentNodeID = abi.encodePacked(_root);
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L81)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

163: bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);
369: bytes memory retData = abi.encodePacked(INVALID_EXIT_CODE);
```
[163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L163) | [369](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L369)
</details>

### [N-99] Complex casting

Complex casting in Solidity contracts can introduce both readability issues and potential for overflows. 
Whenever multiple casts are found, consider whether the complexity is necessary.
If so, it is strongly recommended to add inline comments to explain why these casts are needed and to assure that no overflows are introduced.

<details>
<summary><i>18 issue instances in 8 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

89: recipient: address(uint160(data >> 96)),
151: return (uint256(uint160(_addr)) << 96) | _amount;
```
[89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L89) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L151)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

457: return _msgHash ^ bytes32(uint256(Status.FAILED));
533: _storeContext(bytes32(PLACEHOLDER), address(uint160(PLACEHOLDER)), uint64(PLACEHOLDER));
```
[457](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L457) | [533](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L533)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

35: out_[0] = bytes1(uint8(_len) + uint8(_offset));
45: out_[0] = bytes1(uint8(lenLen) + uint8(_offset) + 55);
47: out_[i] = bytes1(uint8((_len / (256 ** (lenLen - i))) % 256));
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L35) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L45) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L47)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

133: _address[0] = address(bytes20(_attestation.localEnclaveReport.reportData));
154: uint32 id = uint32(bytes4(Bytes.slice(_proof.data, 0, 4)));
155: address newInstance = address(bytes20(Bytes.slice(_proof.data, 4, 20)));
```
[133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L133) | [154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L154) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L155)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

359: ? uint16(bytes2(svnValueBytes)) / 256
360: : uint16(bytes2(svnValueBytes));
```
[359](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L359) | [360](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L360)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

154: uint256 digits = uint256(uint8(bytes1(encoded[i])));
```
[154](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L154)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

336: decoded = uint8(BASE32_HEX_TABLE[uint256(uint8(char)) - 0x30]);
```
[336](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L336)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol

126: uint256 r = uint256(bytes32(signature.substring(0, 32)));
127: uint256 s = uint256(bytes32(signature.substring(32, 32)));
132: uint256 gx = uint256(bytes32(publicKey.substring(0, 32)));
133: uint256 gy = uint256(bytes32(publicKey.substring(32, 32)));
```
[126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L126) | [127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L127) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L132) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SigVerifyLib.sol#L133)
</details>

### [N-100] Non-assembly High-Level Solidity Functions Available

Usage of inline assembly can increase the complexity of a project and potentially introduce security risks. 
It's best to avoid using inline assembly where possible, especially when equivalent non-assembly methods are available.

<details>
<summary><i>2 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

99: assembly {
            pop(
                staticcall(
                    sub(gas(), 2000),
                    5,
                    add(input, 0x20),
                    inputlen,
                    add(decipher, 0x20),
                    decipherlen
                )
            )
        }
247: assembly {
            pop(
                staticcall(
                    sub(gas(), 2000),
                    5,
                    add(input, 0x20),
                    inputlen,
                    add(decipher, 0x20),
                    decipherlen
                )
            )
        }
```
[99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L99) | [247](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L247)
</details>

### [N-101] Equal `block.timestamp` Cases Not Handled

Solidity code that checks if `block.timestamp` is greater than a certain variable but fails to handle the case when `block.timestamp` is equal to the variable may lead to unintended behaviors and potential vulnerabilities.

To ensure correct and secure function execution, it's recommended to include checks for cases where `block.timestamp` equals the compared variable.

<details>
<summary><i>10 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/hooks/AssignmentHook.sol

82: block.timestamp > assignment.expiry
```
[82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/hooks/AssignmentHook.sol#L82)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

296: return _state.reusableBlobs[_blobHash] + _config.blobExpiry > block.timestamp;
```
[296](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L296)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

153: + uint256(ts.timestamp).max(_state.slotB.lastUnpausedAt) > block.timestamp
```
[153](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L153)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol

40: if (claimEnd > block.timestamp || claimEnd + withdrawalWindow < block.timestamp) {
40: if (claimEnd > block.timestamp || claimEnd + withdrawalWindow < block.timestamp) {
114: if (block.timestamp < claimEnd) return (balance, 0);
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L40) | [40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L40) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop2.sol#L114)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

35: merkleRoot == 0x0 || claimStart == 0 || claimEnd == 0 || claimStart > block.timestamp
36: || claimEnd < block.timestamp
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L35) | [36](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L36)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

280: block.timestamp > certs[i].notBefore && block.timestamp < certs[i].notAfter;
280: block.timestamp > certs[i].notBefore && block.timestamp < certs[i].notAfter;
```
[280](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L280) | [280](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L280)
</details>

### [N-102] `else`-block not required

In Solidity, if an `if` block contains a `return` statement, subsequent `else` blocks become unnecessary.
This is because the `return` statement halts the execution of the function at that point, making any `else` conditions redundant.
Therefore, omitting `else` after such `if` blocks can lead to cleaner and more readable code without any change in the functionality.

<details>
<summary><i>7 issue instances in 6 files:</i></summary>

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

70: if (Address.isContract(_addr)) {
            return IERC1271(_addr).isValidSignature(_hash, _sig) == _EIP1271_MAGICVALUE;
        } else {
            return ECDSA.recover(_hash, _sig) == _addr;
        }
```
[70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L70)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

423: if (
            block.chainid == 1 // Ethereum mainnet
        ) {
            // For Taiko mainnet
            // 384 seconds = 6.4 minutes = one ethereum epoch
            return (1 hours, 384 seconds);
        } else if (
            block.chainid == 2 // Ropsten
                || block.chainid == 4 // Rinkeby
                || block.chainid == 5 // Goerli
                || block.chainid == 42 // Kovan
                || block.chainid == 17_000 // Holesky
                || block.chainid == 11_155_111 // Sepolia
        ) {
            // For all Taiko public testnets
            return (30 minutes, 384 seconds);
        } else if (block.chainid >= 32_300 && block.chainid <= 32_400) {
```
[423](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L423)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

163: if (prefix <= 0x7f) {
            // Single byte.
            return (0, 1, RLPItemType.DATA_ITEM);
        } else if (prefix <= 0xb7) {
            // Short string.

            // slither-disable-next-line variable-scope
            uint256 strLen = prefix - 0x80;

            require(
                _in.length > strLen,
                "RLPReader: length of content must be greater than string length (short string)"
            );

            bytes1 firstByteOfContent;
            assembly {
                firstByteOfContent := and(mload(add(ptr, 1)), shl(248, 0xff))
            }
```
[163](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L163)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

111: if (currentNode.decoded.length == BRANCH_NODE_LENGTH) {
                if (currentKeyIndex == key.length) {
                    // Value is the last element of the decoded list (for branch nodes). There's
                    // some ambiguity in the Merkle trie specification because bytes(0) is a
                    // valid value to place into the trie, but for branch nodes bytes(0) can exist
                    // even when the value wasn't explicitly placed there. Geth treats a value of
                    // bytes(0) as "key does not exist" and so we do the same.
                    value_ = RLPReader.readBytes(currentNode.decoded[TREE_RADIX]);
                    require(
                        value_.length > 0,
                        "MerkleTrie: value length must be greater than zero (branch)"
                    );

                    // Extra proof elements are not allowed.
                    require(
                        i == proof.length - 1,
                        "MerkleTrie: value node must be last node in proof (branch)"
                    );

                    return value_;
                } else {
                    // We're not at the end of the key yet.
                    // Figure out what the next node ID should be and continue.
                    uint8 branchKey = uint8(key[currentKeyIndex]);
                    RLPReader.RLPItem memory nextNode = currentNode.decoded[branchKey];
                    currentNodeID = _getNodeID(nextNode);
                    currentKeyIndex += 1;
                }
155: if (prefix == PREFIX_LEAF_EVEN || prefix == PREFIX_LEAF_ODD) {
                    // Prefix of 2 or 3 means this is a leaf node. For the leaf node to be valid,
                    // the key remainder must be exactly equal to the path remainder. We already
                    // did the necessary byte comparison, so it's more efficient here to check that
                    // the key remainder length equals the shared nibble length, which implies
                    // equality with the path remainder (since we already did the same check with
                    // the path remainder and the shared nibble length).
                    require(
                        keyRemainder.length == sharedNibbleLength,
                        "MerkleTrie: key remainder must be identical to path remainder"
                    );

                    // Our Merkle Trie is designed specifically for the purposes of the Ethereum
                    // state trie. Empty values are not allowed in the state trie, so we can safely
                    // say that if the value is empty, the key should not exist and the proof is
                    // invalid.
                    value_ = RLPReader.readBytes(currentNode.decoded[1]);
                    require(
                        value_.length > 0,
                        "MerkleTrie: value length must be greater than zero (leaf)"
                    );

                    // Extra proof elements are not allowed.
                    require(
                        i == proof.length - 1,
                        "MerkleTrie: value node must be last node in proof (leaf)"
                    );

                    return value_;
                } else if (prefix == PREFIX_EXTENSION_EVEN || prefix == PREFIX_EXTENSION_ODD) {
                    // Prefix of 0 or 1 means this is an extension node. We move onto the next node
                    // in the proof and increment the key index by the length of the path remainder
                    // which is equal to the shared nibble length.
                    currentNodeID = _getNodeID(currentNode.decoded[1]);
                    currentKeyIndex += sharedNibbleLength;
                } else {
```
[111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L111) | [155](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L155)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

319: if (qeReportDataIsValid) {
            bytes memory pckSignedQeReportBytes =
                V3Parser.packQEReport(authDataV3.pckSignedQeReport);
            bool qeSigVerified = sigVerifyLib.verifyES256Signature(
                pckSignedQeReportBytes, authDataV3.qeReportSignature, pckCertPubKey
            );
            bool quoteSigVerified = sigVerifyLib.verifyES256Signature(
                signedQuoteData, authDataV3.ecdsa256BitSignature, authDataV3.ecdsaAttestationKey
            );
            return qeSigVerified && quoteSigVerified;
        } else {
            return false;
        }
```
[319](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L319)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

158: if (der[ptr.ixf()] == 0) {
            return der.substring(ptr.ixf() + 1, valueLength - 1);
        } else {
            return der.substring(ptr.ixf(), valueLength);
        }
```
[158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L158)
</details>

### [N-103] Polymorphic functions make security audits more time-consuming and error-prone

While function overriding allows for functions with the same name to coexist, it's advisable to avoid this practice for the sake of readability and maintainability. 

Having multiple functions with the same name, even with different parameters or in inherited contracts, can cause confusion and increase the chance of errors during development, testing, and debugging.
Using distinct and descriptive function names not only clarifies the purpose and behavior of each function but also helps prevent unintended function calls or incorrect overriding.

<details>
<summary><i>24 issue instances in 9 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressResolver.sol

30: function resolve(
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
    {
43: function resolve(
        uint64 _chainId,
        bytes32 _name,
        bool _allowZeroAddress
    )
        public
        view
        virtual
        returns (address payable)
    {
```
[30](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L30) | [43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressResolver.sol#L43)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

95: function __Essential_init(
        address _owner,
        address _addressManager
    )
        internal
        virtual
        onlyInitializing
    {
109: function __Essential_init(address _owner) internal virtual {
```
[95](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L95) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L109)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

22: function sendEther(address _to, uint256 _amount, uint256 _gasLimit) internal {
42: function sendEther(address _to, uint256 _amount) internal {
```
[22](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L22) | [42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L42)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

101: function isApproved(bytes32 _hash) public view returns (bool) {
128: function isApproved(uint256 _approvalBits) internal view returns (bool) {
```
[101](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L101) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L128)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

15: function slice(
        bytes memory _bytes,
        uint256 _start,
        uint256 _length
    )
        internal
        pure
        returns (bytes memory)
    {
91: function slice(bytes memory _bytes, uint256 _start) internal pure returns (bytes memory) {
```
[15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L15) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L91)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

53: function readList(RLPItem memory _in) internal pure returns (RLPItem[] memory out_) {
102: function readList(bytes memory _in) internal pure returns (RLPItem[] memory out_) {
109: function readBytes(RLPItem memory _in) internal pure returns (bytes memory out_) {
128: function readBytes(bytes memory _in) internal pure returns (bytes memory out_) {
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L53) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L102) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L109) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L128)

```solidity
File: packages/protocol/contracts/team/TimelockTokenPool.sol

161: function withdraw() external {
168: function withdraw(address _to, bytes memory _sig) external {
```
[161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L161) | [168](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/TimelockTokenPool.sol#L168)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

39: function compare(bytes memory self, bytes memory other) internal pure returns (int256) {
56: function compare(
        bytes memory self,
        uint256 offset,
        uint256 len,
        bytes memory other,
        uint256 otheroffset,
        uint256 otherlen
    )
        internal
        pure
        returns (int256)
    {
116: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other,
        uint256 otherOffset,
        uint256 len
    )
        internal
        pure
        returns (bool)
    {
138: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other,
        uint256 otherOffset
    )
        internal
        pure
        returns (bool)
    {
160: function equals(
        bytes memory self,
        uint256 offset,
        bytes memory other
    )
        internal
        pure
        returns (bool)
    {
178: function equals(bytes memory self, bytes memory other) internal pure returns (bool) {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L39) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L56) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L116) | [138](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L138) | [160](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L160) | [178](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L178)
</details>

### [N-104] Style guide: Function ordering does not follow the Solidity style guide

Ordering helps readers identify which functions they can call and to find the constructor and fallback definitions easier.
But there are contracts in the project that do not comply with this.
Functions should be grouped according to their visibility and ordered:
- constructor 
- receive function (if exists)
- fallback function (if exists)
- external
- public
- internal
- private.

<details>
<summary><i>6 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit `public` function `configureTcbInfoJson()` declared before `external` function `configureQeIdentityJson()`
102: function configureTcbInfoJson(
        string calldata fmspc,
        TCBInfoStruct.TCBInfo calldata tcbInfoInput
    )
        public
        onlyOwner
    {
113: function configureQeIdentityJson(EnclaveIdStruct.EnclaveId calldata qeIdentityInput)
        external
        onlyOwner
    {
/// @audit `internal` function `_attestationTcbIsValid()` declared before `external` function `verifyAttestation()`
125: function _attestationTcbIsValid(TCBInfoStruct.TCBStatus status)
        internal
        pure
        virtual
        returns (bool valid)
    {
137: function verifyAttestation(bytes calldata data) external view override returns (bool) {
/// @audit `private` function `_enclaveReportSigVerification()` declared before `external` function `verifyParsedQuote()`
302: function _enclaveReportSigVerification(
        bytes memory pckCertPubKey,
        bytes memory signedQuoteData,
        V3Struct.ECDSAQuoteV3AuthData memory authDataV3,
        V3Struct.EnclaveReport memory qeEnclaveReport
    )
        private
        view
        returns (bool)
    {
355: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        view
        override
        returns (bool, bytes memory)
    {
```
[102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L102) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L113) | [125](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L125) | [137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L137) | [302](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L302) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355)
</details>

### [N-105] Style guide: Lines are too long

It is generally recommended that lines in the source code should not exceed 80-120 characters.
Multiline output parameters and return statements should follow the same style recommended for wrapping long lines found in the Maximum Line Length section.

<details>
<summary><i>6 issue instances in 5 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

293: // https://github.com/ethereum/solidity/blob/34dd30d71b4da730488be72ff6af7083cf2a91f6/libsolidity/codegen/YulUtilFunctions.cpp#L102-L114
```
[293](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L293)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

28: // https://github.com/intel/SGXDataCenterAttestationPrimitives/blob/e7604e02331b3377f3766ed3653250e03af72d45/QuoteVerification/QVL/Src/AttestationLibrary/src/CertVerification/X509Constants.h#L64
31: // keccak256(hex"0ba9c4c0c0c86193a3fe23d6b02cda10a8bbd4e88e48b4458561a36e705525f567918e2edc88e40d860bd0cc4ee26aacc988e505a953558c453f6b0904ae7394")
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L28) | [31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L31)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

31: // https://github.com/intel/SGXDataCenterAttestationPrimitives/blob/e7604e02331b3377f3766ed3653250e03af72d45/QuoteVerification/QVL/Src/AttestationLibrary/src/CertVerification/X509Constants.h#L64
```
[31](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L31)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

311: hex"00010203040506070809FFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1FFFFFFFFFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1F";
```
[311](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L311)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

27: https://csrc.nist.gov/CSRC/media/Projects/Cryptographic-Algorithm-Validation-Program/documents/dss/186-2rsatestvectors.zip
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L27)
</details>

### [N-106] Numeric Values Related to Time Lacking Units

For enhanced readability and comprehensibility, numeric values related to time in your Solidity code should employ time units like seconds, minutes, hours, days, or weeks.

Please note that:
- 1 == 1 seconds
- 1 minutes == 60 seconds
- 1 hours == 60 minutes
- 1 days == 24 hours
- 1 weeks == 7 days

More about Time Uints in [Solidity Documentation](https://docs.soliditylang.org/en/latest/units-and-global-variables.html#time-units).

<details>
<summary><i>15 issue instances in 10 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

112: return 7200; // 1 day
```
[112](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L112)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

415: + _tier.provingWindow * 60 >= block.timestamp;
```
[415](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L415)

```solidity
File: packages/protocol/contracts/L1/libs/LibVerifying.sol

152: uint256(ITierProvider(tierProvider).getTier(ts.tier).cooldownWindow) * 60
```
[152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibVerifying.sol#L152)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

45: uint16 public constant TIER_SGX_ZKVM = 300;
```
[45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L45)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

37: cooldownWindow: 60, //1 hours
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L37)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

27: provingWindow: 60, // 1 hours
48: cooldownWindow: 60, //1 hours
```
[27](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L27) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L48)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

38: provingWindow: 60, // 1 hours
48: cooldownWindow: 60, //1 hours
```
[38](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L38) | [48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L48)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

78: localEnclaveReport.reserved3.length == 96 && localEnclaveReport.reserved4.length == 60
83: pckSignedQeReport.reserved3.length == 96 && pckSignedQeReport.reserved4.length == 60
148: enclaveReport.reserved4 = rawEnclaveReport.substring(260, 60);
```
[78](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L78) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L83) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L148)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

28: bytes reserved4; // 60 bytes
```
[28](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L28)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

64: timestamp += uint256(hour) * 3600; // Hours in seconds
65: timestamp += uint256(minute) * 60; // Minutes in seconds
```
[64](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L64) | [65](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L65)
</details>

### [N-107] Style guide: Extraneous whitespace

See the [whitespace](https://docs.soliditylang.org/en/v0.8.24/style-guide.html#whitespace-in-expressions) section of the Solidity Style Guide

<details>
<summary><i>188 issue instances in 28 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
114: function _authorizeUpgrade(address) internal virtual override onlyOwner { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
116: function _authorizePause(address) internal virtual onlyOwner { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
114: function _authorizeUpgrade(address) internal virtual override onlyOwner { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
116: function _authorizePause(address) internal virtual onlyOwner { }
/// @audit `More than one space around an assignment or other operator to align with another`
17: bytes32 private constant _REENTRY_SLOT =
        0xa5054f728453d3dbe953bdc43e4d0cb97e662ea32d7958190f3dc2da31d9721a;
```
[114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L114) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L116) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L114) | [116](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L116) | [17](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L17)

```solidity
File: packages/protocol/contracts/libs/Lib4844.sol

/// @audit `More than one space around an assignment or other operator to align with another`
16: uint256 public constant BLS_MODULUS =
        52_435_875_175_126_190_479_447_740_508_185_965_837_690_552_500_527_637_822_603_658_699_938_581_184_513;
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/Lib4844.sol#L16)

```solidity
File: packages/protocol/contracts/libs/LibAddress.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
58: } catch { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
58: } catch { }
```
[58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L58) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibAddress.sol#L58)

```solidity
File: packages/protocol/contracts/libs/LibTrieProof.sol

/// @audit `More than one space around an assignment or other operator to align with another`
47: bytes memory rlpAccount =
                SecureMerkleTrie.get(abi.encodePacked(_addr), _accountProof, _rootHash);
/// @audit `More than one space around an assignment or other operator to align with another`
54: storageRoot_ =
                bytes32(RLPReader.readBytes(accountState[_ACCOUNT_FIELD_INDEX_STORAGE_HASH]));
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L47) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/libs/LibTrieProof.sol#L54)

```solidity
File: packages/protocol/contracts/L1/libs/LibDepositing.sol

/// @audit `More than one space around an assignment or other operator to align with another`
81: deposits_ =
                new TaikoData.EthDeposit[](numPending.min(_config.ethDepositMaxCountPerBlock));
/// @audit `More than one space around an assignment or other operator to align with another`
109: _state.ethDeposits[_state.slotA.numEthDeposits % _config.ethDepositRingBufferSize] =
                _encodeEthDeposit(_feeRecipient, totalFee);
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L81) | [109](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibDepositing.sol#L109)

```solidity
File: packages/protocol/contracts/L1/libs/LibProposing.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
253: IHook(params.hookCalls[i].hook).onBlockProposed{ value: address(this).balance }(
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
253: IHook(params.hookCalls[i].hook).onBlockProposed{ value: address(this).balance }(
/// @audit `More than one space around an assignment or other operator to align with another`
102: bytes32 parentMetaHash =
            _state.blocks[(b.numBlocks - 1) % _config.blockRingBufferSize].metaHash;
```
[253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L253) | [253](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L253) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProposing.sol#L102)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

/// @audit `More than one space around an assignment or other operator to align with another`
129: (uint32 tid, TaikoData.TransitionState storage ts) =
            _createTransition(_state, blk, _tran, slot);
/// @audit `More than one space around an assignment or other operator to align with another`
140: ITierProvider.Tier memory tier =
            ITierProvider(_resolver.resolve("tier_provider", false)).getTier(_proof.tier);
```
[129](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L129) | [140](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L140)

```solidity
File: packages/protocol/contracts/L1/TaikoData.sol

/// @audit `More than one space around an assignment or other operator to align with another`
187: => mapping(uint32 transitionId => TransitionState ts)
```
[187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoData.sol#L187)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
226: { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
226: { }
```
[226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L226) | [226](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L226)

```solidity
File: packages/protocol/contracts/L2/TaikoL2.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
243: publicInputHashOld := keccak256(inputs, 8192 /*mul(256, 32)*/ )
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
248: publicInputHashNew := keccak256(inputs, 8192 /*mul(256, 32)*/ )
```
[243](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L243) | [248](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2.sol#L248)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
70: receive() external payable { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
199: IRecallableSender(_message.from).onMessageRecalled{ value: _message.value }(
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
467: { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
70: receive() external payable { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
199: IRecallableSender(_message.from).onMessageRecalled{ value: _message.value }(
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
467: { }
/// @audit `More than one space around an assignment or other operator to align with another`
23: bytes32 private constant _CTX_SLOT =
        0xe4ece82196de19aabe639620d7f716c433d1348f96ce727c9989a982dbadc2b9;
/// @audit `More than one space around an assignment or other operator to align with another`
290: address refundTo =
                _message.refundTo == address(0) ? _message.destOwner : _message.refundTo;
```
[70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L70) | [199](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L199) | [467](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L467) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L70) | [199](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L199) | [467](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L467) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L23) | [290](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L290)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
77: IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
265: } catch { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
268: } catch { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
77: IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
265: } catch { }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
268: } catch { }
/// @audit `More than one space around an assignment or other operator to align with another`
76: (msgHash, message_) =
            IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `More than one space around an assignment or other operator to align with another`
141: (CanonicalNFT memory ctoken,,, uint256[] memory tokenIds, uint256[] memory amounts) =
            abi.decode(data, (CanonicalNFT, address, address, uint256[], uint256[]));
/// @audit `Do not include a whitespace in the receive and fallback functions`
59: id: 0, // will receive a new value
/// @audit `Do not include a whitespace in the receive and fallback functions`
60: from: address(0), // will receive a new value
/// @audit `Do not include a whitespace in the receive and fallback functions`
61: srcChainId: 0, // will receive a new value
```
[77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L77) | [265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L265) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L268) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L77) | [265](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L265) | [268](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L268) | [76](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L76) | [141](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L141) | [59](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L59) | [60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L60) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L61)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
239: IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
379: t.safeTransferFrom({ from: msg.sender, to: address(this), value: _amount });
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
239: IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
379: t.safeTransferFrom({ from: msg.sender, to: address(this), value: _amount });
/// @audit `More than one space around an assignment or other operator to align with another`
218: (bytes memory data, CanonicalERC20 memory ctoken, uint256 balanceChange) =
            _handleMessage(msg.sender, _op.token, _op.to, _op.amount);
/// @audit `More than one space around an assignment or other operator to align with another`
238: (msgHash, message_) =
            IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `More than one space around an assignment or other operator to align with another`
259: (CanonicalERC20 memory ctoken, address from, address to, uint256 amount) =
            abi.decode(_data, (CanonicalERC20, address, address, uint256));
/// @audit `More than one space around an assignment or other operator to align with another`
299: (CanonicalERC20 memory ctoken,,, uint256 amount) =
            abi.decode(data, (CanonicalERC20, address, address, uint256));
/// @audit `Do not include a whitespace in the receive and fallback functions`
222: id: 0, // will receive a new value
/// @audit `Do not include a whitespace in the receive and fallback functions`
223: from: address(0), // will receive a new value
/// @audit `Do not include a whitespace in the receive and fallback functions`
224: srcChainId: 0, // will receive a new value
```
[239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L239) | [379](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L379) | [239](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L239) | [379](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L379) | [218](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L218) | [238](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L238) | [259](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L259) | [299](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L299) | [222](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L222) | [223](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L223) | [224](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L224)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
62: IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
62: IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `More than one space around an assignment or other operator to align with another`
61: (msgHash, message_) =
            IBridge(resolve("bridge", false)).sendMessage{ value: msg.value }(message);
/// @audit `More than one space around an assignment or other operator to align with another`
83: (CanonicalNFT memory ctoken, address from, address to, uint256[] memory tokenIds) =
            abi.decode(_data, (CanonicalNFT, address, address, uint256[]));
/// @audit `More than one space around an assignment or other operator to align with another`
124: (CanonicalNFT memory ctoken,,, uint256[] memory tokenIds) =
            abi.decode(data, (CanonicalNFT, address, address, uint256[]));
/// @audit `Do not include a whitespace in the receive and fallback functions`
45: id: 0, // will receive a new value
/// @audit `Do not include a whitespace in the receive and fallback functions`
46: from: address(0), // will receive a new value
/// @audit `Do not include a whitespace in the receive and fallback functions`
47: srcChainId: 0, // will receive a new value
```
[62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L62) | [62](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L62) | [61](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L61) | [83](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L83) | [124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L124) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L45) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L46) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L47)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
56: if gt(_toCopy, _maxCopy) { _toCopy := _maxCopy }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
56: if gt(_toCopy, _maxCopy) { _toCopy := _maxCopy }
/// @audit `More than one space around an assignment or other operator to align with another`
6: uint256 constant LOW_28_MASK =
        0x00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff;
/// @audit `More than one space around an assignment or other operator to align with another`
44: _success :=
                call(
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L56) | [56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L56) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6) | [44](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L44)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/Bytes.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
63: } { mstore(mc, mload(cc)) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
130: for { let i := 0x00 } lt(i, bytesLength) { i := add(i, 0x01) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
130: for { let i := 0x00 } lt(i, bytesLength) { i := add(i, 0x01) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
63: } { mstore(mc, mload(cc)) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
130: for { let i := 0x00 } lt(i, bytesLength) { i := add(i, 0x01) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
130: for { let i := 0x00 } lt(i, bytesLength) { i := add(i, 0x01) } {
```
[63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L63) | [130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L130) | [130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L130) | [63](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L63) | [130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L130) | [130](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/Bytes.sol#L130)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
47: out_ = RLPItem({ length: _in.length, ptr: ptr });
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
298: for { } lt(i, _length) { i := add(i, 32) } { mstore(add(dest, i), mload(add(src, i))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
298: for { } lt(i, _length) { i := add(i, 32) } { mstore(add(dest, i), mload(add(src, i))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
298: for { } lt(i, _length) { i := add(i, 32) } { mstore(add(dest, i), mload(add(src, i))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
300: if gt(i, _length) { mstore(add(dest, _length), 0) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
47: out_ = RLPItem({ length: _in.length, ptr: ptr });
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
298: for { } lt(i, _length) { i := add(i, 32) } { mstore(add(dest, i), mload(add(src, i))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
298: for { } lt(i, _length) { i := add(i, 32) } { mstore(add(dest, i), mload(add(src, i))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
298: for { } lt(i, _length) { i := add(i, 32) } { mstore(add(dest, i), mload(add(src, i))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
300: if gt(i, _length) { mstore(add(dest, _length), 0) }
```
[47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L47) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L298) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L298) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L298) | [300](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L300) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L47) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L298) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L298) | [298](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L298) | [300](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L300)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { Bytes } from "../Bytes.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { RLPReader } from "../rlp/RLPReader.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
209: proof_[i] = TrieNode({ encoded: _proof[i], decoded: RLPReader.readList(_proof[i]) });
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { Bytes } from "../Bytes.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { RLPReader } from "../rlp/RLPReader.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
209: proof_[i] = TrieNode({ encoded: _proof[i], decoded: RLPReader.readList(_proof[i]) });
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L5) | [209](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L209) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L5) | [209](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/MerkleTrie.sol#L209)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { MerkleTrie } from "./MerkleTrie.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { MerkleTrie } from "./MerkleTrie.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L4) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/trie/SecureMerkleTrie.sol#L4)

```solidity
File: packages/protocol/contracts/verifiers/SgxVerifier.sol

/// @audit `More than one space around an assignment or other operator to align with another`
158: address oldInstance =
            ECDSA.recover(getSignedHash(_tran, newInstance, _ctx.prover, _ctx.metaHash), signature);
```
[158](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/verifiers/SgxVerifier.sol#L158)

```solidity
File: packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol

/// @audit `More than one space around an assignment or other operator to align with another`
69: (address delegatee, uint256 nonce, uint256 expiry, uint8 v, bytes32 r, bytes32 s) =
            abi.decode(delegationData, (address, uint256, uint256, uint8, bytes32, bytes32));
```
[69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/ERC20Airdrop.sol#L69)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { V3Struct } from "./lib/QuoteV3Auth/V3Struct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { V3Parser } from "./lib/QuoteV3Auth/V3Parser.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
6: import { IPEMCertChainLib } from "./lib/interfaces/IPEMCertChainLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
7: import { PEMCertChainLib } from "./lib/PEMCertChainLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
8: import { TCBInfoStruct } from "./lib/TCBInfoStruct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
9: import { EnclaveIdStruct } from "./lib/EnclaveIdStruct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
10: import { IAttestation } from "./interfaces/IAttestation.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
13: import { Base64 } from "solady/src/utils/Base64.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
14: import { LibString } from "solady/src/utils/LibString.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
15: import { BytesUtils } from "./utils/BytesUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
18: import { ISigVerifyLib } from "./interfaces/ISigVerifyLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { V3Struct } from "./lib/QuoteV3Auth/V3Struct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { V3Parser } from "./lib/QuoteV3Auth/V3Parser.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
6: import { IPEMCertChainLib } from "./lib/interfaces/IPEMCertChainLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
7: import { PEMCertChainLib } from "./lib/PEMCertChainLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
8: import { TCBInfoStruct } from "./lib/TCBInfoStruct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
9: import { EnclaveIdStruct } from "./lib/EnclaveIdStruct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
10: import { IAttestation } from "./interfaces/IAttestation.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
13: import { Base64 } from "solady/src/utils/Base64.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
14: import { LibString } from "solady/src/utils/LibString.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
15: import { BytesUtils } from "./utils/BytesUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
18: import { ISigVerifyLib } from "./interfaces/ISigVerifyLib.sol";
/// @audit `Immediately before a comma`
374: ,
/// @audit `Immediately before a comma`
375: ,
/// @audit `More than one space around an assignment or other operator to align with another`
33: bytes32 internal constant ROOTCA_PUBKEY_HASH =
        0x89f72d7c488e5b53a77c23ebcb36970ef7eb5bcf6658e9b8292cfbe4703a8473;
/// @audit `More than one space around an assignment or other operator to align with another`
166: (bool successful, V3Struct.ParsedV3QuoteStruct memory parsedV3Quote) =
            V3Parser.parseInput(quote, address(pemCertLib));
/// @audit `More than one space around an assignment or other operator to align with another`
181: bool miscselectMatched =
            quoteEnclaveReport.miscSelect & enclaveId.miscselectMask == enclaveId.miscselect;
/// @audit `More than one space around an assignment or other operator to align with another`
184: bool attributesMatched =
            quoteEnclaveReport.attributes & enclaveId.attributesMask == enclaveId.attributes;
/// @audit `More than one space around an assignment or other operator to align with another`
279: certNotExpired =
                block.timestamp > certs[i].notBefore && block.timestamp < certs[i].notAfter;
/// @audit `More than one space around an assignment or other operator to align with another`
314: bytes memory concatOfAttestKeyAndQeAuthData =
            abi.encodePacked(authDataV3.ecdsaAttestationKey, authDataV3.qeAuthData.data);
/// @audit `More than one space around an assignment or other operator to align with another`
320: bytes memory pckSignedQeReportBytes =
                V3Parser.packQEReport(authDataV3.pckSignedQeReport);
/// @audit `More than one space around an assignment or other operator to align with another`
387: bool mrEnclaveIsTrusted =
                    _trustedUserMrEnclave[v3quote.localEnclaveReport.mrEnclave];
/// @audit `More than one space around an assignment or other operator to align with another`
401: (verifiedEnclaveIdSuccessfully, qeTcbStatus) =
                _verifyQEReportWithIdentity(v3quote.v3AuthData.pckSignedQeReport);
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L10) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L15) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L18) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L8) | [9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L9) | [10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L10) | [13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L13) | [14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L14) | [15](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L15) | [18](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L18) | [374](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L374) | [375](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L375) | [33](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L33) | [166](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L166) | [181](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L181) | [184](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L184) | [279](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L279) | [314](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L314) | [320](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L320) | [387](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L387) | [401](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L401)

```solidity
File: packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { V3Struct } from "../lib/QuoteV3Auth/V3Struct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { V3Struct } from "../lib/QuoteV3Auth/V3Struct.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L4) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/interfaces/IAttestation.sol#L4)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { LibString } from "solady/src/utils/LibString.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { Asn1Decode, NodePtr } from "../utils/Asn1Decode.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
6: import { BytesUtils } from "../utils/BytesUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
7: import { X509DateUtils } from "../utils/X509DateUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
8: import { IPEMCertChainLib } from "./interfaces/IPEMCertChainLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { LibString } from "solady/src/utils/LibString.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { Asn1Decode, NodePtr } from "../utils/Asn1Decode.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
6: import { BytesUtils } from "../utils/BytesUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
7: import { X509DateUtils } from "../utils/X509DateUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
8: import { IPEMCertChainLib } from "./interfaces/IPEMCertChainLib.sol";
/// @audit `More than one space around an assignment or other operator to align with another`
201: (sgxExtnTraversedSuccessfully, pcesvn, cpuSvns, fmspcBytes, pceidBytes) =
                _findPckTcbInfo(der, tbsPtr, tbsParentPtr);
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L8) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L7) | [8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L8) | [201](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L201)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { Base64 } from "solady/src/utils/Base64.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { BytesUtils } from "../../utils/BytesUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
6: import { IPEMCertChainLib, PEMCertChainLib } from "../../lib/PEMCertChainLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
7: import { V3Struct } from "./V3Struct.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
4: import { Base64 } from "solady/src/utils/Base64.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
5: import { BytesUtils } from "../../utils/BytesUtils.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
6: import { IPEMCertChainLib, PEMCertChainLib } from "../../lib/PEMCertChainLib.sol";
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
7: import { V3Struct } from "./V3Struct.sol";
/// @audit `More than one space around an assignment or other operator to align with another`
39: (bool headerVerifiedSuccessfully, V3Struct.Header memory header) =
            parseAndVerifyHeader(rawHeader);
/// @audit `More than one space around an assignment or other operator to align with another`
45: (bool authDataVerifiedSuccessfully, V3Struct.ECDSAQuoteV3AuthData memory authDataV3) =
            parseAuthDataAndVerifyCertType(quote.substring(436, localAuthDataSize), pemCertLibAddr);
/// @audit `More than one space around an assignment or other operator to align with another`
102: == v3Quote.v3AuthData.qeAuthData.data.length,
/// @audit `More than one space around an assignment or other operator to align with another`
277: (bool certParsedSuccessfully, bytes[] memory quoteCerts) =
            pemCertLib.splitCertificateChain(certBytes, 3);
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L7) | [4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L4) | [5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L5) | [6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L6) | [7](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L7) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L39) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L45) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L102) | [277](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Parser.sol#L277)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

/// @audit `More than one space around an assignment or other operator to align with another`
149: == keccak(other, otherOffset, other.length - otherOffset);
/// @audit `More than one space around an assignment or other operator to align with another`
240: ret :=
                and(
/// @audit `More than one space around an assignment or other operator to align with another`
310: bytes constant BASE32_HEX_TABLE =
        hex"00010203040506070809FFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1FFFFFFFFFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1F";
```
[149](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L149) | [240](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L240) | [310](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L310)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol

/// @audit `More than one space around an assignment or other operator to align with another`
93: bytes memory input =
            bytes.concat(bytes32(_s.length), bytes32(_e.length), bytes32(_m.length), _s, _e, _m);
/// @audit `More than one space around an assignment or other operator to align with another`
241: bytes memory input =
            bytes.concat(bytes32(_s.length), bytes32(_e.length), bytes32(_m.length), _s, _e, _m);
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L93) | [241](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/RsaVerify.sol#L241)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
23: case 1 { totallen := add(totallen, 64) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
39: for { let i := 0 } lt(i, totallen) { i := add(i, 64) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
39: for { let i := 0 } lt(i, totallen) { i := add(i, 64) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
45: case 1 { mstore8(add(scratch, sub(len, i)), 0x80) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
49: case 1 { mstore(add(scratch, 32), or(mload(add(scratch, 32)), mul(len, 8))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
52: for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
52: for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
71: for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
71: for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
94: for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
94: for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
23: case 1 { totallen := add(totallen, 64) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
39: for { let i := 0 } lt(i, totallen) { i := add(i, 64) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
39: for { let i := 0 } lt(i, totallen) { i := add(i, 64) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
45: case 1 { mstore8(add(scratch, sub(len, i)), 0x80) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
49: case 1 { mstore(add(scratch, 32), or(mload(add(scratch, 32)), mul(len, 8))) }
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
52: for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
52: for { let j := 64 } lt(j, 128) { j := add(j, 12) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
71: for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
71: for { let j := 128 } lt(j, 320) { j := add(j, 24) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
94: for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
/// @audit `Immediately inside parenthesis, brackets or braces, with the exception of single line function declarations.`
94: for { let j := 0 } lt(j, 80) { j := add(j, 1) } {
/// @audit `More than one space around an assignment or other operator to align with another`
53: let temp :=
                        xor(
/// @audit `More than one space around an assignment or other operator to align with another`
58: temp :=
                        or(
/// @audit `More than one space around an assignment or other operator to align with another`
72: let temp :=
                        xor(
/// @audit `More than one space around an assignment or other operator to align with another`
77: temp :=
                        or(
/// @audit `More than one space around an assignment or other operator to align with another`
105: f :=
                            xor(
/// @audit `More than one space around an assignment or other operator to align with another`
115: f :=
                            or(
/// @audit `More than one space around an assignment or other operator to align with another`
121: f :=
                            or(
/// @audit `More than one space around an assignment or other operator to align with another`
133: f :=
                            xor(
/// @audit `More than one space around an assignment or other operator to align with another`
143: temp :=
                        or(and(div(x, 0x800000000000000000000000000000000000000), 0xFFFFFFE0), temp)
/// @audit `More than one space around an assignment or other operator to align with another`
148: temp :=
                        add(
/// @audit `More than one space around an assignment or other operator to align with another`
156: x :=
                        or(
/// @audit `More than one space around an assignment or other operator to align with another`
161: x :=
                        or(
/// @audit `More than one space around an assignment or other operator to align with another`
176: ret :=
                mul(
```
[23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L23) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L39) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L39) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L45) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L49) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L52) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L52) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L71) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L71) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L94) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L94) | [23](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L23) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L39) | [39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L39) | [45](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L45) | [49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L49) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L52) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L52) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L71) | [71](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L71) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L94) | [94](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L94) | [53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L53) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L58) | [72](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L72) | [77](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L77) | [105](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L105) | [115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L115) | [121](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L121) | [133](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L133) | [143](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L143) | [148](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L148) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L156) | [161](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L161) | [176](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L176)
</details>

### [N-108] Contract/Libraries Names Do Not Match Their Filenames

According to the Solidity Style Guide, contract names should match their filenames. 
Mismatching contract names and filenames can lead to confusion and make the code harder to maintain and review.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

37: library LibTiers {
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L37)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

12: library NodePtr {
```
[12](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L12)
</details>

### [N-109] Avoid the use of sensitive terms

Inclusive language plays a critical role in fostering an environment where everyone belongs.
Please use alternative terms as suggested below:
master -> source
slave -> replica
blacklist -> blocklist
whitelist -> allowlist

<details>
<summary><i>6 issue instances in 1 files:</i></summary>

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

51: /// @notice Mappings from bridged tokens to their blacklist status.
52: mapping(address btoken => bool blacklisted) public btokenBlacklist;
136: error VAULT_BTOKEN_BLACKLISTED();
162: if (btokenBlacklist[_btokenNew]) revert VAULT_BTOKEN_BLACKLISTED();
181: btokenBlacklist[btokenOld_] = true;
216: if (btokenBlacklist[_op.token]) revert VAULT_BTOKEN_BLACKLISTED();
```
[51](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L51) | [52](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L52) | [136](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L136) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L162) | [181](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L181) | [216](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L216)
</details>

### [N-110] Unused import

The contract contains import statements for libraries or other contracts that are not utilized within the code.
Excessive or unused imports can clutter the codebase, leading to inefficiency and potential confusion.
Consider removing any imports that are not essential to the contract's functionality.

<details>
<summary><i>8 issue instances in 8 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/provers/GuardianProver.sol

/// @audit - ITierProvider imported but not used
4: import "../tiers/ITierProvider.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/GuardianProver.sol#L4)

```solidity
File: packages/protocol/contracts/L2/CrossChainOwned.sol

/// @audit - IERC20 imported but not used
4: import "@openzeppelin/contracts/token/ERC20/IERC20.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/CrossChainOwned.sol#L4)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

/// @audit - SafeCast imported but not used
4: import "@openzeppelin/contracts/utils/math/SafeCast.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L4)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit - Strings imported but not used
5: import "@openzeppelin/contracts/utils/Strings.sol";
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L5)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

/// @audit - Strings imported but not used
4: import "@openzeppelin/contracts/utils/Strings.sol";
```
[4](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L4)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

/// @audit - ERC1967Proxy imported but not used
5: import "@openzeppelin/contracts/proxy/ERC1967/ERC1967Proxy.sol";
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L5)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

/// @audit - BridgedERC1155 imported but not used
9: import "./BridgedERC1155.sol";
```
[9](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L9)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit imported `Base64` not used)
13: import { Base64 } from "solady/src/utils/Base64.sol";
```
[13](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L13)
</details>

### [N-111] `if`-statement can be converted to a ternary

The ternary operator provides a shorthand way to write if / else statements.
It can improve readability and reduce the number of lines of code.
Traditional `if / else` statements, particularly those spanning only a one lines, could potentially be refactored using the ternary operator.

<details>
<summary><i>5 issue instances in 5 files:</i></summary>

```solidity
File: packages/protocol/contracts/L1/libs/LibUtils.sol

80: if (_state.transitions[_slot][1].key == _parentHash) {
            tid_ = 1;
        } else {
            tid_ = _state.transitionIds[_blk.blockId][_parentHash];
        }
```
[80](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibUtils.sol#L80)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol

14: if (_in.length == 1 && uint8(_in[0]) < 128) {
            out_ = _in;
        } else {
            out_ = abi.encodePacked(_writeLength(_in.length, 128), _in);
        }
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPWriter.sol#L14)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

56: if (i > 0) {
                input = LibString.slice(pemChainStr, index, index + len);
            } else {
                input = pemChainStr;
            }
```
[56](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L56)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol

199: } else if (lengthbytesLength == 2) {
                length = der.readUint16(ix + 2);
            } else {
                length = uint256(
                    der.readBytesN(ix + 2, lengthbytesLength) >> (32 - lengthbytesLength) * 8
                );
            }
```
[199](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/Asn1Decode.sol#L199)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol

16: if (x509Time.length == 13) {
            if (uint8(x509Time[0]) - 48 < 5) yrs += 2000;
            else yrs += 1900;
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/X509DateUtils.sol#L16)
</details>

### [N-112] Use of `override` is unnecessary

In Solidity version 0.8.8 and later, the use of the `override` keyword becomes superfluous when a function is overriding solely from an interface and the function isn't present in multiple base contracts.
Previously, the `override` keyword was required as an explicit indication to the compiler. However, this is no longer the case, and the extraneous use of the keyword can make the code less clean and more verbose.

Solidity documentation on [Function Overriding](https://docs.soliditylang.org/en/v0.8.20/contracts.html#function-overriding).

<details>
<summary><i>64 issue instances in 23 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

54: function getAddress(uint64 _chainId, bytes32 _name) public view override returns (address) {
57: function _authorizePause(address) internal pure override {
```
[54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L54) | [57](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L57)

```solidity
File: packages/protocol/contracts/common/EssentialContract.sol

113: function _authorizeUpgrade(address) internal virtual override onlyOwner { }
```
[113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/EssentialContract.sol#L113)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoGovernor.sol

48: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
69: function propose(
        address[] memory _targets,
        uint256[] memory _values,
        string[] memory _signatures,
        bytes[] memory _calldatas,
        string memory _description
    )
        public
        virtual
        override(GovernorCompatibilityBravoUpgradeable)
        returns (uint256)
    {
89: function supportsInterface(bytes4 _interfaceId)
        public
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable, IERC165Upgradeable)
        returns (bool)
    {
99: function state(uint256 _proposalId)
        public
        view
        override(IGovernorUpgradeable, GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (ProposalState)
    {
111: function votingDelay() public pure override returns (uint256) {
117: function votingPeriod() public pure override returns (uint256) {
123: function proposalThreshold() public pure override returns (uint256) {
126: function _execute(
        uint256 _proposalId,
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
    {
139: function _cancel(
        address[] memory _targets,
        uint256[] memory _values,
        bytes[] memory _calldatas,
        bytes32 _descriptionHash
    )
        internal
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (uint256)
    {
152: function _executor()
        internal
        view
        override(GovernorUpgradeable, GovernorTimelockControlUpgradeable)
        returns (address)
    {
```
[48](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L48) | [69](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L69) | [89](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L89) | [99](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L99) | [111](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L111) | [117](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L117) | [123](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L123) | [126](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L126) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L139) | [152](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoGovernor.sol#L152)

```solidity
File: packages/protocol/contracts/L1/gov/TaikoTimelockController.sol

24: function getMinDelay() public view override returns (uint256) {
```
[24](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/gov/TaikoTimelockController.sol#L24)

```solidity
File: packages/protocol/contracts/L1/libs/LibProving.sol

350: function _overrideWithHigherProof(
        TaikoData.TransitionState storage _ts,
        TaikoData.Transition memory _tran,
        TaikoData.TierProof memory _proof,
        ITierProvider.Tier memory _tier,
        IERC20 _tko,
        bool _sameTransition
    )
        private
    {
```
[350](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/libs/LibProving.sol#L350)

```solidity
File: packages/protocol/contracts/L1/TaikoL1.sol

124: function unpause() public override {
186: function getConfig() public view virtual override returns (TaikoData.Config memory) {
219: function _authorizePause(address)
        internal
        view
        virtual
        override
        onlyFromOwnerOrNamed("chain_pauser")
    { }
```
[124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L124) | [186](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L186) | [219](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoL1.sol#L219)

```solidity
File: packages/protocol/contracts/L1/TaikoToken.sol

60: function transfer(address _to, uint256 _amount) public override returns (bool) {
70: function transferFrom(
        address _from,
        address _to,
        uint256 _amount
    )
        public
        override
        returns (bool)
    {
82: function _beforeTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20SnapshotUpgradeable)
    {
93: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
104: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
114: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
```
[60](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L60) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L70) | [82](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L82) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L93) | [104](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L104) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/TaikoToken.sol#L114)

```solidity
File: packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
47: function getTierIds() public pure override returns (uint16[] memory tiers_) {
54: function getMinTier(uint256) public pure override returns (uint16) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L20) | [47](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L47) | [54](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/DevnetTierProvider.sol#L54)

```solidity
File: packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
58: function getTierIds() public pure override returns (uint16[] memory tiers_) {
66: function getMinTier(uint256 _rand) public pure override returns (uint16) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L20) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L58) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/MainnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol

20: function getTier(uint16 _tierId) public pure override returns (ITierProvider.Tier memory) {
58: function getTierIds() public pure override returns (uint16[] memory tiers_) {
66: function getMinTier(uint256 _rand) public pure override returns (uint16) {
```
[20](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L20) | [58](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L58) | [66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/TestnetTierProvider.sol#L66)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

43: function getConfig() public view override returns (Config memory) {
```
[43](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L43)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

230: function _authorizePause(address) internal pure override {
```
[230](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L230)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

115: function sendMessage(Message calldata _message)
        external
        payable
        override
        nonReentrant
        whenNotPaused
        returns (bytes32 msgHash_, Message memory message_)
    {
461: function _authorizePause(address)
        internal
        view
        virtual
        override
        onlyFromOwnerOrNamed("bridge_pauser")
    { }
```
[115](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L115) | [461](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L461)

```solidity
File: packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol

42: function _mintToken(address _account, uint256 _amount) internal override {
46: function _burnToken(address _from, uint256 _amount) internal override {
```
[42](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L42) | [46](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/adapters/USDCAdapter.sol#L46)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

91: function name()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (string memory)
    {
102: function symbol()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (string memory)
    {
113: function decimals()
        public
        view
        override(ERC20Upgradeable, IERC20MetadataUpgradeable)
        returns (uint8)
    {
128: function _mintToken(address _account, uint256 _amount) internal override {
132: function _burnToken(address _from, uint256 _amount) internal override {
139: function _beforeTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20SnapshotUpgradeable)
    {
151: function _afterTokenTransfer(
        address _from,
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
162: function _mint(
        address _to,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
172: function _burn(
        address _from,
        uint256 _amount
    )
        internal
        override(ERC20Upgradeable, ERC20VotesUpgradeable)
    {
```
[91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L91) | [102](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L102) | [113](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L113) | [128](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L128) | [132](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L132) | [139](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L139) | [151](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L151) | [162](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L162) | [172](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L172)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20Base.sol

93: function owner() public view override(IBridgedERC20, OwnableUpgradeable) returns (address) {
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20Base.sol#L93)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC721.sol

87: function name() public view override(ERC721Upgradeable) returns (string memory) {
93: function symbol() public view override(ERC721Upgradeable) returns (string memory) {
107: function tokenURI(uint256 _tokenId) public view virtual override returns (string memory) {
114: function _beforeTokenTransfer(
        address, /*_from*/
        address _to,
        uint256, /*_firstTokenId*/
        uint256 /*_batchSize*/
    )
        internal
        virtual
        override
    {
```
[87](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L87) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L93) | [107](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L107) | [114](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC721.sol#L114)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC1155.sol

124: function _beforeTokenTransfer(
        address, /*_operator*/
        address, /*_from*/
        address _to,
        uint256[] memory, /*_ids*/
        uint256[] memory, /*_amounts*/
        bytes memory /*_data*/
    )
        internal
        virtual
        override
    {
```
[124](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC1155.sol#L124)

```solidity
File: packages/protocol/contracts/tokenvault/BaseVault.sol

39: function supportsInterface(bytes4 _interfaceId) public view virtual override returns (bool) {
```
[39](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BaseVault.sol#L39)

```solidity
File: packages/protocol/contracts/tokenvault/ERC1155Vault.sol

127: function onMessageRecalled(
        IBridge.Message calldata message,
        bytes32 msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
192: function supportsInterface(bytes4 interfaceId)
        public
        view
        virtual
        override(BaseVault, ERC1155ReceiverUpgradeable)
        returns (bool)
    {
204: function name() public pure override returns (bytes32) {
```
[127](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L127) | [192](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L192) | [204](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC1155Vault.sol#L204)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

285: function onMessageRecalled(
        IBridge.Message calldata _message,
        bytes32 _msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
316: function name() public pure override returns (bytes32) {
```
[285](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L285) | [316](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L316)

```solidity
File: packages/protocol/contracts/tokenvault/ERC721Vault.sol

110: function onMessageRecalled(
        IBridge.Message calldata _message,
        bytes32 _msgHash
    )
        external
        payable
        override
        nonReentrant
        whenNotPaused
    {
156: function name() public pure override returns (bytes32) {
```
[110](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L110) | [156](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC721Vault.sol#L156)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

137: function verifyAttestation(bytes calldata data) external view override returns (bool) {
355: function verifyParsedQuote(V3Struct.ParsedV3QuoteStruct calldata v3quote)
        external
        view
        override
        returns (bool, bytes memory)
    {
```
[137](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L137) | [355](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L355)
</details>

### [N-113] Setters should prevent re-setting of the same value

Setter functions should include a condition to check if the new value being assigned is different from the current value. This practice prevents redundant state changes and the emission of unnecessary events, ensuring that changes only occur when actual updates to the values are made.

This not only helps to maintain the integrity of the contract's state but also keeps the event logs cleaner and more meaningful by avoiding the recording of identical consecutive values. Such an approach can improve the clarity and efficiency of debugging and data tracking processes.

<details>
<summary><i>13 issue instances in 7 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

/// @audit Missing `_newAddress` check before state change
49: __addresses[_chainId][_name] = _newAddress;
```
[49](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L49)

```solidity
File: packages/protocol/contracts/L1/provers/Guardians.sol

/// @audit Missing `_minGuardians` check before state change
93: minGuardians = _minGuardians;
```
[93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/provers/Guardians.sol#L93)

```solidity
File: packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol

/// @audit Missing `_newConfig` check before state change
35: customConfig = _newConfig;
/// @audit Missing `_newGasExcess` check before state change
37: gasExcess = _newGasExcess;
```
[35](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L35) | [37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L2/TaikoL2EIP1559Configurable.sol#L37)

```solidity
File: packages/protocol/contracts/tokenvault/BridgedERC20.sol

/// @audit Missing `_snapshooter` check before state change
81: snapshooter = _snapshooter;
```
[81](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/BridgedERC20.sol#L81)

```solidity
File: packages/protocol/contracts/tokenvault/ERC20Vault.sol

/// @audit Missing `_ctoken` check before state change
187: bridgedToCanonical[_btokenNew] = _ctoken;
/// @audit Missing `_btokenNew` check before state change
184: IBridgedERC20(btokenOld_).changeMigrationStatus(_btokenNew, false);
```
[187](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L187) | [184](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/tokenvault/ERC20Vault.sol#L184)

```solidity
File: packages/protocol/contracts/team/airdrop/MerkleClaimable.sol

/// @audit Missing `_merkleRoot` check before state change
53: _setConfig(_claimStart, _claimEnd, _merkleRoot);
/// @audit Missing `_claimStart` check before state change
91: claimStart = _claimStart;
/// @audit Missing `_claimEnd` check before state change
92: claimEnd = _claimEnd;
/// @audit Missing `_merkleRoot` check before state change
93: merkleRoot = _merkleRoot;
```
[53](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L53) | [91](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L91) | [92](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L92) | [93](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/team/airdrop/MerkleClaimable.sol#L93)

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

/// @audit Missing `_trusted` check before state change
66: _trustedUserMrSigner[_mrSigner] = _trusted;
/// @audit Missing `_trusted` check before state change
70: _trustedUserMrEnclave[_mrEnclave] = _trusted;
```
[66](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L66) | [70](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L70)
</details>

### [N-114] NatSpec: Contract declarations should have `@title` tags

NatSpec comments offer an intuitive way to understand the core purpose of a smart contract. 
Especially, the `@title` tag serves as a brief descriptor of the contract's function or intent.
In this Solidity file, the `@title` directive seems to be overlooked.
Incorporating the `@title` tag gives readers a concise overview, thus enhancing clarity.
[Refer to NatSpec Documentation](https://docs.soliditylang.org/en/develop/natspec-format.html)

<details>
<summary><i>7 issue instances in 7 files:</i></summary>

```solidity
File: packages/protocol/contracts/common/AddressManager.sol

10: contract AddressManager is EssentialContract, IAddressManager {
```
[10](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/common/AddressManager.sol#L10)

```solidity
File: packages/protocol/contracts/L1/tiers/ITierProvider.sol

37: library LibTiers {
```
[37](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/L1/tiers/ITierProvider.sol#L37)

```solidity
File: packages/protocol/contracts/signal/SignalService.sol

14: contract SignalService is EssentialContract, ISignalService {
```
[14](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/signal/SignalService.sol#L14)

```solidity
File: packages/protocol/contracts/bridge/IBridge.sol

8: interface IBridge {
```
[8](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/IBridge.sol#L8)

```solidity
File: packages/protocol/contracts/bridge/Bridge.sol

16: contract Bridge is EssentialContract, IBridge {
```
[16](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/bridge/Bridge.sol#L16)

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

5: library ExcessivelySafeCall {
```
[5](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L5)

```solidity
File: packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol

6: library LibFixedPointMath {
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/solmate/LibFixedPointMath.sol#L6)
</details>

### [N-115] Explicit Visibility Recommended in Variable/Function Definitions

In Solidity, variable/function visibility is crucial for controlling access and protecting against unwanted modifications. 
While Solidity functions default to `internal` visibility, it is best practice to explicitly state the visibility for better code readability and avoiding confusion.

The missing visibility could lead to a false sense of security in contract design and potential vulnerabilities.

<details>
<summary><i>5 issue instances in 5 files:</i></summary>

```solidity
File: packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol

6: uint256 constant LOW_28_MASK =
        0x00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff;
```
[6](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/nomad-xyz/ExcessivelySafeCall.sol#L6)

```solidity
File: packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol

11: type MemoryPointer is uint256;
```
[11](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/thirdparty/optimism/rlp/RLPReader.sol#L11)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol

32: uint256 constant SGX_TCB_CPUSVN_SIZE = 16;
```
[32](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/PEMCertChainLib.sol#L32)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol

310: bytes constant BASE32_HEX_TABLE =
        hex"00010203040506070809FFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1FFFFFFFFFFFFFFFFFFFFF0A0B0C0D0E0F101112131415161718191A1B1C1D1E1F";
```
[310](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/BytesUtils.sol#L310)

```solidity
File: packages/protocol/contracts/automata-attestation/utils/SHA1.sol

26: function readword(ptr, off, count) -> result {
```
[26](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/utils/SHA1.sol#L26)
</details>

### [N-116] Open TODOs

An open TODO is present in the code. It is recommended to avoid open TODOs
as they may indicate programming errors that still need to be fixed.

<details>
<summary><i>2 issue instances in 2 files:</i></summary>

```solidity
File: packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol

423: // todo! move decodeCert offchain
```
[423](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/AutomataDcapV3Attestation.sol#L423)

```solidity
File: packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol

40: // todo! In encoded path, we need to calculate the size of certDataArray
```
[40](https://github.com/code-423n4/2024-03-taiko/blob/main/packages/protocol/contracts/automata-attestation/lib/QuoteV3Auth/V3Struct.sol#L40)
</details>

### [N-117] Contracts should have full test coverage

It's recommended to have full test coverage for all contracts.
While 100% code coverage does not guarantee absence of bugs, it can catch simple bugs and reduce regressions during code modifications.
Moreover, to achieve full coverage, authors often have to refactor their code into more modular components, each testable separately.
This leads to lower interdependencies, and results in code that is easier to understand and audit.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: app/2024-03-taiko

1: All files
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/app/2024-03-taiko#L1)
</details>

### [N-118] Large or complicated code bases should implement invariant tests

Large or complex code bases should include invariant fuzzing tests, such as those provided by Echidna.
These tests require the identification of invariants that should not be violated under any circumstances, with the fuzzer testing various inputs and function calls to ensure these invariants always hold.
This is especially important for code with a lot of inline-assembly, complicated math, or complex interactions between contracts. Despite having 100% code coverage, bugs can still occur due to the order of operations a user performs.
Extensive and well-written invariant tests can significantly reduce this testing gap.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: app/2024-03-taiko

1: All files
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/app/2024-03-taiko#L1)
</details>

### [N-119] Implement Formal Verification Proofs to Improve Security

Formal verification offers a mathematical proof confirming that your code operates as intended and is devoid of edge cases 
that may lead to unintended behavior. By leveraging this rigorous audit technique, you not only enhance the robustness 
of your code but also strengthen the trust of stakeholders in the safety of your contract.

<details>
<summary><i>1 issue instances in 1 files:</i></summary>

```solidity
File: app/2024-03-taiko

1: All files
```
[1](https://github.com/code-423n4/2024-03-taiko/blob/main/app/2024-03-taiko#L1)
</details>

